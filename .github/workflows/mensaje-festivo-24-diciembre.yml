name: ğŸ„ Mensaje Festivo 24 de Diciembre

on:
  schedule:
    # Se ejecuta el 24 de diciembre a las 00:00 UTC (medianoche)
    # Cron: minuto hora dÃ­a mes dÃ­a-semana
    - cron: '0 0 24 12 *'
  workflow_dispatch: # Permite ejecuciÃ³n manual

jobs:
  enviar-mensaje-festivo:
    runs-on: ubuntu-latest
    name: Enviar Mensaje Festivo a Todos los Usuarios
    
    steps:
      - name: ğŸ“¥ Checkout cÃ³digo
        uses: actions/checkout@v4
      
      - name: ğŸ”§ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      
      - name: ğŸ„ Ejecutar envÃ­o de mensaje festivo
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_ANON_KEY: ${{ secrets.SUPABASE_ANON_KEY }}
          BREVO_API_KEY: ${{ secrets.BREVO_API_KEY }}
          FROM_EMAIL: ${{ secrets.FROM_EMAIL || 'cresalia25@gmail.com' }}
          FROM_NAME: ${{ secrets.FROM_NAME || 'Cresalia' }}
        run: |
          echo "ğŸ„ Iniciando envÃ­o de mensaje festivo..."
          node scripts/enviar-mensaje-festivo-24.js
      
      - name: ğŸ“ Notificar resultado
        if: always()
        run: |
          if [ ${{ job.status }} == 'success' ]; then
            echo "âœ… El mensaje festivo se enviÃ³ correctamente"
          else
            echo "âŒ Hubo un error al enviar el mensaje festivo"
          fi
