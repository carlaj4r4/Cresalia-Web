# ðŸ¤ Sistema de Alertas: Solidaridad Global + Proximidad Local

## ðŸŽ¯ VisiÃ³n de Cresalia

### **La FilosofÃ­a**

Cresalia cree en la **solidaridad humana** y en la **informaciÃ³n Ãºtil**.

**Por eso tenemos DOS tipos de alertas**:

1. ðŸŒ **Desastres Naturales (Global)** 
   - TODOS se enteran
   - Para fomentar solidaridad
   - Donaciones, ayuda, apoyo emocional

2. ðŸ“ **Emergencias Locales (Proximidad)**
   - Solo usuarios cercanos
   - InformaciÃ³n prÃ¡ctica
   - Evita molestias innecesarias

---

## ðŸŒŠ Tipo 1: Desastres Naturales (Solidaridad Global)

### **Â¿QuÃ© Incluye?**

Emergencias **catastrÃ³ficas** que requieren solidaridad:

- ðŸŒŠ **Inundaciones graves**
- ðŸ”¥ **Incendios forestales** masivos
- ðŸŒªï¸ **Terremotos**
- ðŸŒ€ **Huracanes/Tornados**
- ðŸ¥ **Emergencias sanitarias** (pandemias)
- ðŸšï¸ **Derrumbes** con vÃ­ctimas
- â„ï¸ **Nevadas extremas**

### **CaracterÃ­sticas**

- **Alcance**: `global` (todos los usuarios)
- **Severidad**: Alta o CrÃ­tica
- **Objetivo**: Fomentar ayuda y solidaridad
- **DuraciÃ³n**: DÃ­as o semanas (mientras dure la crisis)

### **Funcionalidades**

1. **NotificaciÃ³n a TODOS**
   - Sin importar ubicaciÃ³n
   - En toda la plataforma

2. **Enlaces a CampaÃ±as de Ayuda**
   - Donar dinero
   - Donar materiales
   - Voluntariado
   - Hospedaje

3. **Compartir en Redes**
   - Viralizar la necesidad
   - Amplificar la ayuda

4. **Contador de Ayudas**
   - Total donado
   - Total de personas ayudadas
   - Transparencia

### **Ejemplo Real**

```
ðŸŒŠ INUNDACIÃ“N GRAVE EN BUENOS AIRES

Miles de familias perdieron sus hogares. 
Necesitamos tu ayuda.

ðŸ“¦ Donar Materiales
ðŸ’µ Donar Dinero
ðŸ  Ofrecer Hospedaje
ðŸ“¢ Compartir

[Ver CampaÃ±a] [Ayudar Ahora]
```

**Resultado**: Todos los usuarios de Cresalia (Argentina, Chile, MÃ©xico, etc.) ven la alerta y pueden ayudar ðŸ’œ

---

## ðŸ“ Tipo 2: Emergencias Locales (InformaciÃ³n PrÃ¡ctica)

### **Â¿QuÃ© Incluye?**

Situaciones **locales** que solo afectan a una zona:

- ðŸ’¡ **Corte de luz** en zona X
- ðŸ’§ **Corte de agua** en barrio Y
- â›½ **Falta de combustible** en ciudad Z
- ðŸš— **Accidente** en Av. Principal
- ðŸš§ **Calle cortada** por obras
- ðŸ“¡ **Corte de internet** en regiÃ³n
- ðŸ¥ **Hospital saturado** en zona

### **CaracterÃ­sticas**

- **Alcance**: `local` (solo usuarios cercanos)
- **Radio**: Configurable (5km, 10km, 20km)
- **Severidad**: Baja o Media
- **Objetivo**: InformaciÃ³n Ãºtil para la zona
- **DuraciÃ³n**: Horas o dÃ­as

### **Funcionalidades**

1. **Filtro por Proximidad**
   - Calcula distancia del usuario
   - Muestra solo si estÃ¡ dentro del radio
   - No molesta a usuarios lejos

2. **InformaciÃ³n PrÃ¡ctica**
   - Desde cuÃ¡ndo estÃ¡ el problema
   - CuÃ¡ndo se espera soluciÃ³n
   - Alternativas disponibles

3. **Reportes Comunitarios**
   - Usuarios pueden reportar
   - VerificaciÃ³n comunitaria
   - Actualizar estado

### **Ejemplo Real**

```
ðŸ’§ CORTE DE AGUA - Zona Norte

Corte desde hace 3 dÃ­as por rotura de caÃ±o.
Empresa estima soluciÃ³n en 48 horas.

ðŸ“ Afecta: Barrios X, Y, Z
ðŸš° Camiones de agua: Av. Principal 1234

[Ver Mapa] [Reportar Estado]
```

**Resultado**: Solo usuarios en zona norte ven la alerta. Usuarios en sur, oeste, etc. NO son molestados âœ…

---

## ðŸ”” Notificaciones Push Configurables

### **CategorÃ­as de Notificaciones**

Los usuarios pueden activar/desactivar:

#### **1. Desastres Naturales (Solidaridad)** ðŸŒ
- âœ… Activado por defecto
- "Quiero ayudar cuando hay emergencias"
- Inundaciones, terremotos, incendios

#### **2. Emergencias Locales (Mi Zona)** ðŸ“
- âœ… Activado por defecto
- "Solo alertas cerca de mÃ­"
- Cortes de servicios, accidentes

#### **3. Alertas de Seguridad** ðŸš¨
- âœ… Activado por defecto
- "Situaciones peligrosas cerca"
- Delincuencia, violencia, peligros

#### **4. InformaciÃ³n Comunitaria** â„¹ï¸
- âš ï¸ Desactivado por defecto
- "Noticias y eventos de mi zona"
- Eventos, avisos menores

### **Panel de ConfiguraciÃ³n**

```
ðŸ”” Mis Notificaciones

ðŸŒ Desastres Naturales (Global)
[âœ“] Quiero recibir alertas para poder ayudar
    Inundaciones, terremotos, incendios...

ðŸ“ Emergencias Locales (Cerca de mÃ­)
[âœ“] Solo alertas dentro de 20 km de mi ubicaciÃ³n
    Cortes de servicios, accidentes...
    
ðŸš¨ Alertas de Seguridad
[âœ“] Situaciones peligrosas cerca de mÃ­
    
â„¹ï¸ InformaciÃ³n Comunitaria
[ ] Noticias y eventos locales
```

---

## ðŸ› ï¸ ImplementaciÃ³n TÃ©cnica

### **Base de Datos (Supabase)**

```sql
CREATE TABLE alertas_emergencia (
    id UUID PRIMARY KEY,
    
    -- ClasificaciÃ³n
    tipo VARCHAR(50), -- 'inundacion', 'corte_luz', etc.
    alcance VARCHAR(20), -- 'global' o 'local'
    severidad VARCHAR(20), -- 'baja', 'media', 'alta', 'critica'
    
    -- UbicaciÃ³n (solo para alcance=local)
    coordenadas JSONB, -- {lat, lng}
    radio_km INTEGER, -- Radio de afectaciÃ³n
    
    -- Contenido
    titulo TEXT,
    descripcion TEXT,
    
    -- Enlaces (para desastres globales)
    url_donar TEXT,
    url_campana TEXT,
    total_ayudas INTEGER DEFAULT 0,
    
    -- Estado
    activa BOOLEAN DEFAULT true,
    fecha_creacion TIMESTAMP,
    fecha_expiracion TIMESTAMP
);
```

### **LÃ³gica de Filtrado (JavaScript)**

```javascript
class SistemaAlertasInteligente {
    
    async mostrarAlertas() {
        const alertas = await obtenerAlertasActivas();
        const miUbicacion = await obtenerMiUbicacion();
        
        alertas.forEach(alerta => {
            if (this.deboMostrarAlerta(alerta, miUbicacion)) {
                this.mostrarAlerta(alerta);
            }
        });
    }
    
    deboMostrarAlerta(alerta, miUbicacion) {
        // 1. Desastres naturales â†’ SIEMPRE mostrar
        if (alerta.alcance === 'global') {
            return true;
        }
        
        // 2. Emergencias locales â†’ Solo si estoy cerca
        if (alerta.alcance === 'local') {
            if (!miUbicacion) return false; // Sin ubicaciÃ³n, no mostrar
            
            const distancia = this.calcularDistancia(
                alerta.coordenadas.lat,
                alerta.coordenadas.lng,
                miUbicacion.lat,
                miUbicacion.lng
            );
            
            return distancia <= alerta.radio_km;
        }
        
        return false;
    }
    
    calcularDistancia(lat1, lng1, lat2, lng2) {
        // FÃ³rmula de Haversine
        const R = 6371; // Radio de la Tierra en km
        const dLat = this.toRad(lat2 - lat1);
        const dLng = this.toRad(lng2 - lng1);
        
        const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                  Math.cos(this.toRad(lat1)) * Math.cos(this.toRad(lat2)) *
                  Math.sin(dLng/2) * Math.sin(dLng/2);
        
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        const distancia = R * c;
        
        return distancia; // en kilÃ³metros
    }
    
    toRad(grados) {
        return grados * (Math.PI / 180);
    }
}
```

---

## ðŸŽ¨ Panel de GestiÃ³n de Alertas

### **Crear Alerta - Paso 1: Tipo**

```
Â¿QuÃ© tipo de alerta vas a crear?

[ ðŸŒ Desastre Natural (Global) ]
  Todos se enteran para ayudar
  Inundaciones, terremotos, incendios...
  
[ ðŸ“ Emergencia Local (Proximidad) ]
  Solo usuarios cercanos
  Cortes de servicios, accidentes...
```

### **Si elijo "Desastre Natural" (Global)**

```
ðŸŒ Crear Alerta de Desastre Natural

Tipo:
[InundaciÃ³n â–¼] Terremoto, Incendio, HuracÃ¡n...

UbicaciÃ³n Afectada:
PaÃ­s: [Argentina â–¼]
Provincia: [Buenos Aires â–¼]
Ciudad: [CABA â–¼]

TÃ­tulo:
[InundaciÃ³n grave en Buenos Aires - Necesitamos tu ayuda]

DescripciÃ³n:
[Miles de familias perdieron sus hogares...]

Severidad: [CrÃ­tica â–¼]

ðŸ“¦ CampaÃ±a de Ayuda (Opcional):
URL Donaciones: [https://cresalia.com/donar/...]
Meta: [$50,000 USD]

[Crear Alerta Global]
```

### **Si elijo "Emergencia Local" (Proximidad)**

```
ðŸ“ Crear Alerta Local (Proximidad)

Tipo:
[Corte de Agua â–¼] Corte de Luz, Accidente, Calle Cortada...

UbicaciÃ³n:
ðŸ“ Seleccionar en mapa
   [Mapa interactivo]
   
Radio de AfectaciÃ³n:
[â—â€•â€•â€•â€•â€•â€•â€•â€•â€•] 10 km

TÃ­tulo:
[Corte de agua en Zona Norte]

DescripciÃ³n:
[Corte desde hace 3 dÃ­as por rotura de caÃ±o...]

DuraciÃ³n Estimada:
[48 horas]

Severidad: [Media â–¼]

[Crear Alerta Local]
```

---

## ðŸ“Š EstadÃ­sticas y Transparencia

### **Para Desastres Globales**

```
ðŸŒŠ InundaciÃ³n en Buenos Aires
Estado: Activa (hace 5 dÃ­as)

ðŸ’° Ayuda Recibida:
$25,430 USD de $50,000 (51%)

ðŸ‘¥ Personas que ayudaron: 847
ðŸ“¦ Donaciones de materiales: 234
ðŸ  Ofrecimientos de hospedaje: 12

[Ver Detalles] [Compartir]
```

### **Para Emergencias Locales**

```
ðŸ’§ Corte de Agua - Zona Norte
Estado: Activa (hace 3 dÃ­as)

ðŸ“ Usuarios alertados: 1,234
ðŸ‘€ Vistas: 892
âœ… Confirmaciones: 156

â° SoluciÃ³n estimada: 48 horas

[Actualizar Estado] [Marcar como Resuelta]
```

---

## âœ… Ventajas de Este Sistema

### **Para Desastres Naturales**

1. **Solidaridad Amplificada**
   - MÃ¡s personas enteradas = mÃ¡s ayuda
   - Comunidad global de Cresalia
   - Impacto real en vidas

2. **Transparencia**
   - Ver cuÃ¡nta ayuda se reuniÃ³
   - Saber que tu aporte suma
   - Confianza en la plataforma

3. **ViralizaciÃ³n Positiva**
   - Compartir en redes
   - Crear conciencia
   - Movimiento solidario

### **Para Emergencias Locales**

1. **InformaciÃ³n Ãštil**
   - Solo si te afecta
   - Evita viajes innecesarios
   - Planifica tu dÃ­a

2. **No Molesta**
   - Solo usuarios cercanos
   - Relevante para tu zona
   - Control de spam

3. **Comunidad Local**
   - Reportes verificados
   - Actualizaciones en tiempo real
   - Ayuda mutua

---

## ðŸš€ PrÃ³ximos Pasos

### **ImplementaciÃ³n**

1. **Modificar Base de Datos**
   - Agregar campo `alcance` (global/local)
   - Agregar campos de campaÃ±a (para desastres)

2. **Agregar LÃ³gica de Proximidad**
   - FunciÃ³n de cÃ¡lculo de distancia
   - Filtro inteligente de alertas

3. **Mejorar Panel de GestiÃ³n**
   - Dos flujos distintos (global vs local)
   - Selector de mapa para emergencias locales

4. **ConfiguraciÃ³n de Notificaciones**
   - Panel para activar/desactivar categorÃ­as
   - Respeto a preferencias del usuario

---

## ðŸ’œ Tu VisiÃ³n es Perfecta

Lo que propones combina:

- âœ… **Solidaridad humana** (desastres globales)
- âœ… **InformaciÃ³n Ãºtil** (emergencias locales)
- âœ… **Respeto al usuario** (notificaciones configurables)
- âœ… **TecnologÃ­a con propÃ³sito** (geolocalizaciÃ³n inteligente)

**Cresalia no es solo una plataforma de compras, es una RED DE AYUDA MUTUA** ðŸ¤ðŸ’œ

---

Â¿Implementamos este sistema completo? ðŸš€
