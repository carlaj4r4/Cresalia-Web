<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîß Testing - Crear Sesi√≥n Demo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Sistemas CSS -->
    <link rel="stylesheet" href="css/sistema-feedbacks.css">
    <link rel="stylesheet" href="css/sistema-desafios-emocionales.css">
    <link rel="stylesheet" href="css/contacto-directo-carla.css">
    <link rel="stylesheet" href="css/filtros-avanzados.css">
    <link rel="stylesheet" href="css/elegant-notifications.css">
    
    <!-- Click Derecho Personalizado -->
    <script src="js/click-derecho-personalizado.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-size: 200% 200%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .container {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 50px;
            max-width: 700px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.3);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        h1 {
            color: #374151;
            margin-bottom: 15px;
            font-size: 2rem;
        }
        
        .subtitle {
            color: #6B7280;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }
        
        .plan-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .plan-btn {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border: 3px solid rgba(102, 126, 234, 0.3);
            color: #374151;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.4s ease;
            text-align: center;
            font-weight: 600;
        }
        
        .plan-btn:hover {
            transform: translateY(-5px) scale(1.05);
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.3);
        }
        
        .plan-btn i {
            display: block;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .info-box {
            background: #E0E7FF;
            border-left: 4px solid #667eea;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .info-box p {
            margin: 0;
            color: #3730A3;
            line-height: 1.6;
        }
        
        .warning-box {
            background: #FEF3C7;
            border-left: 4px solid #F59E0B;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .warning-box p {
            margin: 0;
            color: #92400E;
            line-height: 1.6;
        }
        
        .success-msg {
            background: #D1FAE5;
            border-left: 4px solid #10B981;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }
        
        .success-msg.visible {
            display: block;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Testing - Crear Sesi√≥n Demo</h1>
        <p class="subtitle">
            Selecciona un plan para crear una sesi√≥n de prueba y ver c√≥mo funciona el sistema con diferentes planes:
        </p>
        
        <div class="plan-options">
            <div class="plan-btn" onclick="crearSesionDemo('basic')">
                <i class="fas fa-store"></i>
                B√°sico
                <div style="font-size: 12px; margin-top: 5px; opacity: 0.7;">Emprendimiento peque√±o ‚úÖ</div>
            </div>
            
            <div class="plan-btn" onclick="crearSesionDemo('starter')">
                <i class="fas fa-rocket"></i>
                Starter
                <div style="font-size: 12px; margin-top: 5px; opacity: 0.7;">Emprendimiento peque√±o ‚úÖ</div>
            </div>
            
            <div class="plan-btn" onclick="crearSesionDemo('professional')">
                <i class="fas fa-crown"></i>
                Professional
                <div style="font-size: 12px; margin-top: 5px; opacity: 0.7;">Negocio establecido üè¢</div>
            </div>
            
            <div class="plan-btn" onclick="crearSesionDemo('enterprise')">
                <i class="fas fa-building"></i>
                Enterprise
                <div style="font-size: 12px; margin-top: 5px; opacity: 0.7;">Negocio establecido üè¢</div>
            </div>
        </div>
        
        <div class="info-box">
            <p><strong>‚ÑπÔ∏è Sistema de Respaldo Emocional:</strong></p>
            <p>‚Ä¢ El respaldo emocional se muestra <strong>autom√°ticamente</strong> a tiendas que cumplen con estos criterios:</p>
            <p style="margin-left: 20px;">- Menos de 10 productos en cat√°logo</p>
            <p style="margin-left: 20px;">- Menos de 50 ventas mensuales</p>
            <p style="margin-left: 20px;">- Menos de 1000 visitas mensuales</p>
            <p>‚Ä¢ Esta funcionalidad est√° dise√±ada para <strong>emprendedores que est√°n iniciando</strong>, no para negocios establecidos.</p>
        </div>
        
        <div class="warning-box">
            <p><strong>‚ö†Ô∏è Solo para Testing:</strong></p>
            <p>Esta p√°gina es solo para pruebas. En producci√≥n, los usuarios ingresar√°n por el login real con email y contrase√±a.</p>
        </div>
        
        <div class="success-msg" id="successMsg">
            <p style="color: #065F46; font-weight: 600; margin-bottom: 10px;">
                ‚úÖ ¬°Sesi√≥n creada exitosamente!
            </p>
            <p style="color: #065F46; margin-bottom: 15px;" id="planInfo"></p>
            <p style="color: #065F46; font-size: 14px;">
                Ser√°s redirigido al dashboard en 2 segundos...
            </p>
        </div>
    </div>
    
    <script>
        function crearSesionDemo(plan) {
            console.log('üîß Creando sesi√≥n demo para plan:', plan);
            
            // Mapear planes
            const planesInfo = {
                'basic': { tipo: 'basic', nombre: 'B√°sico', color: '#667eea' },
                'starter': { tipo: 'starter', nombre: 'Starter', color: '#8b5cf6' },
                'professional': { tipo: 'professional', nombre: 'Professional', color: '#ec4899' },
                'enterprise': { tipo: 'enterprise', nombre: 'Enterprise', color: '#f59e0b' }
            };
            
            const planInfo = planesInfo[plan];
            
            // Crear datos de usuario demo
            const usuario = {
                id: 'demo_user_' + Date.now(),
                email: `demo-${plan}@cresalia.com`,
                nombre_tienda: `Tienda ${planInfo.nombre}`,
                creado_en: new Date().toISOString()
            };
            
            const tiendaId = 'demo_tienda_' + Date.now();
            const sessionToken = 'demo_token_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            const timestamp = new Date().getTime();
            
            // Guardar en localStorage
            localStorage.setItem('cresalia_sesion_activa', 'true');
            localStorage.setItem('cresalia_usuario_autenticado', JSON.stringify(usuario));
            localStorage.setItem('cresalia_tienda_id', tiendaId);
            localStorage.setItem('cresalia_session_token', sessionToken);
            localStorage.setItem('cresalia_session_timestamp', timestamp.toString());
            localStorage.setItem('cresalia_plan_actual', JSON.stringify(planInfo));
            
            // SIMULACI√ìN DE M√âTRICAS PARA TESTING
            // Para B√°sico y Starter: m√©tricas bajas (habilita respaldo emocional)
            // Para Professional y Enterprise: m√©tricas altas (deshabilita respaldo emocional)
            let metricas;
            if (plan === 'basic' || plan === 'starter') {
                // Emprendimiento peque√±o - HABILITA respaldo emocional
                metricas = {
                    productos_totales: Math.floor(Math.random() * 5) + 2,  // 2-6 productos
                    ventas_mes: Math.floor(Math.random() * 20) + 5,        // 5-24 ventas
                    vistas_mes: Math.floor(Math.random() * 500) + 100,     // 100-599 vistas
                    dias_activo: Math.floor(Math.random() * 60) + 10       // 10-69 d√≠as
                };
            } else {
                // Negocio establecido - DESHABILITA respaldo emocional
                metricas = {
                    productos_totales: Math.floor(Math.random() * 50) + 15,  // 15-64 productos
                    ventas_mes: Math.floor(Math.random() * 200) + 60,        // 60-259 ventas
                    vistas_mes: Math.floor(Math.random() * 3000) + 1200,     // 1200-4199 vistas
                    dias_activo: Math.floor(Math.random() * 365) + 90        // 90-454 d√≠as
                };
            }
            
            localStorage.setItem('cresalia_metricas_tienda', JSON.stringify(metricas));
            
            console.log('‚úÖ Sesi√≥n demo creada:', {
                usuario: usuario.email,
                plan: planInfo.nombre,
                tienda: tiendaId,
                metricas: metricas
            });
            
            // Mostrar mensaje de √©xito
            const successMsg = document.getElementById('successMsg');
            const planInfoElement = document.getElementById('planInfo');
            
            planInfoElement.innerHTML = `
                Plan: <strong>${planInfo.nombre}</strong><br>
                Usuario: <strong>${usuario.email}</strong><br>
                Tipo: <strong>${plan === 'basic' || plan === 'starter' ? 'Emprendimiento Peque√±o üå±' : 'Negocio Establecido üè¢'}</strong><br>
                Respaldo Emocional: <strong>${plan === 'basic' || plan === 'starter' ? 'Habilitado ‚úÖ' : 'Deshabilitado ‚ùå'}</strong>
            `;
            
            successMsg.classList.add('visible');
            
            // Redirigir despu√©s de 2 segundos
            setTimeout(() => {
                window.location.href = 'tiendas/ejemplo-tienda/admin.html';
            }, 2000);
        }
        
        // Verificar si ya hay sesi√≥n
        window.addEventListener('DOMContentLoaded', () => {
            const sesionActiva = localStorage.getItem('cresalia_sesion_activa');
            if (sesionActiva === 'true') {
                const plan = JSON.parse(localStorage.getItem('cresalia_plan_actual') || '{"nombre": "actual"}');
                if (confirm(`Ya tienes una sesi√≥n activa con plan ${plan.nombre}.\n\n¬øQuieres ir al dashboard o crear una nueva sesi√≥n?`)) {
                    window.location.href = 'tiendas/ejemplo-tienda/admin.html';
                } else {
                    // Limpiar sesi√≥n actual
                    localStorage.removeItem('cresalia_sesion_activa');
                    localStorage.removeItem('cresalia_usuario_autenticado');
                    localStorage.removeItem('cresalia_tienda_id');
                    localStorage.removeItem('cresalia_session_token');
                    localStorage.removeItem('cresalia_session_timestamp');
                    localStorage.removeItem('cresalia_plan_actual');
                }
            }
        });
    </script>
    
    <!-- ===== TODOS LOS SISTEMAS ===== -->
    <!-- Sistema de Bienestar Emocional -->
    <script src="core/recursos-bienestar-emocional.js"></script>
    <script src="core/integracion-bienestar.js"></script>
    <script src="core/sistema-bienestar-completo.js"></script>
    
    <!-- Sistema de Feedbacks -->
    <script src="js/sistema-feedbacks.js"></script>
    
    <!-- Sistema de Desaf√≠os Emocionales -->
    <script src="js/sistema-desafios-emocionales.js"></script>
    
    <!-- Sistema de Contacto Directo -->
    <script src="js/contacto-directo-carla.js"></script>
    
    <!-- Categor√≠as y Servicios -->
    <script src="js/categorias-servicios-populares.js"></script>
    
    <!-- Filtros Avanzados -->
    <script src="js/filtros-avanzados.js"></script>
    
    <!-- Notificaciones Elegantes -->
    <script src="js/elegant-notifications.js"></script>
    
    <!-- Inicializaci√≥n de Sistemas -->
    <script>
        // Inicializar todos los sistemas al cargar
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ [Testing Demo] Inicializando sistemas...');
            
            // Esperar un poco para que todos los scripts se carguen
            setTimeout(() => {
                // Verificar qu√© sistemas est√°n disponibles
                const sistemasDisponibles = {
                    feedbacks: typeof FeedbackSystem !== 'undefined',
                    desafios: typeof DesafiosEmocionales !== 'undefined',
                    contacto: typeof ContactoDirectoCarla !== 'undefined',
                    categorias: typeof CategoriasServiciosPopulares !== 'undefined',
                    filtros: typeof FiltrosAvanzados !== 'undefined',
                    bienestar: typeof SistemaBienestarCompleto !== 'undefined'
                };
                
                console.log('üìä Sistemas disponibles:', sistemasDisponibles);
            
            // Sistema de Bienestar (si existe)
            if (sistemasDisponibles.bienestar) {
                try {
                    // Verificar que la clase est√© disponible
                    if (typeof SistemaBienestarCompleto !== 'undefined') {
                        const sistemaBienestar = new SistemaBienestarCompleto({
                            tenant: { slug: 'testing-demo' },
                            plan: 'pro',
                            metrics: {}
                        });
                        sistemaBienestar.init();
                        window.sistemaBienestar = sistemaBienestar;
                        console.log('‚úÖ Sistema de Bienestar inicializado');
                    } else {
                        console.log('‚ö†Ô∏è SistemaBienestarCompleto no est√° disponible a√∫n');
                        // Intentar de nuevo despu√©s de un breve delay
                        setTimeout(() => {
                            if (typeof SistemaBienestarCompleto !== 'undefined') {
                                const sistemaBienestar = new SistemaBienestarCompleto({
                                    tenant: { slug: 'testing-demo' },
                                    plan: 'pro',
                                    metrics: {}
                                });
                                sistemaBienestar.init();
                                window.sistemaBienestar = sistemaBienestar;
                                console.log('‚úÖ Sistema de Bienestar inicializado (retry)');
                            }
                        }, 1000);
                    }
                } catch (error) {
                    console.log('‚ö†Ô∏è Sistema de Bienestar no disponible:', error.message);
                }
            }
            
            // Categor√≠as y Servicios
            if (sistemasDisponibles.categorias) {
                console.log('‚úÖ Categor√≠as y Servicios cargados:', {
                    categorias: CategoriasServiciosPopulares.categorias.length,
                    servicios: CategoriasServiciosPopulares.servicios.length
                });
                window.categoriasDisponibles = CategoriasServiciosPopulares;
            }
            
            // Contacto (opcional - descoment√° para activar bot√≥n flotante)
            if (sistemasDisponibles.contacto) {
                // ContactoDirectoCarla.crearBotonFlotante();
                console.log('‚úÖ Sistema de Contacto disponible');
            }
            
            console.log('üéâ [Testing Demo] Todos los sistemas cargados');
            }, 1000); // Esperar 1 segundo para que todos los scripts se carguen
        });
    </script>
    
</body>
</html>

