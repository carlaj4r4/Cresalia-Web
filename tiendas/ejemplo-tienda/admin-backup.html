<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Tienda - Panel de Administraci√≥n</title>
    
    <!-- Meta tags para seguridad -->
    <meta name="robots" content="noindex, nofollow">
    <meta name="description" content="Panel de administraci√≥n exclusivo">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://sdk.mercadopago.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com; img-src 'self' data: https:; connect-src 'self' https:;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="../../assets/logo/logo-cresalia.png">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../../css/modales-compactos.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Sistema de Autenticaci√≥n -->
    <script>
        // ============================================
        // FUNCIONES B√ÅSICAS (DEFINIDAS PRIMERO)
        // ============================================
        
        // Funci√≥n para mostrar opci√≥n de IA en formularios
        function mostrarOpcionIA(tipo) {
            if (!tienePlanPago()) {
                return '';
            }
            
            return `
                <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #F3E8FF, #E0E7FF); border-radius: 12px; border: 2px solid #8B5CF6;">
                    <div style="display: flex; align-items: center; margin-bottom: 10px;">
                        <i class="fas fa-robot" style="color: #8B5CF6; font-size: 1.2rem; margin-right: 10px;"></i>
                        <h4 style="color: #5B21B6; margin: 0; font-size: 1.1rem;">ü§ñ Generar con IA</h4>
                    </div>
                    <p style="color: #6B7280; margin-bottom: 15px; font-size: 0.9rem;">Tu plan incluye generaci√≥n autom√°tica de descripciones atractivas</p>
                    <button type="button" onclick="generarDescripcionConIA('${tipo}')" style="background: linear-gradient(135deg, #8B5CF6, #7C3AED); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">
                        <i class="fas fa-magic"></i> Generar Descripci√≥n
                    </button>
                </div>
            `;
        }
        
        // Funci√≥n para verificar si tiene plan de pago
        function tienePlanPago() {
            const plan = localStorage.getItem('plan-actual') || 'basico';
            return plan === 'pro' || plan === 'premium' || plan === 'enterprise';
        }
        
        // Funci√≥n para generar descripci√≥n con IA
        function generarDescripcionConIA(tipo) {
            const nombre = document.getElementById(tipo === 'producto' ? 'nombreProducto' : 'nombreServicio').value;
            const categoria = document.getElementById(tipo === 'producto' ? 'categoriaProducto' : 'categoriaServicio').value;
            
            if (!nombre) {
                mostrarNotificacion('‚ö†Ô∏è Por favor ingresa el nombre primero', 'error');
                return;
            }
            
            // Simular generaci√≥n con IA
            const descripcionesIA = {
                'ropa-mujer': `Descubre ${nombre}, una pieza √∫nica que combina estilo y comodidad. Perfecto para cualquier ocasi√≥n, este art√≠culo est√° dise√±ado para realzar tu personalidad y hacerte sentir segura y elegante.`,
                'electronica': `${nombre} - Tecnolog√≠a de vanguardia al alcance de tu mano. Dise√±ado con los m√°s altos est√°ndares de calidad, este dispositivo te ofrece rendimiento excepcional y durabilidad garantizada.`,
                'hogar': `Transforma tu hogar con ${nombre}. Una adici√≥n perfecta que combina funcionalidad y est√©tica, dise√±ada para hacer tu espacio m√°s c√≥modo y acogedor.`,
                'default': `${nombre} - Una excelente opci√≥n que combina calidad y valor. Dise√±ado pensando en tus necesidades, este producto te ofrece la mejor experiencia.`
            };
            
            const descripcion = descripcionesIA[categoria] || descripcionesIA.default;
            
            // Llenar el campo de descripci√≥n
            const campoDescripcion = document.getElementById(tipo === 'producto' ? 'descripcionProducto' : 'descripcionServicio');
            if (campoDescripcion) {
                campoDescripcion.value = descripcion;
                mostrarNotificacion('‚úÖ Descripci√≥n generada con IA', 'success');
            }
        }
        
        // Funci√≥n para mostrar feedback
        function mostrarFeedback() {
            console.log('üìã Mostrando modal de feedback...');
            // Crear modal de feedback si no existe
            if (!document.getElementById('feedbackModal')) {
                const modalHTML = `
                    <div id="feedbackModal" class="modal" style="display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">
                        <div style="background: white; padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;">
                            <h3 style="color: #1e293b; margin-bottom: 20px; text-align: center;">üìù Enviar Feedback</h3>
                            <form onsubmit="enviarFeedback(event)">
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; font-weight: 600;">Tipo de feedback:</label>
                                    <div style="display: flex; gap: 10px;">
                                        <label><input type="radio" name="feedbackTipo" value="sugerencia" required> Sugerencia</label>
                                        <label><input type="radio" name="feedbackTipo" value="problema" required> Problema</label>
                                        <label><input type="radio" name="feedbackTipo" value="elogio" required> Elogio</label>
                                    </div>
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; font-weight: 600;">Asunto:</label>
                                    <input type="text" id="feedbackAsunto" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; font-weight: 600;">Mensaje:</label>
                                    <textarea id="feedbackMensaje" required rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; resize: vertical;"></textarea>
                                </div>
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; margin-bottom: 5px; font-weight: 600;">Email (opcional):</label>
                                    <input type="email" id="feedbackEmail" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                                </div>
                                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                                    <button type="button" onclick="cerrarFeedback()" style="padding: 10px 20px; border: 1px solid #ddd; background: white; border-radius: 8px; cursor: pointer;">Cancelar</button>
                                    <button type="submit" style="padding: 10px 20px; background: linear-gradient(135deg, #3b82f6, #1d4ed8); color: white; border: none; border-radius: 8px; cursor: pointer;">Enviar</button>
                                </div>
                            </form>
                        </div>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', modalHTML);
            }
            
            // Mostrar modal
            const modal = document.getElementById('feedbackModal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        // Funci√≥n para cerrar sesi√≥n
        function cerrarSesion() {
            console.log('üö™ Cerrando sesi√≥n...');
            localStorage.removeItem('cresalia_sesion_activa');
            localStorage.removeItem('cresalia_session_token');
            localStorage.removeItem('cresalia_user_data');
            mostrarNotificacion('‚úÖ Sesi√≥n cerrada correctamente', 'success');
            setTimeout(() => {
                window.location.href = 'login-tienda.html';
            }, 1000);
        }
        
        // Funci√≥n para deshabilitar widget de bienestar
        function deshabilitarBienestar() {
            console.log('üíú Deshabilitando widget de bienestar...');
            const widget = document.getElementById('bienestarWidget');
            if (widget) {
                widget.style.display = 'none';
                localStorage.setItem('bienestar_deshabilitado', 'true');
                mostrarNotificacion('‚úÖ Widget de bienestar deshabilitado', 'success');
            } else {
                console.log('‚ö†Ô∏è Widget de bienestar no encontrado');
            }
        }
        
        // Funci√≥n para habilitar widget de bienestar
        function habilitarBienestar() {
            console.log('üíú Habilitando widget de bienestar...');
            const widget = document.getElementById('bienestarWidget');
            if (widget) {
                widget.style.display = 'block';
                localStorage.removeItem('bienestar_deshabilitado');
                mostrarNotificacion('‚úÖ Widget de bienestar habilitado', 'success');
            } else {
                console.log('‚ö†Ô∏è Widget de bienestar no encontrado');
            }
        }
        
        // Funci√≥n para verificar estado del widget de bienestar al cargar
        function verificarEstadoWidgetBienestar() {
            console.log('üíú Verificando estado del widget de bienestar...');
            const widget = document.getElementById('bienestarWidget');
            if (widget) {
                const deshabilitado = localStorage.getItem('bienestar_deshabilitado');
                if (deshabilitado === 'true') {
                    widget.style.display = 'none';
                    console.log('üíú Widget de bienestar deshabilitado por configuraci√≥n');
                } else {
                    widget.style.display = 'block';
                    console.log('üíú Widget de bienestar habilitado');
                }
            } else {
                console.log('‚ö†Ô∏è Widget de bienestar no encontrado en el DOM');
            }
        }
        
        // ============================================
        // CONFIGURACI√ìN DE SUPABASE
        // ============================================
        
        // Configuraci√≥n de Supabase
        const SUPABASE_URL = 'https://lvdgklwcgrmfbqwghxhl.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_m2TqrW1AqMOWIIyQM4oYkA_zeyAAhmR';
        // Funci√≥n para verificar configuraci√≥n de Supabase
        function verificarConfiguracionSupabase() {
            if (SUPABASE_ANON_KEY.includes('REEMPLAZA')) {
                console.warn('‚ö†Ô∏è CONFIGURACI√ìN INCOMPLETA: Reemplaza SUPABASE_ANON_KEY con tu clave real');
                console.warn('üìù Ve a tu dashboard de Supabase ‚Üí Settings ‚Üí API ‚Üí anon public');
                return false;
            }
            return true;
        }
        
        // Inicializar Supabase
        let supabase = null;
        
        function initSupabase() {
            if (!supabase) {
                // Verificar configuraci√≥n antes de inicializar
                if (!verificarConfiguracionSupabase()) {
                    console.warn('‚ö†Ô∏è Supabase no configurado correctamente - usando modo offline');
                    return null;
                }
                
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log('‚úÖ Supabase inicializado correctamente');
            }
            return supabase;
        }
        
        // ============================================
        // SISTEMA DE AUTENTICACI√ìN Y SEGURIDAD
        // ============================================
        
        // ELIMINAR MODALES ANTIGUOS INMEDIATAMENTE
        console.log('üîß ELIMINANDO modales antiguos INMEDIATAMENTE...');
        
        // Funci√≥n mejorada para eliminar modales antiguos
        function eliminarModalesAntiguos() {
            const modalesAntiguos = document.querySelectorAll('.modal');
            let eliminados = 0;
            
            modalesAntiguos.forEach(modal => {
                // Identificar modales antiguos por ID o clase (EXCEPTO el nuevo modal de turnos)
                const esModalAntiguo = modal.id === 'modalProducto' || 
                                    modal.id === 'modalServicio' ||
                                    modal.classList.contains('modal-antiguo') ||
                                    (modal.id && modal.id.includes('antiguo'));
                
                if (esModalAntiguo) {
                    console.log('üóëÔ∏è Eliminando modal antiguo:', modal.id || 'sin-id');
                    try {
                    modal.remove();
                        eliminados++;
                    } catch (error) {
                        console.warn('‚ö†Ô∏è Error eliminando modal:', error);
                        // Si no se puede eliminar, ocultarlo
                        modal.style.display = 'none';
                        modal.style.visibility = 'hidden';
                        modal.style.opacity = '0';
                    }
                }
            });
            
            if (eliminados > 0) {
                console.log(`‚úÖ ${eliminados} modales antiguos eliminados`);
            }
        }
        
        // Ejecutar inmediatamente
        eliminarModalesAntiguos();
        
        // Funci√≥n para limpiar DOM completamente
        function limpiarDOMCompletamente() {
            console.log('üßπ LIMPIANDO DOM completamente...');
            
            // Eliminar elementos con clases problem√°ticas
            const elementosProblematicos = document.querySelectorAll('.modal-backdrop, .fade, .show');
            elementosProblematicos.forEach(elemento => {
                if (elemento && elemento.remove) {
                    try {
                        elemento.remove();
                    } catch (error) {
                        console.warn('‚ö†Ô∏è Error eliminando elemento problem√°tico:', error);
                    }
                }
            });
            
            // Eliminar scripts duplicados
            const scripts = document.querySelectorAll('script[src*="supabase"]');
            if (scripts.length > 1) {
                for (let i = 1; i < scripts.length; i++) {
                    scripts[i].remove();
                }
            }
            
            console.log('‚úÖ DOM limpiado completamente');
        }
        
        // Ejecutar cada 100ms para asegurar eliminaci√≥n
        setInterval(eliminarModalesAntiguos, 100);
        
        // Ejecutar limpieza completa cada 2 segundos
        setInterval(limpiarDOMCompletamente, 2000);
        
        // Ejecutar cada 500ms para restaurar event listeners
        setInterval(() => {
            restaurarTodosLosEventListeners();
        }, 500);
        
        // RESTAURAR EVENT LISTENERS INMEDIATAMENTE
        setTimeout(() => {
            console.log('üîß RESTAURANDO event listeners INMEDIATAMENTE...');
            restaurarTodosLosEventListeners();
        }, 100);
        
        // RESTAURAR ONCLICK MEJORADO
        setTimeout(() => {
            console.log('üîß RESTAURANDO onclick mejorado...');
            restaurarTodosLosEventListeners();
        }, 500);
        
        // Ejecutar cada 1000ms para restaurar funcionalidad de remiser√≠a
        setInterval(restaurarFuncionalidadRemiseria, 1000);
        
        // Ejecutar tambi√©n cuando el DOM est√© completamente cargado
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîß DOM cargado - eliminando modales antiguos...');
            eliminarModalesAntiguos();
            
            // RESTAURAR EVENT LISTENERS DE MEN√öS INMEDIATAMENTE
            console.log('üîß RESTAURANDO event listeners de men√∫s...');
            restaurarTodosLosEventListeners();
            
            // RESTAURAR FUNCIONALIDAD DE REMISER√çA
            console.log('üöó RESTAURANDO funcionalidad de remiser√≠a...');
            restaurarFuncionalidadRemiseria();
            
            // VERIFICAR ESTADO DEL WIDGET DE BIENESTAR
            setTimeout(() => {
                verificarEstadoWidgetBienestar();
            }, 1500);
            
        // FUNCI√ìN GLOBAL PARA abrirSistemaTurnos - SIN BUCLE INFINITO
        window.abrirSistemaTurnos = function() {
            console.log('üìÖ Abriendo Sistema de Turnos...');
            
            // Usar el sistema unificado de control de modales
            window.CresaliaModalController.abrirModal('modalSistemaTurnos');
        };
        
        // FUNCIONES DEL SISTEMA DE TURNOS
        function agregarTurno() {
            const hora = document.getElementById('horaTurno').value;
            const servicio = document.getElementById('servicioTurno').value;
            const cliente = document.getElementById('clienteTurno').value;
            
            if (hora && servicio && cliente) {
                console.log('‚úÖ Turno agregado:', hora, servicio, cliente);
                
                // Crear nuevo elemento de turno
                const turnosGrid = document.querySelector('.turnos-grid');
                const nuevoTurno = document.createElement('div');
                nuevoTurno.className = 'turno-item';
                nuevoTurno.innerHTML = `
                    <span class="hora">${hora}</span>
                    <span class="estado ocupado">${cliente} - ${servicio}</span>
                    <button class="btn-cancelar" onclick="cancelarTurno('${hora}')">Cancelar</button>
                `;
                
                // Insertar al principio
                turnosGrid.insertBefore(nuevoTurno, turnosGrid.firstChild);
                
                // Limpiar formulario
                document.getElementById('horaTurno').value = '';
                document.getElementById('servicioTurno').value = '';
                document.getElementById('clienteTurno').value = '';
                
                // Actualizar estad√≠sticas
                actualizarEstadisticasTurnos();
                
                alert(`‚úÖ Turno agregado: ${hora} - ${servicio} para ${cliente}`);
            } else {
                alert('Por favor completa todos los campos');
            }
        }
        
        function reservarTurno(hora) {
            const cliente = prompt(`¬øNombre del cliente para el turno de ${hora}?`);
            const servicio = prompt(`¬øQu√© servicio necesita?`);
            
            if (cliente && servicio) {
                console.log('‚úÖ Turno reservado:', hora, cliente, servicio);
                
                // Buscar el turno y actualizarlo
                const turnos = document.querySelectorAll('.turno-item');
                turnos.forEach(turno => {
                    if (turno.querySelector('.hora').textContent === hora) {
                        turno.querySelector('.estado').textContent = `${cliente} - ${servicio}`;
                        turno.querySelector('.estado').className = 'estado ocupado';
                        turno.querySelector('button').textContent = 'Cancelar';
                        turno.querySelector('button').className = 'btn-cancelar';
                        turno.querySelector('button').setAttribute('onclick', `cancelarTurno('${hora}')`);
                    }
                });
                
                actualizarEstadisticasTurnos();
                alert(`‚úÖ Turno reservado: ${hora} - ${servicio} para ${cliente}`);
            }
        }
        
        function cancelarTurno(hora) {
            if (confirm(`¬øCancelar el turno de ${hora}?`)) {
                console.log('‚ùå Turno cancelado:', hora);
                
                // Buscar el turno y liberarlo
                const turnos = document.querySelectorAll('.turno-item');
                turnos.forEach(turno => {
                    if (turno.querySelector('.hora').textContent === hora) {
                        turno.querySelector('.estado').textContent = 'Disponible';
                        turno.querySelector('.estado').className = 'estado disponible';
                        turno.querySelector('button').textContent = 'Reservar';
                        turno.querySelector('button').className = 'btn-reservar';
                        turno.querySelector('button').setAttribute('onclick', `reservarTurno('${hora}')`);
                    }
                });
                
                actualizarEstadisticasTurnos();
                alert(`‚ùå Turno de ${hora} cancelado`);
            }
        }
        
        function actualizarEstadisticasTurnos() {
            const turnos = document.querySelectorAll('.turno-item');
            const ocupados = document.querySelectorAll('.estado.ocupado').length;
            const disponibles = turnos.length - ocupados;
            
            document.querySelector('.stat-number').textContent = turnos.length;
            document.querySelectorAll('.stat-number')[1].textContent = disponibles;
            document.querySelectorAll('.stat-number')[2].textContent = ocupados;
        }
        
        // EXPONER FUNCIONES GLOBALMENTE PARA QUE FUNCIONEN EN ONCLICK
        window.agregarTurno = agregarTurno;
        window.reservarTurno = reservarTurno;
        window.cancelarTurno = cancelarTurno;
        window.actualizarEstadisticasTurnos = actualizarEstadisticasTurnos;
        
        // FUNCI√ìN ESPEC√çFICA PARA CERRAR EL MODAL DE TURNOS
        window.cerrarModalTurnos = function() {
            // Usar el sistema unificado de control de modales
            window.CresaliaModalController.cerrarModal('modalSistemaTurnos');
        };
        
        // FUNCI√ìN ROBUSTA PARA CERRAR CUALQUIER MODAL DEL WIDGET DE BIENESTAR
        window.cerrarModalBienestar = function(modalId) {
            if (!modalId) {
                // Si no se especifica ID, buscar cualquier modal visible del widget
                const modales = document.querySelectorAll('.modal[style*="display: flex"], .modal.show, div[style*="position: fixed"][style*="display: flex"]');
                modales.forEach(modal => {
                    if (modal && modal.remove) {
                        modal.remove();
                    } else if (modal) {
                        modal.style.display = 'none';
                        modal.classList.remove('show');
                    }
                });
            } else {
                const modal = document.getElementById(modalId);
                if (modal) {
                    if (modal.remove) {
                        modal.remove();
                    } else {
                        modal.style.display = 'none';
                        modal.classList.remove('show');
                    }
                }
            }
            
            // Restaurar scroll
            document.body.style.overflow = 'auto';
            console.log('‚úÖ Modal de bienestar cerrado');
        };
        
        // FUNCI√ìN PARA AGREGAR BOT√ìN DE CERRAR A MODALES DEL WIDGET
        window.agregarBotonCerrarWidget = function(modalId) {
            const modal = document.getElementById(modalId);
            if (!modal) return;
            
            // Buscar el header del modal
            let header = modal.querySelector('.modal-header');
            if (!header) {
                // Si no hay header, buscar el primer div con gradiente
                header = modal.querySelector('div[style*="gradient"]');
            }
            if (!header) {
                // Si no hay header, crear uno
                header = modal.querySelector('.modal-content');
                if (header) {
                    const headerDiv = document.createElement('div');
                    headerDiv.className = 'modal-header';
                    headerDiv.style.cssText = 'position: relative; padding: 20px; background: linear-gradient(135deg, #8B5CF6, #A78BFA); border-radius: 20px 20px 0 0;';
                    header.insertBefore(headerDiv, header.firstChild);
                    header = headerDiv;
                }
            }
            
            if (header) {
                // Verificar si ya tiene bot√≥n de cerrar
                if (!header.querySelector('.btn-cerrar-widget')) {
                    const botonCerrar = document.createElement('button');
                    botonCerrar.className = 'btn-cerrar-widget';
                    botonCerrar.innerHTML = '√ó';
                    botonCerrar.style.cssText = `
                        position: absolute;
                        top: 15px;
                        right: 20px;
                        background: rgba(255,255,255,0.2);
                        border: none;
                        color: white;
                        font-size: 1.5rem;
                        cursor: pointer;
                        width: 35px;
                        height: 35px;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        transition: background 0.3s ease;
                        z-index: 10;
                    `;
                    botonCerrar.onclick = function() {
                        cerrarModalBienestar(modalId);
                    };
                    header.appendChild(botonCerrar);
                    console.log('‚úÖ Bot√≥n de cerrar agregado al modal:', modalId);
                }
            }
        };
        
        // SISTEMA AUTOM√ÅTICO PARA AGREGAR BOTONES DE CERRAR A MODALES DEL WIDGET
        window.verificarYAgregarBotonesCerrar = function() {
            // Lista de IDs de modales del widget de bienestar
            const modalesWidget = [
                'progresoPersonalModal',
                'desafiosModal', 
                'progresoEmpresarialModal',
                'diarioModalNuevo',
                'metricasModal',
                'recursosModal'
            ];
            
            modalesWidget.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (modal && modal.style.display === 'flex') {
                    agregarBotonCerrarWidget(modalId);
                }
            });
            
            // Buscar modales creados din√°micamente por archivos externos
            const modalesDinamicos = document.querySelectorAll('div[style*="position: fixed"][style*="display: flex"]');
            modalesDinamicos.forEach(modal => {
                if (!modal.querySelector('.btn-cerrar-widget') && !modal.querySelector('[onclick*="cerrarModal"]')) {
                    // Agregar bot√≥n de cerrar a modales sin bot√≥n
                    const botonCerrar = document.createElement('button');
                    botonCerrar.className = 'btn-cerrar-widget';
                    botonCerrar.innerHTML = '√ó';
                    botonCerrar.style.cssText = `
                        position: absolute;
                        top: 15px;
                        right: 20px;
                        background: rgba(255,255,255,0.2);
                        border: none;
                        color: white;
                        font-size: 1.5rem;
                        cursor: pointer;
                        width: 35px;
                        height: 35px;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        transition: background 0.3s ease;
                        z-index: 10;
                    `;
                    botonCerrar.onclick = function() {
                        cerrarModalBienestar();
                    };
                    
                    // Buscar el header o el primer div para agregar el bot√≥n
                    let header = modal.querySelector('.modal-header');
                    if (!header) {
                        header = modal.querySelector('div[style*="gradient"]');
                    }
                    if (!header) {
                        header = modal.querySelector('.modal-content');
                    }
                    if (!header) {
                        header = modal;
                    }
                    
                    if (header) {
                        header.style.position = 'relative';
                        header.appendChild(botonCerrar);
                        console.log('‚úÖ Bot√≥n de cerrar agregado a modal din√°mico');
                    }
                }
            });
        };
        
        // Ejecutar verificaci√≥n cada vez que se abre un modal
        setInterval(verificarYAgregarBotonesCerrar, 1000);
        
        // FUNCI√ìN UNIVERSAL PARA CERRAR MODALES (REEMPLAZA cerrarModal) - VERSI√ìN FINAL
        window.cerrarModal = function(elemento) {
            try {
                let modal = null;
                
                if (typeof elemento === 'string') {
                    // Si es un ID, usar la funci√≥n centralizada
                    window.ocultarModal(elemento);
                    return;
                } else if (elemento && elemento.closest) {
                    // Si es un bot√≥n, buscar el modal padre con m√∫ltiples m√©todos
                    modal = elemento.closest('.modal');
                    
                    // Si no encuentra con clase .modal, buscar por otros m√©todos
                    if (!modal) {
                        modal = elemento.closest('div[style*="position: fixed"]');
                    }
                    if (!modal) {
                        modal = elemento.closest('div[style*="z-index"]');
                    }
                    if (!modal) {
                        modal = elemento.closest('div[id*="Modal"]');
                    }
                    if (!modal) {
                        modal = elemento.closest('div[id*="modal"]');
                    }
                    // Buscar cualquier div padre que tenga estilos de modal
                    if (!modal) {
                        modal = elemento.closest('div[style*="background: rgba"]');
                    }
                } else {
                    // Buscar cualquier modal visible
                    modal = document.querySelector('.modal[style*="display: flex"], .modal.show');
                    if (!modal) {
                        modal = document.querySelector('div[style*="position: fixed"][style*="display: flex"]');
                    }
                }
                
                if (modal && modal !== null) {
                    // Verificar que el modal existe y no es null antes de hacer remove
                    if (modal.remove && typeof modal.remove === 'function') {
                        modal.remove();
                    } else {
                        modal.style.display = 'none';
                        modal.classList.remove('show');
                    }
                    
                    // Restaurar scroll
                    document.body.style.overflow = 'auto';
                    console.log('‚úÖ Modal cerrado correctamente');
                } else {
                    console.log('‚ö†Ô∏è Modal no encontrado para cerrar');
                    // Restaurar scroll de todas formas
                    document.body.style.overflow = 'auto';
                }
            } catch (error) {
                console.log('‚ö†Ô∏è Error al cerrar modal:', error);
                // Restaurar scroll de todas formas
                document.body.style.overflow = 'auto';
            }
        };
        
        // REEMPLAZAR TODAS LAS FUNCIONES PROBLEM√ÅTICAS
        window.cerrarModalProducto = function() { cerrarModal('modalProducto'); };
        window.cerrarModalServicio = function() { cerrarModal('modalServicio'); };
        window.cerrarModalProgreso = function() { cerrarModal('progresoModal'); };
        window.cerrarModalProgresoPersonal = function() { cerrarModal('progresoPersonalModal'); };
        window.cerrarModalFeedback = function() { cerrarModal('feedbackModal'); };
        window.cerrarModalEditarProducto = function() { cerrarModal('editarProductoModal'); };
        window.cerrarModalEditarServicio = function() { cerrarModal('editarServicioModal'); };
        window.cerrarModalAnalytics = function() { cerrarModal('analyticsModal'); };
        window.cerrarModalVerificacionPago = function() { cerrarModal('verificacionPagoModal'); };
        window.cerrarModalConfigRemiseria = function() { cerrarModal('modalConfigRemiseria'); };
        window.cerrarModalGeneradorLogos = function() { cerrarModal('modalGeneradorLogos'); };
        window.cerrarModalInfoComisiones = function() { cerrarModal('modalInfoComisiones'); };
        window.cerrarModalCalculadoraComisiones = function() { cerrarModal('modalCalculadoraComisiones'); };
        window.cerrarModalGarantias = function() { cerrarModal('modalGarantias'); };
        
        // INTERCEPTAR Y HACER SEGURA LA FUNCI√ìN .remove() EN TODOS LOS ELEMENTOS
        (function() {
            // Guardar la funci√≥n original
            const originalRemove = Element.prototype.remove;
            
            // Reemplazar con versi√≥n segura
            Element.prototype.remove = function() {
                // Verificar que this no sea null y que sea un elemento v√°lido
                if (this && this.nodeType !== undefined) {
                    try {
                        return originalRemove.call(this);
                    } catch (error) {
                        console.log('‚ö†Ô∏è Error al remover elemento, usando fallback:', error);
                        // Fallback: ocultar el elemento
                        if (this.style) {
                            this.style.display = 'none';
                        }
                        // Restaurar scroll
                        document.body.style.overflow = 'auto';
                        return;
                    }
                } else {
                    console.log('‚ö†Ô∏è Intento de remover elemento null o inv√°lido');
                    // Restaurar scroll
                    document.body.style.overflow = 'auto';
                    return;
                }
            };
            
            console.log('‚úÖ Sistema de remoci√≥n segura de elementos activado');
        })();
        
        // FUNCIONES CENTRALIZADAS PARA GESTI√ìN DE MODALES
        window.mostrarModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('show');
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
                console.log('‚úÖ Modal mostrado:', modalId);
            } else {
                console.warn('‚ö†Ô∏è Modal no encontrado:', modalId);
            }
        };
        
        window.ocultarModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('show');
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
                console.log('‚úÖ Modal ocultado:', modalId);
            } else {
                console.warn('‚ö†Ô∏è Modal no encontrado:', modalId);
            }
        };
        
        // FUNCI√ìN ESPEC√çFICA PARA CERRAR MODALES DE CONSEJOS EMPRESARIALES
        window.cerrarModalConsejosEmpresariales = function() {
            // Buscar cualquier modal visible de consejos empresariales
            const modales = document.querySelectorAll('div[style*="position: fixed"][style*="display: flex"]');
            modales.forEach(modal => {
                // Verificar si es un modal de consejos empresariales
                const contenido = modal.textContent || '';
                if (contenido.includes('consejos') || contenido.includes('empresarial') || 
                    contenido.includes('m√∫sica') || contenido.includes('motivacional') ||
                    contenido.includes('ventas') || contenido.includes('crecer')) {
                    
                    if (modal && modal.remove) {
                        modal.remove();
                    } else if (modal) {
                        modal.style.display = 'none';
                    }
                }
            });
            
            // Restaurar scroll
            document.body.style.overflow = 'auto';
            console.log('‚úÖ Modal de consejos empresariales cerrado');
        };
        
        // EXPONER FUNCI√ìN GLOBALMENTE
        window.cerrarModalConsejos = window.cerrarModalConsejosEmpresariales;
        
        // INTERCEPTAR MODALES DE CONSEJOS EMPRESARIALES EN TIEMPO REAL
        const observerConsejos = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                mutation.addedNodes.forEach(function(node) {
                    if (node.nodeType === 1) { // Element node
                        // Buscar modales de consejos empresariales
                        let modalesConsejos = [];
                        
                        // Buscar en el nodo agregado
                        if (node.querySelectorAll) {
                            const modalesEncontrados = node.querySelectorAll('div[style*="position: fixed"]');
                            modalesConsejos = Array.from(modalesEncontrados);
                        }
                        
                        // Si el nodo mismo es un modal
                        if (node.style && node.style.position === 'fixed' && node.style.display === 'flex') {
                            modalesConsejos.push(node);
                        }
                        
                        // Tambi√©n buscar en todo el documento por si acaso
                        const todosLosModales = document.querySelectorAll('div[style*="position: fixed"][style*="display: flex"]');
                        todosLosModales.forEach(modal => {
                            if (!modalesConsejos.includes(modal)) {
                                modalesConsejos.push(modal);
                            }
                        });
                        
                        modalesConsejos.forEach(modal => {
                            const contenido = modal.textContent || '';
                            const esModalConsejos = contenido.includes('consejos') || contenido.includes('empresarial') || 
                                                   contenido.includes('m√∫sica') || contenido.includes('motivacional') ||
                                                   contenido.includes('ventas') || contenido.includes('crecer') ||
                                                   contenido.includes('emprendedores') || contenido.includes('Emprendedores') ||
                                                   contenido.includes('M√∫sica') || contenido.includes('Motivacional') ||
                                                   contenido.includes('Ventas') || contenido.includes('Crecer');
                            
                            if (esModalConsejos && !modal.querySelector('.btn-cerrar-consejos')) {
                                console.log('üîç Modal de consejos detectado:', contenido.substring(0, 50) + '...');
                                
                                // Agregar bot√≥n de cerrar inmediatamente
                                setTimeout(() => {
                                    if (!modal.querySelector('.btn-cerrar-consejos')) {
                                        const botonCerrar = document.createElement('button');
                                        botonCerrar.className = 'btn-cerrar-consejos';
                                        botonCerrar.innerHTML = '√ó';
                                        botonCerrar.style.cssText = `
                                            position: absolute;
                                            top: 15px;
                                            right: 20px;
                                            background: rgba(255,255,255,0.2);
                                            border: none;
                                            color: white;
                                            font-size: 1.5rem;
                                            cursor: pointer;
                                            width: 35px;
                                            height: 35px;
                                            border-radius: 50%;
                                            display: flex;
                                            align-items: center;
                                            justify-content: center;
                                            transition: background 0.3s ease;
                                            z-index: 999999;
                                        `;
                                        botonCerrar.onclick = function() {
                                            cerrarModalConsejosEmpresariales();
                                        };
                                        
                                        // Buscar el header o el primer div para agregar el bot√≥n
                                        let header = modal.querySelector('.modal-header');
                                        if (!header) {
                                            header = modal.querySelector('div[style*="gradient"]');
                                        }
                                        if (!header) {
                                            header = modal.querySelector('.modal-content');
                                        }
                                        if (!header) {
                                            header = modal.querySelector('div');
                                        }
                                        if (!header) {
                                            header = modal;
                                        }
                                        
                                        if (header) {
                                            header.style.position = 'relative';
                                            header.appendChild(botonCerrar);
                                            console.log('‚úÖ Bot√≥n de cerrar agregado a modal de consejos empresariales');
                                        }
                                    }
                                }, 50);
                            }
                        });
                    }
                });
            });
        });
        
        // Iniciar observaci√≥n
        observerConsejos.observe(document.body, {
            childList: true,
            subtree: true
        });
        
        // FUNCI√ìN ADICIONAL PARA BUSCAR MODALES CADA SEGUNDO
        function buscarYAgregarBotonesCerrar() {
            const modalesConsejos = document.querySelectorAll('div[style*="position: fixed"][style*="display: flex"]');
            modalesConsejos.forEach(modal => {
                const contenido = modal.textContent || '';
                const esModalConsejos = contenido.includes('consejos') || contenido.includes('empresarial') || 
                                       contenido.includes('m√∫sica') || contenido.includes('motivacional') ||
                                       contenido.includes('ventas') || contenido.includes('crecer') ||
                                       contenido.includes('emprendedores') || contenido.includes('Emprendedores') ||
                                       contenido.includes('M√∫sica') || contenido.includes('Motivacional') ||
                                       contenido.includes('Ventas') || contenido.includes('Crecer');
                
                if (esModalConsejos && !modal.querySelector('.btn-cerrar-consejos')) {
                    console.log('üîç Modal de consejos encontrado por b√∫squeda peri√≥dica:', contenido.substring(0, 50) + '...');
                    
                    const botonCerrar = document.createElement('button');
                    botonCerrar.className = 'btn-cerrar-consejos';
                    botonCerrar.innerHTML = '√ó';
                    botonCerrar.style.cssText = `
                        position: absolute;
                        top: 15px;
                        right: 20px;
                        background: rgba(255,255,255,0.2);
                        border: none;
                        color: white;
                        font-size: 1.5rem;
                        cursor: pointer;
                        width: 35px;
                        height: 35px;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        transition: background 0.3s ease;
                        z-index: 999999;
                    `;
                    botonCerrar.onclick = function() {
                        cerrarModalConsejosEmpresariales();
                    };
                    
                    // Buscar el header o el primer div para agregar el bot√≥n
                    let header = modal.querySelector('.modal-header');
                    if (!header) {
                        header = modal.querySelector('div[style*="gradient"]');
                    }
                    if (!header) {
                        header = modal.querySelector('.modal-content');
                    }
                    if (!header) {
                        header = modal.querySelector('div');
                    }
                    if (!header) {
                        header = modal;
                    }
                    
                    if (header) {
                        header.style.position = 'relative';
                        header.appendChild(botonCerrar);
                        console.log('‚úÖ Bot√≥n de cerrar agregado por b√∫squeda peri√≥dica');
                    }
                }
            });
        }
        
        // Ejecutar b√∫squeda cada segundo
        setInterval(buscarYAgregarBotonesCerrar, 1000);
        
        // INTERCEPTAR TODOS LOS CLICKS EN BOTONES DE CERRAR
        document.addEventListener('click', function(e) {
            if (e.target && (
                e.target.classList.contains('btn-cerrar-consejos') ||
                e.target.innerHTML === '√ó' ||
                e.target.textContent === '√ó' ||
                e.target.onclick && e.target.onclick.toString().includes('remove')
            )) {
                console.log('üîç Bot√≥n de cerrar clickeado:', e.target);
                
                // Prevenir el comportamiento por defecto
                e.preventDefault();
                e.stopPropagation();
                
                // Buscar el modal m√°s cercano
                let modal = e.target.closest('div[style*="position: fixed"]');
                if (!modal) {
                    // Buscar cualquier modal visible
                    const modalesVisibles = document.querySelectorAll('div[style*="position: fixed"][style*="display: flex"]');
                    modal = modalesVisibles[modalesVisibles.length - 1]; // El √∫ltimo (m√°s reciente)
                }
                
                if (modal) {
                    console.log('‚úÖ Cerrando modal encontrado');
                    modal.style.display = 'none';
                    modal.classList.remove('show');
                    document.body.style.overflow = 'auto';
                } else {
                    console.log('‚ö†Ô∏è No se encontr√≥ modal para cerrar');
                }
            }
        }, true);
        
        console.log('‚úÖ Observador de modales de consejos empresariales activado');
            
            // ARREGLAR SCROLL DESPU√âS DE ABRIR MODALES
            document.addEventListener('click', function(e) {
                // Si se abre cualquier modal, restaurar scroll
                if (e.target.closest('[data-action], [onclick*="abrir"], [onclick*="mostrar"]')) {
                    setTimeout(() => {
                        document.body.style.overflow = 'auto';
                        document.documentElement.style.overflow = 'auto';
                        console.log('üîß Scroll restaurado despu√©s de abrir modal');
                    }, 100);
                }
            });
        });
        
        // DESACTIVAR SISTEMAS CONFLICTIVOS INMEDIATAMENTE
        window._preventAutoModals = true;
        window._modalesBloqueados = true;
        
        // SISTEMA UNIFICADO DE CONTROL DE MODALES
        window.CresaliaModalController = {
            modalesAbiertos: new Set(),
            sistemaActivo: true,
            
            abrirModal: function(modalId) {
                if (!this.sistemaActivo) return;
                
                const modal = document.getElementById(modalId);
                if (!modal) {
                    console.log('‚ùå Modal no encontrado:', modalId);
                    return;
                }
                
                // Cerrar otros modales primero
                this.cerrarTodosLosModales();
                
                // Abrir el modal solicitado
                modal.style.display = 'flex';
                modal.classList.add('show');
                this.modalesAbiertos.add(modalId);
                
                // Prevenir scroll
                document.body.style.overflow = 'hidden';
                
                console.log('‚úÖ Modal abierto:', modalId);
            },
            
            cerrarModal: function(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.style.display = 'none';
                    modal.classList.remove('show');
                    this.modalesAbiertos.delete(modalId);
                    
                    // Restaurar scroll si no hay otros modales abiertos
                    if (this.modalesAbiertos.size === 0) {
                        document.body.style.overflow = 'auto';
                    }
                    
                    console.log('‚úÖ Modal cerrado:', modalId);
                }
            },
            
            cerrarTodosLosModales: function() {
                this.modalesAbiertos.forEach(modalId => {
                    this.cerrarModal(modalId);
                });
                this.modalesAbiertos.clear();
            },
            
            desactivarSistema: function() {
                this.sistemaActivo = false;
                console.log('üö´ Sistema de modales DESACTIVADO');
            }
        };
        
        // SISTEMA UNIFICADO DE EVENT LISTENERS
        let eventListenersRestaurados = false;
        
        // Funci√≥n unificada para restaurar TODOS los event listeners
        function restaurarTodosLosEventListeners() {
            if (eventListenersRestaurados) {
                console.log('üîß Event listeners ya restaurados, saltando...');
                return;
            }
            
            console.log('üîß RESTAURANDO TODOS los event listeners de manera unificada...');
            
            // LIMPIAR TODOS LOS EVENT LISTENERS ANTERIORES
            document.querySelectorAll('*').forEach(elemento => {
                if (elemento._eventListeners) {
                    elemento._eventListeners.forEach(({ event, handler }) => {
                        elemento.removeEventListener(event, handler);
                    });
                    delete elemento._eventListeners;
                }
            });
            
            // 1. BOTONES DE NAVEGACI√ìN (onclick con mostrarSeccion)
            const botonesNavegacion = document.querySelectorAll('[onclick*="mostrarSeccion"]');
            console.log('üîç Botones de navegaci√≥n encontrados:', botonesNavegacion.length);
            botonesNavegacion.forEach(boton => {
                const onclick = boton.getAttribute('onclick');
                if (onclick) {
                    boton.removeAttribute('onclick');
                    const handler = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîß Navegaci√≥n ejecutada:', onclick);
                        try {
                            const seccion = onclick.match(/mostrarSeccion\('([^']+)'\)/);
                            if (seccion) {
                                mostrarSeccion(seccion[1]);
                            } else {
                                eval(onclick);
                            }
                        } catch (e) {
                            console.error('‚ùå Error en navegaci√≥n:', e);
                        }
                    };
                    boton.addEventListener('click', handler);
                    if (!boton._eventListeners) boton._eventListeners = [];
                    boton._eventListeners.push({ event: 'click', handler });
                }
            });
            
            // 2. BOTONES DE MEN√ö LATERAL
            const botonesMenu = document.querySelectorAll('[onclick*="toggleMenu"], [onclick*="cerrarMenu"]');
            console.log('üîç Botones de men√∫ encontrados:', botonesMenu.length);
            botonesMenu.forEach(boton => {
                const onclick = boton.getAttribute('onclick');
                if (onclick) {
                    boton.removeAttribute('onclick');
                    const handler = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîß Men√∫ ejecutado:', onclick);
                        try {
                            if (onclick.includes('toggleMenu')) {
                                toggleMenu();
                            } else if (onclick.includes('cerrarMenu')) {
                                cerrarMenu();
                            } else {
                                eval(onclick);
                            }
                        } catch (e) {
                            console.error('‚ùå Error en men√∫:', e);
                        }
                    };
                    boton.addEventListener('click', handler);
                    if (!boton._eventListeners) boton._eventListeners = [];
                    boton._eventListeners.push({ event: 'click', handler });
                }
            });
            
            // 3. BOTONES DE MODALES
            const botonesModales = document.querySelectorAll('[onclick*="abrirSistemaTurnos"], [onclick*="mostrarFormularioServicio"], [onclick*="mostrarFormularioProducto"]');
            console.log('üîç Botones de modales encontrados:', botonesModales.length);
            botonesModales.forEach(boton => {
                const onclick = boton.getAttribute('onclick');
                if (onclick) {
                    boton.removeAttribute('onclick');
                    const handler = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîß Modal ejecutado:', onclick);
                        try {
                            if (onclick.includes('abrirSistemaTurnos')) {
                                abrirSistemaTurnos();
                            } else if (onclick.includes('mostrarFormularioServicio')) {
                                mostrarFormularioServicio();
                            } else if (onclick.includes('mostrarFormularioProducto')) {
                                mostrarFormularioProducto();
                            } else {
                                eval(onclick);
                            }
                        } catch (e) {
                            console.error('‚ùå Error en modal:', e);
                        }
                    };
                    boton.addEventListener('click', handler);
                    if (!boton._eventListeners) boton._eventListeners = [];
                    boton._eventListeners.push({ event: 'click', handler });
                }
            });
            
            // 4. BOTONES DE FEEDBACK
            const botonesFeedback = document.querySelectorAll('[onclick*="responderFeedback"]');
            console.log('üîç Botones de feedback encontrados:', botonesFeedback.length);
            botonesFeedback.forEach(boton => {
                const onclick = boton.getAttribute('onclick');
                if (onclick) {
                    boton.removeAttribute('onclick');
                    const handler = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîß Feedback ejecutado:', onclick);
                        try {
                            if (onclick.includes('responderFeedback')) {
                                const feedbackId = onclick.match(/responderFeedback\((\d+)\)/);
                                if (feedbackId) {
                                    responderFeedback(feedbackId[1]);
                                }
                            } else {
                                eval(onclick);
                            }
                        } catch (e) {
                            console.error('‚ùå Error en feedback:', e);
                        }
                    };
                    boton.addEventListener('click', handler);
                    if (!boton._eventListeners) boton._eventListeners = [];
                    boton._eventListeners.push({ event: 'click', handler });
                }
            });
            
            // 5. BOTONES DEL HEADER (data-action)
            const botonesHeader = document.querySelectorAll('[data-action]');
            console.log('üîç Botones del header encontrados:', botonesHeader.length);
            botonesHeader.forEach(boton => {
                const action = boton.getAttribute('data-action');
                if (action) {
                    const handler = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîß Header ejecutado:', action);
                        try {
                            switch(action) {
                                case 'feedback':
                                    mostrarFeedback();
                                    break;
                                case 'ver-feedbacks':
                                    mostrarSeccion('feedbacks');
                                    break;
                                case 'ver-tienda':
                                    window.open('index.html', '_blank');
                                    break;
                                case 'cerrar-sesion':
                                    cerrarSesion();
                                    break;
                                default:
                                    console.log('üîß Acci√≥n no reconocida:', action);
                            }
                        } catch (e) {
                            console.error('‚ùå Error en header:', e);
                        }
                    };
                    boton.addEventListener('click', handler);
                    if (!boton._eventListeners) boton._eventListeners = [];
                    boton._eventListeners.push({ event: 'click', handler });
                }
            });
            
            // 6. BOTONES CON DATA-SECCION
            const botonesDataSeccion = document.querySelectorAll('[data-seccion]');
            console.log('üîç Botones con data-seccion encontrados:', botonesDataSeccion.length);
            botonesDataSeccion.forEach(boton => {
                const seccion = boton.getAttribute('data-seccion');
                if (seccion) {
                    const handler = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîß Data-seccion ejecutado:', seccion);
                        try {
                            mostrarSeccion(seccion);
                        } catch (e) {
                            console.error('‚ùå Error en data-seccion:', e);
                        }
                    };
                    boton.addEventListener('click', handler);
                    if (!boton._eventListeners) boton._eventListeners = [];
                    boton._eventListeners.push({ event: 'click', handler });
                }
            });
            
            // 7. WIDGET DE BIENESTAR EMOCIONAL
            const widgetBienestar = document.querySelectorAll('#bienestarWidget, [onclick*="bienestar"], [onclick*="deshabilitarBienestar"], [onclick*="toggleBienestarMenu"]');
            console.log('üîç Widget de bienestar encontrados:', widgetBienestar.length);
            widgetBienestar.forEach(boton => {
                const onclick = boton.getAttribute('onclick');
                if (onclick) {
                    boton.removeAttribute('onclick');
                    const handler = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîß Bienestar ejecutado:', onclick);
                        try {
                            eval(onclick);
                        } catch (e) {
                            console.error('‚ùå Error en bienestar:', e);
                        }
                    };
                    boton.addEventListener('click', handler);
                    if (!boton._eventListeners) boton._eventListeners = [];
                    boton._eventListeners.push({ event: 'click', handler });
                }
            });
            
            // 8. WIDGET DE BIENESTAR - Event delegation (no depende de cu√°ndo se crea)
            document.addEventListener('click', function(e) {
                // Si se clickea en el widget o dentro de √©l
                if (e.target.closest('#bienestarWidget')) {
                    console.log('üíú Widget de bienestar clickeado v√≠a delegaci√≥n');
                    e.preventDefault();
                    e.stopPropagation();
                    try {
                        if (typeof toggleBienestarMenu === 'function') {
                            toggleBienestarMenu();
                        } else {
                            console.error('‚ùå toggleBienestarMenu no est√° definido');
                        }
                    } catch (err) {
                        console.error('‚ùå Error en widget de bienestar:', err);
                    }
                    return;
                }
                
                // Si se clickea en botones del men√∫ de bienestar
                const button = e.target.closest('#bienestarMenu button[data-action]');
                if (button) {
                    console.log('üíú Bot√≥n de bienestar clickeado v√≠a delegaci√≥n');
                    e.preventDefault();
                    e.stopPropagation();
                    const action = button.getAttribute('data-action');
                    if (action) {
                        try {
                            // Manejar acciones espec√≠ficas
                            switch(action) {
                                case 'progreso-personal':
                                    if (typeof verMiProgresoPersonalCorregido === 'function') {
                                        verMiProgresoPersonalCorregido();
                                    }
                                    break;
                                case 'progreso-empresarial':
                                    if (typeof verMiProgresoCorregido === 'function') {
                                        verMiProgresoCorregido();
                                    }
                                    break;
                                case 'desafios-logros':
                                    if (typeof toggleDesafiosLogrosCorregido === 'function') {
                                        toggleDesafiosLogrosCorregido();
                                    }
                                    break;
                                case 'metricas':
                                    if (typeof abrirMetricasRapidasCorregido === 'function') {
                                        abrirMetricasRapidasCorregido();
                                    }
                                    break;
                                case 'diario':
                                    if (typeof abrirDiarioEmocional === 'function') {
                                        abrirDiarioEmocional();
                                    }
                                    break;
                                case 'relajacion':
                                    if (typeof abrirTecnicasRelajacion === 'function') {
                                        abrirTecnicasRelajacion();
                                    }
                                    break;
                                case 'crisis':
                                    if (typeof abrirRecursosCrisis === 'function') {
                                        abrirRecursosCrisis();
                                    }
                                    break;
                                case 'musica-bienestar':
                                    console.log('üéµ M√∫sica motivacional - funci√≥n externa');
                                    // La funci√≥n se ejecuta desde consejos-empresariales-bienestar.js
                                    break;
                                case 'consejos-empresariales':
                                    console.log('üíº Consejos empresariales - funci√≥n externa');
                                    // La funci√≥n se ejecuta desde consejos-empresariales-bienestar.js
                                    break;
                                case 'consejos-ventas':
                                    console.log('üìà C√≥mo hacer crecer tus ventas - funci√≥n externa');
                                    // La funci√≥n se ejecuta desde consejos-empresariales-bienestar.js
                                    break;
                                default:
                                    console.log('üîß Acci√≥n no reconocida:', action);
                            }
                        } catch (err) {
                            console.error('‚ùå Error en bot√≥n de bienestar:', err);
                        }
                    }
                }
            });
            
            eventListenersRestaurados = true;
            console.log('‚úÖ TODOS los event listeners restaurados de manera unificada');
        }
        
        // FUNCI√ìN MEJORADA PARA RESTAURAR ONCLICK
        function restaurarOnclickMejorado() {
            console.log('üîß RESTAURANDO onclick de manera mejorada...');
            
            // Restaurar botones con data-seccion
            const botonesDataSeccion = document.querySelectorAll('[data-seccion]');
            console.log('üîç Botones con data-seccion encontrados:', botonesDataSeccion.length);
            botonesDataSeccion.forEach(boton => {
                const seccion = boton.getAttribute('data-seccion');
                if (seccion) {
                    // Remover onclick anterior
                    boton.removeAttribute('onclick');
                    // Agregar event listener directo
                    boton.addEventListener('click', function(e) {
                        e.preventDefault();
                        console.log('üîß Onclick data-seccion ejecutado:', seccion);
                        try {
                            mostrarSeccion(seccion);
                        } catch (e) {
                            console.error('‚ùå Error en onclick data-seccion:', e);
                        }
                    });
                }
            });
            
            console.log('‚úÖ Onclick restaurado correctamente');
        }
        
        // RESTAURAR FUNCIONALIDAD DE REMISER√çA COMPLETA
        function restaurarFuncionalidadRemiseria() {
            console.log('üöó RESTAURANDO funcionalidad de remiser√≠a...');
            
            // Cargar servicios de remiser√≠a si la funci√≥n existe
            if (window.cargarServiciosRemiseria) {
                console.log('üöó Cargando servicios de remiser√≠a...');
                window.cargarServiciosRemiseria();
            }
            
            // Restaurar configuraci√≥n de remiser√≠a
            if (window.mostrarConfiguracionRemiseria) {
                console.log('üöó Funci√≥n de configuraci√≥n de remiser√≠a disponible');
            }
            
            // Restaurar funciones espec√≠ficas de remiser√≠a
            if (window.cargarServiciosRemiseriaCompleto) {
                console.log('üöó Cargando servicios completos de remiser√≠a...');
                window.cargarServiciosRemiseriaCompleto();
            }
            
            // Restaurar configuraci√≥n de mapa de remiser√≠a
            if (window.cargarMapaRemiseria) {
                console.log('üöó Cargando mapa de remiser√≠a...');
                window.cargarMapaRemiseria();
            }
            
            // Restaurar funci√≥n de mostrar configuraci√≥n con mapa
            if (window.mostrarConfiguracionRemiseriaConMapa) {
                console.log('üöó Funci√≥n de configuraci√≥n con mapa disponible');
            }
            
            console.log('‚úÖ Funcionalidad de remiser√≠a restaurada completamente');
        }
        
        // ============================================
        // FUNCIONES DE CARGA DE DATOS DESDE SUPABASE
        // ============================================
        
        // Cargar productos desde Supabase
        async function cargarProductosDesdeSupabase() {
            try {
                const supabaseClient = initSupabase();
                if (!supabaseClient) {
                    console.log('‚ö†Ô∏è Supabase no disponible - usando datos locales');
                    return [];
                }
                
                const { data, error } = await supabaseClient
                    .from('productos')
                    .select('*')
                    .eq('tienda_id', 'ejemplo-tienda')
                    .eq('activo', true);
                
                if (error) {
                    console.error('Error cargando productos:', error);
                    console.log('‚ö†Ô∏è Usando datos locales como fallback');
                    return [];
                }
                
                console.log('‚úÖ Productos cargados desde Supabase:', data);
                return data || [];
            } catch (error) {
                console.error('Error conectando con Supabase:', error);
                console.log('‚ö†Ô∏è Usando datos locales como fallback');
                return [];
            }
        }
        
        // Cargar servicios desde Supabase
        async function cargarServiciosDesdeSupabase() {
            try {
                const supabaseClient = initSupabase();
                if (!supabaseClient) {
                    console.log('‚ö†Ô∏è Supabase no disponible - usando datos locales');
                    return [];
                }
                
                const { data, error } = await supabaseClient
                    .from('servicios')
                    .select('*')
                    .eq('tienda_id', 'ejemplo-tienda')
                    .eq('activo', true);
                
                if (error) {
                    console.error('Error cargando servicios:', error);
                    console.log('‚ö†Ô∏è Usando datos locales como fallback');
                    return [];
                }
                
                console.log('‚úÖ Servicios cargados desde Supabase:', data);
                return data || [];
            } catch (error) {
                console.error('Error conectando con Supabase:', error);
                console.log('‚ö†Ô∏è Usando datos locales como fallback');
                return [];
            }
        }
        
        // Cargar feedbacks desde Supabase
        async function cargarFeedbacksDesdeSupabase() {
            try {
                const supabaseClient = initSupabase();
                if (!supabaseClient) {
                    console.log('‚ö†Ô∏è Supabase no disponible - usando datos locales');
                    return [];
                }
                
                const { data, error } = await supabaseClient
                    .from('tienda_feedbacks')
                    .select('*')
                    .eq('tienda_id', 'ejemplo-tienda')
                    .order('fecha_creacion', { ascending: false });
                
                if (error) {
                    console.error('Error cargando feedbacks:', error);
                    console.log('‚ö†Ô∏è Usando datos locales como fallback');
                    return [];
                }
                
                console.log('‚úÖ Feedbacks cargados desde Supabase:', data);
                return data || [];
            } catch (error) {
                console.error('Error conectando con Supabase:', error);
                console.log('‚ö†Ô∏è Usando datos locales como fallback');
                return [];
            }
        }
        
        // VERIFICACI√ìN DE AUTENTICACI√ìN - TEMPORALMENTE DESHABILITADA PARA DESARROLLO
        (function() {
            console.log('üîí Verificaci√≥n de autenticaci√≥n DESHABILITADA para desarrollo');
            
            // Crear sesi√≥n temporal para desarrollo
            localStorage.setItem('cresalia_sesion_activa', 'true');
            localStorage.setItem('cresalia_session_token', 'desarrollo_temporal');
            localStorage.setItem('cresalia_user_data', JSON.stringify({
                email: 'demo@cresalia.com',
                nombre_tienda: 'Tienda Demo',
                plan: 'pro',
                tipo: 'tienda'
            }));
            localStorage.setItem('plan-actual', 'pro');
            
            console.log('‚úÖ Sesi√≥n temporal creada para desarrollo');
            console.log('üë§ Usuario temporal: demo@cresalia.com');
            
            // Cargar datos desde Supabase al inicio
            setTimeout(() => {
                console.log('üîÑ Cargando datos desde Supabase...');
                cargarProductosDesdeSupabase().then(() => {
                    console.log('‚úÖ Productos cargados');
                });
                cargarServiciosDesdeSupabase().then(() => {
                    console.log('‚úÖ Servicios cargados');
                });
                cargarFeedbacksDesdeSupabase().then(() => {
                    console.log('‚úÖ Feedbacks cargados');
                });
            }, 1000);
            
            // NOTA: En producci√≥n, reactivar la verificaci√≥n real
        })();
    </script>
    
    <style>
        /* Estilos b√°sicos - estructura principal */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* Ocultar todos los modales por defecto */
        .modal {
            display: none !important;
        }
        
        /* Solo mostrar modales cuando tengan la clase 'show' */
        .modal.show {
            display: flex !important;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        
        .logo-cresalia {
            font-weight: 700;
            font-size: 1.5rem;
            color: #667eea !important;
            transition: all 0.5s ease;
        }
        
        /* Contenedor principal */
        .admin-container {
            min-height: 100vh;
            background: #f8fafc;
            width: 100%;
        }
        
        /* Header del panel */
        .admin-header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .admin-header h1 {
            color: #1e293b;
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        /* Navegaci√≥n */
        .admin-nav {
            background: white;
            padding: 1rem 2rem;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .nav-tabs {
            border: none;
            gap: 1rem;
        }
        
        .nav-tabs .nav-link {
            border: none;
            color: #64748b;
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .nav-tabs .nav-link.active {
            background: linear-gradient(135deg, #a855f7, #ec4899);
            color: white;
        }
        
        .nav-tabs .nav-link:hover {
            background: #f1f5f9;
            color: #475569;
        }
        
        /* Contenido principal */
        .admin-content {
            padding: 2rem;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: calc(100vh - 140px);
        }
        
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .content-section.active {
            display: block;
        }
        
        /* Dashboard mejorado */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border-left: 4px solid;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .stat-card.products {
            border-left-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .stat-card.services {
            border-left-color: #f093fb;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .stat-card.offers {
            border-left-color: #4facfe;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .stat-card.diary {
            border-left-color: #43e97b;
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transform: translate(30px, -30px);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            opacity: 0.9;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* Cards de acci√≥n mejoradas */
        .action-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .action-card {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .action-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }
        
        .action-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }
        
        .action-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2rem;
            color: white;
            background: linear-gradient(135deg, #667eea, #764ba2);
        }
        
        .action-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #1f2937;
        }
        
        .action-description {
            color: #6b7280;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }
        
        /* Secciones mejoradas */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .section-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1f2937;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .section-title i {
            color: #667eea;
        }
        
        /* Animaciones */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes slideInFromLeft {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideInFromRight {
            from {
                opacity: 0;
                transform: translateX(10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        
        .slide-in-left {
            animation: slideInFromLeft 0.3s ease-out;
        }
        
        .slide-in-right {
            animation: slideInFromRight 0.3s ease-out;
        }
        
        /* Modales b√°sicos */
        .modal {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: rgba(0,0,0,0.7) !important;
            display: none;
            align-items: center !important;
            justify-content: center !important;
            z-index: 10001 !important;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 20px !important;
            box-sizing: border-box !important;
        }
        
        .modal.show {
            display: flex !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .modal-content {
            background: white !important;
            border-radius: 12px !important;
            padding: 20px !important;
            max-width: 450px !important;
            width: 100% !important;
            max-height: 70vh !important;
            overflow-y: auto !important;
            transform: scale(1) !important;
            transition: transform 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3) !important;
        }
        
        .modal.show .modal-content {
            transform: scale(1) !important;
        }
        
        /* ESTILOS DEL SISTEMA DE TURNOS */
        .turnos-container {
            padding: 20px;
            max-width: 800px;
        }
        
        .turnos-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            background: #f9f9f9;
        }
        
        .turnos-section h3 {
            margin: 0 0 20px 0;
            color: #333;
            font-size: 1.2em;
        }
        
        .turnos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .turno-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .turno-item .hora {
            font-weight: bold;
            font-size: 1.1em;
            color: #333;
        }
        
        .estado.disponible {
            color: #28a745;
            font-weight: bold;
        }
        
        .estado.ocupado {
            color: #dc3545;
            font-weight: bold;
        }
        
        .btn-reservar {
            padding: 8px 16px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }
        
        .btn-reservar:hover {
            background: #218838;
        }
        
        .btn-cancelar {
            padding: 8px 16px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }
        
        .btn-cancelar:hover {
            background: #c82333;
        }
        
        .form-turno {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .form-turno input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            flex: 1;
            min-width: 150px;
        }
        
        .form-turno button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .form-turno button:hover {
            background: #0056b3;
        }
        
        .stats-turnos {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .stat-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            display: block;
            font-size: 2em;
            font-weight: bold;
            color: #007bff;
        }
        
        .stat-label {
            display: block;
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        /* Botones */
        .btn {
            padding: 12px 24px !important;
            border: none !important;
            border-radius: 8px !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            text-decoration: none !important;
            display: inline-flex !important;
            align-items: center !important;
            gap: 8px !important;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2) !important;
            color: white !important;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2) !important;
        }
        
        /* Notificaciones */
        .notification {
            position: fixed !important;
            top: 20px !important;
            right: 20px !important;
            padding: 15px 20px !important;
            border-radius: 8px !important;
            color: white !important;
            font-weight: 600 !important;
            z-index: 10001 !important;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0) !important;
        }
        
        .notification.success {
            background: linear-gradient(135deg, #56ab2f, #a8e6cf) !important;
        }
        
        .notification.error {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24) !important;
        }
        
        .notification.info {
            background: linear-gradient(135deg, #4facfe, #00f2fe) !important;
        }
        
        /* Responsive - Widgets y Modales */
        @media (max-width: 768px) {
            .modal-content {
                width: 95% !important;
                padding: 15px !important;
                max-width: 400px !important;
                margin: 0 auto !important;
                max-height: 80vh !important;
                overflow-y: auto !important;
                position: relative !important;
            }
            
            /* ARREGLO ESPEC√çFICO PARA MODALES DEL SISTEMA */
            .modal {
                padding: 10px !important;
                align-items: flex-start !important;
                padding-top: 5vh !important;
            }
            
            /* Elementos flotantes/widgets en m√≥vil */
            .notification {
                right: 10px !important;
                left: 10px !important;
                width: auto !important;
                top: 10px !important;
                font-size: 14px !important;
                padding: 12px 15px !important;
            }
            
            /* Botones flotantes m√°s peque√±os */
            .floating-btn, .widget-btn, .chat-widget {
                width: 50px !important;
                height: 50px !important;
                bottom: 20px !important;
                right: 20px !important;
                font-size: 18px !important;
            }
            
            
            /* Modales de sistema m√°s compactos */
            #feedbackModal .modal-content,
            #desafiosModal .modal-content,
            #recursosModal .modal-content,
            #progresoModal .modal-content {
                width: 95% !important;
                margin: 10px auto !important;
                padding: 15px !important;
                max-height: 80vh !important;
                overflow-y: auto !important;
                max-width: none !important;
            }
            
            /* ARREGLO ESPEC√çFICO PARA TODOS LOS MODALES NUEVOS */
            #recursosModal .modal-content,
            #progresoModal .modal-content,
            #desafiosModal .modal-content,
            #progresoPersonalModal .modal-content,
            #ofertaModal .modal-content,
            #modalAlerta .modal-content,
            #modalSolicitudMentoria .modal-content,
            #modalSerMentor .modal-content {
                transform: none !important;
                position: relative !important;
                width: calc(100vw - 20px) !important;
                max-width: 95vw !important;
                margin: 5px auto !important;
                padding: 15px !important;
                max-height: 80vh !important;
                overflow-y: auto !important;
            }
            
            /* Modales espec√≠ficos con contenido m√°s largo */
            #progresoPersonalModal .modal-content,
            #desafiosModal .modal-content {
                max-height: 85vh !important;
                padding: 10px !important;
            }
            
            /* Contenido interno de modales responsive */
            .modal-content h2, .modal-content h3 {
                font-size: 1.2rem !important;
                margin-bottom: 8px !important;
            }
            
            .modal-content h4, .modal-content h5 {
                font-size: 1rem !important;
                margin-bottom: 6px !important;
            }
            
            .modal-content p {
                font-size: 0.9rem !important;
                line-height: 1.4 !important;
                margin-bottom: 8px !important;
            }
            
            /* Botones en modales m√°s peque√±os */
            .modal-content button {
                padding: 8px 12px !important;
                font-size: 0.85rem !important;
                margin: 3px !important;
            }
            
            /* Grids en modales responsive */
            .modal-content [style*="grid-template-columns"] {
                grid-template-columns: 1fr !important;
                gap: 10px !important;
            }
            
            /* Elementos con padding interno */
            .modal-content [style*="padding: 25px"],
            .modal-content [style*="padding: 30px"] {
                padding: 15px !important;
            }
            
            /* Iconos m√°s peque√±os */
            .modal-content [style*="font-size: 2.5rem"],
            .modal-content [style*="font-size: 3rem"] {
                font-size: 1.8rem !important;
            }
            
            /* Headers de modales m√°s peque√±os */
            .modal-header h3,
            .modal-header h2 {
                font-size: 1.3rem !important;
                margin-bottom: 10px !important;
            }
            
            /* Botones en modales m√°s compactos */
            .modal .btn,
            .modal button {
                padding: 10px 15px !important;
                font-size: 14px !important;
                margin: 5px !important;
            }
            
            /* Panel admin responsive */
            .admin-header {
                padding: 1rem !important;
                flex-direction: column !important;
                gap: 10px !important;
            }
            
            .admin-header h1 {
                font-size: 1.2rem !important;
                text-align: center !important;
                margin: 0 !important;
            }
            
            /* Header botones responsive */
            .admin-header-right {
                flex-wrap: wrap !important;
                justify-content: center !important;
                gap: 8px !important;
            }
            
            .admin-header .btn {
                padding: 6px 10px !important;
                font-size: 0.75rem !important;
                gap: 4px !important;
                border-radius: 8px !important;
                min-width: auto !important;
                white-space: nowrap !important;
            }
            
            .admin-header .btn i {
                font-size: 0.75rem !important;
            }
            
            .admin-nav {
                padding: 0.5rem 1rem !important;
            }
            
            .nav-tabs {
                flex-wrap: wrap !important;
                gap: 0.5rem !important;
            }
            
            .nav-tabs .nav-link {
                padding: 0.5rem 1rem !important;
                font-size: 14px !important;
            }
            
            .admin-content {
                padding: 1rem !important;
            }
            
            .dashboard-stats {
                grid-template-columns: 1fr !important;
                gap: 1rem !important;
            }
            
            .stat-card {
                padding: 1rem !important;
            }
        }
        
        /* Para pantallas muy peque√±as */
        @media (max-width: 480px) {
            .modal-content {
                width: 98% !important;
                padding: 15px !important;
                margin: 5px !important;
            }
            
            .floating-btn, .widget-btn, .chat-widget {
                width: 45px !important;
                height: 45px !important;
                bottom: 15px !important;
                right: 15px !important;
                font-size: 16px !important;
            }
            
            .notification {
                right: 5px !important;
                left: 5px !important;
                top: 5px !important;
                font-size: 12px !important;
                padding: 10px !important;
            }
        }
        
        /* Arreglo para navegaci√≥n responsive mejorada */
        @media (min-width: 769px) {
            .nav-tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
                -webkit-overflow-scrolling: touch;
            }
            
            .nav-tabs::-webkit-scrollbar {
                height: 4px;
            }
            
            .nav-tabs::-webkit-scrollbar-track {
                background: #f1f1f1;
                border-radius: 4px;
            }
            
            .nav-tabs::-webkit-scrollbar-thumb {
                background: linear-gradient(135deg, #a855f7, #ec4899);
                border-radius: 4px;
            }
        }
        
        /* En m√≥vil, permitir wrap y ajustar tama√±os */
        @media (max-width: 768px) {
            .nav-tabs {
                flex-wrap: wrap !important;
                justify-content: center !important;
                gap: 0.3rem !important;
                padding: 0.5rem !important;
            }
            
            .nav-tabs .nav-link {
                padding: 0.4rem 0.8rem !important;
                font-size: 12px !important;
                min-width: auto !important;
                flex: 0 0 auto !important;
                white-space: nowrap !important;
            }
            
            .nav-tabs .nav-link i {
                font-size: 12px !important;
                margin-right: 4px !important;
            }
        }
        
        /* Para pantallas muy peque√±as, hacer los botones a√∫n m√°s compactos */
        @media (max-width: 480px) {
            .nav-tabs .nav-link {
                padding: 0.3rem 0.6rem !important;
                font-size: 11px !important;
            }
            
            .nav-tabs .nav-link i {
                font-size: 11px !important;
                margin-right: 3px !important;
            }
        }
        
        
        /* ====================================================
           CLASES OPTIMIZADAS PARA REDUCIR EVENT LISTENERS
           ================================================== */
        
        /* Hover effects optimizados con CSS puro (sin JavaScript) */
        .btn-hover-green:hover {
            transform: translateY(-1px) !important;
            box-shadow: 0 3px 10px rgba(16, 185, 129, 0.2) !important;
        }
        
        .btn-hover-purple:hover {
            transform: translateY(-1px) !important;
            box-shadow: 0 3px 10px rgba(99, 102, 241, 0.2) !important;
        }
        
        .btn-hover-gradient:hover {
            transform: translateY(-1px) !important;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1) !important;
        }
        
        .btn-hover-scale:hover {
            transform: scale(1.02) !important;
        }
        
        .btn-hover-rotate:hover {
            transform: rotate(45deg) !important;
        }
        
        .btn-hover-feedback:hover {
            background: rgba(255,255,255,0.2) !important;
            transform: rotate(45deg) !important;
        }
        
        .estrella-btn:hover {
            transform: scale(1.1) !important;
            color: #fbbf24 !important;
        }
        
        .estrella-btn.selected {
            color: #fbbf24 !important;
        }
        
        /* Efectos hover para botones de recursos */
        .recurso-btn:hover {
            transform: translateY(-1px) !important;
        }
        
        .recurso-btn.orange:hover {
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4) !important;
        }
        
        .recurso-btn.teal:hover {
            box-shadow: 0 8px 25px rgba(78, 205, 196, 0.4) !important;
        }
        
        .recurso-btn.purple:hover {
            box-shadow: 0 8px 25px rgba(210, 153, 194, 0.4) !important;
        }
        
        .recurso-btn.glass:hover {
            background: rgba(255,255,255,0.3) !important;
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.2) !important;
            transform: translateY(-1px) !important;
        }
        
        /* Efectos optimizados para botones de modales */
        .modal-btn:hover {
            transform: translateY(-1px) scale(1.02) !important;
        }
        
        .modal-btn.gray:hover {
            box-shadow: 0 10px 30px rgba(107, 114, 128, 0.4) !important;
        }
        
        /* Hover gen√©rico optimizado para cualquier elemento */
        .hover-lift:hover {
            transform: translateY(-1px) !important;
        }
        
        .hover-scale:hover {
            transform: scale(1.02) !important;
        }
        
        /* Optimizaci√≥n: reducir animaciones en dispositivos de bajo rendimiento */
        @media (prefers-reduced-motion: reduce) {
            .btn-hover-green:hover,
            .btn-hover-purple:hover,
            .btn-hover-gradient:hover,
            .btn-hover-scale:hover,
            .btn-hover-rotate:hover,
            .btn-hover-feedback:hover,
            .estrella-btn:hover,
            .recurso-btn:hover,
            .modal-btn:hover,
            .hover-lift:hover,
            .hover-scale:hover {
                transform: none !important;
                animation: none !important;
                transition: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Panel de Administraci√≥n de Tienda -->
    <div id="adminPanel" class="admin-container">
        <!-- Header del Panel -->
        <header class="admin-header">
            <div class="admin-header-left">
                <h1 class="logo-cresalia">Mi Tienda - Panel de Administraci√≥n</h1>
            </div>
            <div class="admin-header-right" style="display: flex; align-items: center; gap: 15px;">
                <!-- Enlace a p√°gina p√∫blica de la tienda -->
                <a href="index.html" target="_blank" class="btn btn-hover-green" style="background: linear-gradient(135deg, #10b981, #34d399); color: white; padding: 6px 12px; border-radius: 8px; text-decoration: none; display: flex; align-items: center; gap: 6px; font-size: 0.8rem; transition: all 0.3s ease;">
                    <i class="fas fa-store" style="font-size: 0.8rem;"></i> Ver Mi Tienda
                </a>
                
                <!-- Bot√≥n de Feedback -->
                <button class="btn btn-hover-purple header-btn" data-action="feedback" style="background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; padding: 6px 12px; border-radius: 8px; border: none; cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 0.8rem; transition: all 0.3s ease;">
                    <i class="fas fa-comment-dots" style="font-size: 0.8rem;"></i> Feedback
                </button>
                
                <!-- Bot√≥n alternativo para ir a secci√≥n de feedbacks -->
                <button class="btn btn-hover-green header-btn" data-action="ver-feedbacks" style="background: linear-gradient(135deg, #10b981, #34d399); color: white; padding: 6px 12px; border-radius: 8px; border: none; cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 0.8rem; transition: all 0.3s ease;">
                    <i class="fas fa-comments" style="font-size: 0.8rem;"></i> Ver Feedbacks
                </button>
                
                <button class="btn btn-primary header-btn" data-action="cerrar-sesion" style="padding: 6px 12px; font-size: 0.8rem; gap: 6px;">
                    <i class="fas fa-sign-out-alt" style="font-size: 0.8rem;"></i> Cerrar Sesi√≥n
                </button>
            </div>
        </header>

        <!-- Navegaci√≥n -->
        <nav class="admin-nav" id="adminNavigation">
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <button class="nav-link active nav-btn" data-seccion="dashboard">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link nav-btn" data-seccion="reportes">
                        <i class="fas fa-chart-line"></i> Reportes Completos
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link nav-btn" data-seccion="productos">
                        <i class="fas fa-box"></i> Productos
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link nav-btn" data-seccion="servicios">
                        <i class="fas fa-tools"></i> Servicios
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link nav-btn" data-seccion="ofertas">
                        <i class="fas fa-tag"></i> Ofertas
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link nav-btn" data-seccion="bienestar">
                        <i class="fas fa-heart"></i> Mi Espacio
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link nav-btn" data-seccion="feedbacks">
                        <i class="fas fa-comments"></i> Feedbacks
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link nav-btn" data-seccion="suscripcion">
                        <i class="fas fa-crown"></i> Suscripciones
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link nav-btn" data-seccion="configuracion">
                        <i class="fas fa-cog"></i> Configuraci√≥n
                    </button>
                </li>
            </ul>
        </nav>

        <!-- Contenido Principal -->
        <main class="admin-content">
            <!-- Dashboard -->
            <section id="dashboard" class="content-section active">
                <div class="fade-in">
                    <h1 class="section-title">
                        <i class="fas fa-tachometer-alt"></i>
                        Dashboard
                    </h1>
                    <p style="color: #6b7280; margin-bottom: 2rem; font-size: 1.1rem;">
                        Bienvenido al panel de administraci√≥n de tu tienda. Gestiona tus productos, servicios y ofertas desde aqu√≠.
                    </p>
                    
                    <!-- Estad√≠sticas -->
                    <div class="dashboard-stats">
                        <div class="stat-card products slide-in-left">
                            <div class="stat-icon">
                                <i class="fas fa-box"></i>
                            </div>
                            <div class="stat-number" id="totalProductos">0</div>
                            <div class="stat-label">Productos Activos</div>
                        </div>
                        
                        <div class="stat-card services slide-in-left" style="animation-delay: 0.1s;">
                            <div class="stat-icon">
                                <i class="fas fa-tools"></i>
                            </div>
                            <div class="stat-number" id="totalServicios">0</div>
                            <div class="stat-label">Servicios Disponibles</div>
                        </div>
                        
                        <div class="stat-card offers slide-in-right" style="animation-delay: 0.2s;">
                            <div class="stat-icon">
                                <i class="fas fa-tag"></i>
                            </div>
                            <div class="stat-number" id="totalOfertas">0</div>
                            <div class="stat-label">Ofertas Activas</div>
                        </div>
                        
                        <div class="stat-card diary slide-in-right" style="animation-delay: 0.3s;">
                            <div class="stat-icon">
                                <i class="fas fa-heart"></i>
                            </div>
                            <div class="stat-number" id="totalEntradas">0</div>
                            <div class="stat-label">Entradas del Diario</div>
                        </div>
                    </div>
                    
                    <!-- SISTEMA DE MOTIVACI√ìN INTELIGENTE -->
                    <div id="motivacionContainer" style="margin-bottom: 2rem;">
                        <!-- Se llenar√° din√°micamente con JavaScript -->
                    </div>
                    
                    <!-- Acciones R√°pidas -->
                    <h2 style="color: #374151; font-size: 1.5rem; margin-bottom: 1.5rem; margin-top: 2rem;">
                        <i class="fas fa-rocket"></i> Gesti√≥n R√°pida
                    </h2>
                    <div class="action-cards">
                        <div class="action-card fade-in" style="animation-delay: 0.4s;">
                            <div class="action-icon">
                                <i class="fas fa-box"></i>
                            </div>
                            <h3 class="action-title">Mis Productos</h3>
                            <p class="action-description">
                                Gestiona tu cat√°logo completo de productos. Crea, edita y organiza con carga de im√°genes.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarSeccion('productos')" style="text-decoration: none;">
                                <i class="fas fa-box"></i> Ir a Productos
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.5s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                                <i class="fas fa-concierge-bell"></i>
                            </div>
                            <h3 class="action-title">Mis Servicios</h3>
                            <p class="action-description">
                                Administra todos tus servicios profesionales. Define precios, duraciones, reservas, mapas y categor√≠as.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarSeccion('servicios')" style="background: linear-gradient(135deg, #f093fb, #f5576c); text-decoration: none;">
                                <i class="fas fa-concierge-bell"></i> Ir a Servicios
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.55s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #8B5CF6, #A855F7);">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <h3 class="action-title">Sistema de Turnos</h3>
                            <p class="action-description">
                                Gestiona turnos autom√°ticos con IA, comprobantes personalizados y notificaciones por email/WhatsApp.
                            </p>
                            <button class="btn btn-primary" onclick="abrirSistemaTurnos()" style="background: linear-gradient(135deg, #8B5CF6, #A855F7); text-decoration: none;">
                                <i class="fas fa-calendar-check"></i> Configurar Turnos
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.6s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                                <i class="fas fa-tags"></i>
                            </div>
                            <h3 class="action-title">Mis Ofertas</h3>
                            <p class="action-description">
                                Crea y gestiona ofertas especiales. Atrae m√°s clientes con descuentos y promociones.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarSeccion('ofertas')" style="background: linear-gradient(135deg, #4facfe, #00f2fe); text-decoration: none;">
                                <i class="fas fa-tags"></i> Ir a Ofertas
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.7s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #fa709a, #fee140);">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h3 class="action-title">Mi Progreso Empresarial</h3>
                            <p class="action-description">
                                Visualiza tu crecimiento, metas alcanzadas y el camino recorrido en tu negocio.
                            </p>
                            <button class="btn btn-primary" onclick="verMiProgreso()" style="background: linear-gradient(135deg, #fa709a, #fee140); width: 100%; border: none; cursor: pointer;">
                                <i class="fas fa-chart-line"></i> Ver Mi Progreso
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.8s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                <i class="fas fa-tachometer-alt"></i>
                            </div>
                            <h3 class="action-title">M√©tricas R√°pidas</h3>
                            <p class="action-description">
                                Vista r√°pida de tus estad√≠sticas principales en tiempo real con m√©tricas detalladas.
                            </p>
                            <button class="btn btn-primary" onclick="abrirMetricasRapidas()" style="background: linear-gradient(135deg, #667eea, #764ba2); width: 100%; border: none; cursor: pointer;">
                                <i class="fas fa-chart-pie"></i> Ver M√©tricas
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.9s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #a8edea, #fed6e3);">
                                <i class="fas fa-book"></i>
                            </div>
                            <h3 class="action-title">Recursos y Consejos</h3>
                            <p class="action-description">
                                Accede a recursos, consejos y herramientas para mantener tu equilibrio empresarial.
                            </p>
                            <button class="btn btn-primary" onclick="verRecursos()" style="background: linear-gradient(135deg, #a8edea, #fed6e3); color: #333; width: 100%; border: none; cursor: pointer;">
                                <i class="fas fa-book"></i> Ver Recursos
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 1.0s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #ffecd2, #fcb69f);">
                                <i class="fas fa-cog"></i>
                            </div>
                            <h3 class="action-title">Configuraci√≥n</h3>
                            <p class="action-description">
                                Personaliza tu tienda: interfaz, pagos, chatbot, soporte y mucho m√°s.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarSeccion('configuracion')" style="background: linear-gradient(135deg, #ffecd2, #fcb69f); color: #333; text-decoration: none;">
                                <i class="fas fa-cog"></i> Configurar Tienda
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 1.1s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #10B981, #059669);">
                                <i class="fas fa-percentage"></i>
                            </div>
                            <h3 class="action-title">Sistema de Comisiones</h3>
                            <p class="action-description">
                                Transparencia total en nuestras comisiones. Calcula y visualiza comisiones de forma clara.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarInfoComisiones()" style="background: linear-gradient(135deg, #10B981, #059669); color: white; text-decoration: none;">
                                <i class="fas fa-percentage"></i> Ver Comisiones
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.9s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #f59e0b, #ef4444);">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <h3 class="action-title">Garant√≠as y Devoluciones</h3>
                            <p class="action-description">
                                Configura las garant√≠as de tus productos y el sistema de devoluciones para tus clientes.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarConfiguracionGarantias()" style="background: linear-gradient(135deg, #f59e0b, #ef4444); color: white; text-decoration: none;">
                                <i class="fas fa-cog"></i> Configurar
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Reportes -->
            <section id="reportes" class="content-section">
                <div class="fade-in">
                    <h1 class="section-title">
                        <i class="fas fa-chart-line"></i>
                        Reportes y Analytics
                    </h1>
                    <p style="color: #6b7280; margin-bottom: 2rem; font-size: 1.1rem;">
                        Visualiza m√©tricas y genera reportes detallados seg√∫n tu plan.
                    </p>
                    
                    <!-- Cards de Analytics -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-bottom: 3rem;">
                        
                        <!-- M√©tricas R√°pidas -->
                        <div class="action-card" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; text-align: center; padding: 2.5rem;">
                            <div class="action-icon" style="background: rgba(255,255,255,0.2); margin: 0 auto 1.5rem;">
                                <i class="fas fa-tachometer-alt"></i>
                            </div>
                            <h3 class="action-title" style="color: white; margin-bottom: 1rem;">M√©tricas R√°pidas</h3>
                            <p class="action-description" style="color: rgba(255,255,255,0.9); margin-bottom: 1.5rem;">
                                Vista r√°pida de tus estad√≠sticas principales en tiempo real.
                            </p>
                            <button class="btn btn-light" onclick="abrirMetricasRapidas()" style="background: rgba(255,255,255,0.9); color: #667eea; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600;">
                                <i class="fas fa-chart-pie"></i> Ver M√©tricas
                            </button>
                        </div>
                        
                        <!-- Reporte Completo -->
                        <div class="action-card" style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; text-align: center; padding: 2.5rem;">
                            <div class="action-icon" style="background: rgba(255,255,255,0.2); margin: 0 auto 1.5rem;">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            <h3 class="action-title" style="color: white; margin-bottom: 1rem;">Reporte Completo</h3>
                            <p class="action-description" style="color: rgba(255,255,255,0.9); margin-bottom: 1.5rem;">
                                Panel completo con analytics avanzados seg√∫n tu plan.
                            </p>
                            <button class="btn btn-light" onclick="abrirReporteCompleto()" style="background: rgba(255,255,255,0.9); color: #f093fb; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600;">
                                <i class="fas fa-chart-line"></i> Ver Reporte
                            </button>
                        </div>
                        
                        <!-- An√°lisis de Ventas -->
                        <div class="action-card" style="background: linear-gradient(135deg, #43e97b, #38f9d7); color: white; text-align: center; padding: 2.5rem;">
                            <div class="action-icon" style="background: rgba(255,255,255,0.2); margin: 0 auto 1.5rem;">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <h3 class="action-title" style="color: white; margin-bottom: 1rem;">An√°lisis de Ventas</h3>
                            <p class="action-description" style="color: rgba(255,255,255,0.9); margin-bottom: 1.5rem;">
                                Productos m√°s vendidos, tendencias y proyecciones.
                            </p>
                            <button class="btn btn-light" onclick="abrirAnalisisVentas()" style="background: rgba(255,255,255,0.9); color: #43e97b; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600;">
                                <i class="fas fa-shopping-cart"></i> Analizar
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Productos -->
            <section id="productos" class="content-section">
                <div class="fade-in">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-box"></i>
                            Mis Productos
                        </h2>
                        <button class="btn btn-primary" onclick="window.mostrarFormularioProducto()">
                            <i class="fas fa-plus"></i> Agregar Producto
                        </button>
                    </div>
                    <div id="productosLista" class="fade-in" style="animation-delay: 0.2s;">
                        <div class="action-card" style="text-align: center; padding: 3rem;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                <i class="fas fa-box-open"></i>
                            </div>
                            <h3 class="action-title">No hay productos a√∫n</h3>
                            <p class="action-description">
                                ¬°Comienza a construir tu cat√°logo! Agrega tu primer producto y empieza a vender.
                            </p>
                            <button class="btn btn-primary" onclick="window.mostrarFormularioProducto()">
                                <i class="fas fa-plus"></i> Agregar Primer Producto
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Servicios -->
            <section id="servicios" class="content-section">
                <div class="fade-in">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-tools"></i>
                            Mis Servicios
                        </h2>
                        <button class="btn btn-primary" onclick="mostrarFormularioServicio()" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                            <i class="fas fa-plus"></i> Agregar Servicio
                        </button>
                    </div>
                    <div id="serviciosLista" class="fade-in" style="animation-delay: 0.2s;">
                        <div class="action-card" style="text-align: center; padding: 3rem;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                                <i class="fas fa-cogs"></i>
                            </div>
                            <h3 class="action-title">No hay servicios a√∫n</h3>
                            <p class="action-description">
                                ¬°Ofrece tus servicios profesionales! Crea tu primer servicio y expande tu negocio.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarFormularioServicio()" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                                <i class="fas fa-plus"></i> Agregar Primer Servicio
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Ofertas -->
            <section id="ofertas" class="content-section">
                <div class="fade-in">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-tag"></i>
                            Mis Ofertas
                        </h2>
                        <button class="btn btn-primary" onclick="mostrarFormularioOferta()" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                            <i class="fas fa-plus"></i> Crear Oferta
                        </button>
                    </div>
                    <div id="ofertasLista" class="fade-in" style="animation-delay: 0.2s;">
                        <div class="action-card" style="text-align: center; padding: 3rem;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                                <i class="fas fa-tags"></i>
                            </div>
                            <h3 class="action-title">No tienes ofertas a√∫n</h3>
                            <p class="action-description">
                                ¬°Atrae m√°s clientes con ofertas especiales! Crea tu primera oferta y aumenta las ventas.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarFormularioOferta()" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                                <i class="fas fa-plus"></i> Crear Primera Oferta
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Mi Espacio -->
            <section id="bienestar" class="content-section">
                <div class="fade-in">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-heart"></i>
                            Mi Espacio Personal
                        </h2>
                        <p style="color: #6B7280; text-align: center; margin-top: 10px;">Un espacio seguro para tu bienestar emocional y crecimiento personal üíú</p>
                    </div>
                    
                    <!-- Acciones R√°pidas -->
                    <div class="action-cards">
                        <div class="action-card fade-in" style="animation-delay: 0.1s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
                                <i class="fas fa-heart"></i>
                            </div>
                            <h3 class="action-title">Mi Diario Emocional</h3>
                            <p class="action-description">
                                Reflexiona sobre tu d√≠a, procesa emociones y celebra tus logros empresariales.
                            </p>
                            <button class="btn btn-primary" onclick="abrirDiarioEmocional()" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
                                <i class="fas fa-arrow-right"></i> Abrir Diario
                            </button>
                        </div>
                        
                        
                        <div class="action-card fade-in" style="animation-delay: 0.3s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #8B5CF6, #A78BFA);">
                                <i class="fas fa-comments"></i>
                            </div>
                            <h3 class="action-title">¬øNecesit√°s Hablar?</h3>
                            <p class="action-description">
                                Si la est√°s pasando mal, contactame directamente. Estoy ac√° para ayudarte.
                            </p>
                            <button class="btn btn-primary" onclick="ContactoDirectoCrisla.abrirModal('apoyo')" style="background: linear-gradient(135deg, #8B5CF6, #A78BFA);">
                                <i class="fas fa-heart"></i> Contactar a Crisla
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.4s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <h3 class="action-title">Desaf√≠os y Logros</h3>
                            <p class="action-description">
                                Completa desaf√≠os y desbloquea logros mientras cuidas tu bienestar.
                            </p>
                            <button class="btn btn-primary" onclick="toggleDesafiosLogros()" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                                <i class="fas fa-trophy"></i> Ver Desaf√≠os
                            </button>
                        </div>
                    </div>
                    
                    <!-- Contenedor de Desaf√≠os y Logros (se muestra/oculta) -->
                    <div id="desafiosLogrosContainer" style="display: none; margin-top: 40px;">
                        <div id="desafiosContainer"></div>
                    </div>
                </div>
            </section>

            <!-- Feedbacks -->
            <section id="feedbacks" class="content-section">
                <div class="fade-in">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-comments"></i>
                            Feedbacks de Mi Tienda
                        </h2>
                        <p style="color: #6B7280; text-align: center; margin-top: 10px;">Gestiona los comentarios y opiniones de tus clientes üí¨</p>
                    </div>
                    
                    <!-- Estad√≠sticas de Feedback -->
                    <div class="dashboard-stats" style="margin-bottom: 2rem;">
                        <div class="stat-card feedbacks slide-in-left" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            <div class="stat-icon">
                                <i class="fas fa-comment-dots"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalFeedbacks">0</h3>
                                <p>Total Feedbacks</p>
                            </div>
                        </div>
                        
                        <div class="stat-card rating slide-in-right" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            <div class="stat-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="promedioRating">0.0</h3>
                                <p>Rating Promedio</p>
                            </div>
                        </div>
                        
                        <div class="stat-card responses slide-in-up" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            <div class="stat-icon">
                                <i class="fas fa-reply"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="feedbacksRespondidos">0</h3>
                                <p>Respondidos</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Contenedor de Feedbacks -->
                    <div id="feedbacksContainer" style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div id="feedbacksList">
                            <div style="text-align: center; padding: 40px; color: #6B7280;">
                                <i class="fas fa-comments" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.5;"></i>
                                <h3>No hay feedbacks a√∫n</h3>
                                <p>Los comentarios de tus clientes aparecer√°n aqu√≠</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bot√≥n para refrescar -->
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-primary" onclick="cargarFeedbacks()" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                            <i class="fas fa-sync-alt"></i> Refrescar Feedbacks
                        </button>
                    </div>
                </div>
            </section>

            <!-- Suscripciones -->
            <section id="suscripcion" class="content-section">
                <div class="fade-in">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-crown"></i>
                            Planes de Suscripci√≥n
                        </h2>
                        <p class="section-subtitle">Elige el plan que mejor se adapte a tu negocio</p>
                    </div>

                    <!-- Informaci√≥n de transparencia -->
                    <div class="alert alert-info" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 15px; margin-bottom: 30px;">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-info-circle me-3" style="font-size: 1.5rem;"></i>
                            <div>
                                <h5 class="mb-1">üíú Transparencia Total</h5>
                                <p class="mb-0">Todas las comisiones son transparentes. Puedes elegir tu moneda de pago preferida.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Planes disponibles -->
                    <div class="row g-4">
                        <!-- Plan Gratuito -->
                        <div class="col-lg-4 col-md-6">
                            <div class="plan-card" style="border: 2px solid #e5e7eb; border-radius: 20px; padding: 30px; text-align: center; background: white; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                                <div class="plan-icon" style="width: 80px; height: 80px; background: linear-gradient(135deg, #10B981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                                    <i class="fas fa-gift" style="font-size: 2rem; color: white;"></i>
                                </div>
                                <h3 class="plan-name" style="color: #333; font-size: 1.5rem; margin-bottom: 10px;">Plan Gratuito</h3>
                                <div class="plan-price" style="margin-bottom: 20px;">
                                    <span class="price-amount" style="font-size: 2.5rem; font-weight: 700; color: #10B981;">$0</span>
                                    <span class="price-period" style="color: #6B7280; font-size: 1rem;">/mes</span>
                                </div>
                                <ul class="plan-features" style="list-style: none; padding: 0; margin-bottom: 30px;">
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Hasta 10 productos</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Hasta 5 servicios</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Comprobantes b√°sicos</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Soporte por email</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Comisi√≥n: 1.8% por venta</li>
                                </ul>
                                <button class="btn btn-outline-success btn-lg" onclick="seleccionarPlan('free')" style="width: 100%; padding: 12px; border-radius: 12px; font-weight: 600;">
                                    <i class="fas fa-check"></i> Plan Actual
                                </button>
                            </div>
                        </div>

                        <!-- Plan B√°sico -->
                        <div class="col-lg-4 col-md-6">
                            <div class="plan-card" style="border: 2px solid #667eea; border-radius: 20px; padding: 30px; text-align: center; background: linear-gradient(135deg, #f8fafc, #e2e8f0); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2); position: relative;">
                                <div class="plan-badge" style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 8px 20px; border-radius: 20px; font-size: 0.9rem; font-weight: 600;">
                                    <i class="fas fa-star me-1"></i> Recomendado
                                </div>
                                <div class="plan-icon" style="width: 80px; height: 80px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                                    <i class="fas fa-rocket" style="font-size: 2rem; color: white;"></i>
                                </div>
                                <h3 class="plan-name" style="color: #333; font-size: 1.5rem; margin-bottom: 10px;">Plan B√°sico</h3>
                                <div class="plan-price" style="margin-bottom: 20px;">
                                    <span class="price-amount" style="font-size: 2.5rem; font-weight: 700; color: #667eea;">$9.99</span>
                                    <span class="price-period" style="color: #6B7280; font-size: 1rem;">/mes</span>
                                </div>
                                <ul class="plan-features" style="list-style: none; padding: 0; margin-bottom: 30px;">
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Productos ilimitados</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Servicios ilimitados</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Comprobantes personalizados</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Analytics b√°sicos</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Soporte prioritario</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Comisi√≥n: 5% por venta</li>
                                </ul>
                                <button class="btn btn-primary btn-lg" onclick="seleccionarPlan('basic')" style="width: 100%; padding: 12px; border-radius: 12px; font-weight: 600; background: linear-gradient(135deg, #667eea, #764ba2); border: none;">
                                    <i class="fas fa-crown"></i> Actualizar a B√°sico
                                </button>
                            </div>
                        </div>

                        <!-- Plan Premium -->
                        <div class="col-lg-4 col-md-6">
                            <div class="plan-card" style="border: 2px solid #EC4899; border-radius: 20px; padding: 30px; text-align: center; background: linear-gradient(135deg, #fdf2f8, #fce7f3); box-shadow: 0 8px 25px rgba(236, 72, 153, 0.2);">
                                <div class="plan-icon" style="width: 80px; height: 80px; background: linear-gradient(135deg, #EC4899, #BE185D); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                                    <i class="fas fa-gem" style="font-size: 2rem; color: white;"></i>
                                </div>
                                <h3 class="plan-name" style="color: #333; font-size: 1.5rem; margin-bottom: 10px;">Plan Premium</h3>
                                <div class="plan-price" style="margin-bottom: 20px;">
                                    <span class="price-amount" style="font-size: 2.5rem; font-weight: 700; color: #EC4899;">$19.99</span>
                                    <span class="price-period" style="color: #6B7280; font-size: 1rem;">/mes</span>
                                </div>
                                <ul class="plan-features" style="list-style: none; padding: 0; margin-bottom: 30px;">
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Todo del Plan B√°sico</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Analytics avanzados</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>IA para descripciones</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Notificaciones push</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Soporte 24/7</li>
                                    <li style="padding: 8px 0; color: #374151;"><i class="fas fa-check text-success me-2"></i>Comisi√≥n: 3% por venta</li>
                                </ul>
                                <button class="btn btn-lg" onclick="seleccionarPlan('premium')" style="width: 100%; padding: 12px; border-radius: 12px; font-weight: 600; background: linear-gradient(135deg, #EC4899, #BE185D); border: none; color: white;">
                                    <i class="fas fa-gem"></i> Actualizar a Premium
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Informaci√≥n de comisiones -->
                    <div class="row mt-5">
                        <div class="col-12">
                            <div class="card" style="border: none; border-radius: 15px; background: linear-gradient(135deg, #f8fafc, #e2e8f0);">
                                <div class="card-body" style="padding: 30px;">
                                    <h4 class="card-title text-center mb-4" style="color: #333;">
                                        <i class="fas fa-calculator me-2"></i>Transparencia en Comisiones
                                    </h4>
                                    <div class="row">
                                        <div class="col-md-4 text-center">
                                            <div class="commission-item" style="padding: 20px; background: white; border-radius: 12px; margin-bottom: 15px;">
                                                <h5 style="color: #10B981; font-weight: 700;">Plan Gratuito</h5>
                                                <p class="mb-1" style="font-size: 1.2rem; font-weight: 600;">1.8% por venta</p>
                                                <small class="text-muted">+ Comisi√≥n Mercado Pago (~4.9%)</small>
                                            </div>
                                        </div>
                                        <div class="col-md-4 text-center">
                                            <div class="commission-item" style="padding: 20px; background: white; border-radius: 12px; margin-bottom: 15px;">
                                                <h5 style="color: #667eea; font-weight: 700;">Plan B√°sico</h5>
                                                <p class="mb-1" style="font-size: 1.2rem; font-weight: 600;">5% por venta</p>
                                                <small class="text-muted">+ Comisi√≥n Mercado Pago (~4.9%)</small>
                                            </div>
                                        </div>
                                        <div class="col-md-4 text-center">
                                            <div class="commission-item" style="padding: 20px; background: white; border-radius: 12px; margin-bottom: 15px;">
                                                <h5 style="color: #EC4899; font-weight: 700;">Plan Premium</h5>
                                                <p class="mb-1" style="font-size: 1.2rem; font-weight: 600;">3% por venta</p>
                                                <small class="text-muted">+ Comisi√≥n Mercado Pago (~4.9%)</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-center mt-3">
                                        <p class="text-muted">
                                            <i class="fas fa-info-circle me-1"></i>
                                            <strong>Ejemplo:</strong> Si vendes $1000 con Plan Premium, pagas $30 (3%) + $49 (Mercado Pago) = $79 total
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bot√≥n de prueba -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card" style="border: none; border-radius: 15px; background: linear-gradient(135deg, #10B981, #059669); color: white;">
                                <div class="card-body" style="padding: 30px; text-align: center;">
                                    <h4 class="card-title mb-4">
                                        <i class="fas fa-vial me-2"></i>Prueba R√°pida del Sistema
                                    </h4>
                                    <p class="mb-4">Prueba el sistema de pagos sin configurar Mercado Pago</p>
                                    <div class="d-flex gap-3 justify-content-center">
                                        <button onclick="probarSistemaPagos()" class="btn btn-light btn-lg" style="padding: 15px 30px; border-radius: 12px; font-weight: 600;">
                                            <i class="fas fa-play"></i> Probar Sistema
                                        </button>
                                        <button onclick="probarPagoRapido()" class="btn btn-warning btn-lg" style="padding: 15px 30px; border-radius: 12px; font-weight: 600;">
                                            <i class="fas fa-bolt"></i> Prueba R√°pida
                                        </button>
                                        <button onclick="probarSistemaSimple()" class="btn btn-success btn-lg" style="padding: 15px 30px; border-radius: 12px; font-weight: 600;">
                                            <i class="fas fa-check"></i> Prueba Simple
                                        </button>
                                        <button onclick="procesarPagoReal('basic')" class="btn btn-danger btn-lg" style="padding: 15px 30px; border-radius: 12px; font-weight: 600;">
                                            <i class="fas fa-credit-card"></i> Pago Real B√°sico
                                        </button>
                                        <button onclick="procesarPagoReal('premium')" class="btn btn-warning btn-lg" style="padding: 15px 30px; border-radius: 12px; font-weight: 600;">
                                            <i class="fas fa-credit-card"></i> Pago Real Premium
                                        </button>
                                        <button onclick="forzarCargaServicios()" class="btn btn-info btn-lg" style="padding: 15px 30px; border-radius: 12px; font-weight: 600;">
                                            <i class="fas fa-tools"></i> Cargar Servicios
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Selector de moneda -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card" style="border: none; border-radius: 15px; background: linear-gradient(135deg, #667eea, #764ba2); color: white;">
                                <div class="card-body" style="padding: 30px;">
                                    <h4 class="card-title text-center mb-4">
                                        <i class="fas fa-globe me-2"></i>Selecciona tu Moneda de Pago
                                    </h4>
                                    <div class="row">
                                        <div class="col-md-3 text-center">
                                            <button class="btn btn-outline-light btn-lg currency-btn" onclick="seleccionarMoneda('ARS')" style="width: 100%; padding: 15px; border-radius: 12px; font-weight: 600; margin-bottom: 10px;">
                                                <i class="fas fa-dollar-sign me-2"></i>ARS (Pesos)
                                            </button>
                                        </div>
                                        <div class="col-md-3 text-center">
                                            <button class="btn btn-outline-light btn-lg currency-btn" onclick="seleccionarMoneda('USD')" style="width: 100%; padding: 15px; border-radius: 12px; font-weight: 600; margin-bottom: 10px;">
                                                <i class="fas fa-dollar-sign me-2"></i>USD (D√≥lares)
                                            </button>
                                        </div>
                                        <div class="col-md-3 text-center">
                                            <button class="btn btn-outline-light btn-lg currency-btn" onclick="seleccionarMoneda('EUR')" style="width: 100%; padding: 15px; border-radius: 12px; font-weight: 600; margin-bottom: 10px;">
                                                <i class="fas fa-euro-sign me-2"></i>EUR (Euros)
                                            </button>
                                        </div>
                                        <div class="col-md-3 text-center">
                                            <button class="btn btn-outline-light btn-lg currency-btn" onclick="seleccionarMoneda('BRL')" style="width: 100%; padding: 15px; border-radius: 12px; font-weight: 600; margin-bottom: 10px;">
                                                <i class="fas fa-coins me-2"></i>BRL (Reales)
                                            </button>
                                        </div>
                                    </div>
                                    <div class="text-center mt-3">
                                        <p class="mb-0">
                                            <i class="fas fa-shield-alt me-1"></i>
                                            Todas las transacciones son seguras y transparentes
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Configuraci√≥n -->
            <section id="configuracion" class="content-section">
                <div class="fade-in">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-cog"></i>
                            Configuraci√≥n de Mi Tienda
                        </h2>
                    </div>
                    
                    <div class="action-cards">
                        <div class="action-card fade-in" style="animation-delay: 0.1s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                <i class="fas fa-store"></i>
                            </div>
                            <h3 class="action-title">Informaci√≥n de la Tienda</h3>
                            <p class="action-description">
                                Cambia el nombre, descripci√≥n y datos principales de tu tienda. Los cambios se reflejan autom√°ticamente.
                            </p>
                            <button class="btn btn-primary" onclick="abrirConfiguracionTienda()" style="background: linear-gradient(135deg, #667eea, #764ba2); text-decoration: none;">
                                <i class="fas fa-edit"></i> Editar Informaci√≥n
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.15s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                                <i class="fas fa-palette"></i>
                            </div>
                            <h3 class="action-title">Dise√±o y Colores</h3>
                            <p class="action-description">
                                Personaliza los colores, logo y dise√±o de tu tienda para reflejar tu marca.
                            </p>
                            <button class="btn btn-primary" onclick="abrirPersonalizacionDiseno()" style="background: linear-gradient(135deg, #f093fb, #f5576c); text-decoration: none;">
                                <i class="fas fa-palette"></i> Configurar Dise√±o
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.2s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
                                <i class="fas fa-image"></i>
                            </div>
                            <h3 class="action-title">Im√°genes y Videos</h3>
                            <p class="action-description">
                                Agrega banners, im√°genes de presentaci√≥n y videos para tu tienda.
                            </p>
                            <button class="btn btn-primary" onclick="abrirImagenesVideos()" style="background: linear-gradient(135deg, #43e97b, #38f9d7); text-decoration: none;">
                                <i class="fas fa-image"></i> Subir Contenido
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.25s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                                <i class="fas fa-question-circle"></i>
                            </div>
                            <h3 class="action-title">Preguntas Frecuentes (FAQ)</h3>
                            <p class="action-description">
                                Agrega preguntas y respuestas frecuentes para ayudar a tus clientes.
                            </p>
                            <button class="btn btn-primary" onclick="abrirConfiguracionFAQ()" style="background: linear-gradient(135deg, #4facfe, #00f2fe); text-decoration: none;">
                                <i class="fas fa-question-circle"></i> Gestionar FAQ
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.35s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #10b981, #34d399);">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <h3 class="action-title">Ubicaci√≥n y Contacto</h3>
                            <p class="action-description">
                                Configura tu direcci√≥n, ciudad, c√≥digo postal y datos de ubicaci√≥n f√≠sica.
                            </p>
                            <button class="btn btn-primary" onclick="abrirConfiguracionUbicacion()" style="background: linear-gradient(135deg, #10b981, #34d399); text-decoration: none;">
                                <i class="fas fa-map-marker-alt"></i> Configurar Ubicaci√≥n
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.4s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #06B6D4, #0891B2);">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <h3 class="action-title">Informaci√≥n de la Empresa</h3>
                            <p class="action-description">
                                Configura a√±o de creaci√≥n, redes sociales y datos que aparecer√°n en tu tienda.
                            </p>
                            <button class="btn btn-primary" onclick="configurarInfoEmpresa()" style="background: linear-gradient(135deg, #06B6D4, #0891B2); text-decoration: none;">
                                <i class="fas fa-calendar-alt"></i> Configurar Info
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.3s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                                <i class="fas fa-robot"></i>
                            </div>
                            <h3 class="action-title">CRESALIA-BOT</h3>
                            <p class="action-description">
                                Configura el chatbot de soporte autom√°tico para responder preguntas de tus clientes 24/7.
                            </p>
                            <button class="btn btn-primary" onclick="configurarCresaliaBot()" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                                <i class="fas fa-robot"></i> Configurar Bot
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.4s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
                                <i class="fas fa-truck"></i>
                            </div>
                            <h3 class="action-title">Env√≠os y Log√≠stica</h3>
                            <p class="action-description">
                                Configura opciones de env√≠o, zonas de cobertura, precios y tiempos de entrega.
                            </p>
                            <button class="btn btn-primary" onclick="configurarEnvios()" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
                                <i class="fas fa-truck"></i> Configurar Env√≠os
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.5s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #8B5CF6, #A78BFA);">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <h3 class="action-title">Suscripciones y Pagos</h3>
                            <p class="action-description">
                                Gestiona tu plan actual, m√©todos de pago, renovaciones y cancelaciones.
                            </p>
                            <button class="btn btn-primary" onclick="gestionarSuscripciones()" style="background: linear-gradient(135deg, #8B5CF6, #A78BFA);">
                                <i class="fas fa-credit-card"></i> Gestionar Suscripci√≥n
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.6s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #F59E0B, #FBBF24);">
                                <i class="fas fa-gift"></i>
                            </div>
                            <h3 class="action-title">Pack de Inicio</h3>
                            <p class="action-description">
                                Recursos gratuitos para comenzar: logo, banners, plantillas y gu√≠a completa.
                            </p>
                            <button class="btn btn-primary" onclick="abrirPackInicio()" style="background: linear-gradient(135deg, #F59E0B, #FBBF24);">
                                <i class="fas fa-gift"></i> Obtener Pack
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.7s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #EC4899, #F9A8D4);">
                                <i class="fas fa-headset"></i>
                            </div>
                            <h3 class="action-title">Servicio de Ayuda</h3>
                            <p class="action-description">
                                Configura tu sistema de soporte personalizado con colores y respuestas autom√°ticas.
                            </p>
                            <button class="btn btn-primary" onclick="configurarServicioAyuda()" style="background: linear-gradient(135deg, #EC4899, #F9A8D4);">
                                <i class="fas fa-headset"></i> Configurar Ayuda
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.8s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #10B981, #34D399);">
                                <i class="fas fa-users"></i>
                            </div>
                            <h3 class="action-title">Comunidad de Vendedores</h3>
                            <p class="action-description">
                                Conecta con otros emprendedores, comparte experiencias y aprende juntos.
                            </p>
                            <button class="btn btn-primary" onclick="abrirComunidadVendedores()" style="background: linear-gradient(135deg, #10B981, #34D399);">
                                <i class="fas fa-users"></i> Ver Comunidad
                            </button>
                        </div>
                        
                        <!-- Panel de Auditor√≠a removido - Solo para super admin -->
                        
                        <!-- Comunidad de Compradores removida - Solo para compradores -->
                        
                        <div class="action-card fade-in" style="animation-delay: 0.5s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #fa709a, #fee140);">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <h3 class="action-title">M√©tricas Avanzadas</h3>
                            <p class="action-description">
                                Accede a estad√≠sticas detalladas de ventas, visitas, productos m√°s vendidos y m√°s.
                            </p>
                            <button class="btn btn-primary" onclick="verAnalytics()" style="background: linear-gradient(135deg, #fa709a, #fee140);">
                                <i class="fas fa-chart-bar"></i> Ver M√©tricas
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.6s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #ff6b6b, #ee5a24);">
                                <i class="fas fa-life-ring"></i>
                            </div>
                            <h3 class="action-title">Soporte T√©cnico</h3>
                            <p class="action-description">
                                Accede al soporte t√©cnico de Cresalia. Estamos aqu√≠ para ayudarte con cualquier problema.
                            </p>
                            <button class="btn btn-primary" onclick="alert('Para soporte t√©cnico, cont√°ctanos en: soporte@cresalia.com üìß')" style="background: linear-gradient(135deg, #ff6b6b, #ee5a24);">
                                <i class="fas fa-life-ring"></i> Contactar Soporte
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.7s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #10B981, #059669);">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <h3 class="action-title">Medios de Pago</h3>
                            <p class="action-description">
                                Configura los medios de pago que acepta tu tienda: Mercado Pago, transferencias, efectivo y criptomonedas.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarMediosPago()" style="background: linear-gradient(135deg, #10B981, #059669);">
                                <i class="fas fa-credit-card"></i> Configurar Pagos
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.8s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #EC4899, #F9A8D4);">
                                <i class="fas fa-heart"></i>
                            </div>
                            <h3 class="action-title">Bienestar Emocional</h3>
                            <p class="action-description">
                                Activa o desactiva el sistema de bienestar emocional. M√∫sica relajante, consejos de salud mental y recursos para tu equilibrio.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarConfiguracionBienestar()" style="background: linear-gradient(135deg, #EC4899, #F9A8D4);">
                                <i class="fas fa-heart"></i> Configurar Bienestar
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 0.9s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #8B5CF6, #A78BFA);">
                                <i class="fas fa-history"></i>
                            </div>
                            <h3 class="action-title">Historial de Ventas</h3>
                            <p class="action-description">
                                Ve todas tus ventas, pedidos completados, estad√≠sticas de ingresos y el historial completo de tu negocio.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarHistorialVentas()" style="background: linear-gradient(135deg, #8B5CF6, #A78BFA);">
                                <i class="fas fa-history"></i> Ver Historial
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 1.0s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #10B981, #34D399);">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <h3 class="action-title">Confirmar Pagos</h3>
                            <p class="action-description">
                                Marca los pagos como confirmados y env√≠a notas de agradecimiento personalizadas a tus clientes.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarConfirmacionPagos()" style="background: linear-gradient(135deg, #10B981, #34D399);">
                                <i class="fas fa-credit-card"></i> Gestionar Pagos
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 1.0s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #F59E0B, #FBBF24);">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <h3 class="action-title">Ubicaciones y Mapas</h3>
                            <p class="action-description">
                                Configura las ubicaciones de tu tienda, almacenes, oficinas y puntos de retiro para que los clientes te encuentren.
                            </p>
                            <button class="btn btn-primary" onclick="mostrarMapaUbicaciones()" style="background: linear-gradient(135deg, #F59E0B, #FBBF24);">
                                <i class="fas fa-map-marker-alt"></i> Configurar Ubicaciones
                            </button>
                        </div>
                        
                        <div class="action-card fade-in" style="animation-delay: 1.1s;">
                            <div class="action-icon" style="background: linear-gradient(135deg, #EC4899, #F9A8D4);">
                                <i class="fas fa-user-tag"></i>
                            </div>
                            <h3 class="action-title">Mi Alias Profesional</h3>
                            <p class="action-description">
                                Configura tu alias profesional para trabajar en la comunidad. Puedes usar un nombre diferente al real.
                            </p>
                            <button class="btn btn-primary" onclick="configurarAliasProfesional()" style="background: linear-gradient(135deg, #EC4899, #F9A8D4);">
                                <i class="fas fa-user-tag"></i> Configurar Alias
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- MODAL SISTEMA DE TURNOS -->
    <div id="modalSistemaTurnos" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìÖ Sistema de Gesti√≥n de Turnos</h2>
                <button class="btn-cerrar" onclick="cerrarModalTurnos()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="turnos-container">
                    <div class="turnos-section">
                        <h3>üïê Turnos Disponibles</h3>
                        <div class="turnos-grid">
                            <div class="turno-item">
                                <span class="hora">09:00</span>
                                <span class="estado disponible">Disponible</span>
                                <button class="btn-reservar" onclick="reservarTurno('09:00')">Reservar</button>
                            </div>
                            <div class="turno-item">
                                <span class="hora">10:00</span>
                                <span class="estado disponible">Disponible</span>
                                <button class="btn-reservar" onclick="reservarTurno('10:00')">Reservar</button>
                            </div>
                            <div class="turno-item">
                                <span class="hora">11:00</span>
                                <span class="estado ocupado">Ocupado</span>
                                <button class="btn-cancelar" onclick="cancelarTurno('11:00')">Cancelar</button>
                            </div>
                            <div class="turno-item">
                                <span class="hora">14:00</span>
                                <span class="estado disponible">Disponible</span>
                                <button class="btn-reservar" onclick="reservarTurno('14:00')">Reservar</button>
                            </div>
                            <div class="turno-item">
                                <span class="hora">15:00</span>
                                <span class="estado disponible">Disponible</span>
                                <button class="btn-reservar" onclick="reservarTurno('15:00')">Reservar</button>
                            </div>
                            <div class="turno-item">
                                <span class="hora">16:00</span>
                                <span class="estado disponible">Disponible</span>
                                <button class="btn-reservar" onclick="reservarTurno('16:00')">Reservar</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="turnos-section">
                        <h3>‚ûï Agregar Nuevo Turno</h3>
                        <form class="form-turno">
                            <input type="time" id="horaTurno" placeholder="Hora" required>
                            <input type="text" id="servicioTurno" placeholder="Servicio" required>
                            <input type="text" id="clienteTurno" placeholder="Cliente" required>
                            <button type="button" onclick="agregarTurno()">Agregar Turno</button>
                        </form>
                    </div>
                    
                    <div class="turnos-section">
                        <h3>üìä Estad√≠sticas de Turnos</h3>
                        <div class="stats-turnos">
                            <div class="stat-item">
                                <span class="stat-number">12</span>
                                <span class="stat-label">Turnos Hoy</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">8</span>
                                <span class="stat-label">Disponibles</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">4</span>
                                <span class="stat-label">Ocupados</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts b√°sicos -->
    <script>
        // Funciones b√°sicas de navegaci√≥n - COMENTADA PARA EVITAR CONFLICTOS
        /*
        function mostrarSeccion(seccionId) {
            // Ocultar todas las secciones
            const secciones = document.querySelectorAll('.content-section');
            secciones.forEach(seccion => {
                seccion.classList.remove('active');
            });
            
            // Mostrar la secci√≥n seleccionada
            const seccionActiva = document.getElementById(seccionId);
            if (seccionActiva) {
                seccionActiva.classList.add('active');
                
                // Cargar contenido espec√≠fico seg√∫n la secci√≥n
                if (seccionId === 'feedbacks') {
                    setTimeout(() => cargarFeedbacks(), 100);
                } else if (seccionId === 'productos') {
                    setTimeout(() => cargarProductosEjemplo(), 100);
                } else if (seccionId === 'servicios') {
                    setTimeout(() => cargarServiciosEjemplo(), 100);
                }
            }
            
            // Actualizar navegaci√≥n
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.classList.remove('active');
            });
            
            event.target.classList.add('active');
        }
        */
        
        // Funci√≥n para mostrar notificaciones
        function mostrarNotificacion(mensaje, tipo = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${tipo}`;
            notification.textContent = mensaje;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // Funci√≥n para cerrar sesi√≥n
        function cerrarSesion() {
            mostrarNotificacion('Sesi√≥n cerrada correctamente', 'info');
            // Aqu√≠ ir√≠a la l√≥gica de cierre de sesi√≥n
        }
        
        // ========================================
        // MODALES FUNCIONALES
        // ========================================
        
        // Modal de Productos - Los botones ahora llaman directamente a window.mostrarFormularioProducto()
        
        // Funci√≥n para mostrar formulario de productos (versi√≥n simplificada)
        window.mostrarFormularioProducto = function() {
            console.log('üì¶ Mostrando formulario de producto...');
            window.mostrarModal('modalProducto');
        };
        
        function cerrarModalProducto() {
            console.log('üî¥ Cerrando modal de producto...');
            window.ocultarModal('modalProducto');
        }
                <div style="background: white; border-radius: 20px; padding: 40px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #10B981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; color: white; font-size: 2rem;">
                            <i class="fas fa-box"></i>
                        </div>
                        <h2 style="color: #333; margin-bottom: 10px;">Agregar Nuevo Producto</h2>
                        <p style="color: #666; margin-bottom: 0;">Completa la informaci√≥n de tu producto</p>
                    </div>
                    
                    <form id="formProducto" onsubmit="guardarProducto(event)">
                        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Nombre del Producto</label>
                                <input type="text" id="nombreProducto" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Precio</label>
                                <input type="number" id="precioProducto" step="0.01" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Categor√≠a</label>
                                <select id="categoriaProducto" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                    <option value="">Seleccionar categor√≠a</option>
                                    <option value="ropa-mujer">Ropa de Mujer</option>
                                    <option value="ropa-hombre">Ropa de Hombre</option>
                                    <option value="electronica">Electr√≥nica</option>
                                    <option value="hogar">Hogar</option>
                                    <option value="belleza">Belleza</option>
                                    <option value="deportes">Deportes</option>
                                    <option value="alimentos">Alimentos y Bebidas</option>
                                    <option value="panaderia">Panader√≠a y Pasteler√≠a</option>
                                    <option value="comida-rapida">Comida R√°pida</option>
                                    <option value="restaurante">Restaurante</option>
                                    <option value="bar">Bar y Tragos</option>
                                    <option value="cafe">Caf√© y T√©</option>
                                    <option value="automotriz">Automotriz</option>
                                    <option value="lubricentro">Lubricentro</option>
                                    <option value="detail">Detail y Limpieza</option>
                                    <option value="transporte">Transporte</option>
                                    <option value="distribucion">Distribuci√≥n</option>
                                    <option value="negocio">Negocio General</option>
                                    <option value="local">Local Comercial</option>
                                    <option value="otros">Otros</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Stock</label>
                                <input type="number" id="stockProducto" min="0" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Descripci√≥n</label>
                            <textarea id="descripcionProducto" rows="3" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem; resize: vertical;"></textarea>
                        </div>
                        
                        <div id="opcionIAProducto">
                            ${mostrarOpcionIA('producto')}
                        </div>
                        
                        <div style="margin-bottom: 30px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Imagen del Producto</label>
                            <input type="file" id="imagenProducto" accept="image/*" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            <small style="color: #6B7280; font-size: 0.8rem;">Se guardar√° en localStorage para mayor privacidad</small>
                        </div>
                        
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button type="button" onclick="cerrarModalProducto()" style="background: #6b7280; color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                            <button type="submit" style="background: linear-gradient(135deg, #10B981, #059669); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-save"></i> Guardar Producto
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            console.log('‚úÖ HTML del modal de producto generado');
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de producto agregado al DOM');
            
            // Verificar que el modal se agreg√≥ correctamente
            setTimeout(() => {
                const modalVerificado = document.getElementById('modalProducto');
                if (modalVerificado) {
                    console.log('‚úÖ Modal de producto verificado en el DOM');
                    console.log('‚úÖ Modal visible:', modalVerificado.style.display);
                } else {
                    console.error('‚ùå Modal de producto no encontrado en el DOM');
                }
            }, 100);
        };
        
        function cerrarModalProducto() {
            const modal = document.getElementById('modalProducto');
            if (modal) {
                modal.remove();
            }
        }
        
        // Funci√≥n para guardar producto - VERSI√ìN ANTIGUA ELIMINADA COMPLETAMENTE
        /*
        function guardarProducto(event) {
            event.preventDefault();
            console.log('üíæ Guardando producto...');
            
            const nombre = document.getElementById('nombreProducto').value;
            const precio = parseFloat(document.getElementById('precioProducto').value);
            const categoria = document.getElementById('categoriaProducto').value;
            const stock = parseInt(document.getElementById('stockProducto').value);
            const descripcion = document.getElementById('descripcionProducto').value;
            // Manejar imagen como archivo
            const imagenInput = document.getElementById('imagenProducto');
            
            let imagen = 'https://picsum.photos/150/150?random=' + Date.now(); // Imagen por defecto
            
            if (imagenInput.files && imagenInput.files[0]) {
                // Convertir archivo a base64 para localStorage
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagen = e.target.result;
                    // Continuar con el guardado despu√©s de procesar la imagen
                    guardarProductoConImagen(imagen);
                };
                reader.readAsDataURL(imagenInput.files[0]);
                return; // Salir aqu√≠, el guardado continuar√° en el callback
            }
            
            // Si no hay imagen, guardar directamente
            guardarProductoConImagen(imagen);
            
            // Recargar la lista de productos
            setTimeout(() => cargarProductosEjemplo(), 500);
        }
        */
        
        // Modal de Servicios - VERSI√ìN SIMPLIFICADA
        function mostrarFormularioServicio() {
            console.log('üõ†Ô∏è Mostrando formulario de servicio...');
            window.mostrarModal('modalServicio');
        }
        
        function cerrarModalServicio() {
            console.log('üî¥ Cerrando modal de servicio...');
            window.ocultarModal('modalServicio');
        }
        
        // Modal de Ofertas
        function mostrarFormularioOferta() {
            console.log('üîµ FUNCI√ìN mostrarFormularioOferta() EJECUTADA');
            console.log('üéØ Creando modal de oferta...');
            mostrarNotificacion('Abriendo formulario de nueva oferta...', 'info');
            
            // Verificar si ya existe el modal y eliminarlo
            const modalExistente = document.getElementById('ofertaModal');
            if (modalExistente) {
                console.log('üóëÔ∏è Eliminando modal existente');
                modalExistente.remove();
            }
            
            const modalHTML = `
                <div id="ofertaModal" class="modal" style="display: flex; z-index: 99999 !important;">
                    <div class="modal-content" style="max-width: 600px; z-index: 100000 !important;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #F59E0B, #FBBF24); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                                <i class="fas fa-tag" style="font-size: 32px; color: white;"></i>
                            </div>
                            <h2 style="color: #F59E0B; margin-bottom: 10px;">üè∑Ô∏è Crear Nueva Oferta</h2>
                            <p style="color: #6B7280;">Crea ofertas especiales para atraer m√°s clientes</p>
                        </div>
                        
                        <form id="ofertaForm">
                            <div style="margin-bottom: 20px;">
                                <label for="nombreOferta" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">Nombre de la Oferta:</label>
                                <input type="text" id="nombreOferta" placeholder="Ej: Descuento 20% en smartphones" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 14px;" autocomplete="off" required>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label for="descripcionOferta" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">Descripci√≥n:</label>
                                <textarea id="descripcionOferta" placeholder="Describe los beneficios de tu oferta..." style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 14px; min-height: 80px; resize: vertical;" autocomplete="off" required></textarea>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                                <div>
                                    <label for="descuentoOferta" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">Descuento (%):</label>
                                    <input type="number" id="descuentoOferta" min="1" max="100" placeholder="20" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 14px;" autocomplete="off" required>
                                </div>
                                <div>
                                    <label for="fechaFinOferta" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">V√°lida hasta:</label>
                                    <input type="date" id="fechaFinOferta" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 14px;" autocomplete="off" required>
                                </div>
                            </div>
                            
                            <div style="text-align: center; margin-top: 30px;">
                                <button type="button" onclick="guardarOferta()" style="background: linear-gradient(135deg, #F59E0B, #FBBF24); color: white; border: none; padding: 15px 30px; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; margin-right: 10px;">
                                    <i class="fas fa-save"></i> Crear Oferta
                                </button>
                                <button type="button" onclick="cerrarModal(this)" style="background: #6B7280; color: white; border: none; padding: 15px 30px; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer;">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            // Insertar modal en el body
            try {
                document.body.insertAdjacentHTML('beforeend', modalHTML);
                console.log('‚úÖ Modal HTML insertado');
            } catch (error) {
                console.error('‚ùå Error al insertar HTML:', error);
                return;
            }
            
            // Verificar inmediatamente
            setTimeout(() => {
                const modalCreado = document.getElementById('ofertaModal');
                console.log('üîç Buscando modal ofertaModal...');
                
                if (modalCreado) {
                    console.log('‚úÖ Modal ofertaModal encontrado en el DOM');
                    console.log('üîç Display:', modalCreado.style.display);
                    console.log('üîç Z-index:', modalCreado.style.zIndex);
                    console.log('üîç Parent:', modalCreado.parentElement);
                    console.log('üîç Computed style:', window.getComputedStyle(modalCreado).display);
                    
                    // Forzar visibilidad
                    modalCreado.style.display = 'flex';
                    modalCreado.style.visibility = 'visible';
                    modalCreado.style.opacity = '1';
                } else {
                    console.error('‚ùå ERROR: Modal no se encuentra en el DOM');
                    console.log('üîç Modales en el DOM:', document.querySelectorAll('.modal').length);
                    console.log('üîç Body children:', document.body.children.length);
                }
            }, 100);
        }
        
        function cerrarOfertaModal() {
            const modal = document.getElementById('ofertaModal');
            if (modal) {
                modal.remove();
            }
        }
        
        function guardarOferta() {
            const nombre = document.getElementById('nombreOferta').value;
            const descripcion = document.getElementById('descripcionOferta').value;
            const descuento = document.getElementById('descuentoOferta').value;
            const fechaFin = document.getElementById('fechaFinOferta').value;
            
            if (!nombre || !descripcion || !descuento || !fechaFin) {
                mostrarNotificacion('‚ö†Ô∏è Por favor completa todos los campos', 'error');
                return;
            }
            
            // Aqu√≠ ir√≠a la l√≥gica para guardar la oferta
            mostrarNotificacion('‚úÖ Oferta creada exitosamente', 'success');
            cerrarOfertaModal();
        }
        
        // Modal de Diario Emocional
        function abrirDiarioEmocional() {
            console.log('üîµ FUNCI√ìN abrirDiarioEmocional() EJECUTADA');
            console.log('‚úÖ Abriendo Mi Espacio...');
            
            let modal = document.getElementById('diarioModalNuevo');
            console.log('üîç Modal diarioModalNuevo en DOM:', modal ? 'S√ç' : 'NO');
            
            if (modal) {
                console.log('‚úÖ Modal ya existe, mostr√°ndolo');
                modal.style.display = 'flex';
                modal.classList.add('show');
            } else {
                console.log('üìù Creando nuevo modal diarioModalNuevo');
                const modalHTML = `
                    <div id="diarioModalNuevo" class="modal" style="display: flex; z-index: 99999 !important;">
                        <div class="modal-content" style="max-width: 700px; max-height: 90vh; overflow-y: auto;">
                            <div class="modal-header">
                                <h3><i class="fas fa-heart"></i> Mi Espacio Personal</h3>
                                <button class="close-btn" onclick="cerrarModal(this)">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="modal-body">
                                <p style="color: #6B7280; margin-bottom: 20px; text-align: center;">
                                    Un espacio seguro para reflexionar sobre tu d√≠a
                                </p>
                                
                                <form id="diarioFormNuevo" onsubmit="guardarDiarioEmocionalNuevo(event)">
                                    <div class="form-group">
                                        <label for="emocionSeleccionadaNueva"><i class="fas fa-smile"></i> ¬øC√≥mo te sientes hoy?</label>
                                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 10px; margin-top: 10px;">
                                            <button type="button" class="emocion-btn" onclick="seleccionarEmocion(this, 'feliz')" style="padding: 15px; border-radius: 10px; border: 2px solid #10B981; background: #DCFCE7; cursor: pointer;">
                                                <div style="font-size: 24px;">üòä</div>
                                                <div style="font-size: 12px; margin-top: 5px;">Feliz</div>
                                            </button>
                                            <button type="button" class="emocion-btn" onclick="seleccionarEmocion(this, 'motivado')" style="padding: 15px; border-radius: 10px; border: 2px solid #F59E0B; background: #FEF3C7; cursor: pointer;">
                                                <div style="font-size: 24px;">üöÄ</div>
                                                <div style="font-size: 12px; margin-top: 5px;">Motivado</div>
                                            </button>
                                            <button type="button" class="emocion-btn" onclick="seleccionarEmocion(this, 'neutral')" style="padding: 15px; border-radius: 10px; border: 2px solid #6B7280; background: #F3F4F6; cursor: pointer;">
                                                <div style="font-size: 24px;">üòê</div>
                                                <div style="font-size: 12px; margin-top: 5px;">Neutral</div>
                                            </button>
                                            <button type="button" class="emocion-btn" onclick="seleccionarEmocion(this, 'estresado')" style="padding: 15px; border-radius: 10px; border: 2px solid #EF4444; background: #FEE2E2; cursor: pointer;">
                                                <div style="font-size: 24px;">üò∞</div>
                                                <div style="font-size: 12px; margin-top: 5px;">Estresado</div>
                                            </button>
                                            <button type="button" class="emocion-btn" onclick="seleccionarEmocion(this, 'preocupado')" style="padding: 15px; border-radius: 10px; border: 2px solid #DC2626; background: #FEF2F2; cursor: pointer;">
                                                <div style="font-size: 24px;">üòü</div>
                                                <div style="font-size: 12px; margin-top: 5px;">Preocupado</div>
                                            </button>
                                        </div>
                                        <input type="hidden" id="emocionSeleccionadaNueva" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="diarioReflexionNueva">
                                            <i class="fas fa-pen"></i> ¬øQu√© pas√≥ hoy?
                                        </label>
                                        <textarea id="diarioReflexionNueva" class="form-control" rows="4" 
                                                  placeholder="Escribe libremente sobre tu d√≠a..."></textarea>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="diarioLogrosNueva">
                                            <i class="fas fa-trophy"></i> Logros de hoy (opcional)
                                        </label>
                                        <textarea id="diarioLogrosNueva" class="form-control" rows="2" 
                                                  placeholder="¬øQu√© lograste hoy?"></textarea>
                                    </div>
                                    
                                    <div class="modal-footer" style="margin-top: 20px;">
                                        <button type="button" class="btn btn-secondary" onclick="cerrarModal(this)">
                                            <i class="fas fa-times"></i> Cancelar
                                        </button>
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-save"></i> Guardar Entrada
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                `;
                
                try {
                    document.body.insertAdjacentHTML('beforeend', modalHTML);
                    console.log('‚úÖ Modal HTML insertado en el DOM');
                } catch (error) {
                    console.error('‚ùå Error al insertar modal:', error);
                    return;
                }
                
                // Buscar el modal despu√©s de insertarlo
                setTimeout(() => {
                    modal = document.getElementById('diarioModalNuevo');
                    console.log('üîç Verificando modal despu√©s de insertar:', modal ? 'ENCONTRADO' : 'NO ENCONTRADO');
                    
                    if (modal) {
                        console.log('‚úÖ Aplicando estilos al modal');
                        modal.style.display = 'flex';
                        modal.style.visibility = 'visible';
                        modal.style.opacity = '1';
                        modal.classList.add('show');
                        console.log('‚úÖ Modal diarioModalNuevo visible');
                    } else {
                        console.error('‚ùå ERROR: Modal no aparece en el DOM');
                    }
                }, 100);
            }
            
            mostrarNotificacion('üìù Abriendo Mi Espacio Personal', 'info');
        }
        
        function cerrarDiarioEmocionalNuevo() {
            const modal = document.getElementById('diarioModalNuevo');
            if (modal) {
                modal.style.display = 'none';
                modal.classList.remove('show');
            }
        }
        
        // ====================================================
        // NUEVAS HERRAMIENTAS DE BIENESTAR EMOCIONAL
        // ====================================================
        
        // T√©cnicas de Relajaci√≥n - ULTRA SIMPLIFICADO
        function abrirTecnicasRelajacion() {
            console.log('üåø Abriendo T√©cnicas de Relajaci√≥n...');
            
            // Cerrar men√∫ de bienestar primero
            cerrarBienestarMenu();
            
            // Crear modal usando createElement (m√°s confiable)
            const modal = document.createElement('div');
            modal.id = 'relajacionModal';
            modal.className = 'modal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999999 !important;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 12px; max-width: 400px; width: 95%; max-height: 70vh; overflow-y: auto; position: relative;">
                    <div style="background: linear-gradient(135deg, #10B981, #34D399); color: white; padding: 12px; border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0; font-size: 1.3rem;"><i class="fas fa-leaf"></i> T√©cnicas de Relajaci√≥n</h3>
                        <button onclick="cerrarModal(this)" style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;">√ó</button>
                    </div>
                    <div style="padding: 15px;">
                        <div style="margin-bottom: 12px;">
                            <h4 style="color: #065F46; margin-bottom: 8px; font-size: 1rem;"><i class="fas fa-lungs"></i> Respiraci√≥n 4-7-8</h4>
                            <div style="background: #F0FDF4; padding: 10px; border-radius: 6px; border-left: 3px solid #10B981;">
                                <p style="margin: 0; color: #065F46; font-size: 0.85rem;"><strong>Instrucciones:</strong></p>
                                <ol style="margin: 6px 0; color: #065F46; font-size: 0.8rem;">
                                    <li>Inhala por la nariz durante 4 segundos</li>
                                    <li>Mant√©n la respiraci√≥n durante 7 segundos</li>
                                    <li>Exhala por la boca durante 8 segundos</li>
                                    <li>Repite 4 veces</li>
                                </ol>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 12px;">
                            <h4 style="color: #065F46; margin-bottom: 8px; font-size: 1rem;"><i class="fas fa-spa"></i> Relajaci√≥n Muscular</h4>
                            <div style="background: #F0FDF4; padding: 10px; border-radius: 6px; border-left: 3px solid #10B981;">
                                <p style="margin: 0; color: #065F46; font-size: 0.85rem;">Tensa cada grupo muscular por 5 segundos, luego relaja por 10 segundos:</p>
                                <ul style="margin: 6px 0; color: #065F46; font-size: 0.8rem;">
                                    <li>Pies y tobillos</li>
                                    <li>Pantorrillas y muslos</li>
                                    <li>Abdomen y espalda</li>
                                    <li>Manos y brazos</li>
                                    <li>Hombros y cuello</li>
                                    <li>Cara y mand√≠bula</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 15px;">
                            <button onclick="cerrarModal(this)" style="background: linear-gradient(135deg, #10B981, #34D399); color: white; border: none; padding: 8px 16px; border-radius: 15px; cursor: pointer; font-weight: 600; font-size: 0.85rem;">
                                <i class="fas fa-check"></i> Entendido
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de relajaci√≥n creado y agregado');
        }
        
        function cerrarRelajacion() {
            const modal = document.getElementById('relajacionModal');
            if (modal) {
                modal.remove();
            }
        }
        
        // Funci√≥n de prueba para verificar modales
        function testModalesBienestar() {
            console.log('üß™ PROBANDO MODALES DE BIENESTAR...');
            
            // Crear modal de prueba simple
            const testModal = document.createElement('div');
            testModal.id = 'testModal';
            testModal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999999 !important;
            `;
            
            testModal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 15px; max-width: 400px; text-align: center;">
                    <h3 style="color: #8B5CF6; margin-bottom: 20px;">üß™ Modal de Prueba</h3>
                    <p style="margin-bottom: 20px;">Si ves esto, los modales funcionan correctamente.</p>
                    <button onclick="cerrarModal(this)" style="background: #8B5CF6; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                        Cerrar
                    </button>
                </div>
            `;
            
            document.body.appendChild(testModal);
            console.log('‚úÖ Modal de prueba creado');
        }
        
        // Recursos de Crisis - ULTRA SIMPLIFICADO
        function abrirRecursosCrisis() {
            console.log('üÜò Abriendo Recursos de Crisis...');
            
            // Cerrar men√∫ de bienestar primero
            cerrarBienestarMenu();
            
            // Crear modal usando createElement (m√°s confiable)
            const modal = document.createElement('div');
            modal.id = 'crisisModal';
            modal.className = 'modal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999999 !important;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 12px; max-width: 400px; width: 95%; max-height: 70vh; overflow-y: auto; position: relative;">
                    <div style="background: linear-gradient(135deg, #F59E0B, #FBBF24); color: white; padding: 12px; border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0; font-size: 1.2rem;"><i class="fas fa-phone"></i> Recursos de Crisis</h3>
                        <button onclick="cerrarModal(this)" style="background: none; border: none; color: white; font-size: 1.3rem; cursor: pointer;">√ó</button>
                    </div>
                    <div style="padding: 15px;">
                        <div style="background: #FEF3C7; padding: 12px; border-radius: 8px; margin-bottom: 12px; border-left: 3px solid #F59E0B;">
                            <h4 style="color: #92400E; margin: 0 0 8px 0; font-size: 1rem;"><i class="fas fa-exclamation-triangle"></i> Si est√°s en crisis AHORA:</h4>
                            <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 6px;">
                                <strong style="color: #92400E; font-size: 0.9rem;">üìû L√≠nea 135 (Argentina)</strong>
                                <p style="margin: 2px 0; color: #92400E; font-size: 0.8rem;">Atenci√≥n 24/7 - GRATUITA</p>
                            </div>
                            <div style="background: white; padding: 10px; border-radius: 6px;">
                                <strong style="color: #92400E; font-size: 0.9rem;">üì± L√≠nea 141</strong>
                                <p style="margin: 2px 0; color: #92400E; font-size: 0.8rem;">Prevenci√≥n del suicidio - GRATUITA</p>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 12px;">
                            <h4 style="color: #92400E; margin-bottom: 8px; font-size: 1rem;"><i class="fas fa-laptop"></i> Online Gratuito:</h4>
                            <div style="background: #FEF3C7; padding: 10px; border-radius: 6px;">
                                <ul style="margin: 0; color: #92400E; font-size: 0.8rem;">
                                    <li><strong>7 Cups:</strong> Chat 24/7 con escuchas entrenados</li>
                                    <li><strong>Crisis Text Line:</strong> Texto gratuito</li>
                                    <li><strong>Proyecto Suma:</strong> Terapia online gratuita</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 15px;">
                            <button onclick="cerrarModal(this)" style="background: linear-gradient(135deg, #F59E0B, #FBBF24); color: white; border: none; padding: 8px 16px; border-radius: 15px; cursor: pointer; font-weight: 600; font-size: 0.85rem;">
                                <i class="fas fa-check"></i> Entendido
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de crisis creado y agregado');
        }
        
        function cerrarCrisis() {
            const modal = document.getElementById('crisisModal');
            if (modal) {
                modal.remove();
            }
        }
        
        // Centros de Salud - ULTRA SIMPLIFICADO
        function abrirCentrosSalud() {
            console.log('üè• Abriendo Centros de Salud...');
            
            // Cerrar men√∫ de bienestar primero
            cerrarBienestarMenu();
            
            // Crear modal usando createElement (m√°s confiable)
            const modal = document.createElement('div');
            modal.id = 'centrosSaludModal';
            modal.className = 'modal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999999 !important;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 12px; max-width: 400px; width: 95%; max-height: 70vh; overflow-y: auto; position: relative;">
                    <div style="background: linear-gradient(135deg, #3B82F6, #60A5FA); color: white; padding: 12px; border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0; font-size: 1.2rem;"><i class="fas fa-hospital"></i> Centros de Salud Mental</h3>
                        <button onclick="cerrarModal(this)" style="background: none; border: none; color: white; font-size: 1.3rem; cursor: pointer;">√ó</button>
                    </div>
                    <div style="padding: 15px;">
                        <div style="margin-bottom: 12px;">
                            <h4 style="color: #1E40AF; margin-bottom: 8px; font-size: 1rem;"><i class="fas fa-phone"></i> L√≠neas Nacionales GRATUITAS:</h4>
                            <div style="background: #EFF6FF; padding: 10px; border-radius: 6px; border-left: 3px solid #3B82F6;">
                                <ul style="margin: 0; color: #1E40AF; font-size: 0.8rem;">
                                    <li><strong>L√≠nea 135:</strong> Crisis 24/7</li>
                                    <li><strong>L√≠nea 141:</strong> Prevenci√≥n del suicidio</li>
                                    <li><strong>0800-999-0091:</strong> Programa Nacional</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 12px;">
                            <h4 style="color: #1E40AF; margin-bottom: 8px; font-size: 1rem;"><i class="fas fa-laptop"></i> Online Gratuito (M√°s Confiable):</h4>
                            <div style="background: #EFF6FF; padding: 10px; border-radius: 6px; border-left: 3px solid #3B82F6;">
                                <ul style="margin: 0; color: #1E40AF; font-size: 0.8rem;">
                                    <li><strong>7 Cups:</strong> Chat 24/7 con escuchas entrenados</li>
                                    <li><strong>Crisis Text Line:</strong> Texto gratuito</li>
                                    <li><strong>Proyecto Suma:</strong> Terapia online gratuita</li>
                                    <li><strong>Universidad de Buenos Aires:</strong> Facultad de Psicolog√≠a - Atenci√≥n gratuita</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 12px;">
                            <h4 style="color: #1E40AF; margin-bottom: 8px; font-size: 1rem;"><i class="fas fa-map-marker-alt"></i> En Corrientes (Intentar):</h4>
                            <div style="background: #EFF6FF; padding: 10px; border-radius: 6px; border-left: 3px solid #3B82F6;">
                                <p style="margin: 0; color: #1E40AF; font-size: 0.8rem;"><strong>Hospital Escuela "Dr. Ram√≥n Carrillo"</strong></p>
                                <p style="margin: 2px 0; color: #1E40AF; font-size: 0.75rem;">Tel: (0379) 442-2000 - Servicio de Salud Mental</p>
                                <p style="margin: 2px 0; color: #1E40AF; font-size: 0.75rem;"><em>Nota: Puede ser dif√≠cil conseguir turno</em></p>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 15px;">
                            <button onclick="cerrarModal(this)" style="background: linear-gradient(135deg, #3B82F6, #60A5FA); color: white; border: none; padding: 8px 16px; border-radius: 15px; cursor: pointer; font-weight: 600; font-size: 0.85rem;">
                                <i class="fas fa-check"></i> Entendido
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de centros de salud creado y agregado');
        }
        
        function cerrarCentrosSalud() {
            const modal = document.getElementById('centrosSaludModal');
            if (modal) {
                modal.remove();
            }
        }
        
        function seleccionarEmocion(button, emocion) {
            document.querySelectorAll('.emocion-btn').forEach(btn => {
                btn.style.transform = 'scale(1)';
                btn.style.boxShadow = 'none';
            });
            
            button.style.transform = 'scale(1.1)';
            button.style.boxShadow = '0 4px 15px rgba(0,0,0,0.2)';
            
            document.getElementById('emocionSeleccionadaNueva').value = emocion;
        }
        
        function guardarDiarioEmocionalNuevo(event) {
            event.preventDefault();
            
            const emocion = document.getElementById('emocionSeleccionadaNueva').value;
            const reflexion = document.getElementById('diarioReflexionNueva').value;
            const logros = document.getElementById('diarioLogrosNueva').value;
            
            if (!emocion || !reflexion) {
                mostrarNotificacion('‚ö†Ô∏è Por favor selecciona una emoci√≥n y escribe tu reflexi√≥n', 'error');
                return;
            }
            
            // Aqu√≠ ir√≠a la l√≥gica para guardar en localStorage o base de datos
            mostrarNotificacion('üíñ ¬°Tu reflexi√≥n del d√≠a ha sido guardada!', 'success');
            cerrarDiarioEmocionalNuevo();
        }
        
        // ========================================
        // SISTEMA DE RESPALDO EMOCIONAL BASADO EN M√âTRICAS
        // ========================================
        
        // Verificar si la tienda califica para el respaldo emocional
        function verificarCalificacionRespaldoEmocional() {
            // Obtener m√©tricas de la tienda
            const metricas = JSON.parse(localStorage.getItem('cresalia_metricas_tienda') || '{}');
            
            // Criterios para mostrar respaldo emocional (emprendimientos peque√±os/iniciales)
            const CRITERIOS = {
                maxProductos: 10,    // Menos de 10 productos
                maxVentasMes: 50,    // Menos de 50 ventas mensuales
                maxVistasMes: 1000   // Menos de 1000 visitas mensuales
            };
            
            // Verificar si cumple con los criterios
            const califica = (
                (metricas.productos_totales || 0) < CRITERIOS.maxProductos &&
                (metricas.ventas_mes || 0) < CRITERIOS.maxVentasMes &&
                (metricas.vistas_mes || 0) < CRITERIOS.maxVistasMes
            );
            
            console.log('üìä Verificaci√≥n de Respaldo Emocional:', {
                metricas: metricas,
                criterios: CRITERIOS,
                califica: califica ? 'S√ç ‚úÖ' : 'NO ‚ùå'
            });
            
            return califica;
        }
        
        // Mostrar/Ocultar secci√≥n de "Mi Espacio" seg√∫n las m√©tricas
        function ajustarVisibilidadRespaldoEmocional() {
            const califica = verificarCalificacionRespaldoEmocional();
            const seccionBienestar = document.querySelector('[onclick="mostrarSeccion(\'bienestar\')"]');
            const tabBienestar = seccionBienestar?.closest('.nav-item');
            
            if (califica) {
                // Mostrar "Mi Espacio" para emprendimientos peque√±os
                if (tabBienestar) {
                    tabBienestar.style.display = '';
                    console.log('‚úÖ "Mi Espacio" visible - Tienda califica para respaldo emocional');
                }
            } else {
                // Ocultar "Mi Espacio" para negocios establecidos
                if (tabBienestar) {
                    tabBienestar.style.display = 'none';
                    console.log('‚ùå "Mi Espacio" oculto - Tienda NO califica para respaldo emocional (negocio establecido)');
                }
            }
        }
        
        // ========================================
        // FUNCIONES DE ESTAD√çSTICAS Y DATOS
        // ========================================
        
        // Actualizar estad√≠sticas del dashboard
        function actualizarEstadisticas() {
            // Obtener datos reales del localStorage
            const tiendaId = obtenerTiendaId();
            const productos = JSON.parse(localStorage.getItem(`productos_${tiendaId}`) || '[]');
            const servicios = JSON.parse(localStorage.getItem(`servicios_${tiendaId}`) || '[]');
            const ofertas = JSON.parse(localStorage.getItem(`ofertas_${tiendaId}`) || '[]');
            const diario = JSON.parse(localStorage.getItem(`diario_${tiendaId}`) || '[]');
            
            const estadisticas = {
                productos: productos.length,
                servicios: servicios.length,
                ofertas: ofertas.length,
                entradas: diario.length
            };
            
            // Actualizar n√∫meros con animaci√≥n
            animarNumero('totalProductos', estadisticas.productos);
            animarNumero('totalServicios', estadisticas.servicios);
            animarNumero('totalOfertas', estadisticas.ofertas);
            animarNumero('totalEntradas', estadisticas.entradas);
            
            console.log('üìä Estad√≠sticas actualizadas:', estadisticas);
        }
        
        // Animaci√≥n de n√∫meros
        function animarNumero(elementId, valorFinal) {
            const elemento = document.getElementById(elementId);
            if (!elemento) return;
            
            const valorInicial = 0;
            const duracion = 2000; // 2 segundos
            const incremento = valorFinal / (duracion / 16); // 60 FPS
            let valorActual = valorInicial;
            
            const animacion = setInterval(() => {
                valorActual += incremento;
                if (valorActual >= valorFinal) {
                    valorActual = valorFinal;
                    clearInterval(animacion);
                }
                elemento.textContent = Math.floor(valorActual);
            }, 16);
        }
        
        // Inicializar dashboard
        function inicializarDashboard() {
            console.log('üöÄ Inicializando dashboard...');
            
            // Verificar y ajustar visibilidad del respaldo emocional
            ajustarVisibilidadRespaldoEmocional();
            
            // Actualizar estad√≠sticas despu√©s de un breve delay
            setTimeout(() => {
                actualizarEstadisticasMultiTenant();
                // NUEVO: Mostrar mensaje motivacional - DESACTIVADO
                // mostrarSistemaMotivacional();
            }, 500);
            
            // Actualizar estad√≠sticas cada 30 segundos
            setInterval(actualizarEstadisticasMultiTenant, 30000);
            
            console.log('‚úÖ Dashboard inicializado');
            
            // Cerrar todos los modales al inicio para evitar pantalla en negro
            cerrarTodosLosModales();
            
            // Forzar carga de todos los modales - DESACTIVADO
            /*
            setTimeout(() => {
                forzarCargaModales();
            }, 1000);
            */
        
        // Funci√≥n para cerrar todos los modales
        function cerrarTodosLosModales() {
            const modales = document.querySelectorAll('.modal');
            modales.forEach(modal => {
                modal.classList.remove('show');
                modal.style.display = 'none';
                modal.style.opacity = '0';
                modal.style.visibility = 'hidden';
            });
            console.log('üîí Todos los modales cerrados al inicio');
        }
        
        // Funci√≥n para forzar la carga de todos los modales
        function forzarCargaModales() {
            console.log('üîß Forzando carga de todos los modales...');
            
            // Buscar todos los modales en el HTML
            const modalesEnHTML = document.querySelectorAll('div[id*="modal"]');
            console.log('üîç Modales encontrados en HTML:', modalesEnHTML.length);
            
            modalesEnHTML.forEach((modal, index) => {
                console.log(`  ${index + 1}. ${modal.id} - Clase: ${modal.className}`);
                
                // Asegurar que el modal est√© oculto pero disponible
                modal.style.display = 'none';
                modal.style.opacity = '0';
                modal.style.visibility = 'hidden';
                modal.classList.remove('show');
            });
            
            // Verificar modales espec√≠ficos
            const modalProducto = document.getElementById('modalProducto');
            const modalServicio = document.getElementById('modalServicio');
            const modalSistemaTurnos = document.getElementById('modalSistemaTurnos');
            
            console.log('üîç Verificaci√≥n espec√≠fica:');
            console.log('  - modalProducto:', modalProducto ? 'ENCONTRADO' : 'NO ENCONTRADO');
            console.log('  - modalServicio:', modalServicio ? 'ENCONTRADO' : 'NO ENCONTRADO');
            console.log('  - modalSistemaTurnos:', modalSistemaTurnos ? 'ENCONTRADO' : 'NO ENCONTRADO');
            
            return {
                total: modalesEnHTML.length,
                producto: !!modalProducto,
                servicio: !!modalServicio,
                turnos: !!modalSistemaTurnos
            };
        }
        
        // Funci√≥n global para diagnosticar y forzar modales
        window.diagnosticarYForzarModales = function() {
            console.log('üîß === DIAGN√ìSTICO Y FORZADO DE MODALES ===');
            
            // Ejecutar forzarCargaModales
            const resultado = forzarCargaModales();
            
            // Verificar si los modales est√°n disponibles
            const modalProducto = document.getElementById('modalProducto');
            const modalServicio = document.getElementById('modalServicio');
            const modalSistemaTurnos = document.getElementById('modalSistemaTurnos');
            
            console.log('üìä Resultado del diagn√≥stico:');
            console.log('  - Total modales encontrados:', resultado.total);
            console.log('  - Modal Producto:', resultado.producto ? '‚úÖ' : '‚ùå');
            console.log('  - Modal Servicio:', resultado.servicio ? '‚úÖ' : '‚ùå');
            console.log('  - Modal Sistema Turnos:', resultado.turnos ? '‚úÖ' : '‚ùå');
            
            // Si alg√∫n modal no est√° disponible, intentar recrearlo
            if (!modalProducto || !modalServicio) {
                console.log('‚ö†Ô∏è Algunos modales no est√°n disponibles, intentando recrear...');
                
                // Forzar recarga de la p√°gina si es necesario
                if (!modalProducto && !modalServicio) {
                    console.log('üîÑ Modales no encontrados - NO recargando p√°gina');
                    // setTimeout(() => {
                    //     window.location.reload();
                    // }, 2000);
                }
            }
            
            return resultado;
        };
        
        // Funci√≥n de diagn√≥stico espec√≠fica para remis
        window.diagnosticarRemis = function() {
            console.log('üöó === DIAGN√ìSTICO DEL SISTEMA DE REMIS ===');
            
            const tiendaId = obtenerTiendaId();
            const serviciosRemis = JSON.parse(localStorage.getItem(`servicios_${tiendaId}`) || '[]');
            
            console.log('üîç Tienda ID:', tiendaId);
            console.log('üîç Servicios en localStorage:', serviciosRemis.length);
            console.log('üîç Servicios de remis:', serviciosRemis);
            
            // Verificar si hay servicios de remis
            const serviciosRemisFiltrados = serviciosRemis.filter(servicio => 
                servicio.categoria === 'transporte' || 
                servicio.nombre?.toLowerCase().includes('remis') ||
                servicio.id?.includes('remis')
            );
            
            console.log('üöó Servicios de remis encontrados:', serviciosRemisFiltrados.length);
            serviciosRemisFiltrados.forEach((servicio, index) => {
                console.log(`  ${index + 1}. ${servicio.nombre} - $${servicio.precio}`);
            });
            
            // Verificar configuraci√≥n de remis
            const remisConfig = document.getElementById('remisConfig');
            const servicioCategoria = document.getElementById('servicioCategoria');
            
            console.log('üîß Configuraci√≥n de remis:');
            console.log('  - remisConfig existe:', !!remisConfig);
            console.log('  - servicioCategoria existe:', !!servicioCategoria);
            console.log('  - toggleRemisFields existe:', typeof window.toggleRemisFields);
            
            return {
                servicios: serviciosRemisFiltrados,
                configuracion: {
                    remisConfig: !!remisConfig,
                    servicioCategoria: !!servicioCategoria,
                    toggleRemisFields: typeof window.toggleRemisFields
                }
            };
        };
        
        // Funci√≥n de diagn√≥stico de modales
        window.diagnosticarModales = function() {
            console.log('üîç === DIAGN√ìSTICO DE MODALES ===');
            
            // Verificar funciones disponibles
            console.log('üìã Funciones disponibles:');
            console.log('  - verMiProgreso:', typeof verMiProgreso !== 'undefined' ? 'S√ç' : 'NO');
            console.log('  - verRecursos:', typeof verRecursos !== 'undefined' ? 'S√ç' : 'NO');
            console.log('  - cerrarProgresoModal:', typeof cerrarProgresoModal !== 'undefined' ? 'S√ç' : 'NO');
            console.log('  - cerrarRecursosModal:', typeof cerrarRecursosModal !== 'undefined' ? 'S√ç' : 'NO');
            
            // Verificar modales en DOM
            const modales = document.querySelectorAll('.modal');
            console.log('üîç Modales en DOM:', modales.length);
            modales.forEach((modal, index) => {
                console.log(`  - Modal ${index + 1}: ${modal.id} Display: ${modal.style.display} Classes: ${modal.className}`);
            });
            
            // Verificar elementos del body
            console.log('üîç Body children:', document.body.children.length);
            console.log('üîç Body style:', {
                position: document.body.style.position,
                zIndex: document.body.style.zIndex,
                overflow: document.body.style.overflow
            });
            
            // Verificar modales espec√≠ficos
            const modalProducto = document.getElementById('modalProducto');
            const modalServicio = document.getElementById('modalServicio');
            const modalSistemaTurnos = document.getElementById('modalSistemaTurnos');
            
            console.log('üîç Modal Producto:', modalProducto ? 'ENCONTRADO' : 'NO ENCONTRADO');
            console.log('üîç Modal Servicio:', modalServicio ? 'ENCONTRADO' : 'NO ENCONTRADO');
            console.log('üîç Modal Sistema Turnos:', modalSistemaTurnos ? 'ENCONTRADO' : 'NO ENCONTRADO');
            
            if (modalProducto) {
                console.log('üîç Modal Producto - Display:', modalProducto.style.display);
                console.log('üîç Modal Producto - Classes:', modalProducto.className);
                console.log('üîç Modal Producto - Computed Style:', window.getComputedStyle(modalProducto).display);
            }
            
            if (modalServicio) {
                console.log('üîç Modal Servicio - Display:', modalServicio.style.display);
                console.log('üîç Modal Servicio - Classes:', modalServicio.className);
                console.log('üîç Modal Servicio - Computed Style:', window.getComputedStyle(modalServicio).display);
            }
            
            if (modalSistemaTurnos) {
                console.log('üîç Modal Sistema Turnos - Display:', modalSistemaTurnos.style.display);
                console.log('üîç Modal Sistema Turnos - Classes:', modalSistemaTurnos.className);
                console.log('üîç Modal Sistema Turnos - Computed Style:', window.getComputedStyle(modalSistemaTurnos).display);
            }
        };
        }
        
        // ========================================
        // SISTEMA MOTIVACIONAL INTELIGENTE
        // ========================================
        
        // Analizar rendimiento de la tienda
        function analizarRendimiento() {
            const metricas = JSON.parse(localStorage.getItem('cresalia_metricas_tienda') || '{}');
            const tiendaId = obtenerTiendaId();
            const productos = JSON.parse(localStorage.getItem(generarClaveTienda('productos')) || '[]');
            
            // Calcular puntuaci√≥n de rendimiento (0-100)
            let puntuacion = 0;
            let factores = [];
            
            // Factor 1: Productos (max 25 puntos)
            const puntosProductos = Math.min(25, (metricas.productos_totales || 0) * 2.5);
            puntuacion += puntosProductos;
            factores.push({ nombre: 'Productos', puntos: puntosProductos, max: 25 });
            
            // Factor 2: Ventas mensuales (max 35 puntos)
            const puntosVentas = Math.min(35, (metricas.ventas_mes || 0) * 0.7);
            puntuacion += puntosVentas;
            factores.push({ nombre: 'Ventas', puntos: puntosVentas, max: 35 });
            
            // Factor 3: Visitas mensuales (max 25 puntos)
            const puntosVisitas = Math.min(25, (metricas.vistas_mes || 0) * 0.025);
            puntuacion += puntosVisitas;
            factores.push({ nombre: 'Visitas', puntos: puntosVisitas, max: 25 });
            
            // Factor 4: Tiempo activo (max 15 puntos)
            const puntosTiempo = Math.min(15, (metricas.dias_activo || 0) * 0.15);
            puntuacion += puntosTiempo;
            factores.push({ nombre: 'Tiempo Activo', puntos: puntosTiempo, max: 15 });
            
            // Clasificar rendimiento
            let nivel, color, icono, mensaje;
            if (puntuacion >= 75) {
                nivel = 'excelente';
                color = { gradient: 'linear-gradient(135deg, #10b981, #34d399)', text: '#065f46' };
                icono = 'üéâ';
                mensaje = '¬°Excelente trabajo!';
            } else if (puntuacion >= 50) {
                nivel = 'bien';
                color = { gradient: 'linear-gradient(135deg, #3b82f6, #60a5fa)', text: '#1e40af' };
                icono = 'üí™';
                mensaje = '¬°Vas muy bien!';
            } else if (puntuacion >= 25) {
                nivel = 'regular';
                color = { gradient: 'linear-gradient(135deg, #f59e0b, #fbbf24)', text: '#92400e' };
                icono = 'üå±';
                mensaje = '¬°Buen comienzo!';
            } else {
                nivel = 'iniciando';
                color = { gradient: 'linear-gradient(135deg, #8b5cf6, #a78bfa)', text: '#6d28d9' };
                icono = 'üöÄ';
                mensaje = '¬°Empecemos juntos!';
            }
            
            return {
                puntuacion: Math.round(puntuacion),
                nivel,
                color,
                icono,
                mensaje,
                factores,
                metricas
            };
        }
        
        // Generar mensaje motivacional personalizado
        function generarMensajeMotivacional(analisis) {
            const { nivel, metricas } = analisis;
            
            let titulo, descripcion, consejos, opciones;
            
            switch (nivel) {
                case 'excelente':
                    titulo = '¬°Felicitaciones por tu √©xito! üéâ';
                    descripcion = `Tu tienda est√° funcionando incre√≠blemente bien. Con ${metricas.productos_totales || 0} productos y ${metricas.ventas_mes || 0} ventas este mes, est√°s demostrando que tu dedicaci√≥n da frutos.`;
                    consejos = [
                        'Mant√©n la consistencia en la calidad de tus productos',
                        'Considera expandir tu cat√°logo a nuevas categor√≠as',
                        'Comparte tu historia de √©xito con otros emprendedores'
                    ];
                    opciones = [
                        { texto: '‚ú® Ver mi progreso detallado', accion: 'verMiProgreso()' },
                        { texto: 'üìä Ver analytics avanzados', accion: 'alert("Pr√≥ximamente: Analytics avanzados üìä")' }
                    ];
                    break;
                    
                case 'bien':
                    titulo = '¬°Vas por muy buen camino! üí™';
                    descripcion = `Tu esfuerzo est√° dando resultados positivos. Tienes ${metricas.productos_totales || 0} productos y est√°s generando ${metricas.ventas_mes || 0} ventas mensuales. ¬°Sigue as√≠!`;
                    consejos = [
                        'Optimiza las descripciones de tus productos',
                        'Considera agregar m√°s variedad a tu cat√°logo',
                        'Promociona tus productos en redes sociales'
                    ];
                    opciones = [
                        { texto: 'üí° Ver consejos personalizados', accion: 'verRecursos()' },
                        { texto: 'üìà Ver mi progreso', accion: 'verMiProgreso()' }
                    ];
                    break;
                    
                case 'regular':
                    titulo = '¬°Est√°s construyendo algo grande! üå±';
                    descripcion = `Todo emprendimiento exitoso empieza as√≠. Con ${metricas.productos_totales || 0} productos, est√°s dando los primeros pasos importantes. Cada d√≠a cuenta.`;
                    consejos = [
                        'Agrega al menos 5 productos m√°s para aumentar visibilidad',
                        'Mejora las fotos y descripciones de tus productos',
                        'Comparte tu tienda con amigos y familia primero'
                    ];
                    opciones = [
                        { texto: 'üí° Quiero consejos pr√°cticos', accion: 'verRecursos()' },
                        { texto: 'üí¨ Hablar con el respaldo emocional', accion: 'abrirDiarioEmocional()' },
                        { texto: 'üìö Ver recursos de ayuda', accion: 'verRecursos()' }
                    ];
                    break;
                    
                case 'iniciando':
                    titulo = '¬°Bienvenido a tu nueva aventura! üöÄ';
                    descripcion = `Est√°s dando el primer paso m√°s importante: comenzar. No importa que apenas est√©s empezando, cada gran tienda empez√≥ exactamente donde est√°s t√∫ ahora.`;
                    consejos = [
                        'Comienza agregando tus primeros 3-5 productos',
                        'No te preocupes por la perfecci√≥n, enf√≥cate en empezar',
                        'T√≥mate tiempo para aprender el sistema paso a paso'
                    ];
                    opciones = [
                        { texto: 'üí¨ ¬øNecesitas apoyo? Estamos aqu√≠', accion: 'abrirDiarioEmocional()' },
                        { texto: 'üí° Ver consejos', accion: 'verRecursos()' }
                    ];
                    break;
            }
            
            return { titulo, descripcion, consejos, opciones };
        }
        
        // Mostrar sistema motivacional en el dashboard
        function mostrarSistemaMotivacional() {
            const analisis = analizarRendimiento();
            const mensaje = generarMensajeMotivacional(analisis);
            const container = document.getElementById('motivacionContainer');
            
            if (!container) return;
            
            // Crear HTML del mensaje motivacional
            const motivacionHTML = `
                <div class="motivacion-card" style="
                    background: white;
                    border-radius: 20px;
                    padding: 30px;
                    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
                    position: relative;
                    overflow: hidden;
                    animation: slideInUp 0.8s ease-out 0.4s backwards;
                    border-left: 6px solid;
                    border-image: ${analisis.color.gradient} 1;
                ">
                    <!-- Header con puntuaci√≥n -->
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                        <div style="flex: 1;">
                            <h3 style="
                                font-size: 1.5rem;
                                font-weight: 700;
                                color: ${analisis.color.text};
                                margin-bottom: 8px;
                                display: flex;
                                align-items: center;
                                gap: 10px;
                            ">
                                <span style="font-size: 1.8rem;">${analisis.icono}</span>
                                ${mensaje.titulo}
                            </h3>
                            <p style="color: #6b7280; font-size: 1rem; margin: 0; line-height: 1.6;">
                                ${mensaje.descripcion}
                            </p>
                        </div>
                        
                        <!-- Badge de puntuaci√≥n -->
                        <div style="
                            background: ${analisis.color.gradient};
                            color: white;
                            padding: 15px 25px;
                            border-radius: 15px;
                            text-align: center;
                            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                            min-width: 120px;
                        ">
                            <div style="font-size: 2rem; font-weight: 800; margin-bottom: 5px;">
                                ${analisis.puntuacion}
                            </div>
                            <div style="font-size: 0.85rem; opacity: 0.95; font-weight: 600;">
                                ${analisis.mensaje}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Consejos pr√°cticos -->
                    <div style="background: #f9fafb; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                        <h4 style="color: #374151; font-size: 1.1rem; font-weight: 600; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-lightbulb" style="color: #f59e0b;"></i>
                            Consejos para seguir creciendo:
                        </h4>
                        <ul style="list-style: none; padding: 0; margin: 0;">
                            ${mensaje.consejos.map((consejo, index) => `
                                <li style="
                                    padding: 10px 0;
                                    color: #4b5563;
                                    display: flex;
                                    align-items: flex-start;
                                    gap: 10px;
                                    font-size: 0.95rem;
                                    line-height: 1.5;
                                ">
                                    <span style="
                                        background: ${analisis.color.gradient};
                                        color: white;
                                        width: 24px;
                                        height: 24px;
                                        border-radius: 50%;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                        font-size: 0.75rem;
                                        font-weight: 700;
                                        flex-shrink: 0;
                                    ">${index + 1}</span>
                                    ${consejo}
                                </li>
                            `).join('')}
                        </ul>
                    </div>
                    
                    <!-- Opciones de acci√≥n -->
                    <div style="display: flex; flex-wrap: wrap; gap: 12px;">
                        ${mensaje.opciones.map((opcion, index) => `
                            <button onclick="${opcion.accion}" style="
                                background: ${index === 0 ? analisis.color.gradient : 'white'};
                                color: ${index === 0 ? 'white' : analisis.color.text};
                                border: ${index === 0 ? 'none' : `2px solid ${analisis.color.text}`};
                                padding: 12px 24px;
                                border-radius: 12px;
                                font-weight: 600;
                                cursor: pointer;
                                transition: all 0.3s ease;
                                font-size: 0.95rem;
                                display: flex;
                                align-items: center;
                                gap: 8px;
                                flex: 1;
                                min-width: 200px;
                                justify-content: center;
                            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(0,0,0,0.15)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                ${opcion.texto}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
            
            container.innerHTML = motivacionHTML;
            
            console.log('üíñ Sistema motivacional mostrado:', {
                nivel: analisis.nivel,
                puntuacion: analisis.puntuacion,
                mensaje: mensaje.titulo
            });
        }
        
        // ========================================
        // SISTEMA DE FEEDBACK UNIVERSAL
        // ========================================
        
        // FUNCI√ìN DE FEEDBACK PRINCIPAL - VERSI√ìN MEJORADA Y FUNCIONAL
        function abrirFeedback() {
            console.log('üìã Abriendo sistema de feedback de la tienda');
            
            // Siempre usar modal b√°sico hermoso (m√°s confiable)
            console.log('‚ö†Ô∏è Usando modal de feedback b√°sico hermoso');
            mostrarModalFeedbackHermoso();
        }
        
        function mostrarModalFeedbackHermoso() {
            // Remover modal existente si hay uno
            const modalExistente = document.getElementById('feedbackModal');
            if (modalExistente) modalExistente.remove();
            
            const modalHTML = `
                <div id="feedbackModal" class="modal" style="display: flex !important; z-index: 99999 !important; animation: fadeInOverlay 0.3s ease; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center;">
                    <div class="modal-content modal-hermoso" style="max-width: 700px; z-index: 100000 !important; animation: slideUpModal 0.5s cubic-bezier(0.16, 1, 0.3, 1); overflow: hidden; background: white; border-radius: 20px; margin: 20px;">
                        <!-- Header con gradiente animado -->
                        <div style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); background-size: 200% 200%; animation: gradientFlow 8s ease infinite; padding: 35px 30px; text-align: center; border-radius: 20px 20px 0 0; position: relative; overflow: hidden;">
                            <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%); animation: rotateBg 30s linear infinite;"></div>
                            <div style="position: relative; z-index: 1;">
                                <div style="width: 90px; height: 90px; background: rgba(255,255,255,0.3); backdrop-filter: blur(10px); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; box-shadow: 0 15px 50px rgba(0,0,0,0.2); animation: float 6s ease-in-out infinite;">
                                    <i class="fas fa-comment-dots" style="font-size: 40px; color: white; animation: pulse 4s ease-in-out infinite;"></i>
                                </div>
                                <h3 style="color: white; margin: 0; font-size: 1.8rem; font-weight: 800; text-shadow: 0 4px 15px rgba(0,0,0,0.2);">üí¨ Tu Opini√≥n Importa</h3>
                                <p style="color: rgba(255,255,255,0.95); margin: 8px 0 0 0; font-size: 0.95rem;">Ay√∫danos a mejorar tu tienda con tu feedback</p>
                            </div>
                            <button onclick="cerrarModal(this)" style="position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; color: white; font-size: 1.2rem; transition: all 0.3s ease; z-index: 2;" onmouseover="this.style.background='rgba(255,255,255,0.3)'; this.style.transform='rotate(90deg)';" onmouseout="this.style.background='rgba(255,255,255,0.2)'; this.style.transform='rotate(0)';">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <!-- Cuerpo del modal -->
                        <div style="padding: 30px; background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);">
                            <form id="feedbackFormHermoso" onsubmit="enviarFeedbackHermoso(event)">
                                <!-- Categor√≠a -->
                                <div style="margin-bottom: 25px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">
                                        <i class="fas fa-tag" style="color: #6366f1; margin-right: 8px;"></i>Categor√≠a
                                        </label>
                                    <select id="feedbackCategoria" required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 1rem; transition: all 0.3s ease; background: white;" onfocus="this.style.borderColor='#6366f1'; this.style.boxShadow='0 0 0 3px rgba(99, 102, 241, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                                        <option value="">Selecciona una categor√≠a...</option>
                                        <option value="producto">üì¶ Productos</option>
                                        <option value="servicio">üîß Servicios</option>
                                        <option value="atencion">üë• Atenci√≥n al Cliente</option>
                                        <option value="envio">üöö Env√≠os</option>
                                        <option value="general">üí¨ General</option>
                                    </select>
                                            </div>
                                
                                <!-- Calificaci√≥n -->
                                <div style="margin-bottom: 25px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">
                                        <i class="fas fa-star" style="color: #fbbf24; margin-right: 8px;"></i>Calificaci√≥n
                                        </label>
                                    <div id="estrellasFeedback" style="display: flex; gap: 5px; justify-content: center; margin: 15px 0;">
                                        ${[1,2,3,4,5].map(i => `
                                            <button type="button" class="estrella-btn" data-rating="${i}" onclick="seleccionarEstrellaHermoso(${i})" style="background: none; border: none; font-size: 2rem; color: #d1d5db; cursor: pointer; transition: all 0.2s ease; padding: 5px;" onmouseover="this.style.transform='scale(1.2)'; this.style.color='#fbbf24';" onmouseout="this.style.transform='scale(1)'; if(!this.classList.contains('selected')) this.style.color='#d1d5db';">
                                                <i class="fas fa-star"></i>
                                            </button>
                                        `).join('')}
                                            </div>
                                    <input type="hidden" id="calificacionFeedback" required>
                                            </div>
                                
                                <!-- Comentario -->
                                <div style="margin-bottom: 25px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">
                                        <i class="fas fa-comment" style="color: #8b5cf6; margin-right: 8px;"></i>Comentario
                                        </label>
                                    <textarea id="comentarioFeedback" rows="4" placeholder="Comparte tu experiencia con nosotros..." required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 1rem; resize: vertical; font-family: inherit; transition: all 0.3s ease;" onfocus="this.style.borderColor='#8b5cf6'; this.style.boxShadow='0 0 0 3px rgba(139, 92, 246, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';"></textarea>
                                </div>
                                
                                <!-- Botones -->
                                <div style="display: flex; gap: 15px; justify-content: center; margin-top: 30px;">
                                    <button type="submit" style="background: linear-gradient(135deg, #10b981, #34d399); color: white; padding: 12px 30px; border: none; border-radius: 12px; cursor: pointer; font-size: 1rem; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(16, 185, 129, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                        <i class="fas fa-paper-plane"></i> Enviar Feedback
                                    </button>
                                    <button type="button" onclick="cerrarModal(this)" style="background: #6b7280; color: white; padding: 12px 30px; border: none; border-radius: 12px; cursor: pointer; font-size: 1rem; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.background='#4b5563';" onmouseout="this.style.background='#6b7280';">
                                        <i class="fas fa-times"></i> Cancelar
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            console.log('‚úÖ Modal de feedback hermoso mostrado');
        }
        
        function cerrarFeedbackHermoso() {
            const modal = document.getElementById('feedbackModal');
            if (modal) modal.remove();
        }
        
        function seleccionarEstrellaHermoso(rating) {
            const estrellas = document.querySelectorAll('.estrella-btn');
            const inputCalificacion = document.getElementById('calificacionFeedback');
            
            estrellas.forEach((estrella, index) => {
                if (index < rating) {
                    estrella.style.color = '#fbbf24';
                    estrella.classList.add('selected');
                } else {
                    estrella.style.color = '#d1d5db';
                    estrella.classList.remove('selected');
                }
            });
            
            inputCalificacion.value = rating;
            console.log('‚≠ê Calificaci√≥n seleccionada:', rating);
        }
        
        function enviarFeedbackHermoso(event) {
            event.preventDefault();
            
            const categoria = document.getElementById('feedbackCategoria').value;
            const calificacion = document.getElementById('calificacionFeedback').value;
            const comentario = document.getElementById('comentarioFeedback').value;
            
            if (!calificacion) {
                mostrarNotificacion('‚≠ê Por favor selecciona una calificaci√≥n', 'warning');
                return;
            }
            
            console.log('üì§ Enviando feedback:', { categoria, calificacion, comentario });
            
            // Simular env√≠o
            mostrarNotificacion('‚úÖ ¬°Gracias por tu feedback! Tu opini√≥n es muy valiosa para nosotros.', 'success');
            
            setTimeout(() => {
                cerrarFeedbackHermoso();
            }, 2000);
        }
        
        // ========================================
        // SISTEMA DE NAVEGACI√ìN Y SECCIONES
        // ========================================
        
        // Funci√≥n para mostrar secciones
        function mostrarSeccion(seccionId) {
            console.log('üìÑ Mostrando secci√≥n:', seccionId);
            
            // Ocultar todas las secciones
            const secciones = document.querySelectorAll('.content-section');
            secciones.forEach(seccion => {
                seccion.style.display = 'none';
                seccion.classList.remove('active');
            });
            
            // Mostrar la secci√≥n seleccionada
            const seccionActiva = document.getElementById(seccionId);
            if (seccionActiva) {
                seccionActiva.style.display = 'block';
                seccionActiva.classList.add('active');
                console.log('‚úÖ Secci√≥n mostrada:', seccionId);
                
                // Cargar contenido espec√≠fico seg√∫n la secci√≥n
                if (seccionId === 'feedbacks') {
                    setTimeout(() => cargarFeedbacks(), 100);
                } else if (seccionId === 'productos') {
                    setTimeout(() => cargarProductosEjemplo(), 100);
                } else if (seccionId === 'servicios') {
                    setTimeout(() => cargarServiciosEjemplo(), 100);
                }
            } else {
                console.error('‚ùå Secci√≥n no encontrada:', seccionId);
            }
            
            // Actualizar navegaci√≥n
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.classList.remove('active');
            });
            
            // Marcar como activo el bot√≥n correspondiente
            const botonActivo = document.querySelector(`[onclick="mostrarSeccion('${seccionId}')"]`);
            if (botonActivo) {
                botonActivo.classList.add('active');
            }
        }
        
        // ========================================
        // FUNCI√ìN PARA CERRAR SESI√ìN
        // ========================================
        
        function cerrarSesion() {
            console.log('üö™ Cerrando sesi√≥n...');
            
            // Limpiar localStorage
            localStorage.removeItem('cresalia_sesion_activa');
            localStorage.removeItem('cresalia_session_token');
            localStorage.removeItem('cresalia_user_data');
            localStorage.removeItem('plan-actual');
            localStorage.removeItem('tienda_actual');
            
            // Mostrar notificaci√≥n
            mostrarNotificacion('‚úÖ Sesi√≥n cerrada correctamente', 'success');
            
            // Redirigir al login despu√©s de 1 segundo
            setTimeout(() => {
                window.location.href = '../../login-tienda.html';
            }, 1000);
        
        
        // ========================================
        // FUNCIONES PRINCIPALES CORREGIDAS
        // ========================================
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        // Cerrar modal de feedback
        function cerrarFeedback() {
            const modal = document.getElementById('feedbackModal');
            if (modal) {
                modal.remove();
            }
        }
        
        // Enviar feedback
        async function enviarFeedback(event) {
            event.preventDefault();
            
            const tipo = document.querySelector('input[name="feedbackTipo"]:checked')?.value;
            const asunto = document.getElementById('feedbackAsunto').value;
            const mensaje = document.getElementById('feedbackMensaje').value;
            const email = document.getElementById('feedbackEmail').value;
            
            if (!tipo || !asunto || !mensaje) {
                mostrarNotificacion('‚ö†Ô∏è Por favor completa todos los campos requeridos', 'error');
                return;
            }
            
            // Datos del usuario
            const usuario = JSON.parse(localStorage.getItem('cresalia_usuario_autenticado') || '{}');
            const tiendaId = localStorage.getItem('cresalia_tienda_id');
            
            // Crear objeto de feedback
            const feedback = {
                id: 'feedback_' + Date.now(),
                tipo: tipo,
                asunto: asunto,
                mensaje: mensaje,
                email: email || usuario.email || 'No proporcionado',
                tienda_id: tiendaId,
                usuario_nombre: usuario.nombre_tienda || usuario.email || 'Usuario',
                fecha: new Date().toISOString(),
                estado: 'pendiente',
                leido: false
            };
            
            // Guardar en localStorage (en producci√≥n ir√≠a a Supabase)
            const feedbacks = JSON.parse(localStorage.getItem('cresalia_feedbacks') || '[]');
            feedbacks.push(feedback);
            localStorage.setItem('cresalia_feedbacks', JSON.stringify(feedbacks));
            
            console.log('üìã Feedback enviado:', feedback);
            
            // Enviar a Supabase y panel master
            try {
                const supabaseClient = initSupabase();
                const { data, error } = await supabaseClient
                    .from('tienda_feedbacks')
                    .insert([{
                        tienda_id: 'ejemplo-tienda',
                        usuario_nombre: feedback.nombre,
                        usuario_email: feedback.email,
                        calificacion: feedback.calificacion,
                        comentario: feedback.mensaje,
                        aprobado: false
                    }]);
                
                if (error) {
                    console.error('Error guardando feedback en Supabase:', error);
                    mostrarNotificacion('Error al guardar feedback', 'error');
                } else {
                    console.log('‚úÖ Feedback guardado en Supabase:', data);
                }
            } catch (error) {
                console.error('Error conectando con Supabase:', error);
                mostrarNotificacion('Error de conexi√≥n con la base de datos', 'error');
            }
            
            // Mostrar mensaje de √©xito
            mostrarNotificacion('‚úÖ ¬°Gracias por tu feedback! Lo revisaremos pronto.', 'success');
            cerrarFeedback();
        }
        
        // ========================================
        // FUNCIONES DE GUARDADO (INTEGRACI√ìN SUPABASE)
        // ========================================
        
        // Funci√≥n para dar consejos sobre fotos y descripciones
        function darConsejosProducto(producto) {
            const consejos = [];
            
            // Consejos sobre descripci√≥n
            if (!producto.descripcion || producto.descripcion.length < 50) {
                consejos.push('üí° Tu descripci√≥n podr√≠a ser m√°s detallada para atraer m√°s clientes. Incluye beneficios, caracter√≠sticas especiales y por qu√© elegir tu producto.');
            }
            
            if (producto.descripcion && producto.descripcion.length > 0 && !producto.descripcion.includes('beneficio') && !producto.descripcion.includes('ventaja')) {
                consejos.push('üí° Menciona los beneficios de tu producto. Los clientes quieren saber qu√© obtendr√°n al comprarlo.');
            }
            
            // Consejos sobre imagen
            if (!producto.imagen || producto.imagen === '') {
                consejos.push('üì∏ Agregar una foto atractiva puede aumentar las ventas hasta 3 veces. Usa buena iluminaci√≥n y muestra el producto desde diferentes √°ngulos.');
            } else if (producto.imagen.startsWith('data:image')) {
                consejos.push('üì∏ ¬°Excelente! Las fotos tomadas localmente se ven m√°s aut√©nticas. Aseg√∫rate de que est√©n bien iluminadas y enfocadas.');
            }
            
            // Consejos sobre precio
            if (producto.precio < 10) {
                consejos.push('üí∞ Considera si tu precio refleja el valor real de tu producto. A veces un precio muy bajo puede parecer de baja calidad.');
            }
            
            // Consejos sobre categor√≠a
            if (producto.categoria === 'otros') {
                consejos.push('üè∑Ô∏è Una categor√≠a espec√≠fica ayuda a los clientes a encontrar tu producto m√°s f√°cilmente.');
            }
            
            return consejos;
        }
        
        // Funci√≥n para dar consejos sobre servicios
        function darConsejosServicio(servicio) {
            const consejos = [];
            
            // Consejos sobre descripci√≥n
            if (!servicio.descripcion || servicio.descripcion.length < 50) {
                consejos.push('üí° Describe qu√© incluye tu servicio, cu√°nto tiempo toma y qu√© beneficios obtendr√° el cliente.');
            }
            
            if (servicio.descripcion && !servicio.descripcion.includes('experiencia') && !servicio.descripcion.includes('profesional')) {
                consejos.push('üí° Menciona tu experiencia y profesionalismo. Los clientes conf√≠an m√°s en servicios con credibilidad.');
            }
            
            // Consejos sobre duraci√≥n
            if (!servicio.duracion || servicio.duracion === '') {
                consejos.push('‚è∞ Especifica la duraci√≥n del servicio. Los clientes quieren saber cu√°nto tiempo invertir√°n.');
            }
            
            // Consejos sobre precio
            if (servicio.precio < 20) {
                consejos.push('üí∞ Aseg√∫rate de que tu precio refleje la calidad y tiempo que inviertes en el servicio.');
            }
            
            return consejos;
        }
        
        // Guardar producto (con integraci√≥n Supabase) - VERSI√ìN ANTIGUA ELIMINADA COMPLETAMENTE
        /*
        function guardarProducto(event) {
            event.preventDefault();
            
            const producto = {
                id: 'prod-' + Date.now(),
                tipo: 'producto',
                nombre: document.getElementById('productoNombre').value,
                descripcion: document.getElementById('productoDescripcion').value || '',
                precio: parseFloat(document.getElementById('productoPrecio').value),
                categoria: document.getElementById('productoCategoria').value,
                stock: parseInt(document.getElementById('productoStock').value) || 0,
                imagen: document.getElementById('productoImagen').value || '',
                destacado: document.getElementById('productoDestacado').checked,
                oferta: document.getElementById('productoOferta').checked,
                nuevo: document.getElementById('productoNuevo').checked,
                fecha_creacion: new Date().toISOString()
            };
            
            // Dar consejos antes de guardar
            const consejos = darConsejosProducto(producto);
            if (consejos.length > 0) {
                mostrarConsejosProducto(consejos, producto);
                return; // No guardar hasta que el usuario confirme
            }
        */
        
        // Funci√≥n para mostrar consejos de producto
        function mostrarConsejosProducto(consejos, producto) {
            const modalHTML = `
                <div id="consejosModal" class="modal" style="display: flex !important; z-index: 99999 !important;">
                    <div class="modal-content" style="max-width: 600px; z-index: 100000 !important; background: white; border-radius: 20px; padding: 40px;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #F59E0B, #D97706); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; color: white; font-size: 2rem;">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <h2 style="color: #333; margin-bottom: 10px;">üí° Consejos para Mejorar tu Producto</h2>
                            <p style="color: #666; margin-bottom: 0;">Peque√±os ajustes pueden atraer m√°s clientes</p>
                        </div>
                        
                        <div style="margin-bottom: 30px;">
                            ${consejos.map(consejo => `
                                <div style="background: #FEF3C7; border-left: 4px solid #F59E0B; padding: 15px; margin-bottom: 15px; border-radius: 8px;">
                                    <p style="margin: 0; color: #92400E; font-weight: 500;">${consejo}</p>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button onclick="cerrarConsejosModal()" style="background: #6b7280; color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-edit"></i> Mejorar Ahora
                            </button>
                            <button onclick="guardarProductoConsejos()" style="background: linear-gradient(135deg, #10B981, #059669); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-save"></i> Guardar Como Est√°
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        // Funci√≥n para cerrar modal de consejos
        function cerrarConsejosModal() {
            const modal = document.getElementById('consejosModal');
            if (modal) {
                modal.remove();
            }
        }
        
        // Funci√≥n para guardar producto ignorando consejos
        function guardarProductoConsejos() {
            cerrarConsejosModal();
            
            // Obtener datos del formulario
            const producto = {
                id: 'prod-' + Date.now(),
                tipo: 'producto',
                nombre: document.getElementById('productoNombre').value,
                descripcion: document.getElementById('productoDescripcion').value || '',
                precio: parseFloat(document.getElementById('productoPrecio').value),
                categoria: document.getElementById('productoCategoria').value,
                stock: parseInt(document.getElementById('productoStock').value) || 0,
                imagen: document.getElementById('productoImagen').value || '',
                destacado: document.getElementById('productoDestacado').checked,
                oferta: document.getElementById('productoOferta').checked,
                nuevo: document.getElementById('productoNuevo').checked,
                fecha_creacion: new Date().toISOString()
            };
            
            // Guardar en localStorage
            let productos = JSON.parse(localStorage.getItem('productos_tienda') || '[]');
            productos.push(producto);
            localStorage.setItem('productos_tienda', JSON.stringify(productos));
            
            mostrarNotificacion('‚úÖ Producto agregado correctamente', 'success');
            cerrarModalProducto();
            actualizarEstadisticas();
        }
        
        // Guardar servicio (con integraci√≥n Supabase)
        async function guardarServicio(event) {
            event.preventDefault();
            
            const servicio = {
                id: 'serv-' + Date.now(),
                tipo: 'servicio',
                nombre: document.getElementById('servicioNombre').value,
                descripcion: document.getElementById('servicioDescripcion').value,
                precio: parseFloat(document.getElementById('servicioPrecio').value),
                duracion: parseFloat(document.getElementById('servicioDuracion').value),
                categoria: document.getElementById('servicioCategoria').value,
                notas: document.getElementById('servicioNotas').value || '',
                fecha_creacion: new Date().toISOString()
            };
            
            // Dar consejos antes de guardar
            const consejos = darConsejosServicio(servicio);
            if (consejos.length > 0) {
                mostrarConsejosServicio(consejos, servicio);
                return; // No guardar hasta que el usuario confirme
            }
            
            // Guardar en localStorage (backup local)
            let servicios = JSON.parse(localStorage.getItem('servicios_tienda') || '[]');
            servicios.push(servicio);
            localStorage.setItem('servicios_tienda', JSON.stringify(servicios));
            
            // Guardar en Supabase
            try {
                const supabaseClient = initSupabase();
                const { data, error } = await supabaseClient
                    .from('servicios')
                    .insert([servicio]);
                
                if (error) {
                    console.error('Error guardando servicio en Supabase:', error);
                    mostrarNotificacion('Error al guardar en la base de datos', 'error');
                } else {
                    console.log('‚úÖ Servicio guardado en Supabase:', data);
                }
            } catch (error) {
                console.error('Error conectando con Supabase:', error);
                mostrarNotificacion('Error de conexi√≥n con la base de datos', 'error');
            }
            
            mostrarNotificacion('‚úÖ Servicio agregado correctamente', 'success');
            cerrarModalServicio();
            actualizarEstadisticas();
            
            console.log('‚úÖ Servicio guardado:', servicio);
        }
        
        // Funci√≥n para mostrar consejos de servicio
        function mostrarConsejosServicio(consejos, servicio) {
            const modalHTML = `
                <div id="consejosModal" class="modal" style="display: flex !important; z-index: 99999 !important;">
                    <div class="modal-content" style="max-width: 600px; z-index: 100000 !important; background: white; border-radius: 20px; padding: 40px;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #8B5CF6, #7C3AED); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; color: white; font-size: 2rem;">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <h2 style="color: #333; margin-bottom: 10px;">üí° Consejos para Mejorar tu Servicio</h2>
                            <p style="color: #666; margin-bottom: 0;">Peque√±os ajustes pueden atraer m√°s clientes</p>
                        </div>
                        
                        <div style="margin-bottom: 30px;">
                            ${consejos.map(consejo => `
                                <div style="background: #EDE9FE; border-left: 4px solid #8B5CF6; padding: 15px; margin-bottom: 15px; border-radius: 8px;">
                                    <p style="margin: 0; color: #5B21B6; font-weight: 500;">${consejo}</p>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button onclick="cerrarConsejosModal()" style="background: #6b7280; color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-edit"></i> Mejorar Ahora
                            </button>
                            <button onclick="guardarServicioConsejos()" style="background: linear-gradient(135deg, #8B5CF6, #7C3AED); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-save"></i> Guardar Como Est√°
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        // Funci√≥n para guardar servicio ignorando consejos
        function guardarServicioConsejos() {
            cerrarConsejosModal();
            
            // Obtener datos del formulario
            const servicio = {
                id: 'serv-' + Date.now(),
                tipo: 'servicio',
                nombre: document.getElementById('servicioNombre').value,
                descripcion: document.getElementById('servicioDescripcion').value,
                precio: parseFloat(document.getElementById('servicioPrecio').value),
                duracion: parseFloat(document.getElementById('servicioDuracion').value),
                categoria: document.getElementById('servicioCategoria').value,
                notas: document.getElementById('servicioNotas').value || '',
                fecha_creacion: new Date().toISOString()
            };
            
            // Guardar en localStorage
            let servicios = JSON.parse(localStorage.getItem('servicios_tienda') || '[]');
            servicios.push(servicio);
            localStorage.setItem('servicios_tienda', JSON.stringify(servicios));
            
            mostrarNotificacion('‚úÖ Servicio agregado correctamente', 'success');
            cerrarModalServicio();
            actualizarEstadisticas();
        }
        
        // ========================================
        // FUNCIONALIDAD DE IA PARA DESCRIPCIONES
        // ========================================
        
        // Funci√≥n para verificar si el usuario tiene un plan pagado
        function tienePlanPago() {
            const planActual = localStorage.getItem('plan_actual') || localStorage.getItem('plan-actual') || 'gratuito';
            // Los comprobantes personalizados SOLO est√°n disponibles en planes pagos
            return planActual !== 'gratuito' && planActual !== 'free';
        }
        
        // Funci√≥n para generar descripci√≥n con IA
        function generarDescripcionIA(tipo, datos) {
            if (!tienePlanPago()) {
                mostrarNotificacion('ü§ñ Esta funci√≥n est√° disponible solo en planes pagos', 'info');
                return null;
            }
            
            console.log('ü§ñ Generando descripci√≥n con IA para:', tipo, datos);
            
            // Simular generaci√≥n de IA (en producci√≥n ser√≠a una llamada real a la API)
            const descripcionesIA = {
                producto: {
                    'ropa-mujer': `¬°Descubre este hermoso ${datos.nombre}! Dise√±ado para realzar tu figura y brindarte comodidad durante todo el d√≠a. Fabricado con materiales de alta calidad que garantizan durabilidad y estilo. Perfecto para ocasiones especiales o uso diario. ¬°No te quedes sin el tuyo!`,
                    'electronica': `¬°Tecnolog√≠a de vanguardia en tus manos! Este ${datos.nombre} combina innovaci√≥n y funcionalidad para ofrecerte la mejor experiencia. Caracter√≠sticas avanzadas que facilitan tu d√≠a a d√≠a. Garant√≠a incluida y soporte t√©cnico especializado. ¬°La tecnolog√≠a que necesitas!`,
                    'hogar': `¬°Transforma tu hogar con este incre√≠ble ${datos.nombre}! Dise√±ado para brindar comodidad, estilo y funcionalidad a tu espacio. Materiales de primera calidad que garantizan durabilidad. F√°cil instalaci√≥n y mantenimiento. ¬°Haz de tu hogar un lugar √∫nico!`,
                    'belleza': `¬°Realza tu belleza natural con este ${datos.nombre}! Formulado con ingredientes cuidadosamente seleccionados para cuidar tu piel. Resultados visibles desde el primer uso. F√°cil aplicaci√≥n y larga duraci√≥n. ¬°Descubre la belleza que llevas dentro!`,
                    'alimentos': `¬°Sabor aut√©ntico y calidad garantizada! Este ${datos.nombre} est√° preparado con los mejores ingredientes frescos. Receta tradicional que deleita el paladar. Perfecto para compartir en familia. ¬°Una experiencia gastron√≥mica √∫nica!`,
                    'panaderia': `¬°Fresco del horno y listo para disfrutar! Este ${datos.nombre} est√° elaborado con ingredientes naturales y t√©cnicas artesanales. Sabor tradicional que evoca recuerdos de la infancia. Perfecto para el desayuno o merienda. ¬°Horneado con amor!`,
                    'default': `¬°Descubre este incre√≠ble ${datos.nombre}! Dise√±ado para brindarte calidad, comodidad y satisfacci√≥n. Caracter√≠sticas √∫nicas que lo hacen especial. Perfecto para tus necesidades. ¬°No te quedes sin el tuyo!`
                },
                servicio: {
                    'peluqueria': `¬°Transforma tu look con nuestro servicio de ${datos.nombre}! Profesionales especializados que conocen las √∫ltimas tendencias. T√©cnicas modernas y productos de alta calidad. Resultado garantizado que realzar√° tu belleza natural. ¬°Reserva tu cita ahora!`,
                    'estetica': `¬°Cuida tu belleza con nuestro servicio de ${datos.nombre}! Tratamientos especializados para realzar tu belleza natural. Profesionales certificados y productos premium. Ambiente relajante y resultados visibles. ¬°D√©jate consentir!`,
                    'transporte': `¬°Viaja con comodidad y seguridad! Nuestro servicio de ${datos.nombre} te garantiza puntualidad, limpieza y profesionalismo. Veh√≠culos modernos y conductores experimentados. Tarifas competitivas y atenci√≥n personalizada. ¬°Tu transporte de confianza!`,
                    'lubricentro': `¬°Mant√©n tu veh√≠culo en perfecto estado! Nuestro servicio de ${datos.nombre} incluye cambio de aceite, filtros y revisi√≥n general. T√©cnicos especializados y repuestos originales. Garant√≠a en todos nuestros trabajos. ¬°Conf√≠a en los expertos!`,
                    'detail': `¬°Deja tu veh√≠culo como nuevo! Nuestro servicio de ${datos.nombre} incluye limpieza interior y exterior, encerado y detallado completo. Productos profesionales y t√©cnicas especializadas. Resultado impecable garantizado. ¬°Tu auto merece lo mejor!`,
                    'restaurante': `¬°Disfruta de una experiencia gastron√≥mica √∫nica! Nuestro servicio de ${datos.nombre} combina sabores aut√©nticos con presentaci√≥n impecable. Ingredientes frescos y t√©cnicas culinarias tradicionales. Ambiente acogedor y atenci√≥n personalizada. ¬°Reserva tu mesa!`,
                    'default': `¬°Descubre nuestro servicio de ${datos.nombre}! Profesionales especializados que garantizan calidad y satisfacci√≥n. Atenci√≥n personalizada y resultados excepcionales. ¬°Conf√≠a en los expertos!`
                }
            };
            
            const categoria = datos.categoria || 'default';
            const tipoDescripcion = tipo === 'producto' ? descripcionesIA.producto : descripcionesIA.servicio;
            
            return tipoDescripcion[categoria] || tipoDescripcion.default;
        }
        
        // Funci√≥n para mostrar opci√≥n de IA en formularios
        function mostrarOpcionIA(tipo) {
            if (!tienePlanPago()) {
                return '';
            }
            
            return `
                <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #F3E8FF, #E0E7FF); border-radius: 12px; border: 2px solid #8B5CF6;">
                    <div style="display: flex; align-items: center; margin-bottom: 10px;">
                        <i class="fas fa-robot" style="color: #8B5CF6; font-size: 1.2rem; margin-right: 10px;"></i>
                        <h4 style="color: #5B21B6; margin: 0; font-size: 1.1rem;">ü§ñ Generar con IA</h4>
                    </div>
                    <p style="color: #6B7280; margin-bottom: 15px; font-size: 0.9rem;">Tu plan incluye generaci√≥n autom√°tica de descripciones atractivas</p>
                    <button type="button" onclick="generarDescripcionConIA('${tipo}')" style="background: linear-gradient(135deg, #8B5CF6, #7C3AED); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">
                        <i class="fas fa-magic"></i> Generar Descripci√≥n
                    </button>
                </div>
            `;
        }
        
        // Funci√≥n para generar descripci√≥n con IA
        function generarDescripcionConIA(tipo) {
            const nombre = document.getElementById(tipo === 'producto' ? 'nombreProducto' : 'nombreServicio').value;
            const categoria = document.getElementById(tipo === 'producto' ? 'categoriaProducto' : 'categoriaServicio').value;
            
            if (!nombre) {
                mostrarNotificacion('‚ö†Ô∏è Ingresa primero el nombre', 'warning');
                return;
            }
            
            const datos = { nombre, categoria };
            const descripcionIA = generarDescripcionIA(tipo, datos);
            
            if (descripcionIA) {
                const campoDescripcion = document.getElementById(tipo === 'producto' ? 'descripcionProducto' : 'descripcionServicio');
                campoDescripcion.value = descripcionIA;
                mostrarNotificacion('ü§ñ Descripci√≥n generada con IA', 'success');
            }
        }
        
        // ========================================
        // FUNCIONES DE BIENESTAR PERSONAL
        // ========================================
        
        // Ver Mi Progreso - Dise√±o elegante y animado
        function verMiProgreso() {
            try {
            console.log('üîµ FUNCI√ìN verMiProgreso() EJECUTADA');
            
            // Remover modal existente si lo hay
            const modalExistente = document.getElementById('progresoModal');
            if (modalExistente) {
                modalExistente.remove();
            }
            
            const modalHTML = `
                <div id="progresoModal" style="display: flex !important; position: fixed !important; top: 0 !important; left: 0 !important; width: 100% !important; height: 100% !important; z-index: 2147483647 !important; background: rgba(0,0,0,0.7) !important; align-items: center !important; justify-content: center !important;">
                    <div onclick="event.stopPropagation()" style="max-width: 900px; width: 90%; max-height: 90vh; background: white; border-radius: 20px; overflow-y: auto; overflow-x: hidden; position: relative; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                        <!-- Header con gradiente animado -->
                        <div style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); background-size: 200% 200%; animation: gradientFlow 8s ease infinite; padding: 40px 30px; text-align: center; border-radius: 20px 20px 0 0; position: relative; overflow: hidden;">
                            <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%); animation: rotateBg 30s linear infinite;"></div>
                            <div style="position: relative; z-index: 1;">
                                <div style="width: 100px; height: 100px; background: rgba(255,255,255,0.3); backdrop-filter: blur(10px); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; box-shadow: 0 15px 50px rgba(0,0,0,0.2); animation: float 6s ease-in-out infinite;">
                                    <i class="fas fa-chart-line" style="font-size: 45px; color: white; animation: pulse 4s ease-in-out infinite;"></i>
                            </div>
                                <h2 style="color: white; margin-bottom: 10px; font-size: 2.2rem; font-weight: 800; text-shadow: 0 4px 15px rgba(0,0,0,0.2);">üìà Mi Progreso Empresarial</h2>
                                <p style="color: rgba(255,255,255,0.95); font-size: 1.1rem; text-shadow: 0 2px 10px rgba(0,0,0,0.1);">‚ú® Visualiza tu crecimiento y logros alcanzados ‚ú®</p>
                            </div>
                        </div>
                        
                        <!-- Contenido del modal -->
                        <div style="padding: 40px 30px; background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);">
                            <!-- Estad√≠sticas con animaci√≥n -->
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 35px;">
                                <div class="stat-card-progreso" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px 20px; border-radius: 20px; text-align: center; box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; animation: slideInLeft 0.6s ease 0.1s backwards;">
                                    <div style="font-size: 3rem; font-weight: 800; margin-bottom: 10px; animation: countUp 1s ease;" id="progresoProductos">0</div>
                                    <div style="font-size: 0.95rem; opacity: 0.95; font-weight: 600;">üéÅ Productos Creados</div>
                            </div>
                                <div class="stat-card-progreso" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 25px 20px; border-radius: 20px; text-align: center; box-shadow: 0 10px 30px rgba(240, 147, 251, 0.3); transition: all 0.3s ease; animation: slideInLeft 0.6s ease 0.2s backwards;">
                                    <div style="font-size: 3rem; font-weight: 800; margin-bottom: 10px; animation: countUp 1s ease;" id="progresoServicios">0</div>
                                    <div style="font-size: 0.95rem; opacity: 0.95; font-weight: 600;">üõ†Ô∏è Servicios Ofrecidos</div>
                            </div>
                                <div class="stat-card-progreso" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 25px 20px; border-radius: 20px; text-align: center; box-shadow: 0 10px 30px rgba(79, 172, 254, 0.3); transition: all 0.3s ease; animation: slideInLeft 0.6s ease 0.3s backwards;">
                                    <div style="font-size: 3rem; font-weight: 800; margin-bottom: 10px; animation: countUp 1s ease;" id="progresoOfertas">0</div>
                                    <div style="font-size: 0.95rem; opacity: 0.95; font-weight: 600;">üè∑Ô∏è Ofertas Creadas</div>
                            </div>
                                <div class="stat-card-progreso" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 25px 20px; border-radius: 20px; text-align: center; box-shadow: 0 10px 30px rgba(67, 233, 123, 0.3); transition: all 0.3s ease; animation: slideInLeft 0.6s ease 0.4s backwards;">
                                    <div style="font-size: 3rem; font-weight: 800; margin-bottom: 10px; animation: countUp 1s ease;" id="progresoEntradas">0</div>
                                    <div style="font-size: 0.95rem; opacity: 0.95; font-weight: 600;">üìî Entradas del Diario</div>
                            </div>
                        </div>
                        
                            <!-- Metas con dise√±o mejorado -->
                            <div style="background: linear-gradient(135deg, #f8f9ff 0%, #fff5f8 100%); padding: 30px; border-radius: 20px; margin-bottom: 30px; box-shadow: inset 0 2px 20px rgba(0,0,0,0.05); animation: fadeInUp 0.6s ease 0.5s backwards;">
                                <h4 style="color: #1f2937; margin-bottom: 20px; font-size: 1.5rem; font-weight: 700; display: flex; align-items: center; gap: 12px;">
                                    <span style="background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 1.8rem;">üéØ</span>
                                    Metas Alcanzadas
                                </h4>
                                <div style="display: grid; gap: 15px;">
                                    <div class="meta-item" style="display: flex; justify-content: space-between; align-items: center; padding: 18px 20px; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); transition: all 0.3s ease; animation: fadeInUp 0.5s ease 0.6s backwards;">
                                        <span style="font-weight: 600; color: #1f2937; display: flex; align-items: center; gap: 10px;">
                                            <span style="font-size: 1.3rem;">‚úÖ</span> Primer producto creado
                                        </span>
                                        <span style="background: linear-gradient(135deg, #10b981, #34d399); color: white; padding: 6px 16px; border-radius: 20px; font-weight: 700; font-size: 0.85rem; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);">Completado</span>
                                </div>
                                    <div class="meta-item" style="display: flex; justify-content: space-between; align-items: center; padding: 18px 20px; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); transition: all 0.3s ease; animation: fadeInUp 0.5s ease 0.7s backwards;">
                                        <span style="font-weight: 600; color: #1f2937; display: flex; align-items: center; gap: 10px;">
                                            <span style="font-size: 1.3rem;">‚úÖ</span> Primer servicio agregado
                                        </span>
                                        <span style="background: linear-gradient(135deg, #10b981, #34d399); color: white; padding: 6px 16px; border-radius: 20px; font-weight: 700; font-size: 0.85rem; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);">Completado</span>
                                </div>
                                    <div class="meta-item" style="display: flex; justify-content: space-between; align-items: center; padding: 18px 20px; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); transition: all 0.3s ease; animation: fadeInUp 0.5s ease 0.8s backwards;">
                                        <span style="font-weight: 600; color: #1f2937; display: flex; align-items: center; gap: 10px;">
                                            <span style="font-size: 1.3rem;">‚è≥</span> 10 productos en cat√°logo
                                        </span>
                                        <span style="background: linear-gradient(135deg, #f59e0b, #fbbf24); color: white; padding: 6px 16px; border-radius: 20px; font-weight: 700; font-size: 0.85rem; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);">En progreso</span>
                                </div>
                                    <div class="meta-item" style="display: flex; justify-content: space-between; align-items: center; padding: 18px 20px; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); transition: all 0.3s ease; animation: fadeInUp 0.5s ease 0.9s backwards;">
                                        <span style="font-weight: 600; color: #1f2937; display: flex; align-items: center; gap: 10px;">
                                            <span style="font-size: 1.3rem;">‚è≥</span> Primera oferta creada
                                        </span>
                                        <span style="background: linear-gradient(135deg, #f59e0b, #fbbf24); color: white; padding: 6px 16px; border-radius: 20px; font-weight: 700; font-size: 0.85rem; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);">En progreso</span>
                                </div>
                            </div>
                        </div>
                        
                            <!-- Bot√≥n de cierre elegante -->
                        <div style="text-align: center; margin-top: 30px;">
                                <button type="button" onclick="cerrarModal(this)" style="background: linear-gradient(135deg, #6b7280, #4b5563); color: white; border: none; padding: 16px 40px; border-radius: 15px; font-size: 16px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 6px 20px rgba(107, 114, 128, 0.3); animation: fadeInUp 0.5s ease 1s backwards;" onmouseover="this.style.transform='translateY(-3px) scale(1.05)'; this.style.boxShadow='0 10px 30px rgba(107, 114, 128, 0.4)';" onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 6px 20px rgba(107, 114, 128, 0.3)';">
                                <i class="fas fa-times"></i> Cerrar
                            </button>
                    </div>
                </div>
                </div>
                
                <style>
                    @keyframes fadeInOverlay {
                        from { opacity: 0; }
                        to { opacity: 1; }
                    }
                    
                    @keyframes slideUpModal {
                        from { 
                            opacity: 0;
                            transform: translateY(50px) scale(0.9);
                        }
                        to { 
                            opacity: 1;
                            transform: translateY(0) scale(1);
                        }
                    }
                    
                    @keyframes gradientFlow {
                        0%, 100% { background-position: 0% 50%; }
                        50% { background-position: 100% 50%; }
                    }
                    
                    @keyframes rotateBg {
                        from { transform: rotate(0deg); }
                        to { transform: rotate(360deg); }
                    }
                    
                    @keyframes float {
                        0%, 100% { transform: translateY(0px); }
                        50% { transform: translateY(-10px); }
                    }
                    
                    @keyframes pulse {
                        0%, 100% { transform: scale(1); }
                        50% { transform: scale(1.1); }
                    }
                    
                    @keyframes slideInLeft {
                        from {
                            opacity: 0;
                            transform: translateX(-30px);
                        }
                        to {
                            opacity: 1;
                            transform: translateX(0);
                        }
                    }
                    
                    @keyframes fadeInUp {
                        from {
                            opacity: 0;
                            transform: translateY(20px);
                        }
                        to {
                            opacity: 1;
                            transform: translateY(0);
                        }
                    }
                    
                    @keyframes countUp {
                        from { opacity: 0; transform: scale(0.5); }
                        to { opacity: 1; transform: scale(1); }
                    }
                    
                    .stat-card-progreso:hover {
                        transform: translateY(-8px) scale(1.03);
                        box-shadow: 0 20px 40px rgba(0,0,0,0.2);
                    }
                    
                    .meta-item:hover {
                        transform: translateX(8px);
                        box-shadow: 0 8px 25px rgba(0,0,0,0.12);
                    }
                </style>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            console.log('‚úÖ Modal HTML agregado al DOM');
            
            // Agregar evento para cerrar al hacer click fuera
            setTimeout(() => {
                const modal = document.getElementById('progresoModal');
                if (modal) {
                    modal.addEventListener('click', function(e) {
                        if (e.target.id === 'progresoModal') {
                            cerrarProgresoModal();
                        }
                    });
                    console.log('‚úÖ Modal visible y eventos configurados');
                }
            }, 50);
            
            // Actualizar estad√≠sticas del progreso
            setTimeout(() => {
                const tiendaId = obtenerTiendaId();
                const productos = JSON.parse(localStorage.getItem(generarClaveTienda('productos')) || '[]');
                const servicios = JSON.parse(localStorage.getItem(generarClaveTienda('servicios')) || '[]');
                const ofertas = JSON.parse(localStorage.getItem(generarClaveTienda('ofertas')) || '[]');
                const diario = JSON.parse(localStorage.getItem(generarClaveTienda('diario')) || '[]');
                
                console.log('üìä Datos para progreso:', { productos: productos.length, servicios: servicios.length, ofertas: ofertas.length, diario: diario.length });
                
                animarNumero('progresoProductos', productos.length);
                animarNumero('progresoServicios', servicios.length);
                animarNumero('progresoOfertas', ofertas.length);
                animarNumero('progresoEntradas', diario.length);
            }, 100);
            } catch (error) {
                console.error('‚ùå Error en verMiProgreso:', error);
                mostrarNotificacion('Error al abrir modal de progreso', 'error');
            }
        }
        
        function cerrarProgresoModal() {
            const modal = document.getElementById('progresoModal');
            if (modal) {
                modal.remove();
                // Asegurar que el body pueda scrollear
                document.body.style.overflow = '';
                console.log('‚úÖ Modal de progreso cerrado');
            }
        }
        
        // Ver Recursos de Bienestar - Dise√±o elegante y animado
        function verRecursos() {
            try {
            console.log('üîµ FUNCI√ìN verRecursos() EJECUTADA');
            
            // Remover modal existente si lo hay
            const modalExistente = document.getElementById('recursosModal');
            if (modalExistente) {
                modalExistente.remove();
            }
            
            const modalHTML = `
                <div id="recursosModal" style="display: flex !important; position: fixed !important; top: 0 !important; left: 0 !important; width: 100% !important; height: 100% !important; z-index: 2147483647 !important; background: rgba(0,0,0,0.7) !important; align-items: center !important; justify-content: center !important;">
                    <div onclick="event.stopPropagation()" style="max-width: 950px; width: 90%; max-height: 90vh; background: white; border-radius: 20px; overflow-y: auto; overflow-x: hidden; position: relative; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                        <!-- Header con gradiente animado -->
                        <div style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); background-size: 200% 200%; animation: gradientFlow 8s ease infinite; padding: 40px 30px; text-align: center; border-radius: 20px 20px 0 0; position: relative; overflow: hidden;">
                            <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, transparent 70%); animation: rotateBg 30s linear infinite;"></div>
                            <div style="position: relative; z-index: 1;">
                                <div style="width: 100px; height: 100px; background: rgba(255,255,255,0.4); backdrop-filter: blur(10px); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; box-shadow: 0 15px 50px rgba(0,0,0,0.2); animation: float 6s ease-in-out infinite;">
                                    <i class="fas fa-book" style="font-size: 45px; color: #333; animation: pulse 4s ease-in-out infinite;"></i>
                            </div>
                                <h2 style="color: #333; margin-bottom: 10px; font-size: 2.2rem; font-weight: 800; text-shadow: 0 4px 15px rgba(255,255,255,0.5);">üìö Recursos de Bienestar</h2>
                                <p style="color: #444; font-size: 1.1rem; text-shadow: 0 2px 10px rgba(255,255,255,0.3);">‚ú® Herramientas para mantener el equilibrio empresarial ‚ú®</p>
                            </div>
                        </div>
                        
                        <!-- Contenido del modal -->
                        <div style="padding: 40px 30px; background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);">
                            <!-- Cards de recursos con animaci√≥n -->
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; margin-bottom: 35px;">
                                <div class="recurso-card" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); padding: 30px 25px; border-radius: 20px; text-align: center; box-shadow: 0 10px 30px rgba(252, 182, 159, 0.3); transition: all 0.3s ease; animation: fadeInUp 0.6s ease 0.1s backwards;">
                                    <div style="font-size: 3rem; margin-bottom: 15px; animation: bounceIn 1s ease 0.1s backwards;">üßò‚Äç‚ôÄÔ∏è</div>
                                    <h4 style="color: #333; margin-bottom: 12px; font-size: 1.3rem; font-weight: 700;">Mindfulness Empresarial</h4>
                                    <p style="color: #555; font-size: 0.95rem; margin-bottom: 18px; line-height: 1.6;">T√©cnicas de meditaci√≥n para emprendedores</p>
                                    <button onclick="alert('¬°Funci√≥n en desarrollo! Pr√≥ximamente tendr√°s acceso a gu√≠as completas de mindfulness üßò‚Äç‚ôÄÔ∏è')" style="background: linear-gradient(135deg, #ff6b6b, #ff8e53); color: white; border: none; padding: 12px 24px; border-radius: 12px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(255, 107, 107, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(255, 107, 107, 0.3)';">Ver Gu√≠a</button>
                            </div>
                            
                                <div class="recurso-card" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 30px 25px; border-radius: 20px; text-align: center; box-shadow: 0 10px 30px rgba(168, 237, 234, 0.3); transition: all 0.3s ease; animation: fadeInUp 0.6s ease 0.2s backwards;">
                                    <div style="font-size: 3rem; margin-bottom: 15px; animation: bounceIn 1s ease 0.2s backwards;">‚è∞</div>
                                    <h4 style="color: #333; margin-bottom: 12px; font-size: 1.3rem; font-weight: 700;">Gesti√≥n del Tiempo</h4>
                                    <p style="color: #555; font-size: 0.95rem; margin-bottom: 18px; line-height: 1.6;">M√©todos para optimizar tu productividad</p>
                                    <button onclick="alert('¬°Funci√≥n en desarrollo! Pr√≥ximamente tendr√°s acceso a t√©cnicas avanzadas de gesti√≥n del tiempo ‚è∞')" style="background: linear-gradient(135deg, #4ecdc4, #44a3a0); color: white; border: none; padding: 12px 24px; border-radius: 12px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(78, 205, 196, 0.3);" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(78, 205, 196, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(78, 205, 196, 0.3)';">Ver Gu√≠a</button>
                            </div>
                            
                                <div class="recurso-card" style="background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%); padding: 30px 25px; border-radius: 20px; text-align: center; box-shadow: 0 10px 30px rgba(210, 153, 194, 0.3); transition: all 0.3s ease; animation: fadeInUp 0.6s ease 0.3s backwards;">
                                    <div style="font-size: 3rem; margin-bottom: 15px; animation: bounceIn 1s ease 0.3s backwards;">üí™</div>
                                    <h4 style="color: #333; margin-bottom: 12px; font-size: 1.3rem; font-weight: 700;">Resiliencia Empresarial</h4>
                                    <p style="color: #555; font-size: 0.95rem; margin-bottom: 18px; line-height: 1.6;">C√≥mo superar obst√°culos y crecer</p>
                                    <button onclick="alert('¬°Funci√≥n en desarrollo! Pr√≥ximamente tendr√°s acceso a estrategias de resiliencia üí™')" style="background: linear-gradient(135deg, #d299c2, #b084a8); color: white; border: none; padding: 12px 24px; border-radius: 12px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(210, 153, 194, 0.3);" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(210, 153, 194, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(210, 153, 194, 0.3)';">Ver Gu√≠a</button>
                            </div>
                            
                                <div class="recurso-card" style="background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%); padding: 30px 25px; border-radius: 20px; text-align: center; box-shadow: 0 10px 30px rgba(137, 247, 254, 0.3); transition: all 0.3s ease; animation: fadeInUp 0.6s ease 0.4s backwards;">
                                    <div style="font-size: 3rem; margin-bottom: 15px; animation: bounceIn 1s ease 0.4s backwards;">ü§ù</div>
                                    <h4 style="color: white; margin-bottom: 12px; font-size: 1.3rem; font-weight: 700; text-shadow: 0 2px 8px rgba(0,0,0,0.1);">Networking Efectivo</h4>
                                    <p style="color: rgba(255,255,255,0.95); font-size: 0.95rem; margin-bottom: 18px; line-height: 1.6;">Construye relaciones empresariales s√≥lidas</p>
                                    <button onclick="alert('¬°Funci√≥n en desarrollo! Pr√≥ximamente tendr√°s acceso a gu√≠as de networking ü§ù')" style="background: rgba(255,255,255,0.3); backdrop-filter: blur(10px); color: white; border: 2px solid white; padding: 12px 24px; border-radius: 12px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(255, 255, 255, 0.2);" onmouseover="this.style.transform='translateY(-3px)'; this.style.background='rgba(255,255,255,0.4)'; this.style.boxShadow='0 8px 25px rgba(255, 255, 255, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.background='rgba(255,255,255,0.3)'; this.style.boxShadow='0 4px 15px rgba(255, 255, 255, 0.2)';">Ver Gu√≠a</button>
                            </div>
                        </div>
                        
                            <!-- Consejo del d√≠a con dise√±o mejorado -->
                            <div style="background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%); padding: 30px; border-radius: 20px; margin-bottom: 30px; border-left: 6px solid #3b82f6; box-shadow: 0 8px 25px rgba(59, 130, 246, 0.15); animation: fadeInUp 0.6s ease 0.5s backwards;">
                                <h4 style="color: #1e40af; margin-bottom: 15px; font-size: 1.4rem; font-weight: 700; display: flex; align-items: center; gap: 12px;">
                                    <span style="font-size: 1.8rem; animation: pulseGlow 2s ease infinite;">üí°</span>
                                    Consejo del D√≠a
                                </h4>
                                <p style="color: #1e40af; margin: 0; font-style: italic; font-size: 1.05rem; line-height: 1.7; font-weight: 500;">
                                "El √©xito empresarial no se trata solo de ganar dinero, sino de crear valor sostenible mientras mantienes tu bienestar personal. Recuerda: un emprendedor equilibrado es un emprendedor exitoso."
                            </p>
                        </div>
                        
                            <!-- Bot√≥n de cierre elegante -->
                        <div style="text-align: center; margin-top: 30px;">
                                <button type="button" onclick="cerrarModal(this)" style="background: linear-gradient(135deg, #6b7280, #4b5563); color: white; border: none; padding: 16px 40px; border-radius: 15px; font-size: 16px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 6px 20px rgba(107, 114, 128, 0.3); animation: fadeInUp 0.5s ease 0.6s backwards;" onmouseover="this.style.transform='translateY(-3px) scale(1.05)'; this.style.boxShadow='0 10px 30px rgba(107, 114, 128, 0.4)';" onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 6px 20px rgba(107, 114, 128, 0.3)';">
                                <i class="fas fa-times"></i> Cerrar
                            </button>
                    </div>
                </div>
                </div>
                
                <style>
                    @keyframes bounceIn {
                        0% {
                            opacity: 0;
                            transform: scale(0.3);
                        }
                        50% {
                            opacity: 1;
                            transform: scale(1.05);
                        }
                        70% {
                            transform: scale(0.9);
                        }
                        100% {
                            transform: scale(1);
                        }
                    }
                    
                    @keyframes pulseGlow {
                        0%, 100% {
                            transform: scale(1);
                            filter: brightness(1);
                        }
                        50% {
                            transform: scale(1.1);
                            filter: brightness(1.3);
                        }
                    }
                    
                    .recurso-card:hover {
                        transform: translateY(-10px) scale(1.02);
                        box-shadow: 0 20px 50px rgba(0,0,0,0.2);
                    }
                </style>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            console.log('‚úÖ Modal de recursos agregado al DOM');
            
            // Agregar evento para cerrar al hacer click fuera
            setTimeout(() => {
                const modal = document.getElementById('recursosModal');
                if (modal) {
                    modal.addEventListener('click', function(e) {
                        if (e.target.id === 'recursosModal') {
                            cerrarRecursosModal();
                        }
                    });
                    console.log('‚úÖ Modal de recursos visible y eventos configurados');
                }
            }, 50);
            
            } catch (error) {
                console.error('‚ùå Error en verRecursos:', error);
                mostrarNotificacion('Error al abrir modal de recursos', 'error');
            }
        }
        
        function cerrarRecursosModal() {
            const modal = document.getElementById('recursosModal');
            if (modal) {
                modal.remove();
                // Asegurar que el body pueda scrollear
                document.body.style.overflow = '';
                console.log('‚úÖ Modal de recursos cerrado');
            }
        }
        
        // ========================================
        // FUNCIONES DE IMAGEN
        // ========================================
        
        // Previsualizar imagen seleccionada
        function previewImage(input) {
            const preview = document.getElementById('imagePreview');
            const previewImg = document.getElementById('previewImg');
            
            if (input.files && input.files[0]) {
                const file = input.files[0];
                
                // Validar tama√±o (5MB m√°ximo)
                if (file.size > 5 * 1024 * 1024) {
                    mostrarNotificacion('‚ö†Ô∏è La imagen es muy grande. M√°ximo 5MB', 'error');
                    input.value = '';
                    return;
                }
                
                // Validar tipo de archivo
                if (!file.type.startsWith('image/')) {
                    mostrarNotificacion('‚ö†Ô∏è Por favor selecciona una imagen v√°lida', 'error');
                    input.value = '';
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImg.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
                
                console.log('‚úÖ Imagen seleccionada:', file.name, 'Tama√±o:', (file.size / 1024 / 1024).toFixed(2) + 'MB');
            } else {
                preview.style.display = 'none';
            }
        }
        
        // ========================================
        // SISTEMA MULTI-TENANT
        // ========================================
        
        // Obtener ID de tienda actual
        function obtenerTiendaId() {
            const tiendaActual = JSON.parse(localStorage.getItem('tienda_actual') || '{}');
            return tiendaActual.id || 'demo-tienda';
        }
        
        // Generar clave √∫nica para localStorage por tienda
        function generarClaveTienda(tipo) {
            const tiendaId = obtenerTiendaId();
            return `${tipo}_${tiendaId}`;
        }
        
        // Actualizar funciones de guardado para multi-tenant
        function guardarProductoMultiTenant(event) {
            event.preventDefault();
            
            // Manejar imagen
            const imagenInput = document.getElementById('productoImagen');
            let imagenData = null;
            
            if (imagenInput.files && imagenInput.files[0]) {
                const file = imagenInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    imagenData = e.target.result; // Base64 de la imagen
                    
                    // Continuar con el guardado
                    guardarProductoConImagen(imagenData);
                };
                
                reader.readAsDataURL(file);
            } else {
                // Sin imagen, guardar directamente
                guardarProductoConImagen(null);
            }
        }
        
        // VERSI√ìN ANTIGUA ELIMINADA COMPLETAMENTE - CONFLICTO CON NUEVA VERSI√ìN
        /*
        function guardarProductoConImagen(imagenData) {
            const nombre = document.getElementById('nombreProducto').value;
            const precio = parseFloat(document.getElementById('precioProducto').value);
            const categoria = document.getElementById('categoriaProducto').value;
            const stock = parseInt(document.getElementById('stockProducto').value);
            const descripcion = document.getElementById('descripcionProducto').value;
            
            if (!nombre || !precio || !categoria || stock < 0) {
                mostrarNotificacion('‚ö†Ô∏è Por favor completa todos los campos requeridos', 'error');
                return;
            }
            
            const producto = {
                id: Date.now(),
                tipo: 'producto',
                nombre: nombre,
                precio: precio,
                categoria: categoria,
                stock: stock,
                descripcion: descripcion,
                imagen: imagenData || 'https://picsum.photos/150/150?random=' + Date.now(),
                fechaCreacion: new Date().toISOString()
            };
        */
        
        async function guardarServicioMultiTenant(event) {
            event.preventDefault();
            
            const servicio = {
                id: 'serv-' + Date.now(),
                tipo: 'servicio',
                nombre: document.getElementById('servicioNombre').value,
                descripcion: document.getElementById('servicioDescripcion').value,
                precio: parseFloat(document.getElementById('servicioPrecio').value),
                duracion: parseFloat(document.getElementById('servicioDuracion').value),
                categoria: document.getElementById('servicioCategoria').value,
                notas: document.getElementById('servicioNotas').value || '',
                // Nuevos campos para servicios avanzados
                ubicacion: document.getElementById('servicioUbicacion').value || '',
                horarios: document.getElementById('servicioHorarios').value || '',
                contacto: document.getElementById('servicioContacto').value || '',
                modalidad: document.getElementById('servicioModalidad').value || '',
                fecha_creacion: new Date().toISOString(),
                tienda_id: obtenerTiendaId() // Agregar ID de tienda
            };
            
            // Guardar en localStorage con clave espec√≠fica de la tienda
            const claveTienda = generarClaveTienda('servicios');
            let servicios = JSON.parse(localStorage.getItem(claveTienda) || '[]');
            servicios.push(servicio);
            localStorage.setItem(claveTienda, JSON.stringify(servicios));
            
            // Guardar en Supabase con RLS
            try {
                const supabaseClient = initSupabase();
                const { data, error } = await supabaseClient
                    .from('servicios')
                    .insert([servicio]);
                
                if (error) {
                    console.error('Error guardando servicio en Supabase:', error);
                    mostrarNotificacion('Error al guardar en la base de datos', 'error');
                } else {
                    console.log('‚úÖ Servicio guardado en Supabase:', data);
                }
            } catch (error) {
                console.error('Error conectando con Supabase:', error);
                mostrarNotificacion('Error de conexi√≥n con la base de datos', 'error');
            }
            
            mostrarNotificacion('‚úÖ Servicio agregado correctamente', 'success');
            cerrarModalServicio();
            actualizarEstadisticas();
            
            console.log('‚úÖ Servicio guardado para tienda:', obtenerTiendaId(), servicio);
        }
        
        // Actualizar estad√≠sticas para multi-tenant
        function actualizarEstadisticasMultiTenant() {
            const tiendaId = obtenerTiendaId();
            
            // Obtener datos espec√≠ficos de la tienda
            const productos = JSON.parse(localStorage.getItem(generarClaveTienda('productos')) || '[]');
            const servicios = JSON.parse(localStorage.getItem(generarClaveTienda('servicios')) || '[]');
            const ofertas = JSON.parse(localStorage.getItem(generarClaveTienda('ofertas')) || '[]');
            const diario = JSON.parse(localStorage.getItem(generarClaveTienda('diario')) || '[]');
            
            const estadisticas = {
                productos: productos.length,
                servicios: servicios.length,
                ofertas: ofertas.length,
                entradas: diario.length
            };
            
            // Actualizar n√∫meros con animaci√≥n
            animarNumero('totalProductos', estadisticas.productos);
            animarNumero('totalServicios', estadisticas.servicios);
            animarNumero('totalOfertas', estadisticas.ofertas);
            animarNumero('totalEntradas', estadisticas.entradas);
            
            console.log('üìä Estad√≠sticas actualizadas para tienda:', tiendaId, estadisticas);
        }
        
        // Asignar eventos a los formularios
        document.addEventListener('DOMContentLoaded', function() {
            const formProducto = document.getElementById('formProducto');
            const formServicio = document.getElementById('formServicio');
            
            if (formProducto) {
                formProducto.addEventListener('submit', guardarProductoMultiTenant);
            }
            
            if (formServicio) {
                formServicio.addEventListener('submit', guardarServicioMultiTenant);
            }
            
        // Inicializar dashboard con multi-tenant
        inicializarDashboard();
        
        // ===== SISTEMA DE TURNOS - FUNCIONES GLOBALES =====
        
        // Funci√≥n para abrir el sistema de turnos - VERSI√ìN UNIFICADA (COMENTADA PARA EVITAR BUCLE)
        /*window.abrirSistemaTurnos = function() {
            console.log('üìÖ Abriendo Sistema de Turnos...');
            
            // Usar el sistema unificado de control de modales
            window.CresaliaModalController.abrirModal('modalSistemaTurnos');
        };
            if (!modal) {
                // Intentar buscarlo por clase
                modal = document.querySelector('.modal[id*="turnos"], .modal[id*="Turnos"]');
                console.log('üîç Modal no encontrado por ID, buscando por clase...', modal);
            }
            if (!modal) {
                // Buscar por HTML contenido
                const modals = document.querySelectorAll('.modal');
                modal = Array.from(modals).find(m => m.innerHTML.includes('Sistema de Turnos') || m.innerHTML.includes('turnos'));
                console.log('üîç Modal no encontrado por clase, buscando por contenido...', modal);
            }
            
            if (modal) {
                // FORZAR VISIBILIDAD DEL MODAL CON M√ÅXIMA PRIORIDAD
                modal.style.cssText = `
                    display: flex !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                    z-index: 999999 !important;
                    position: fixed !important;
                    top: 0 !important;
                    left: 0 !important;
                    width: 100% !important;
                    height: 100% !important;
                    background: rgba(0,0,0,0.8) !important;
                    align-items: center !important;
                    justify-content: center !important;
                `;
                modal.classList.add('show');
                
                // Prevenir scroll del body
                document.body.style.overflow = 'hidden';
                document.body.style.position = 'fixed';
                document.body.style.width = '100%';
                
                console.log('‚úÖ Modal de turnos ULTRA FORZADO a abrirse');
                
                // Cargar configuraci√≥n despu√©s de un peque√±o delay
                setTimeout(() => {
                    try {
                cargarConfiguracionTurnos();
                    } catch (error) {
                        console.warn('‚ö†Ô∏è Error cargando configuraci√≥n de turnos:', error);
                    }
                }, 100);
                
                // SISTEMA DE PROTECCI√ìN CONTINUA
                const protegerModal = setInterval(() => {
                    if (modal.style.display !== 'flex') {
                        console.log('üîß Modal fue cerrado por otro sistema, reabriendo...');
                        modal.style.cssText = `
                            display: flex !important;
                            visibility: visible !important;
                            opacity: 1 !important;
                            z-index: 999999 !important;
                            position: fixed !important;
                            top: 0 !important;
                            left: 0 !important;
                            width: 100% !important;
                            height: 100% !important;
                            background: rgba(0,0,0,0.8) !important;
                            align-items: center !important;
                            justify-content: center !important;
                        `;
                        modal.classList.add('show');
                    }
                }, 50);
                
                // Limpiar el intervalo cuando se cierre el modal
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        clearInterval(protegerModal);
                    }
                });
                
            } else {
                console.error('‚ùå Modal de turnos no encontrado');
            }
        }*/
        
        // Funci√≥n para cerrar el sistema de turnos - VERSI√ìN SEGURA
        window.cerrarSistemaTurnos = function() {
            const modal = document.getElementById('modalSistemaTurnos');
            if (modal) {
                // Cerrar modal de forma segura
                modal.classList.remove('show');
                modal.style.display = 'none';
                modal.style.visibility = 'hidden';
                modal.style.opacity = '0';
                
                // Restaurar scroll del body
                document.body.style.overflow = '';
                document.body.style.position = '';
                document.body.style.width = '';
                document.body.style.overflow = 'auto';
                
                // Controlar scroll en m√≥vil al cerrar
                if (typeof controlarScrollMovil === 'function') {
                controlarScrollMovil(false);
                }
                
                console.log('‚úÖ Modal de turnos cerrado correctamente');
            } else {
                console.warn('‚ö†Ô∏è Modal de turnos no encontrado para cerrar');
            }
        }
        
        // Funci√≥n para cerrar modales de forma segura
        window.cerrarModalSeguro = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('show');
                modal.style.display = 'none';
                modal.style.visibility = 'hidden';
                modal.style.opacity = '0';
                
                // Restaurar scroll del body
                document.body.style.overflow = '';
                document.body.style.position = '';
                document.body.style.width = '';
                document.body.style.overflow = 'auto';
                
                console.log('‚úÖ Modal cerrado correctamente:', modalId);
            } else {
                console.warn('‚ö†Ô∏è Modal no encontrado:', modalId);
            }
        }
        
        // Funci√≥n global para reemplazar remove() problem√°tico
        window.cerrarModalGlobal = function(elemento) {
            if (elemento && elemento.remove) {
                try {
                    elemento.remove();
                } catch (error) {
                    console.warn('‚ö†Ô∏è Error al remover elemento, usando m√©todo alternativo:', error);
                    elemento.style.display = 'none';
                    elemento.style.visibility = 'hidden';
                    elemento.style.opacity = '0';
                }
            } else {
                console.warn('‚ö†Ô∏è Elemento no v√°lido para cerrar');
            }
        }
        
        // Funci√≥n para mostrar/ocultar configuraci√≥n de remis
        window.toggleRemisFields = function() {
            const categoria = document.getElementById('servicioCategoria');
            const config = document.getElementById('remisConfig');
            
            if (categoria && config) {
                if (categoria.value === 'remis') {
                    config.style.display = 'block';
                    // Hacer obligatorios los campos de remis
                    document.getElementById('asientosDisponibles').required = true;
                    document.getElementById('precioPorPersona').required = true;
                    document.getElementById('destinosServicio').required = true;
                } else {
                    config.style.display = 'none';
                    // Hacer opcionales los campos de remis
                    document.getElementById('asientosDisponibles').required = false;
                    document.getElementById('precioPorPersona').required = false;
                    document.getElementById('destinosServicio').required = false;
                }
            }
        }
        
        // Funci√≥n para mostrar/ocultar configuraci√≥n de paquetes
        window.togglePaquetesConfig = function() {
            const checkbox = document.getElementById('aceptaPaquetes');
            const config = document.getElementById('paquetesConfig');
            
            if (checkbox && config) {
                if (checkbox.checked) {
                    config.style.display = 'block';
                } else {
                    config.style.display = 'none';
                }
            }
        }
        
        // Funci√≥n para mostrar confirmaci√≥n de pagos
        window.mostrarConfirmacionPagos = function() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                z-index: 999999 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                padding: 20px !important;
                box-sizing: border-box !important;
            `;
            
            // Obtener datos de ventas pendientes
            const ventasPendientes = JSON.parse(localStorage.getItem('ventasPendientes') || '[]');
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 12px; padding: 30px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h3 style="color: #10B981; margin-bottom: 10px;">üí≥ Confirmar Pagos</h3>
                        <p style="color: #666;">Marca los pagos como confirmados y env√≠a agradecimientos</p>
                    </div>
                    
                    <div id="listaVentasPendientes" style="margin-bottom: 20px;">
                        ${ventasPendientes.length > 0 ? ventasPendientes.map(venta => `
                            <div style="background: #f8fafc; border: 2px solid #e5e7eb; border-radius: 8px; padding: 15px; margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h4 style="margin: 0; color: #374151;">${venta.cliente}</h4>
                                        <p style="margin: 5px 0; color: #666;">${venta.producto} - $${venta.precio}</p>
                                        <p style="margin: 0; color: #666; font-size: 0.9rem;">Fecha: ${new Date(venta.fecha).toLocaleDateString('es-ES')}</p>
                                    </div>
                                    <div style="text-align: right;">
                                        <button onclick="confirmarPago('${venta.id}')" 
                                                style="background: #10B981; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; margin-left: 10px;">
                                            ‚úÖ Confirmar Pago
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `).join('') : `
                            <div style="text-align: center; padding: 40px; color: #666;">
                                <i class="fas fa-credit-card" style="font-size: 3rem; margin-bottom: 15px; color: #10B981;"></i>
                                <p>No hay ventas pendientes de confirmaci√≥n</p>
                            </div>
                        `}
                    </div>
                    
                    <div style="border-top: 2px solid #e5e7eb; padding-top: 20px;">
                        <h4 style="color: #374151; margin-bottom: 15px;">üé® Personalizar Notas de Agradecimiento</h4>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #374151;">Nombre de tu Tienda</label>
                                <input type="text" id="nombreTiendaAgradecimiento" placeholder="Mi Tienda" 
                                       style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 6px;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #374151;">Logo (URL)</label>
                                <input type="url" id="logoAgradecimiento" placeholder="https://ejemplo.com/logo.png" 
                                       style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 6px;">
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #374151;">Mensaje Personalizado</label>
                            <textarea id="mensajeAgradecimiento" placeholder="¬°Gracias por tu compra! Tu apoyo significa mucho para nosotros..." 
                                      style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 6px; height: 80px; resize: vertical;"></textarea>
                        </div>
                        
                        <div style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                                Cerrar
                            </button>
                            <button onclick="guardarConfiguracionAgradecimiento()" style="background: #10B981; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                                üíæ Guardar Configuraci√≥n
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Cargar configuraci√≥n existente
            cargarConfiguracionAgradecimiento();
        }
        
        // Funci√≥n para confirmar pago
        window.confirmarPago = function(ventaId) {
            const ventasPendientes = JSON.parse(localStorage.getItem('ventasPendientes') || '[]');
            const venta = ventasPendientes.find(v => v.id === ventaId);
            
            if (venta) {
                // Mover a ventas confirmadas
                const ventasConfirmadas = JSON.parse(localStorage.getItem('ventasConfirmadas') || '[]');
                venta.fechaConfirmacion = new Date().toISOString();
                venta.estado = 'confirmado';
                ventasConfirmadas.push(venta);
                localStorage.setItem('ventasConfirmadas', JSON.stringify(ventasConfirmadas));
                
                // Remover de pendientes
                const nuevasPendientes = ventasPendientes.filter(v => v.id !== ventaId);
                localStorage.setItem('ventasPendientes', JSON.stringify(nuevasPendientes));
                
                // Enviar nota de agradecimiento
                enviarNotaAgradecimiento(venta);
                
                // Actualizar la lista
                mostrarConfirmacionPagos();
                
                mostrarNotificacion('‚úÖ Pago confirmado y agradecimiento enviado', 'success');
            }
        }
        
        // Funci√≥n para enviar nota de agradecimiento
        function enviarNotaAgradecimiento(venta) {
            const config = JSON.parse(localStorage.getItem('configuracionAgradecimiento') || '{}');
            const nombreTienda = config.nombreTienda || 'Tu Tienda';
            const mensaje = config.mensaje || '¬°Gracias por tu compra! Tu apoyo significa mucho para nosotros.';
            const logo = config.logo || '';
            
            const notaAgradecimiento = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Gracias por tu Compra</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); }
        .container { max-width: 600px; margin: 0 auto; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .header { background: linear-gradient(135deg, #10B981, #34D399); color: white; padding: 30px; text-align: center; }
        .content { padding: 30px; }
        .highlight { background: #f0f9ff; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #10B981; }
        .footer { background: #f8fafc; padding: 20px; text-align: center; color: #666; border-top: 1px solid #e5e7eb; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            ${logo ? `<img src="${logo}" alt="Logo" style="max-width: 100px; margin-bottom: 15px;">` : ''}
            <h1>¬°Gracias por tu Compra! üéâ</h1>
            <p style="margin: 0; font-size: 1.1rem;">${nombreTienda}</p>
        </div>
        
        <div class="content">
            <h2>Estimado/a ${venta.cliente},</h2>
            
            <p>${mensaje}</p>
            
            <div class="highlight">
                <h3>üìã Detalles de tu Compra</h3>
                <p><strong>Producto:</strong> ${venta.producto}</p>
                <p><strong>Precio:</strong> $${venta.precio}</p>
                <p><strong>Fecha:</strong> ${new Date(venta.fecha).toLocaleDateString('es-ES')}</p>
                <p><strong>Estado:</strong> ‚úÖ Pago Confirmado</p>
            </div>
            
            <p>Esperamos que disfrutes tu compra y que vuelvas pronto. ¬°Tu satisfacci√≥n es nuestra prioridad!</p>
            
            <div style="text-align: center; margin: 30px 0;">
                <p style="font-size: 1.2rem; color: #10B981; font-weight: bold;">
                    ¬°Gracias por confiar en nosotros! üíö
                </p>
            </div>
        </div>
        
        <div class="footer">
            <p><strong>El equipo de Cresalia</strong> te agradece por usar nuestra plataforma</p>
            <p style="font-size: 0.9rem; margin-top: 10px;">
                Esta nota fue generada autom√°ticamente por Cresalia - Tu plataforma de confianza para el comercio digital
            </p>
            <p style="font-size: 0.8rem; color: #999; margin-top: 15px;">
                Fecha de emisi√≥n: ${new Date().toLocaleString('es-ES')}
            </p>
        </div>
    </div>
</body>
</html>
            `;
            
            // Crear y descargar la nota
            const blob = new Blob([notaAgradecimiento], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `agradecimiento-${venta.cliente}-${new Date().toISOString().split('T')[0]}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            console.log('üìß Nota de agradecimiento generada para:', venta.cliente);
        }
        
        // Funci√≥n para guardar configuraci√≥n de agradecimiento
        window.guardarConfiguracionAgradecimiento = function() {
            const config = {
                nombreTienda: document.getElementById('nombreTiendaAgradecimiento').value,
                logo: document.getElementById('logoAgradecimiento').value,
                mensaje: document.getElementById('mensajeAgradecimiento').value,
                fechaActualizacion: new Date().toISOString()
            };
            
            localStorage.setItem('configuracionAgradecimiento', JSON.stringify(config));
            mostrarNotificacion('‚úÖ Configuraci√≥n de agradecimiento guardada', 'success');
        }
        
        // Funci√≥n para cargar configuraci√≥n de agradecimiento
        function cargarConfiguracionAgradecimiento() {
            const config = JSON.parse(localStorage.getItem('configuracionAgradecimiento') || '{}');
            
            if (config.nombreTienda) document.getElementById('nombreTiendaAgradecimiento').value = config.nombreTienda;
            if (config.logo) document.getElementById('logoAgradecimiento').value = config.logo;
            if (config.mensaje) document.getElementById('mensajeAgradecimiento').value = config.mensaje;
        }
        
        // Sistema de agradecimiento mensual autom√°tico
        function verificarAgradecimientoMensual() {
            const ultimoAgradecimiento = localStorage.getItem('ultimoAgradecimientoMensual');
            const ahora = new Date();
            const ultimoMes = ultimoAgradecimiento ? new Date(ultimoAgradecimiento) : null;
            
            // Verificar si ha pasado un mes desde el √∫ltimo agradecimiento
            if (!ultimoMes || (ahora.getMonth() !== ultimoMes.getMonth() || ahora.getFullYear() !== ultimoMes.getFullYear())) {
                enviarAgradecimientoMensual();
                localStorage.setItem('ultimoAgradecimientoMensual', ahora.toISOString());
            }
        }
        
        // Funci√≥n para enviar agradecimiento mensual
        function enviarAgradecimientoMensual() {
            const clientes = JSON.parse(localStorage.getItem('clientesRegistrados') || '[]');
            const ventasConfirmadas = JSON.parse(localStorage.getItem('ventasConfirmadas') || '[]');
            
            if (clientes.length > 0) {
                const agradecimientoMensual = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Agradecimiento Mensual - Cresalia</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .container { max-width: 600px; margin: 0 auto; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .header { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 30px; text-align: center; }
        .content { padding: 30px; }
        .highlight { background: #f0f9ff; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #667eea; }
        .footer { background: #f8fafc; padding: 20px; text-align: center; color: #666; border-top: 1px solid #e5e7eb; }
        .stats { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0; }
        .stat-card { background: #f8fafc; padding: 15px; border-radius: 8px; text-align: center; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>¬°Gracias por ser parte de Cresalia! üíú</h1>
            <p style="margin: 0; font-size: 1.1rem;">Tu plataforma de confianza para el comercio digital</p>
        </div>
        
        <div class="content">
            <h2>Estimado/a Cliente,</h2>
            
            <p>Queremos agradecerte por confiar en Cresalia durante este mes. Tu apoyo nos motiva a seguir mejorando y creciendo juntos.</p>
            
            <div class="stats">
                <div class="stat-card">
                    <h3 style="margin: 0; color: #667eea;">${ventasConfirmadas.length}</h3>
                    <p style="margin: 5px 0; color: #666;">Ventas Confirmadas</p>
                </div>
                <div class="stat-card">
                    <h3 style="margin: 0; color: #667eea;">${clientes.length}</h3>
                    <p style="margin: 5px 0; color: #666;">Clientes Activos</p>
                </div>
            </div>
            
            <div class="highlight">
                <h3>üéâ ¬°Nuevas Funcionalidades!</h3>
                <p>Este mes hemos agregado:</p>
                <ul>
                    <li>‚úÖ Sistema de confirmaci√≥n de pagos</li>
                    <li>‚úÖ Notas de agradecimiento personalizadas</li>
                    <li>‚úÖ Sistema de transporte local</li>
                    <li>‚úÖ Calendario de turnos interactivo</li>
                    <li>‚úÖ Comprobantes autom√°ticos</li>
                </ul>
            </div>
            
            <p>Tu satisfacci√≥n es nuestra prioridad. Si tienes alguna sugerencia o necesitas ayuda, no dudes en contactarnos.</p>
            
            <div style="text-align: center; margin: 30px 0;">
                <p style="font-size: 1.2rem; color: #667eea; font-weight: bold;">
                    ¬°Gracias por hacer crecer Cresalia! üöÄ
                </p>
            </div>
        </div>
        
        <div class="footer">
            <p><strong>El equipo de Cresalia</strong> te agradece por usar nuestra plataforma</p>
            <p style="font-size: 0.9rem; margin-top: 10px;">
                Esta nota fue generada autom√°ticamente por Cresalia - Tu plataforma de confianza para el comercio digital
            </p>
            <p style="font-size: 0.8rem; color: #999; margin-top: 15px;">
                Fecha de emisi√≥n: ${new Date().toLocaleString('es-ES')}
            </p>
        </div>
    </div>
</body>
</html>
                `;
                
                // Crear y descargar el agradecimiento mensual
                const blob = new Blob([agradecimientoMensual], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `agradecimiento-mensual-cresalia-${new Date().toISOString().split('T')[0]}.html`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                console.log('üìß Agradecimiento mensual generado');
                mostrarNotificacion('üìß Agradecimiento mensual enviado a todos los clientes', 'success');
            }
        }
        
        // Ejecutar verificaci√≥n de agradecimiento mensual al cargar la p√°gina - DESACTIVADO
        /*
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(verificarAgradecimientoMensual, 2000); // Esperar 2 segundos despu√©s de cargar
        });
        */
        
        // Funci√≥n para cambiar pesta√±as
        window.cambiarTabTurnos = function(tabName) {
            // Verificar si el usuario tiene plan pagado para comprobantes personalizados
            if (tabName === 'comprobantes') {
                const planActual = localStorage.getItem('plan_actual') || localStorage.getItem('plan-actual') || 'gratuito';
                if (planActual === 'gratuito' || planActual === 'free') {
                    mostrarNotificacion('üìÑ Los comprobantes personalizados est√°n disponibles solo en planes pagos. Los turnos b√°sicos s√≠ est√°n disponibles para todos los planes.', 'info');
                    return;
                }
            }
            
            // Ocultar todas las pesta√±as
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.style.display = 'none');
            
            // Desactivar todos los botones
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => {
                btn.style.background = '#e5e7eb';
                btn.style.color = '#6b7280';
            });
            
            // Mostrar pesta√±a seleccionada
            document.getElementById('tab-' + tabName).style.display = 'block';
            
            // Activar bot√≥n seleccionado
            event.target.style.background = '#8B5CF6';
            event.target.style.color = 'white';
            
            // Cargar datos espec√≠ficos seg√∫n la pesta√±a
            if (tabName === 'turnos') {
                cargarTurnosActivos();
                generarCalendario();
            }
        }
        
        // Funci√≥n para cargar configuraci√≥n de turnos
        window.cargarConfiguracionTurnos = function() {
            const config = JSON.parse(localStorage.getItem('configuracionTurnos') || '{}');
            
            if (config.horarios) document.getElementById('horariosAtencion').value = config.horarios;
            if (config.duracion) document.getElementById('duracionTurno').value = config.duracion;
            if (config.email) document.getElementById('emailTurnos').value = config.email;
            if (config.whatsapp) document.getElementById('whatsappTurnos').value = config.whatsapp;
            if (config.precio) document.getElementById('precioTurno').value = config.precio;
        }
        
        // Funci√≥n para guardar configuraci√≥n de turnos
        window.guardarConfiguracionTurnos = function(event) {
            event.preventDefault();
            
            const config = {
                horarios: document.getElementById('horariosAtencion').value,
                duracion: document.getElementById('duracionTurno').value,
                email: document.getElementById('emailTurnos').value,
                whatsapp: document.getElementById('whatsappTurnos').value,
                precio: document.getElementById('precioTurno').value,
                fecha_actualizacion: new Date().toISOString()
            };
            
            localStorage.setItem('configuracionTurnos', JSON.stringify(config));
            mostrarNotificacion('‚úÖ Configuraci√≥n de turnos guardada exitosamente', 'success');
        }
        
        // Variables globales para el calendario
        let mesActual = new Date().getMonth();
        let a√±oActual = new Date().getFullYear();
        let turnosProgramados = JSON.parse(localStorage.getItem('turnosProgramados') || '[]');
        
        // Funci√≥n para cambiar mes en el calendario
        window.cambiarMes = function(direccion) {
            mesActual += direccion;
            if (mesActual < 0) {
                mesActual = 11;
                a√±oActual--;
            } else if (mesActual > 11) {
                mesActual = 0;
                a√±oActual++;
            }
            generarCalendario();
        }
        
        // Funci√≥n para generar el calendario
        function generarCalendario() {
            const meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 
                         'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            
            // Actualizar t√≠tulo del mes
            document.getElementById('mesActual').textContent = `${meses[mesActual]} ${a√±oActual}`;
            
            const calendario = document.getElementById('calendarioTurnos');
            const primerDia = new Date(a√±oActual, mesActual, 1);
            const ultimoDia = new Date(a√±oActual, mesActual + 1, 0);
            const diasEnMes = ultimoDia.getDate();
            const diaInicio = primerDia.getDay();
            
            let html = `
                <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; background: #e5e7eb; border-radius: 8px; overflow: hidden;">
                    <div style="background: #8B5CF6; color: white; padding: 12px; text-align: center; font-weight: 600;">Dom</div>
                    <div style="background: #8B5CF6; color: white; padding: 12px; text-align: center; font-weight: 600;">Lun</div>
                    <div style="background: #8B5CF6; color: white; padding: 12px; text-align: center; font-weight: 600;">Mar</div>
                    <div style="background: #8B5CF6; color: white; padding: 12px; text-align: center; font-weight: 600;">Mi√©</div>
                    <div style="background: #8B5CF6; color: white; padding: 12px; text-align: center; font-weight: 600;">Jue</div>
                    <div style="background: #8B5CF6; color: white; padding: 12px; text-align: center; font-weight: 600;">Vie</div>
                    <div style="background: #8B5CF6; color: white; padding: 12px; text-align: center; font-weight: 600;">S√°b</div>
            `;
            
            // Espacios vac√≠os al inicio
            for (let i = 0; i < diaInicio; i++) {
                html += `<div style="background: #f8fafc; padding: 12px; text-align: center; min-height: 40px;"></div>`;
            }
            
            // D√≠as del mes
            for (let dia = 1; dia <= diasEnMes; dia++) {
                const fecha = new Date(a√±oActual, mesActual, dia);
                const turnosDelDia = turnosProgramados.filter(turno => {
                    const fechaTurno = new Date(turno.fecha);
                    return fechaTurno.toDateString() === fecha.toDateString();
                });
                
                const tieneTurnos = turnosDelDia.length > 0;
                const esHoy = fecha.toDateString() === new Date().toDateString();
                
                html += `
                    <div onclick="seleccionarFecha('${fecha.toISOString().split('T')[0]}')" 
                         style="background: ${esHoy ? '#fef3c7' : tieneTurnos ? '#dbeafe' : 'white'}; 
                                padding: 12px; text-align: center; min-height: 40px; cursor: pointer; 
                                border: ${esHoy ? '2px solid #f59e0b' : '1px solid #e5e7eb'};
                                transition: all 0.2s ease;"
                         onmouseover="this.style.background='#f0f9ff'; this.style.transform='scale(1.05)'"
                         onmouseout="this.style.background='${esHoy ? '#fef3c7' : tieneTurnos ? '#dbeafe' : 'white'}'; this.style.transform='scale(1)'">
                        <div style="font-weight: ${esHoy ? 'bold' : 'normal'}; color: ${esHoy ? '#f59e0b' : '#374151'};">
                            ${dia}
                        </div>
                        ${tieneTurnos ? `<div style="font-size: 10px; color: #3b82f6; margin-top: 2px;">${turnosDelDia.length} turno${turnosDelDia.length > 1 ? 's' : ''}</div>` : ''}
                    </div>
                `;
            }
            
            html += '</div>';
            calendario.innerHTML = html;
        }
        
        // Funci√≥n para seleccionar fecha
        window.seleccionarFecha = function(fecha) {
            console.log('üìÖ Fecha seleccionada:', fecha);
            mostrarFormularioNuevoTurno(fecha);
        }
        
        // Funci√≥n para mostrar formulario de nuevo turno
        function mostrarFormularioNuevoTurno(fecha) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                z-index: 999999 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                padding: 20px !important;
                box-sizing: border-box !important;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 12px; padding: 30px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h3 style="color: #8B5CF6; margin-bottom: 10px;">üìÖ Nuevo Turno</h3>
                        <p style="color: #666;">Fecha: ${new Date(fecha).toLocaleDateString('es-ES')}</p>
                    </div>
                    
                    <form id="formNuevoTurno">
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #374151;">Cliente</label>
                            <input type="text" id="clienteTurno" placeholder="Nombre del cliente" required style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #374151;">Hora</label>
                            <input type="time" id="horaTurno" required style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #374151;">Servicio</label>
                            <select id="servicioTurno" required style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                                <option value="">Selecciona un servicio</option>
                                <option value="consulta">Consulta General</option>
                                <option value="remis">Remis</option>
                                <option value="otro">Otro</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #374151;">Observaciones</label>
                            <textarea id="observacionesTurno" placeholder="Notas adicionales..." style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; height: 80px; resize: vertical;"></textarea>
                        </div>
                        
                        <div style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button type="button" onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                                Cancelar
                            </button>
                            <button type="submit" style="background: #8B5CF6; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                                Crear Turno
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Manejar env√≠o del formulario
            document.getElementById('formNuevoTurno').addEventListener('submit', function(e) {
                e.preventDefault();
                crearNuevoTurno(fecha);
            });
        }
        
        // Funci√≥n para crear nuevo turno
        function crearNuevoTurno(fecha) {
            const cliente = document.getElementById('clienteTurno').value;
            const hora = document.getElementById('horaTurno').value;
            const servicio = document.getElementById('servicioTurno').value;
            const observaciones = document.getElementById('observacionesTurno').value;
            
            const nuevoTurno = {
                id: Date.now(),
                fecha: fecha,
                hora: hora,
                cliente: cliente,
                servicio: servicio,
                observaciones: observaciones,
                estado: 'confirmado',
                fechaCreacion: new Date().toISOString()
            };
            
            turnosProgramados.push(nuevoTurno);
            localStorage.setItem('turnosProgramados', JSON.stringify(turnosProgramados));
            
            // Enviar confirmaci√≥n autom√°tica
            enviarConfirmacionTurno(nuevoTurno);
            
            // Cerrar modal y actualizar calendario
            cerrarModal(document.querySelector('#formNuevoTurno button[type="button"]'));
            generarCalendario();
            cargarTurnosActivos();
            
            mostrarNotificacion('‚úÖ Turno creado y confirmaci√≥n enviada', 'success');
        }
        
        // Funci√≥n para enviar confirmaci√≥n autom√°tica
        function enviarConfirmacionTurno(turno) {
            // Obtener informaci√≥n del remis si es un servicio de transporte
            const servicioRemis = turnosProgramados.find(t => t.servicio === 'remis');
            let mensajeRemis = '';
            
            if (servicioRemis) {
                const asientos = document.getElementById('asientosDisponibles')?.value || '4';
                const precio = document.getElementById('precioPorPersona')?.value || '500';
                const destinos = Array.from(document.getElementById('destinosServicio')?.selectedOptions || [])
                    .map(option => option.text).join(', ');
                const saleEseDia = document.getElementById('saleEseDia')?.checked ? 'S√ç' : 'NO';
                const aceptaPaquetes = document.getElementById('aceptaPaquetes')?.checked;
                
                // Medios de pago
                const mediosPago = [];
                if (document.getElementById('efectivo')?.checked) mediosPago.push('Efectivo');
                if (document.getElementById('transferencia')?.checked) mediosPago.push('Transferencia');
                if (document.getElementById('mercadopago')?.checked) mediosPago.push('Mercado Pago');
                if (document.getElementById('tarjeta')?.checked) mediosPago.push('Tarjeta');
                
                mensajeRemis = `
üöó INFORMACI√ìN DEL REMIS:
‚Ä¢ Asientos disponibles: ${asientos}
‚Ä¢ Precio por persona: $${precio}
‚Ä¢ Destinos: ${destinos}
‚Ä¢ Sale ese d√≠a: ${saleEseDia}
‚Ä¢ Medios de pago: ${mediosPago.join(', ')}

${aceptaPaquetes ? `
üì¶ ENV√çO DE PAQUETES:
‚Ä¢ Resistencia: $${document.getElementById('precioResistencia')?.value || '6000'}
‚Ä¢ Barranqueras: $${document.getElementById('precioBarranqueras')?.value || '5500'}
‚Ä¢ Otros destinos: $${document.getElementById('precioOtros')?.value || '5000'}
` : ''}
                `;
            }
            
            const mensaje = `
üìÖ TURNO CONFIRMADO

Cliente: ${turno.cliente}
Fecha: ${new Date(turno.fecha).toLocaleDateString('es-ES')}
Hora: ${turno.hora}
Servicio: ${turno.servicio}

${mensajeRemis}

${turno.observaciones ? `Observaciones: ${turno.observaciones}` : ''}

¬°Gracias por elegirnos! üöÄ
            `;
            
            // Simular env√≠o de confirmaci√≥n
            console.log('üìß Enviando confirmaci√≥n:', mensaje);
            
            // Generar comprobante descargable
            generarComprobanteRemis(turno, mensaje);
            
            // Aqu√≠ se integrar√≠a con WhatsApp, email o descarga
            // Por ahora solo mostramos en consola
        }
        
        // Funci√≥n para generar comprobante del remis
        function generarComprobanteRemis(turno, mensaje) {
            const comprobante = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Comprobante de Turno - Remis</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { text-align: center; border-bottom: 2px solid #0ea5e9; padding-bottom: 20px; margin-bottom: 30px; }
        .content { line-height: 1.6; }
        .highlight { background: #f0f9ff; padding: 15px; border-radius: 8px; margin: 15px 0; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üöó COMPROBANTE DE TURNO - TRANSPORTE</h1>
        <p>Servicio de Transporte Local</p>
    </div>
    
    <div class="content">
        <h2>üìã Informaci√≥n del Turno</h2>
        <div class="highlight">
            <p><strong>Cliente:</strong> ${turno.cliente}</p>
            <p><strong>Fecha:</strong> ${new Date(turno.fecha).toLocaleDateString('es-ES')}</p>
            <p><strong>Hora:</strong> ${turno.hora}</p>
            <p><strong>Servicio:</strong> ${turno.servicio}</p>
        </div>
        
        <h2>üöó Informaci√≥n del Remis</h2>
        <div class="highlight">
            <p><strong>Asientos disponibles:</strong> ${document.getElementById('asientosDisponibles')?.value || '4'}</p>
            <p><strong>Precio por persona:</strong> $${document.getElementById('precioPorPersona')?.value || '500'}</p>
            <p><strong>Destinos:</strong> ${Array.from(document.getElementById('destinosServicio')?.selectedOptions || []).map(option => option.text).join(', ')}</p>
            <p><strong>Sale ese d√≠a:</strong> ${document.getElementById('saleEseDia')?.checked ? 'S√ç' : 'NO'}</p>
        </div>
        
        <h2>üí≥ Medios de Pago</h2>
        <div class="highlight">
            <p>${Array.from(['efectivo', 'transferencia', 'mercadopago', 'tarjeta'])
                .filter(id => document.getElementById(id)?.checked)
                .map(id => {
                    const labels = { efectivo: 'üíµ Efectivo', transferencia: 'üì± Transferencia', mercadopago: 'üí≥ Mercado Pago', tarjeta: 'üí≥ Tarjeta' };
                    return labels[id];
                }).join(', ')}</p>
        </div>
        
        ${document.getElementById('aceptaPaquetes')?.checked ? `
        <h2>üì¶ Env√≠o de Paquetes</h2>
        <div class="highlight">
            <p><strong>Resistencia:</strong> $${document.getElementById('precioResistencia')?.value || '6000'}</p>
            <p><strong>Barranqueras:</strong> $${document.getElementById('precioBarranqueras')?.value || '5500'}</p>
            <p><strong>Otros destinos:</strong> $${document.getElementById('precioOtros')?.value || '5000'}</p>
        </div>
        ` : ''}
        
        <h2>üìù Observaciones</h2>
        <div class="highlight">
            <p>${turno.observaciones || 'Sin observaciones'}</p>
        </div>
        
        <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #ccc;">
            <p><strong>¬°Gracias por elegirnos! üöÄ</strong></p>
            <p>Fecha de emisi√≥n: ${new Date().toLocaleString('es-ES')}</p>
        </div>
    </div>
</body>
</html>
            `;
            
            // Crear y descargar el comprobante
            const blob = new Blob([comprobante], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `comprobante-remis-${turno.cliente}-${turno.fecha}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Funci√≥n para simular un turno
        window.simularTurno = function() {
            const turno = {
                id: 'turno-' + Date.now(),
                cliente: 'Cliente Demo',
                servicio: 'Consultor√≠a de Marketing',
                fecha: new Date().toLocaleDateString('es-ES'),
                hora: new Date().toLocaleTimeString('es-ES'),
                estado: 'confirmado',
                contacto: 'cliente@email.com'
            };
            
            let turnos = JSON.parse(localStorage.getItem('turnosActivos') || '[]');
            turnos.push(turno);
            localStorage.setItem('turnosActivos', JSON.stringify(turnos));
            
            // Generar comprobante autom√°ticamente
            generarComprobante(turno);
            
            mostrarNotificacion('‚úÖ Turno simulado creado y comprobante enviado', 'success');
        }
        
        // Funci√≥n para generar comprobante
        window.generarComprobante = function(turno) {
            const config = JSON.parse(localStorage.getItem('configuracionTurnos') || '{}');
            const colorComprobante = document.getElementById('colorComprobante')?.value || '#8B5CF6';
            const mensajeComprobante = document.getElementById('mensajeComprobante')?.value || '¬°Gracias por elegir nuestros servicios!';
            
            // Crear comprobante HTML
            const comprobanteHTML = `
                <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 2px solid ${colorComprobante}; border-radius: 15px;">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h2 style="color: ${colorComprobante}; margin: 0;">COMPROBANTE DE TURNO</h2>
                        <p style="color: #666; margin: 5px 0;">${new Date().toLocaleDateString('es-ES')}</p>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <h3 style="color: ${colorComprobante}; margin-top: 0;">Detalles del Turno</h3>
                        <p><strong>Cliente:</strong> ${turno.cliente}</p>
                        <p><strong>Servicio:</strong> ${turno.servicio}</p>
                        <p><strong>Fecha:</strong> ${turno.fecha}</p>
                        <p><strong>Hora:</strong> ${turno.hora}</p>
                        <p><strong>Estado:</strong> ${turno.estado.toUpperCase()}</p>
                    </div>
                    
                    <div style="background: ${colorComprobante}20; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <p style="margin: 0; color: ${colorComprobante}; font-weight: 600;">${mensajeComprobante}</p>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                        <p style="color: #666; font-size: 12px; margin: 0;">Comprobante generado autom√°ticamente por Cresalia</p>
                    </div>
                </div>
            `;
            
            // Simular env√≠o por email/WhatsApp
            console.log('üìß Comprobante generado:', comprobanteHTML);
            
            // Mostrar modal con el comprobante
            mostrarComprobanteModal(comprobanteHTML);
        }
        
        // Funci√≥n para mostrar el comprobante en modal
        window.mostrarComprobanteModal = function(html) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 99999; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 15px; max-width: 700px; width: 100%; max-height: 90vh; overflow-y: auto;">
                    <div style="padding: 20px; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0; color: #374151;">üìÑ Comprobante de Turno</h3>
                        <button onclick="cerrarModal(this)" style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
                    </div>
                    <div style="padding: 20px;">
                        ${html}
                        <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center;">
                            <button onclick="descargarComprobante()" style="background: #10B981; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                                üì• Descargar PDF
                            </button>
                            <button onclick="enviarComprobante()" style="background: #3B82F6; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                                üìß Enviar por Email
                            </button>
                            <button onclick="enviarWhatsApp()" style="background: #25D366; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                                üì± Enviar WhatsApp
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        // Funciones para manejar el comprobante
        window.descargarComprobante = function() {
            mostrarNotificacion('üì• Descargando comprobante en PDF...', 'info');
        }
        
        window.enviarComprobante = function() {
            mostrarNotificacion('üìß Enviando comprobante por email...', 'info');
        }
        
        window.enviarWhatsApp = function() {
            mostrarNotificacion('üì± Enviando compprobante por WhatsApp...', 'info');
        }
        
        // Funci√≥n para generar comprobante de ejemplo
        window.generarComprobanteEjemplo = function() {
            const turnoEjemplo = {
                id: 'ejemplo-' + Date.now(),
                cliente: 'Cliente Ejemplo',
                servicio: 'Consultor√≠a de Marketing',
                fecha: '15/12/2024',
                hora: '14:30',
                estado: 'confirmado',
                contacto: 'ejemplo@email.com'
            };
            
            generarComprobante(turnoEjemplo);
        }
        
        // Funci√≥n para probar el Bot IA
        window.probarBotIA = function() {
            const tipoBot = document.getElementById('usarBotIA').value;
            
            if (tipoBot === 'no') {
                mostrarNotificacion('‚ÑπÔ∏è Bot IA deshabilitado. Los turnos se manejar√°n manualmente.', 'info');
            } else if (tipoBot === 'generico') {
                mostrarNotificacion('ü§ñ Usando Bot IA gen√©rico de Cresalia para manejar turnos.', 'info');
            } else {
                // Guardar configuraci√≥n personalizada
                const configIA = {
                    mensajeBienvenida: document.getElementById('mensajeBienvenidaBot').value,
                    descripcion: document.getElementById('descripcionBotIA').value,
                    personalidad: document.getElementById('personalidadBotIA').value,
                    color: document.getElementById('colorBotIA').value,
                    fecha_configuracion: new Date().toISOString()
                };
                
                localStorage.setItem('configuracionBotIA', JSON.stringify(configIA));
                mostrarNotificacion('ü§ñ Bot IA personalizado configurado y guardado exitosamente.', 'success');
            }
        }
        
        // Event listeners para el sistema de turnos
        document.addEventListener('DOMContentLoaded', function() {
            const formTurnos = document.getElementById('formConfiguracionTurnos');
            if (formTurnos) {
                formTurnos.addEventListener('submit', guardarConfiguracionTurnos);
            }
            
            const selectBotIA = document.getElementById('usarBotIA');
            if (selectBotIA) {
                selectBotIA.addEventListener('change', function() {
                    const configBot = document.getElementById('configuracionBotIA');
                    if (this.value === 'si') {
                        configBot.style.display = 'block';
                    } else {
                        configBot.style.display = 'none';
                    }
                });
            }
        });
            
            // Mostrar informaci√≥n de la tienda actual
            const tiendaId = obtenerTiendaId();
            console.log('üè™ Tienda actual:', tiendaId);
        });
        
        // ========================================
        // DIAGN√ìSTICO DE MODALES
        // ========================================
        
        // Funci√≥n de diagn√≥stico para modales
        function diagnosticarModales() {
            console.log('üîç === DIAGN√ìSTICO DE MODALES ===');
            
            // Verificar funciones
            console.log('üìã Funciones disponibles:');
            console.log('  - verMiProgreso:', typeof verMiProgreso !== 'undefined' ? 'S√ç' : 'NO');
            console.log('  - verRecursos:', typeof verRecursos !== 'undefined' ? 'S√ç' : 'NO');
            console.log('  - cerrarProgresoModal:', typeof cerrarProgresoModal !== 'undefined' ? 'S√ç' : 'NO');
            console.log('  - cerrarRecursosModal:', typeof cerrarRecursosModal !== 'undefined' ? 'S√ç' : 'NO');
            
            // Verificar modales existentes
            const modalesExistentes = document.querySelectorAll('.modal');
            console.log('üîç Modales en DOM:', modalesExistentes.length);
            modalesExistentes.forEach((modal, index) => {
                console.log(`  - Modal ${index + 1}:`, modal.id, 'Display:', modal.style.display);
            });
            
            // Verificar z-index
            const body = document.body;
            console.log('üîç Body children:', body.children.length);
            console.log('üîç Body style:', {
                position: body.style.position,
                zIndex: body.style.zIndex,
                overflow: body.style.overflow
            });
        }
        
        // Ejecutar diagn√≥stico al cargar - DESACTIVADO
        // setTimeout(diagnosticarModales, 1000);
        
        // Funci√≥n de prueba para modales
        window.testModales = function() {
            console.log('üß™ === PRUEBA DE MODALES ===');
            
            console.log('1. Probando verMiProgreso...');
            try {
                verMiProgreso();
                console.log('‚úÖ verMiProgreso ejecutado');
            } catch (error) {
                console.error('‚ùå Error en verMiProgreso:', error);
            }
            
            setTimeout(() => {
                console.log('2. Probando verRecursos...');
                try {
                    verRecursos();
                    console.log('‚úÖ verRecursos ejecutado');
                } catch (error) {
                    console.error('‚ùå Error en verRecursos:', error);
                }
            }, 2000);
        };
        
        console.log('‚úÖ Estructura b√°sica del admin panel cargada');
        console.log('üí° Para diagnosticar modales, ejecuta: testModales()');
    </script>
    
    <!-- ========================================== -->
    <!-- MODALES HTML -->
    <!-- ========================================== -->
    
    <!-- Modal para Agregar Producto - REDISE√ëADO -->
    <div id="modalProducto" class="modal" style="display: none !important;">
        <div class="modal-content modal-hermoso" style="max-width: 750px; animation: slideUpModal 0.5s cubic-bezier(0.16, 1, 0.3, 1); overflow: hidden;">
            <!-- Header con gradiente animado -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); background-size: 200% 200%; animation: gradientFlow 8s ease infinite; padding: 35px 30px; text-align: center; border-radius: 20px 20px 0 0; position: relative; overflow: hidden;">
                <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%); animation: rotateBg 30s linear infinite;"></div>
                <div style="position: relative; z-index: 1;">
                    <div style="width: 90px; height: 90px; background: rgba(255,255,255,0.3); backdrop-filter: blur(10px); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; box-shadow: 0 15px 50px rgba(0,0,0,0.2); animation: float 6s ease-in-out infinite;">
                        <i class="fas fa-box" style="font-size: 40px; color: white; animation: pulse 4s ease-in-out infinite;"></i>
                    </div>
                    <h3 style="color: white; margin: 0; font-size: 1.8rem; font-weight: 800; text-shadow: 0 4px 15px rgba(0,0,0,0.2);">üì¶ Agregar Nuevo Producto</h3>
                    <p style="color: rgba(255,255,255,0.95); margin: 8px 0 0 0; font-size: 0.95rem;">Crea productos incre√≠bles para tu tienda</p>
                </div>
                <button class="close-btn" onclick="cerrarModal(this)" style="position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; color: white; font-size: 1.2rem; transition: all 0.3s ease; z-index: 2;" onmouseover="this.style.background='rgba(255,255,255,0.3)'; this.style.transform='rotate(90deg)';" onmouseout="this.style.background='rgba(255,255,255,0.2)'; this.style.transform='rotate(0)';">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- Cuerpo del modal -->
            <div style="padding: 30px; background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%); max-height: 65vh; overflow-y: auto;">
                <form id="formProducto" onsubmit="guardarProducto(event); return false;">
                    <div class="form-group" style="margin-bottom: 20px; animation: fadeInUp 0.5s ease 0.1s backwards;">
                        <label for="productoNombre" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Nombre del Producto *</label>
                        <input type="text" id="productoNombre" class="form-control" placeholder="Ej: Laptop Gaming Pro" required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102, 126, 234, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 20px; animation: fadeInUp 0.5s ease 0.2s backwards;">
                        <label for="productoDescripcion" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Descripci√≥n</label>
                        <textarea id="productoDescripcion" class="form-control" rows="3" placeholder="Describe las caracter√≠sticas principales..." style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; resize: vertical; transition: all 0.3s ease;" onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102, 126, 234, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';"></textarea>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.3s backwards;">
                            <label for="productoPrecio" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Precio * ($)</label>
                            <input type="number" id="productoPrecio" class="form-control" step="0.01" placeholder="0.00" required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102, 126, 234, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                    </div>
                    
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.4s backwards;">
                            <label for="productoStock" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Stock Disponible</label>
                            <input type="number" id="productoStock" class="form-control" min="0" value="0" placeholder="0" style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102, 126, 234, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 20px; animation: fadeInUp 0.5s ease 0.5s backwards;">
                        <label for="productoCategoria" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Categor√≠a *</label>
                        <select id="productoCategoria" class="form-control" required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease; background: white;" onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102, 126, 234, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                            <option value="">Selecciona una categor√≠a</option>
                            <option value="tecnologia">üíª Tecnolog√≠a</option>
                            <option value="electronica">‚ö° Electr√≥nica</option>
                            <option value="hogar">üè† Hogar</option>
                            <option value="moda">üëî Moda</option>
                            <option value="belleza">üíÑ Belleza</option>
                            <option value="deportes">‚öΩ Deportes</option>
                            <option value="otro">üì¶ Otro</option>
                        </select>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 20px; animation: fadeInUp 0.5s ease 0.6s backwards;">
                        <label for="productoImagen" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Imagen del Producto</label>
                        <input type="file" id="productoImagen" class="form-control" accept="image/*" onchange="previewImage(this)" style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px;">
                        <div id="imagePreview" style="margin-top: 10px; display: none; text-align: center;">
                            <img id="previewImg" style="max-width: 200px; max-height: 200px; border-radius: 12px; border: 2px solid #e5e7eb; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    </div>
                        <small style="color: #6b7280; font-size: 0.825rem; display: block; margin-top: 5px;">
                            <i class="fas fa-info-circle"></i> Formatos: JPG, PNG, GIF. M√°x: 5MB
                        </small>
                    </div>
                    
                    <!-- Opciones adicionales -->
                    <div style="background: #f9fafb; padding: 20px; border-radius: 12px; margin-bottom: 20px; animation: fadeInUp 0.5s ease 0.7s backwards;">
                        <h4 style="color: #374151; font-size: 1rem; font-weight: 600; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-star" style="color: #f59e0b;"></i>
                            Opciones Destacadas
                        </h4>
                        <div style="display: grid; gap: 12px;">
                            <div class="form-check" style="display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" id="productoDestacado" class="form-check-input" style="width: 20px; height: 20px; cursor: pointer;">
                                <label for="productoDestacado" class="form-check-label" style="margin: 0; font-weight: 500; color: #374151; cursor: pointer;">‚≠ê Producto Destacado (aparece primero)</label>
                    </div>
                            <div class="form-check" style="display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" id="productoOferta" class="form-check-input" style="width: 20px; height: 20px; cursor: pointer;">
                                <label for="productoOferta" class="form-check-label" style="margin: 0; font-weight: 500; color: #374151; cursor: pointer;">üè∑Ô∏è En Oferta (con badge especial)</label>
                    </div>
                            <div class="form-check" style="display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" id="productoNuevo" class="form-check-input" style="width: 20px; height: 20px; cursor: pointer;">
                                <label for="productoNuevo" class="form-check-label" style="margin: 0; font-weight: 500; color: #374151; cursor: pointer;">üÜï Producto Nuevo (badge "NUEVO")</label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Botones -->
                    <div style="display: flex; gap: 12px; justify-content: flex-end; animation: fadeInUp 0.5s ease 0.8s backwards;">
                        <button type="button" class="btn-secondary" onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 14px 28px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 0.95rem;" onmouseover="this.style.background='#4b5563'; this.style.transform='translateY(-2px)';" onmouseout="this.style.background='#6b7280'; this.style.transform='translateY(0)';">
                            <i class="fas fa-times"></i> Cancelar
                        </button>
                        <button type="submit" class="btn-primary" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 14px 28px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 0.95rem; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(102, 126, 234, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)';">
                            <i class="fas fa-save"></i> Guardar Producto
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Agregar Servicio - REDISE√ëADO -->
    <div id="modalServicio" class="modal" style="display: none !important;">
        <div class="modal-content modal-hermoso" style="max-width: 750px; animation: slideUpModal 0.5s cubic-bezier(0.16, 1, 0.3, 1); overflow: hidden;">
            <!-- Header -->
            <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); background-size: 200% 200%; animation: gradientFlow 8s ease infinite; padding: 35px 30px; text-align: center; border-radius: 20px 20px 0 0; position: relative; overflow: hidden;">
                <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%); animation: rotateBg 30s linear infinite;"></div>
                <div style="position: relative; z-index: 1;">
                    <div style="width: 90px; height: 90px; background: rgba(255,255,255,0.3); backdrop-filter: blur(10px); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; box-shadow: 0 15px 50px rgba(0,0,0,0.2); animation: float 6s ease-in-out infinite;">
                        <i class="fas fa-tools" style="font-size: 40px; color: white; animation: pulse 4s ease-in-out infinite;"></i>
                    </div>
                    <h3 style="color: white; margin: 0; font-size: 1.8rem; font-weight: 800; text-shadow: 0 4px 15px rgba(0,0,0,0.2);">üõ†Ô∏è Agregar Nuevo Servicio</h3>
                    <p style="color: rgba(255,255,255,0.95); margin: 8px 0 0 0; font-size: 0.95rem;">Ofrece servicios profesionales a tus clientes</p>
                </div>
                <button class="close-btn" onclick="cerrarModal(this)" style="position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; color: white; font-size: 1.2rem; transition: all 0.3s ease; z-index: 2;" onmouseover="this.style.background='rgba(255,255,255,0.3)'; this.style.transform='rotate(90deg)';" onmouseout="this.style.background='rgba(255,255,255,0.2)'; this.style.transform='rotate(0)';">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <!-- Body -->
            <div style="padding: 30px; background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%); max-height: 65vh; overflow-y: auto;">
                <form id="formServicio">
                    <div class="form-group" style="margin-bottom: 20px; animation: fadeInUp 0.5s ease 0.1s backwards;">
                        <label for="servicioNombre" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Nombre del Servicio *</label>
                        <input type="text" id="servicioNombre" class="form-control" placeholder="Ej: Consultor√≠a de Marketing" required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                    </div>
                    <div class="form-group" style="margin-bottom: 20px; animation: fadeInUp 0.5s ease 0.2s backwards;">
                        <label for="servicioDescripcion" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Descripci√≥n *</label>
                        <textarea id="servicioDescripcion" class="form-control" rows="3" placeholder="Describe tu servicio..." required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; resize: vertical; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';"></textarea>
                    </div>
                    <div class="form-group" style="margin-bottom: 20px; animation: fadeInUp 0.5s ease 0.25s backwards;">
                        <label for="servicioCategoria" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Categor√≠a *</label>
                        <select id="servicioCategoria" class="form-control" required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';" onchange="toggleRemisFields()">
                            <option value="">Selecciona una categor√≠a</option>
                            <option value="consultoria">üíº Consultor√≠a</option>
                            <option value="diseno">üé® Dise√±o</option>
                            <option value="desarrollo">üíª Desarrollo</option>
                            <option value="marketing">üì£ Marketing</option>
                            <option value="remis">üöó Remis (Transporte)</option>
                            <option value="mecanica">üîß Mec√°nica</option>
                            <option value="detail">‚ú® Detail (Limpieza de Autos)</option>
                            <option value="salud">üè• Salud y Bienestar</option>
                            <option value="educacion">üìö Educaci√≥n</option>
                            <option value="legal">‚öñÔ∏è Servicios Legales</option>
                            <option value="contabilidad">üìä Contabilidad</option>
                            <option value="limpieza">üßπ Limpieza</option>
                            <option value="reparacion">üîß Reparaciones</option>
                            <option value="eventos">üéâ Eventos</option>
                            <option value="coaching">üéØ Coaching</option>
                            <option value="traduccion">üåê Traducci√≥n</option>
                            <option value="fotografia">üì∏ Fotograf√≠a</option>
                            <option value="peluqueria">üíá Peluquer√≠a y Est√©tica</option>
                            <option value="gastronomia">üçΩÔ∏è Gastronom√≠a</option>
                            <option value="seguridad">üõ°Ô∏è Seguridad</option>
                            <option value="otro">üîß Otro</option>
                        </select>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.3s backwards;">
                            <label for="servicioPrecio" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Precio por Hora/Sesi√≥n * ($)</label>
                            <input type="number" id="servicioPrecio" class="form-control" step="0.01" placeholder="0.00" required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                        </div>
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.4s backwards;">
                            <label for="servicioDuracion" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Duraci√≥n Estimada *</label>
                            <select id="servicioDuracion" class="form-control" required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                                <option value="">Selecciona duraci√≥n</option>
                                <option value="30min">30 minutos</option>
                                <option value="1hora">1 hora</option>
                                <option value="2horas">2 horas</option>
                                <option value="3horas">3 horas</option>
                                <option value="4horas">4 horas</option>
                                <option value="1dia">1 d√≠a completo</option>
                                <option value="personalizado">Personalizado</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Nuevos campos espec√≠ficos para servicios -->
                    <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.5s backwards;">
                            <label for="servicioModalidad" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Modalidad *</label>
                            <select id="servicioModalidad" class="form-control" required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                                <option value="">Selecciona modalidad</option>
                                <option value="presencial">üè¢ Presencial</option>
                                <option value="online">üíª Online</option>
                                <option value="mixto">üîÑ Mixto (Presencial + Online)</option>
                            </select>
                        </div>
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.6s backwards;">
                            <label for="servicioUbicacion" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Ubicaci√≥n/Enlace</label>
                            <input type="text" id="servicioUbicacion" class="form-control" placeholder="Direcci√≥n o enlace de Zoom/Meet" style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.7s backwards;">
                            <label for="servicioHorarios" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Horarios Disponibles</label>
                            <input type="text" id="servicioHorarios" class="form-control" placeholder="Ej: Lunes a Viernes 9:00-18:00" style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                        </div>
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.8s backwards;">
                            <label for="servicioContacto" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Contacto para Reservas</label>
                            <input type="text" id="servicioContacto" class="form-control" placeholder="WhatsApp, tel√©fono o email" style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                        </div>
                    </div>
                    
                    <!-- Sistema especial para REMIS DEL INTERIOR DE CHACO -->
                    <div id="remisConfig" style="display: none; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 2px solid #0ea5e9;">
                        <h4 style="color: #0c4a6e; margin-bottom: 15px; text-align: center;">üöó Servicio de Transporte Local</h4>
                        
                        <!-- Informaci√≥n b√°sica del remis -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label for="asientosDisponibles" style="display: block; margin-bottom: 8px; font-weight: 600; color: #0c4a6e; font-size: 0.9rem;">Asientos Disponibles *</label>
                                <input type="number" id="asientosDisponibles" class="form-control" min="1" max="20" placeholder="4" required style="width: 100%; padding: 10px 12px; border: 2px solid #0ea5e9; border-radius: 8px; font-size: 14px;">
                            </div>
                            <div>
                                <label for="precioPorPersona" style="display: block; margin-bottom: 8px; font-weight: 600; color: #0c4a6e; font-size: 0.9rem;">Precio por Persona ($) *</label>
                                <input type="number" id="precioPorPersona" class="form-control" step="0.01" placeholder="500.00" required style="width: 100%; padding: 10px 12px; border: 2px solid #0ea5e9; border-radius: 8px; font-size: 14px;">
                            </div>
                        </div>
                        
                        <!-- Destinos del servicio -->
                        <div style="margin-bottom: 15px;">
                            <label for="destinosServicio" style="display: block; margin-bottom: 8px; font-weight: 600; color: #0c4a6e; font-size: 0.9rem;">Destinos que Atiende *</label>
                            <select id="destinosServicio" multiple required style="width: 100%; padding: 10px 12px; border: 2px solid #0ea5e9; border-radius: 8px; font-size: 14px; height: 100px;">
                                <option value="centro">Centro de la ciudad</option>
                                <option value="norte">Zona Norte</option>
                                <option value="sur">Zona Sur</option>
                                <option value="este">Zona Este</option>
                                <option value="oeste">Zona Oeste</option>
                                <option value="aeropuerto">Aeropuerto</option>
                                <option value="terminal">Terminal de √≥mnibus</option>
                                <option value="hospitales">Hospitales y cl√≠nicas</option>
                                <option value="universidades">Universidades</option>
                                <option value="centros-comerciales">Centros comerciales</option>
                                <option value="otro">Otro (especificar en observaciones)</option>
                            </select>
                            <small style="color: #666; font-size: 12px;">Mant√©n presionado Ctrl para seleccionar m√∫ltiples destinos</small>
                        </div>
                        
                        <!-- Opci√≥n de salir ese d√≠a -->
                        <div style="margin-bottom: 15px;">
                            <label style="display: flex; align-items: center; cursor: pointer; font-weight: 600; color: #0c4a6e;">
                                <input type="checkbox" id="saleEseDia" style="margin-right: 10px; transform: scale(1.2);">
                                ‚úÖ Salgo este d√≠a (Lunes a Viernes)
                            </label>
                        </div>
                        
                        <!-- Env√≠o de paquetes -->
                        <div style="margin-bottom: 15px;">
                            <label style="display: flex; align-items: center; cursor: pointer; font-weight: 600; color: #0c4a6e; margin-bottom: 10px;">
                                <input type="checkbox" id="aceptaPaquetes" onchange="togglePaquetesConfig()" style="margin-right: 10px; transform: scale(1.2);">
                                üì¶ Acepto env√≠o de paquetes
                            </label>
                            
                            <div id="paquetesConfig" style="display: none; background: #f8fafc; padding: 15px; border-radius: 8px; border: 1px solid #d1d5db;">
                                <h5 style="color: #0c4a6e; margin-bottom: 10px;">Configuraci√≥n de Paquetes</h5>
                                
                                <div style="margin-bottom: 10px;">
                                    <label for="precioResistencia" style="display: block; margin-bottom: 5px; font-weight: 600; color: #0c4a6e; font-size: 0.85rem;">Precio hasta Resistencia ($)</label>
                                    <input type="number" id="precioResistencia" class="form-control" step="0.01" placeholder="6000.00" style="width: 100%; padding: 8px 10px; border: 2px solid #0ea5e9; border-radius: 6px; font-size: 13px;">
                                </div>
                                
                                <div style="margin-bottom: 10px;">
                                    <label for="precioBarranqueras" style="display: block; margin-bottom: 5px; font-weight: 600; color: #0c4a6e; font-size: 0.85rem;">Precio hasta Barranqueras ($)</label>
                                    <input type="number" id="precioBarranqueras" class="form-control" step="0.01" placeholder="5500.00" style="width: 100%; padding: 8px 10px; border: 2px solid #0ea5e9; border-radius: 6px; font-size: 13px;">
                                </div>
                                
                                <div style="margin-bottom: 10px;">
                                    <label for="precioOtros" style="display: block; margin-bottom: 5px; font-weight: 600; color: #0c4a6e; font-size: 0.85rem;">Otros destinos (precio base)</label>
                                    <input type="number" id="precioOtros" class="form-control" step="0.01" placeholder="5000.00" style="width: 100%; padding: 8px 10px; border: 2px solid #0ea5e9; border-radius: 6px; font-size: 13px;">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Medios de pago -->
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #0c4a6e; font-size: 0.9rem;">Medios de Pago que Acepta *</label>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                <label style="display: flex; align-items: center; cursor: pointer; font-size: 0.85rem;">
                                    <input type="checkbox" id="efectivo" style="margin-right: 8px;">
                                    üíµ Efectivo
                                </label>
                                <label style="display: flex; align-items: center; cursor: pointer; font-size: 0.85rem;">
                                    <input type="checkbox" id="transferencia" style="margin-right: 8px;">
                                    üì± Transferencia
                                </label>
                                <label style="display: flex; align-items: center; cursor: pointer; font-size: 0.85rem;">
                                    <input type="checkbox" id="mercadopago" style="margin-right: 8px;">
                                    üí≥ Mercado Pago
                                </label>
                                <label style="display: flex; align-items: center; cursor: pointer; font-size: 0.85rem;">
                                    <input type="checkbox" id="tarjeta" style="margin-right: 8px;">
                                    üí≥ Tarjeta
                                </label>
                            </div>
                        </div>
                        
                        <!-- Mapa integrado -->
                        <div style="margin-top: 15px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #0c4a6e; font-size: 0.9rem;">üìç Ubicaci√≥n en Mapa</label>
                            <div id="mapaRemis" style="width: 100%; height: 200px; background: #f3f4f6; border: 2px solid #0ea5e9; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #666;">
                                üó∫Ô∏è Mapa de ubicaci√≥n (se cargar√° aqu√≠)
                            </div>
                            <small style="color: #666; font-size: 12px;">Selecciona tu ubicaci√≥n en el mapa</small>
                        </div>
                    </div>
                    
                    <!-- Nuevas funcionalidades para servicios -->
                    <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.5s backwards;">
                            <label for="servicioUbicacion" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">üìç Ubicaci√≥n</label>
                            <input type="text" id="servicioUbicacionEdit" class="form-control" placeholder="Ej: Consultorio, Domicilio, Online" style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                        </div>
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.6s backwards;">
                            <label for="servicioHorarios" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">üïí Horarios Disponibles</label>
                            <input type="text" id="servicioHorariosEdit" class="form-control" placeholder="Ej: Lun-Vie 9:00-18:00" style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.7s backwards;">
                            <label for="servicioContacto" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">üìû Contacto para Reservas</label>
                            <input type="text" id="servicioContactoEdit" class="form-control" placeholder="Email, WhatsApp, tel√©fono" style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                        </div>
                        <div class="form-group" style="animation: fadeInUp 0.5s ease 0.8s backwards;">
                            <label for="servicioModalidad" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">üíª Modalidad</label>
                            <select id="servicioModalidadEdit" class="form-control" style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease; background: white;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                                <option value="">Selecciona modalidad</option>
                                <option value="presencial">üè¢ Presencial</option>
                                <option value="online">üíª Online</option>
                                <option value="domicilio">üè† A domicilio</option>
                                <option value="mixto">üîÑ Mixto (Presencial + Online)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group" style="margin-bottom: 20px; animation: fadeInUp 0.5s ease 0.5s backwards;">
                        <label for="servicioCategoriaEdit" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Categor√≠a *</label>
                        <select id="servicioCategoriaEdit" class="form-control" required style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; transition: all 0.3s ease; background: white;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                            <option value="">Selecciona una categor√≠a</option>
                            <option value="consultoria">üíº Consultor√≠a</option>
                            <option value="diseno">üé® Dise√±o</option>
                            <option value="desarrollo">üíª Desarrollo</option>
                            <option value="marketing">üì£ Marketing</option>
                            <option value="remis">üöó Remis (Transporte)</option>
                            <option value="mecanica">üîß Mec√°nica</option>
                            <option value="detail">‚ú® Detail (Limpieza de Autos)</option>
                            <option value="salud">üè• Salud y Bienestar</option>
                            <option value="educacion">üìö Educaci√≥n</option>
                            <option value="legal">‚öñÔ∏è Servicios Legales</option>
                            <option value="contabilidad">üìä Contabilidad</option>
                            <option value="limpieza">üßπ Limpieza</option>
                            <option value="reparacion">üîß Reparaciones</option>
                            <option value="eventos">üéâ Eventos</option>
                            <option value="coaching">üéØ Coaching</option>
                            <option value="traduccion">üåê Traducci√≥n</option>
                            <option value="fotografia">üì∏ Fotograf√≠a</option>
                            <option value="peluqueria">üíá Peluquer√≠a y Est√©tica</option>
                            <option value="gastronomia">üçΩÔ∏è Gastronom√≠a</option>
                            <option value="seguridad">üõ°Ô∏è Seguridad</option>
                            <option value="otro">üîß Otro</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 20px; animation: fadeInUp 0.5s ease 0.6s backwards;">
                        <label for="servicioNotas" style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.95rem;">Notas Adicionales</label>
                        <textarea id="servicioNotas" class="form-control" rows="2" placeholder="Informaci√≥n adicional..." style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 14px; resize: vertical; transition: all 0.3s ease;" onfocus="this.style.borderColor='#f093fb'; this.style.boxShadow='0 0 0 3px rgba(240, 147, 251, 0.1)';" onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';"></textarea>
                    </div>
                    <div style="display: flex; gap: 12px; justify-content: flex-end; animation: fadeInUp 0.5s ease 0.7s backwards;">
                        <button type="button" class="btn-secondary" onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 14px 28px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 0.95rem;" onmouseover="this.style.background='#4b5563'; this.style.transform='translateY(-2px)';" onmouseout="this.style.background='#6b7280'; this.style.transform='translateY(0)';">
                            <i class="fas fa-times"></i> Cancelar
                        </button>
                        <button type="submit" class="btn-primary" style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; border: none; padding: 14px 28px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 0.95rem; box-shadow: 0 4px 15px rgba(240, 147, 251, 0.3);" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(240, 147, 251, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(240, 147, 251, 0.3)';">
                            <i class="fas fa-save"></i> Guardar Servicio
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal Sistema de Turnos -->
    <div id="modalSistemaTurnos" class="modal">
        <div class="modal-content modal-hermoso" style="max-width: 900px; animation: slideUpModal 0.5s cubic-bezier(0.16, 1, 0.3, 1); overflow: hidden;">
            <!-- Header -->
            <div style="background: linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%); background-size: 200% 200%; animation: gradientFlow 8s ease infinite; padding: 35px 30px; text-align: center; border-radius: 20px 20px 0 0; position: relative; overflow: hidden;">
                <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%); animation: rotateBg 30s linear infinite;"></div>
                <div style="position: relative; z-index: 1;">
                    <div style="width: 90px; height: 90px; background: rgba(255,255,255,0.3); backdrop-filter: blur(10px); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; box-shadow: 0 15px 50px rgba(0,0,0,0.2); animation: float 6s ease-in-out infinite;">
                        <i class="fas fa-calendar-check" style="font-size: 40px; color: white; animation: pulse 4s ease-in-out infinite;"></i>
                    </div>
                    <h3 style="color: white; margin: 0; font-size: 1.8rem; font-weight: 800; text-shadow: 0 4px 15px rgba(0,0,0,0.2);">üìÖ Sistema de Turnos Autom√°tico</h3>
                    <p style="color: rgba(255,255,255,0.95); margin: 8px 0 0 0; font-size: 0.95rem;">Gestiona turnos con IA y comprobantes personalizados</p>
                </div>
                <button class="close-btn" onclick="cerrarModal(this)" style="position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; color: white; font-size: 1.2rem; transition: all 0.3s ease; z-index: 2;" onmouseover="this.style.background='rgba(255,255,255,0.3)'; this.style.transform='rotate(90deg)';" onmouseout="this.style.background='rgba(255,255,255,0.2)'; this.style.transform='rotate(0)';">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div style="padding: 30px; background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%); max-height: 70vh; overflow-y: auto;">
                
                <!-- Pesta√±as del sistema -->
                <div style="display: flex; gap: 10px; margin-bottom: 30px; border-bottom: 2px solid #e5e7eb;">
                    <button class="tab-button active" onclick="cambiarTabTurnos('configuracion')" style="background: #8B5CF6; color: white; border: none; padding: 12px 20px; border-radius: 8px 8px 0 0; cursor: pointer; font-weight: 600;">
                        <i class="fas fa-cog"></i> Configuraci√≥n
                    </button>
                    <button class="tab-button" onclick="cambiarTabTurnos('turnos')" style="background: #e5e7eb; color: #6b7280; border: none; padding: 12px 20px; border-radius: 8px 8px 0 0; cursor: pointer; font-weight: 600;">
                        <i class="fas fa-calendar"></i> Turnos Activos
                    </button>
                    <button class="tab-button" onclick="cambiarTabTurnos('comprobantes')" style="background: #e5e7eb; color: #6b7280; border: none; padding: 12px 20px; border-radius: 8px 8px 0 0; cursor: pointer; font-weight: 600;">
                        <i class="fas fa-file-invoice"></i> Comprobantes
                    </button>
                    <button class="tab-button" onclick="cambiarTabTurnos('ia')" style="background: #e5e7eb; color: #6b7280; border: none; padding: 12px 20px; border-radius: 8px 8px 0 0; cursor: pointer; font-weight: 600;">
                        <i class="fas fa-robot"></i> Bot IA
                    </button>
                </div>

                <!-- Tab Configuraci√≥n -->
                <div id="tab-configuracion" class="tab-content">
                    <form id="formConfiguracionTurnos">
                        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">üïí Horarios de Atenci√≥n</label>
                                <input type="text" id="horariosAtencion" placeholder="Ej: Lun-Vie 9:00-18:00, S√°b 9:00-14:00" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            </div>
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">‚è±Ô∏è Duraci√≥n por Turno (minutos)</label>
                                <input type="number" id="duracionTurno" placeholder="30" min="15" max="480" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">üìß Email para Notificaciones</label>
                                <input type="email" id="emailTurnos" placeholder="tu@email.com" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            </div>
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">üì± WhatsApp para Notificaciones</label>
                                <input type="text" id="whatsappTurnos" placeholder="+54 9 11 1234-5678" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">üí∞ Precio por Turno ($)</label>
                            <input type="number" id="precioTurno" placeholder="0.00" step="0.01" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                        </div>
                        
                        <button type="submit" style="width: 100%; background: linear-gradient(135deg, #8B5CF6, #A855F7); color: white; border: none; padding: 15px; border-radius: 10px; font-weight: 600; cursor: pointer;">
                            <i class="fas fa-save"></i> Guardar Configuraci√≥n
                        </button>
                    </form>
                </div>

                <!-- Tab Turnos Activos -->
                <div id="tab-turnos" class="tab-content" style="display: none;">
                    <!-- Calendario de Turnos -->
                    <div style="margin-bottom: 30px;">
                        <h4 style="color: #374151; margin-bottom: 20px;"><i class="fas fa-calendar-alt"></i> Calendario de Turnos</h4>
                        
                        <!-- Selector de mes -->
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; background: #f8fafc; padding: 15px; border-radius: 10px;">
                            <button onclick="cambiarMes(-1)" style="background: #8B5CF6; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer;">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <h5 id="mesActual" style="margin: 0; color: #374151;">Enero 2024</h5>
                            <button onclick="cambiarMes(1)" style="background: #8B5CF6; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer;">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        
                        <!-- Calendario -->
                        <div id="calendarioTurnos" style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <!-- Se generar√° din√°micamente -->
                        </div>
                    </div>
                    
                    <!-- Lista de Turnos -->
                    <div style="margin-top: 30px;">
                        <h4 style="color: #374151; margin-bottom: 20px;"><i class="fas fa-list"></i> Turnos Programados</h4>
                        <div id="listaTurnos" style="background: #f8fafc; border-radius: 10px; padding: 20px;">
                            <div style="text-align: center; color: #666; padding: 20px;">
                                <i class="fas fa-calendar-check" style="font-size: 2rem; margin-bottom: 10px; color: #8B5CF6;"></i>
                                <p>No hay turnos programados a√∫n</p>
                                <button onclick="simularTurno()" style="background: #8B5CF6; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; margin-top: 15px;">
                                    <i class="fas fa-plus"></i> Simular Turno de Prueba
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Comprobantes -->
                <div id="tab-comprobantes" class="tab-content" style="display: none;">
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #374151; margin-bottom: 15px;"><i class="fas fa-file-invoice"></i> Personalizar Comprobantes</h4>
                        
                        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">üè∑Ô∏è Logo de la Empresa</label>
                                <input type="file" id="logoComprobante" accept="image/*" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            </div>
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">üé® Color Principal</label>
                                <input type="color" id="colorComprobante" value="#8B5CF6" style="width: 100%; height: 45px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">üìù Mensaje Personalizado</label>
                            <textarea id="mensajeComprobante" placeholder="¬°Gracias por elegir nuestros servicios! Tu turno ha sido confirmado." style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; min-height: 80px;"></textarea>
                        </div>
                        
                        <button onclick="generarComprobanteEjemplo()" style="background: #10B981; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                            <i class="fas fa-eye"></i> Ver Comprobante de Ejemplo
                        </button>
                    </div>
                </div>

                <!-- Tab Bot IA -->
                <div id="tab-ia" class="tab-content" style="display: none;">
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #374151; margin-bottom: 15px;"><i class="fas fa-robot"></i> Configuraci√≥n del Bot IA</h4>
                        
                        <div class="form-group" style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">ü§ñ ¬øUsar Bot IA para Turnos?</label>
                            <select id="usarBotIA" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                                <option value="no">No, manejar turnos manualmente</option>
                                <option value="si">S√≠, usar Bot IA personalizado</option>
                                <option value="generico">Usar Bot IA gen√©rico de Cresalia</option>
                            </select>
                        </div>
                        
                        <div id="configuracionBotIA" style="display: none;">
                            <div class="form-group" style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">üí¨ Mensaje de Bienvenida</label>
                                <textarea id="mensajeBienvenidaBot" placeholder="¬°Hola! Soy el asistente virtual de [Tu Empresa]. ¬øEn qu√© puedo ayudarte?" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; min-height: 80px;"></textarea>
                            </div>
                            
                            <div class="form-group" style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">üìù Descripci√≥n de tu IA</label>
                                <textarea id="descripcionBotIA" placeholder="Soy [Nombre de tu IA], tu asistente virtual especializado en [tu industria]. Puedo ayudarte con consultas, reservas de turnos, informaci√≥n sobre productos y mucho m√°s. ¬°Estoy aqu√≠ 24/7 para asistirte!" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; min-height: 100px;"></textarea>
                                <small style="color: #666; font-size: 12px;">Esta descripci√≥n aparecer√° cuando los usuarios interact√∫en con tu IA</small>
                            </div>
                            
                            <div class="form-group" style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">üé≠ Personalidad de la IA</label>
                                <select id="personalidadBotIA" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                                    <option value="profesional">üëî Profesional y formal</option>
                                    <option value="amigable">üòä Amigable y cercana</option>
                                    <option value="experta">üéØ Experta y t√©cnica</option>
                                    <option value="motivadora">üí™ Motivadora y energ√©tica</option>
                                    <option value="empatica">üíú Emp√°tica y comprensiva</option>
                                </select>
                            </div>
                            
                            <div class="form-group" style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">üé® Color del Bot</label>
                                <input type="color" id="colorBotIA" value="#8B5CF6" style="width: 100%; height: 45px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <button onclick="probarBotIA()" style="background: #F59E0B; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                                <i class="fas fa-play"></i> Probar Bot IA
                            </button>
                            <button onclick="mercadoPago.mostrarTransparencia()" style="background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                                <i class="fas fa-calculator"></i> Ver Transparencia
                            </button>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
    
    <!-- Estilos adicionales para los modales -->
    <style>
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .modal-header h3 {
            margin: 0;
            color: #1f2937;
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #6b7280;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .close-btn:hover {
            background: #f3f4f6;
            color: #374151;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #374151;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-check {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-check-input {
            margin: 0;
        }
        
        .form-check-label {
            margin: 0;
            font-weight: 500;
        }
        
        .btn-secondary {
            background: #6b7280 !important;
            color: white !important;
        }
        
        .btn-secondary:hover {
            background: #4b5563 !important;
        }
    </style>
    
    <!-- ===== ESTILOS ADICIONALES ===== -->
    <link rel="stylesheet" href="../../css/sistema-feedbacks.css">
    <link rel="stylesheet" href="../../css/sistema-desafios-emocionales.css">
    <link rel="stylesheet" href="../../css/contacto-directo-carla.css">
    <link rel="stylesheet" href="../../css/filtros-avanzados.css">
    
    <!-- Click Derecho Personalizado -->
    <script src="../../js/click-derecho-personalizado.js"></script>
    
    <!-- Mercado Pago SDK -->
    <script src="https://sdk.mercadopago.com/js/v2"></script>
    <script src="../../js/mercado-pago-integration.js"></script>
    
    <!-- Notificaciones Compactas -->
    <script src="../../js/notificaciones-compactas.js"></script>
    
    <!-- Optimizador de Animaciones -->
    <script src="../../js/optimizador-animaciones.js"></script>
    
    <!-- Consejos Empresariales y Bienestar -->
    <script src="../../js/consejos-empresariales-bienestar.js"></script>
    
    <!-- Sistema de Interconexiones -->
    <script src="../../js/interconexiones-sistema.js"></script>
    
    <!-- Configuraci√≥n de Bienestar Opcional -->
    <script src="../../js/configuracion-bienestar-opcional.js"></script>
    
    <!-- Sistema de Historiales -->
    <script src="../../js/historiales-sistema.js"></script>
    
    <!-- Sistema de Mapas -->
    <script src="../../js/sistema-mapas.js"></script>
    
    <!-- ===== SCRIPTS DE SISTEMAS ===== -->
    <!-- Sistema de Bienestar Emocional - DESHABILITADO (ahora usamos widget optimizado) -->
    <!-- <script src="../../core/recursos-bienestar-emocional.js"></script> -->
    <!-- <script src="../../core/integracion-bienestar.js"></script> -->
    <!-- <script src="../../core/sistema-bienestar-completo.js?v=2"></script> -->
    
    <!-- Sistema de Feedbacks -->
    <script src="../../js/sistema-feedbacks.js?v=2"></script>
    
    <!-- Sistema de Desaf√≠os Emocionales -->
    <script src="../../js/sistema-desafios-emocionales.js"></script>
    
    <!-- Sistema de Contacto Directo -->
    <script src="../../js/contacto-directo-carla.js"></script>
    
    <!-- Categor√≠as y Servicios -->
    <script src="../../js/categorias-servicios-populares.js"></script>
    
    <!-- Filtros Avanzados -->
    <script src="../../js/filtros-avanzados.js"></script>
    
    <!-- Notificaciones Elegantes -->
    <script src="../../js/elegant-notifications.js"></script>
    
    <!-- ===== CORRECCIONES DEL SISTEMA ===== -->
    <script src="correcciones-admin.js"></script>
    
    <!-- ===== SINCRONIZACI√ìN DE TIENDA ===== -->
    <script src="sincronizacion-tienda.js"></script>
    
    <!-- ===== PERSONALIZACI√ìN DE TIENDA ===== -->
    <script src="personalizacion-tienda.js"></script>
    
    <!-- ===== FUNCIONES ADICIONALES ===== -->
    <script>
        // ====================================================
        // FUNCI√ìN PRINCIPAL DE NAVEGACI√ìN
        // ====================================================
        
        function mostrarSeccion(seccionNombre) {
            console.log(`üîÑ Mostrando secci√≥n: ${seccionNombre}`);
            
            // Ocultar todas las secciones
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
                section.style.display = 'none';
            });
            
            // Mostrar la secci√≥n solicitada
            const seccion = document.getElementById(seccionNombre);
            if (seccion) {
                seccion.classList.add('active');
                seccion.style.display = 'block';
                console.log(`‚úÖ Secci√≥n ${seccionNombre} mostrada`);
                
                // RESTAURAR EVENT LISTENERS DESPU√âS DE CAMBIAR DE SECCI√ìN
                setTimeout(() => {
                    if (window.restaurarEventListenersDashboard) {
                        console.log('üîß Restaurando event listeners despu√©s de cambiar de secci√≥n...');
                        window.restaurarEventListenersDashboard();
                    }
                }, 100);
            } else {
                console.warn(`‚ö†Ô∏è Secci√≥n ${seccionNombre} no encontrada`);
            }
            
            // Actualizar navegaci√≥n activa
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Buscar y activar el link correspondiente
            const linkActivo = document.querySelector(`[onclick*="mostrarSeccion('${seccionNombre}')"]`);
            if (linkActivo) {
                linkActivo.classList.add('active');
            }
        }
        
        // ====================================================
        // FUNCIONES DE BIENESTAR Y DESAF√çOS
        // ====================================================
        
        // ====================================================
        // FUNCIONES DE CIERRE DE SESI√ìN Y B√ÅSICAS
        // ====================================================
        
        function cerrarSesion() {
            if (confirm('¬øEst√°s seguro de que quieres cerrar sesi√≥n?')) {
                console.log('üëã Cerrando sesi√≥n...');
                localStorage.clear();
                window.location.href = '../../login-tienda.html';
            }
        }
        
        function abrirFeedback() {
            console.log('üí¨ Abriendo feedback');
            mostrarModalFeedbackBasico();
        }
        
        function verMiProgreso() {
            console.log('üìä Abriendo progreso');
            mostrarMiProgreso();
        }
        
        
        
        // Implementar mi progreso ARREGLADO
        function mostrarMiProgreso() {
            console.log('üìä [ARREGLADO] Iniciando funci√≥n mostrarMiProgreso...');
            
            // Remover modal existente
            const modal = document.getElementById('progresoModal');
            if (modal) {
                console.log('üóëÔ∏è Removiendo modal existente');
                modal.remove();
            }
            
            const modalHTML = `
                <div id="progresoModal" class="modal" style="position: fixed !important; top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important; background: rgba(0,0,0,0.8) !important; display: flex !important; align-items: center !important; justify-content: center !important; z-index: 2147483647 !important; padding: 20px !important;">
                    <div class="modal-content" style="max-width: 600px; width: 95%; background: white; border-radius: 20px; padding: 25px; max-height: 85vh; overflow-y: auto; position: relative; margin: auto;">
                        <div class="modal-header" style="border-bottom: none; padding-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
                            <h3 style="color: #333; margin: 0; font-size: 1.5rem;"><i class="fas fa-chart-line"></i> Mi Progreso Empresarial</h3>
                            <button class="close-btn" onclick="cerrarModal(this)" style="background: none; border: none; font-size: 1.8rem; cursor: pointer; color: #999; padding: 5px; line-height: 1;">√ó</button>
                        </div>
                        <div class="modal-body" style="padding: 15px 0;">
                            <div style="text-align: center; margin-bottom: 25px;">
                                <div style="width: 100px; height: 100px; margin: 0 auto; background: linear-gradient(135deg, #fa709a, #fee140); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 25px rgba(250, 112, 154, 0.3);">
                                    <div style="font-size: 2rem;">üåü</div>
                                </div>
                                <h4 style="color: #333; margin-top: 15px; font-size: 1.3rem;">¬°Vas muy bien!</h4>
                                <p style="color: #666; font-size: 0.95rem;">Has completado 7 d√≠as de crecimiento empresarial</p>
                            </div>
                            
                            <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 18px; border-radius: 15px; border-left: 4px solid #667eea;">
                                <h5 style="color: #333; margin-bottom: 15px; font-size: 1.1rem;">üìä Estad√≠sticas de Progreso:</h5>
                                
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem;">
                                        <span style="color: #666;">üìù Entradas en diario:</span>
                                        <strong style="color: #667eea;">8</strong>
                                    </div>
                                    <div style="background: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                                        <div style="background: linear-gradient(90deg, #667eea, #764ba2); height: 100%; width: 80%; transition: width 0.5s ease;"></div>
                                    </div>
                                </div>
                                
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem;">
                                        <span style="color: #666;">üî• D√≠as consecutivos:</span>
                                        <strong style="color: #4CAF50;">7</strong>
                                    </div>
                                    <div style="background: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                                        <div style="background: linear-gradient(90deg, #4CAF50, #81C784); height: 100%; width: 70%; transition: width 0.5s ease;"></div>
                                    </div>
                                </div>
                                
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem;">
                                        <span style="color: #666;">üéØ Objetivos completados:</span>
                                        <strong style="color: #FF6B6B;">5/8</strong>
                                    </div>
                                    <div style="background: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                                        <div style="background: linear-gradient(90deg, #FF6B6B, #FF8A80); height: 100%; width: 62%; transition: width 0.5s ease;"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="text-align: center; margin-top: 20px;">
                                <button onclick="cerrarModal(this)" style="background: linear-gradient(135deg, #6b7280, #9ca3af); color: white; padding: 10px 25px; border: none; border-radius: 10px; cursor: pointer; font-size: 0.95rem;">
                                    <i class="fas fa-times"></i> Cerrar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Verificar inserci√≥n y asegurar visibilidad
            setTimeout(() => {
                const modalInsertado = document.getElementById('progresoModal');
                if (modalInsertado) {
                    console.log('‚úÖ Modal de progreso insertado correctamente');
                    modalInsertado.scrollIntoView({ behavior: 'smooth' });
                    document.body.style.overflow = 'hidden'; // Bloquear scroll del body
                } else {
                    console.error('‚ùå Error: Modal de progreso no se insert√≥');
                }
            }, 100);
        }
        
        // Funci√≥n espec√≠fica para cerrar modal progreso
        function cerrarModalProgreso() {
            const modal = document.getElementById('progresoModal');
            if (modal) {
                modal.remove();
                document.body.style.overflow = ''; // Restaurar scroll
                console.log('‚úÖ Modal de progreso cerrado correctamente');
            }
        }
        
        // NUEVA FUNCI√ìN: Ver Mi Progreso Personal (espec√≠fica para Mi Espacio)
        function verMiProgresoPersonal() {
            console.log('üíú [ARREGLADO] Iniciando funci√≥n verMiProgresoPersonal...');
            
            // Remover modal existente
            const modal = document.getElementById('progresoPersonalModal');
            if (modal) {
                console.log('üóëÔ∏è Removiendo modal existente');
                modal.remove();
            }
            
            const modalHTML = `
                <div id="progresoPersonalModal" class="modal" style="position: fixed !important; top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important; background: rgba(0,0,0,0.8) !important; display: flex !important; align-items: center !important; justify-content: center !important; z-index: 2147483647 !important; padding: 20px !important;">
                    <div class="modal-content" style="max-width: 700px; width: 95%; background: white; border-radius: 25px; padding: 0; max-height: 85vh; overflow-y: auto; position: relative; margin: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                        
                        <!-- Header con gradiente hermoso -->
                        <div style="background: linear-gradient(135deg, #8B5CF6, #A78BFA, #F59E0B); background-size: 200% 200%; animation: gradientFlow 8s ease infinite; padding: 30px; text-align: center; border-radius: 25px 25px 0 0; position: relative; overflow: hidden;">
                            <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%); animation: rotateBg 30s linear infinite;"></div>
                            <div style="position: relative; z-index: 1;">
                                <div style="width: 90px; height: 90px; background: rgba(255,255,255,0.25); backdrop-filter: blur(10px); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; box-shadow: 0 15px 50px rgba(0,0,0,0.2); animation: float 6s ease-in-out infinite;">
                                    <i class="fas fa-heart" style="font-size: 40px; color: white; animation: pulse 4s ease-in-out infinite;"></i>
                                </div>
                                <h2 style="color: white; margin-bottom: 8px; font-size: 1.8rem; font-weight: 700; text-shadow: 0 4px 15px rgba(0,0,0,0.2);">üíú Mi Progreso Personal</h2>
                                <p style="color: rgba(255,255,255,0.95); font-size: 1rem; text-shadow: 0 2px 10px rgba(0,0,0,0.1); margin: 0;">Tu evoluci√≥n emocional y de bienestar üå∏</p>
                            </div>
                            <button onclick="cerrarModalBienestar('progresoPersonalModal')" style="position: absolute; top: 15px; right: 20px; background: rgba(255,255,255,0.2); border: none; color: white; font-size: 1.5rem; cursor: pointer; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: background 0.3s ease;">√ó</button>
                        </div>
                        
                        <!-- Contenido del modal -->
                        <div style="padding: 30px;">
                            <!-- Progreso Emocional -->
                            <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 25px; border-radius: 20px; margin-bottom: 25px; border-left: 5px solid #8B5CF6;">
                                <h3 style="color: #333; margin: 0 0 20px 0; font-size: 1.3rem; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-heart" style="color: #8B5CF6;"></i>
                                    Evoluci√≥n Emocional
                                </h3>
                                
                                <!-- M√©tricas de bienestar -->
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; margin-bottom: 20px;">
                                    <div style="text-align: center; padding: 15px; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(236, 72, 153, 0.1);">
                                        <div style="font-size: 2rem; font-weight: bold; color: #EC4899; margin-bottom: 5px;">7</div>
                                        <div style="color: #666; font-size: 0.85rem; font-weight: 500;">D√≠as de Bienestar</div>
                                    </div>
                                    <div style="text-align: center; padding: 15px; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(249, 168, 212, 0.1);">
                                        <div style="font-size: 2rem; font-weight: bold; color: #F9A8D4; margin-bottom: 5px;">12</div>
                                        <div style="color: #666; font-size: 0.85rem; font-weight: 500;">Entradas en Diario</div>
                                    </div>
                                    <div style="text-align: center; padding: 15px; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(251, 191, 36, 0.1);">
                                        <div style="font-size: 2rem; font-weight: bold; color: #FBBF24; margin-bottom: 5px;">3</div>
                                        <div style="color: #666; font-size: 0.85rem; font-weight: 500;">Desaf√≠os Completados</div>
                                    </div>
                                </div>
                                
                                <!-- Barras de progreso -->
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span style="color: #666; font-size: 0.9rem; font-weight: 500;">üí™ Autoestima:</span>
                                        <strong style="color: #8B5CF6;">85%</strong>
                                    </div>
                                    <div style="background: #e9ecef; height: 10px; border-radius: 5px; overflow: hidden;">
                                        <div style="background: linear-gradient(90deg, #8B5CF6, #A78BFA); height: 100%; width: 85%; transition: width 1s ease; border-radius: 5px;"></div>
                                    </div>
                                </div>
                                
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span style="color: #666; font-size: 0.9rem; font-weight: 500;">üßò Equilibrio Mental:</span>
                                        <strong style="color: #10b981;">78%</strong>
                                    </div>
                                    <div style="background: #e9ecef; height: 10px; border-radius: 5px; overflow: hidden;">
                                        <div style="background: linear-gradient(90deg, #10b981, #34d399); height: 100%; width: 78%; transition: width 1s ease; border-radius: 5px;"></div>
                                    </div>
                                </div>
                                
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span style="color: #666; font-size: 0.9rem; font-weight: 500;">üíù Amor Propio:</span>
                                        <strong style="color: #f59e0b;">92%</strong>
                                    </div>
                                    <div style="background: #e9ecef; height: 10px; border-radius: 5px; overflow: hidden;">
                                        <div style="background: linear-gradient(90deg, #f59e0b, #fbbf24); height: 100%; width: 92%; transition: width 1s ease; border-radius: 5px;"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Logros Recientes -->
                            <div style="background: linear-gradient(135deg, #ecfdf5, #d1fae5); padding: 25px; border-radius: 20px; margin-bottom: 25px; border-left: 5px solid #10b981;">
                                <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.3rem; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-trophy" style="color: #10b981;"></i>
                                    Logros Recientes
                                </h3>
                                
                                <div style="display: flex; flex-direction: column; gap: 12px;">
                                    <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(16, 185, 129, 0.1);">
                                        <div style="width: 35px; height: 35px; background: linear-gradient(135deg, #10b981, #34d399); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 16px;">üåü</div>
                                        <div>
                                            <div style="font-weight: 600; color: #333; font-size: 0.95rem;">Primera semana de constancia</div>
                                            <div style="color: #666; font-size: 0.8rem;">Completaste 7 d√≠as seguidos de bienestar</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(236, 72, 153, 0.1);">
                                        <div style="width: 35px; height: 35px; background: linear-gradient(135deg, #8B5CF6, #A78BFA); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 16px;">üíù</div>
                                        <div>
                                            <div style="font-weight: 600; color: #333; font-size: 0.95rem;">Escritora del coraz√≥n</div>
                                            <div style="color: #666; font-size: 0.8rem;">Escribiste 10 entradas en tu diario emocional</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(251, 191, 36, 0.1);">
                                        <div style="width: 35px; height: 35px; background: linear-gradient(135deg, #FBBF24, #F59E0B); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 16px;">üéØ</div>
                                        <div>
                                            <div style="font-weight: 600; color: #333; font-size: 0.95rem;">Desafiante valiente</div>
                                            <div style="color: #666; font-size: 0.8rem;">Completaste 3 desaf√≠os de crecimiento personal</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Mensaje motivacional -->
                            <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #fef3c7, #fde68a); border-radius: 20px; border-left: 5px solid #f59e0b;">
                                <h4 style="color: #92400e; margin: 0 0 10px 0; font-size: 1.1rem;">‚ú® Mensaje para ti ‚ú®</h4>
                                <p style="color: #78350f; margin: 0; font-size: 0.95rem; line-height: 1.5;">
                                    Cada d√≠a que dedicas a tu bienestar es una inversi√≥n en tu futuro m√°s brillante. 
                                    Sigues creciendo, aprendiendo y volvi√©ndote m√°s fuerte. ¬°Est√°s haciendo un trabajo incre√≠ble! üíú
                                </p>
                            </div>
                            
                            <!-- Bot√≥n para cerrar -->
                            <div style="text-align: center; margin-top: 25px;">
                                <button onclick="cerrarModal(this)" style="background: linear-gradient(135deg, #6b7280, #9ca3af); color: white; padding: 12px 30px; border: none; border-radius: 15px; cursor: pointer; font-size: 1rem; font-weight: 600; transition: all 0.3s ease;">
                                    <i class="fas fa-heart"></i> Cerrar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Verificar inserci√≥n y asegurar visibilidad
            setTimeout(() => {
                const modalInsertado = document.getElementById('progresoPersonalModal');
                if (modalInsertado) {
                    console.log('‚úÖ Modal de progreso personal insertado correctamente');
                    // Agregar bot√≥n de cerrar autom√°ticamente
                    agregarBotonCerrarWidget('progresoPersonalModal');
                    // NO bloquear el scroll del body - el modal tiene su propio scroll
                } else {
                    console.error('‚ùå Error: Modal de progreso personal no se insert√≥');
                }
            }, 100);
        }
        
        // Funci√≥n espec√≠fica para cerrar modal progreso personal
        function cerrarModalProgresoPersonal() {
            const modal = document.getElementById('progresoPersonalModal');
            if (modal) {
                modal.remove();
                console.log('‚úÖ Modal de progreso personal cerrado correctamente');
            }
        }
        
        // ====================================================
        // FUNCIONES DE DESAF√çOS Y LOGROS
        // ====================================================
        
        // Funci√≥n para toggle de desaf√≠os y logros
        function toggleDesafiosLogros() {
            console.log('üèÜ NUEVA - Abriendo sistema de desaf√≠os y logros');
            
            // Cerrar modal existente si hay uno
            const modalExistente = document.getElementById('desafiosModal');
            if (modalExistente) {
                modalExistente.remove();
                return;
            }
            
            // Modal b√°sico hermoso directamente
            console.log('üìã Usando modal b√°sico de desaf√≠os');
            mostrarDesafiosBasico();
        }
        
        function mostrarDesafiosBasico() {
            console.log('üèÜ NUEVA - Iniciando funci√≥n mostrarDesafiosBasico...');
            
            // Remover modal existente
            const modalExistente = document.getElementById('desafiosModal');
            if (modalExistente) {
                console.log('üóëÔ∏è Removiendo modal existente de desaf√≠os');
                modalExistente.remove();
            }
            
            const modal = document.createElement('div');
            modal.id = 'desafiosModal';
            modal.style.cssText = 'position: fixed !important; top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important; background: rgba(0,0,0,0.8) !important; display: flex !important; align-items: center !important; justify-content: center !important; z-index: 2147483647 !important; padding: 15px !important;';
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px; width: 95%; background: white; border-radius: 16px; padding: 20px; max-height: 85vh; overflow-y: auto; position: relative; margin: auto;">
                    <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 2px solid #f1f5f9; padding-bottom: 12px;">
                        <h3 style="margin: 0; color: #1f2937; font-size: 1.3rem;"><i class="fas fa-trophy"></i> Desaf√≠os y Logros</h3>
                        <button onclick="cerrarModal(this)" class="close-btn" style="background: none; border: none; font-size: 1.6rem; cursor: pointer; color: #6b7280; padding: 5px; line-height: 1;">&times;</button>
                    </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin-top: 15px;">
                            <!-- Desaf√≠o 1 -->
                            <div style="background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 15px; padding: 20px; color: white; text-align: center; transition: transform 0.3s ease; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
                                <div style="font-size: 2.5rem; margin-bottom: 12px;">üéØ</div>
                                <h4 style="margin: 0 0 8px 0; font-size: 1.1rem;">Desaf√≠o Diario</h4>
                                <p style="margin: 0 0 12px 0; opacity: 0.9; font-size: 0.9rem;">Completa tu rutina de bienestar diaria</p>
                                <div style="background: rgba(255,255,255,0.2); border-radius: 8px; padding: 8px; margin-bottom: 12px;">
                                    <div style="background: #10b981; height: 6px; border-radius: 3px; width: 70%; transition: width 0.5s ease;"></div>
                                </div>
                                <p style="margin: 0; font-size: 0.85rem; font-weight: 600;">Progreso: 7/10 d√≠as</p>
                            </div>
                            
                            <!-- Desaf√≠o 2 -->
                            <div style="background: linear-gradient(135deg, #f093fb, #f5576c); border-radius: 15px; padding: 20px; color: white; text-align: center; transition: transform 0.3s ease; box-shadow: 0 4px 15px rgba(240, 147, 251, 0.3);">
                                <div style="font-size: 2.5rem; margin-bottom: 12px;">üßò‚Äç‚ôÄÔ∏è</div>
                                <h4 style="margin: 0 0 8px 0; font-size: 1.1rem;">Maestro de la Meditaci√≥n</h4>
                                <p style="margin: 0 0 12px 0; opacity: 0.9; font-size: 0.9rem;">Medita 5 d√≠as consecutivos</p>
                                <div style="background: rgba(255,255,255,0.2); border-radius: 8px; padding: 8px; margin-bottom: 12px;">
                                    <div style="background: #fbbf24; height: 6px; border-radius: 3px; width: 40%; transition: width 0.5s ease;"></div>
                                </div>
                                <p style="margin: 0; font-size: 0.85rem; font-weight: 600;">Progreso: 2/5 d√≠as</p>
                            </div>
                            
                            <!-- Logro 1 -->
                            <div style="background: linear-gradient(135deg, #4facfe, #00f2fe); border-radius: 15px; padding: 20px; color: white; text-align: center; transition: transform 0.3s ease; box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);">
                                <div style="font-size: 2.5rem; margin-bottom: 12px;">üèÜ</div>
                                <h4 style="margin: 0 0 8px 0; font-size: 1.1rem;">Primera Semana</h4>
                                <p style="margin: 0 0 12px 0; opacity: 0.9; font-size: 0.9rem;">¬°Completaste tu primera semana!</p>
                                <div style="background: #10b981; border-radius: 8px; padding: 8px; font-weight: bold; font-size: 0.85rem;">
                                    ‚úÖ DESBLOQUEADO
                                </div>
                            </div>
                            
                            <!-- Logro 2 -->
                            <div style="background: linear-gradient(135deg, #fa709a, #fee140); border-radius: 15px; padding: 20px; color: white; text-align: center; transition: transform 0.3s ease; box-shadow: 0 4px 15px rgba(250, 112, 154, 0.3);">
                                <div style="font-size: 2.5rem; margin-bottom: 12px;">‚≠ê</div>
                                <h4 style="margin: 0 0 8px 0; font-size: 1.1rem;">Respirador Experto</h4>
                                <p style="margin: 0 0 12px 0; opacity: 0.9; font-size: 0.9rem;">Completa 20 ejercicios de respiraci√≥n</p>
                                <div style="background: rgba(255,255,255,0.3); border-radius: 8px; padding: 8px; font-weight: bold; font-size: 0.85rem;">
                                    üîí BLOQUEADO
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 25px; padding-top: 15px; border-top: 1px solid #e5e7eb;">
                            <button onclick="cerrarModal(this)" style="background: linear-gradient(135deg, #6b7280, #9ca3af); color: white; padding: 10px 25px; border: none; border-radius: 10px; cursor: pointer; font-size: 0.95rem; transition: all 0.3s ease;">
                                <i class="fas fa-times"></i> Cerrar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Agregar eventos para cerrar modal
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
            
            // Evento para cerrar con Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const modalActual = document.getElementById('desafiosModal');
                    if (modalActual) modalActual.remove();
                }
            });
            
            // Agregar efecto hover a las tarjetas
            setTimeout(() => {
                const cards = modal.querySelectorAll('[style*="linear-gradient"]');
                cards.forEach(card => {
                    card.addEventListener('mouseenter', function() {
                        this.style.transform = 'translateY(-5px) scale(1.02)';
                    });
                    card.addEventListener('mouseleave', function() {
                        this.style.transform = 'translateY(0) scale(1)';
                    });
                });
                console.log('‚úÖ Modal de desaf√≠os creado y funcional');
            }, 100);
        }
        
        function cerrarDesafiosBasico() {
            const modal = document.getElementById('desafiosModal');
            if (modal) {
                modal.remove();
                console.log('‚úÖ Modal de desaf√≠os cerrado');
            }
        }
        
        
        // ========================================
        // FUNCI√ìN DE FALLBACK PARA ANALYTICS
        // ========================================
        
        function mostrarAnalyticsBasico() {
            console.log('üìä Mostrando analytics b√°sico como fallback');
            
            const modalHTML = `
                <div id="analyticsModal" class="modal" style="display: flex !important; z-index: 99999 !important;">
                    <div class="modal-content" style="max-width: 500px; z-index: 100000 !important; background: white; border-radius: 20px; padding: 40px;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <h2 style="color: #374151; font-size: 2rem; margin: 0; background: linear-gradient(135deg, #6366f1, #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                                üìä Analytics B√°sico
                            </h2>
                            <p style="color: #6B7280; margin-top: 10px;">M√©tricas de tu tienda</p>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div style="background: linear-gradient(135deg, #f3f4f6, #e5e7eb); padding: 20px; border-radius: 15px; text-align: center;">
                                <h3 style="color: #374151; margin: 0 0 10px 0;">üì¶ Productos</h3>
                                <p style="font-size: 2rem; font-weight: bold; color: #6366f1; margin: 0;">${document.querySelectorAll('.producto-card, .producto-item').length}</p>
                            </div>
                            <div style="background: linear-gradient(135deg, #f3f4f6, #e5e7eb); padding: 20px; border-radius: 15px; text-align: center;">
                                <h3 style="color: #374151; margin: 0 0 10px 0;">üîß Servicios</h3>
                                <p style="font-size: 2rem; font-weight: bold; color: #8b5cf6; margin: 0;">${document.querySelectorAll('.servicio-card, .servicio-item').length}</p>
                            </div>
                            <div style="background: linear-gradient(135deg, #f3f4f6, #e5e7eb); padding: 20px; border-radius: 15px; text-align: center;">
                                <h3 style="color: #374151; margin: 0 0 10px 0;">üè∑Ô∏è Ofertas</h3>
                                <p style="font-size: 2rem; font-weight: bold; color: #10b981; margin: 0;">${document.querySelectorAll('.oferta-card, .oferta-item').length}</p>
                            </div>
                            <div style="background: linear-gradient(135deg, #f3f4f6, #e5e7eb); padding: 20px; border-radius: 15px; text-align: center;">
                                <h3 style="color: #374151; margin: 0 0 10px 0;">üí¨ Feedbacks</h3>
                                <p style="font-size: 2rem; font-weight: bold; color: #f59e0b; margin: 0;">${document.querySelectorAll('.feedback-card, .feedback-item').length}</p>
                            </div>
                        </div>
                        
                        <div style="text-align: center;">
                            <button onclick="cerrarModal(this)" style="background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; padding: 12px 30px; border: none; border-radius: 10px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(99, 102, 241, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                <i class="fas fa-times"></i> Cerrar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            console.log('‚úÖ Analytics b√°sico mostrado');
        }
        
        // ========================================
        // FUNCI√ìN PARA CARGAR PRODUCTOS Y SERVICIOS
        // ========================================
        
        function cargarProductosEjemplo() {
            console.log('üì¶ Cargando productos...');
            
            try {
            // Cargar productos reales de localStorage
            const tiendaId = obtenerTiendaId();
            let productosReales = JSON.parse(localStorage.getItem(`productos_${tiendaId}`) || '[]');
            
            // Filtrar solo los productos (tipo === 'producto')
            productosReales = productosReales.filter(item => item.tipo === 'producto');
                
                // Verificar que la secci√≥n de productos existe
                const productosSection = document.getElementById('productos');
                if (!productosSection) {
                    console.error('‚ùå Secci√≥n de productos no encontrada');
                    mostrarNotificacion('Error: Secci√≥n de productos no encontrada', 'error');
                    return;
                }
                
                // Verificar que la lista de productos existe
                const productosListaElement = document.getElementById('productosLista');
                if (!productosListaElement) {
                    console.error('‚ùå Lista de productos no encontrada');
                    mostrarNotificacion('Error: Lista de productos no encontrada', 'error');
                    return;
                }
            
            // Si no hay productos reales, mostrar ejemplos
            const productosEjemplo = productosReales.length > 0 ? productosReales : [
                {
                    id: 1,
                    tipo: 'producto',
                    nombre: 'Producto Ejemplo 1',
                    precio: 29.99,
                    categoria: 'ropa-mujer',
                    stock: 15,
                    imagen: 'https://picsum.photos/150/150?random=1'
                },
                {
                    id: 2,
                    tipo: 'producto',
                    nombre: 'Producto Ejemplo 2',
                    precio: 49.99,
                    categoria: 'electronica',
                    stock: 8,
                    imagen: 'https://picsum.photos/150/150?random=2'
                },
                {
                    id: 3,
                    nombre: 'Producto Ejemplo 3',
                    precio: 19.99,
                    categoria: 'hogar',
                    stock: 25,
                    imagen: 'https://picsum.photos/150/150?random=3'
                }
            ];
            
            const productosLista = document.getElementById('productosLista');
            if (productosLista) {
                productosLista.innerHTML = productosEjemplo.map(producto => `
                    <div class="action-card" style="margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <img src="${producto.imagen}" alt="${producto.nombre}" style="width: 60px; height: 60px; border-radius: 10px; object-fit: cover;">
                            <div style="flex: 1;">
                                <h3 style="margin: 0 0 5px 0; color: #374151;">${producto.nombre}</h3>
                                <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">Categor√≠a: ${producto.categoria}</p>
                                <p style="margin: 0; color: #10b981; font-weight: bold;">$${producto.precio} - Stock: ${producto.stock}</p>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-sm" onclick="editarProducto(${producto.id})" style="background: #3b82f6; color: white; padding: 8px 12px; border: none; border-radius: 6px; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#2563eb'" onmouseout="this.style.background='#3b82f6'">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button class="btn btn-sm" onclick="eliminarProducto(${producto.id})" style="background: #ef4444; color: white; padding: 8px 12px; border: none; border-radius: 6px; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#dc2626'" onmouseout="this.style.background='#ef4444'">
                                    <i class="fas fa-trash"></i> Eliminar
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                // Actualizar contador
                const totalProductos = document.getElementById('totalProductos');
                if (totalProductos) {
                    totalProductos.textContent = productosEjemplo.length;
                }
                
                console.log('‚úÖ Productos de ejemplo cargados');
                } else {
                    console.error('‚ùå No se pudo encontrar la lista de productos');
                    mostrarNotificacion('Error: No se pudo cargar la lista de productos', 'error');
                }
            } catch (error) {
                console.error('‚ùå Error al cargar productos:', error);
                mostrarNotificacion('Error al cargar productos: ' + error.message, 'error');
            }
        }
        
        function cargarServiciosEjemplo() {
            console.log('üîß Cargando servicios...');
            
            try {
            // Cargar servicios reales de localStorage
            const tiendaId = obtenerTiendaId();
            let serviciosReales = JSON.parse(localStorage.getItem(`servicios_${tiendaId}`) || '[]');
            
            console.log('üîç Servicios encontrados en localStorage:', serviciosReales.length);
            console.log('üîç Servicios:', serviciosReales);
            
            // Filtrar solo los servicios (tipo === 'servicio')
            serviciosReales = serviciosReales.filter(item => item.tipo === 'servicio');
                
                // Verificar que la secci√≥n de servicios existe
                const serviciosSection = document.getElementById('servicios');
                if (!serviciosSection) {
                    console.error('‚ùå Secci√≥n de servicios no encontrada');
                    mostrarNotificacion('Error: Secci√≥n de servicios no encontrada', 'error');
                    return;
                }
                
                // Verificar que la lista de servicios existe
                const serviciosListaElement = document.getElementById('serviciosLista');
                if (!serviciosListaElement) {
                    console.error('‚ùå Lista de servicios no encontrada');
                    mostrarNotificacion('Error: Lista de servicios no encontrada', 'error');
                    return;
                }
            
            // Si no hay servicios reales, mostrar ejemplos
            const serviciosEjemplo = serviciosReales.length > 0 ? serviciosReales : [
                {
                    id: 1,
                    tipo: 'servicio',
                    nombre: 'Consulta de Bienestar',
                    precio: 50.00,
                    categoria: 'bienestar',
                    duracion: '60 minutos',
                    descripcion: 'Sesi√≥n personalizada de bienestar emocional',
                    modalidad: 'presencial',
                    ubicacion: 'Consultorio Principal',
                    horarios: 'Lunes a Viernes 9:00-18:00',
                    contacto: 'WhatsApp: +54 9 11 1234-5678',
                    disponible: true,
                    cupos: 10
                },
                {
                    id: 2,
                    tipo: 'servicio',
                    nombre: 'Terapia de Relajaci√≥n',
                    precio: 40.00,
                    categoria: 'bienestar',
                    duracion: '45 minutos',
                    descripcion: 'T√©cnicas de relajaci√≥n y meditaci√≥n',
                    modalidad: 'online',
                    ubicacion: 'Zoom/Meet',
                    horarios: 'Martes y Jueves 14:00-16:00',
                    contacto: 'Email: terapia@ejemplo.com',
                    disponible: true,
                    cupos: 5
                },
                {
                    id: 3,
                    tipo: 'servicio',
                    nombre: 'Coaching Empresarial',
                    precio: 80.00,
                    categoria: 'empresarial',
                    duracion: '90 minutos',
                    descripcion: 'Asesor√≠a para emprendedores y empresarios',
                    modalidad: 'mixto',
                    ubicacion: 'Oficina o Online',
                    horarios: 'Lunes a Viernes 10:00-17:00',
                    contacto: 'Tel: +54 9 11 9876-5432',
                    disponible: true,
                    cupos: 3
                },
                {
                    id: 4,
                    tipo: 'servicio',
                    nombre: 'Sesi√≥n de Yoga',
                    precio: 30.00,
                    categoria: 'fitness',
                    duracion: '60 minutos',
                    descripcion: 'Clase de yoga para principiantes',
                    modalidad: 'presencial',
                    ubicacion: 'Estudio de Yoga',
                    horarios: 'S√°bados 9:00-10:00',
                    contacto: 'WhatsApp: +54 9 11 5555-1234',
                    disponible: true,
                    cupos: 15
                }
            ];
            
            const serviciosLista = document.getElementById('serviciosLista');
            if (serviciosLista) {
                serviciosLista.innerHTML = serviciosEjemplo.map(servicio => `
                    <div class="action-card" style="margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #f093fb, #f5576c); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem;">
                                <i class="fas fa-cogs"></i>
                            </div>
                            <div style="flex: 1;">
                                <h3 style="margin: 0 0 5px 0; color: #374151;">${servicio.nombre}</h3>
                                <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">Categor√≠a: ${servicio.categoria}</p>
                                <p style="margin: 0; color: #8b5cf6; font-weight: bold;">$${servicio.precio} - ${servicio.duracion}</p>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-sm" onclick="editarServicio(${servicio.id})" style="background: #3b82f6; color: white; padding: 8px 12px; border: none; border-radius: 6px; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#2563eb'" onmouseout="this.style.background='#3b82f6'">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button class="btn btn-sm" onclick="eliminarServicio(${servicio.id})" style="background: #ef4444; color: white; padding: 8px 12px; border: none; border-radius: 6px; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#dc2626'" onmouseout="this.style.background='#ef4444'">
                                    <i class="fas fa-trash"></i> Eliminar
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                // Actualizar contador
                const totalServicios = document.getElementById('totalServicios');
                if (totalServicios) {
                    totalServicios.textContent = serviciosEjemplo.length;
                }
                
                console.log('‚úÖ Servicios de ejemplo cargados');
                } else {
                    console.error('‚ùå No se pudo encontrar la lista de servicios');
                    mostrarNotificacion('Error: No se pudo cargar la lista de servicios', 'error');
                }
            } catch (error) {
                console.error('‚ùå Error al cargar servicios:', error);
                mostrarNotificacion('Error al cargar servicios: ' + error.message, 'error');
            }
        }
        
        // ========================================
        // FUNCIONES ADICIONALES PARA FEEDBACK
        // ========================================
        
        function cerrarModalFeedback() {
            const modal = document.getElementById('feedbackModal');
            if (modal) {
                modal.remove();
                console.log('‚úÖ Modal de feedback cerrado');
            }
        }
        
        function seleccionarEstrellasAdmin(cantidad) {
            const estrellas = document.querySelectorAll('#feedbackModal .far.fa-star');
            estrellas.forEach((estrella, index) => {
                if (index < cantidad) {
                    estrella.className = 'fas fa-star';
                    estrella.style.color = '#FCD34D';
                } else {
                    estrella.className = 'far fa-star';
                    estrella.style.color = '#D1D5DB';
                }
            });
        }
        
        function enviarFeedbackAdmin(event) {
            event.preventDefault();
            
            const comentario = document.getElementById('comentarioAdmin').value;
            const estrellasSeleccionadas = document.querySelectorAll('#feedbackModal .fas.fa-star').length;
            
            if (!comentario.trim()) {
                mostrarNotificacion('Por favor escribe un comentario', 'error');
                return;
            }
            
            if (estrellasSeleccionadas === 0) {
                mostrarNotificacion('Por favor selecciona una calificaci√≥n', 'error');
                return;
            }
            
            console.log('üìß Enviando feedback admin:', { comentario, calificacion: estrellasSeleccionadas });
            
            // Simular env√≠o exitoso
            setTimeout(() => {
                mostrarNotificacion('‚úÖ Feedback enviado exitosamente', 'success');
                cerrarModalFeedback();
            }, 1000);
        }
        
        // ========================================
        // FUNCIONES FALTANTES
        // ========================================
        
        // FUNCI√ìN ELIMINADA - Ya no hay dropdown de analytics
        
        function verAnalytics() {
            console.log('üìä Ver analytics');
            mostrarAnalyticsDetallado();
        }
        
        function configurarEnvios() {
            console.log('üöö Configurar env√≠os');
            // Llamar a la funci√≥n completa de env√≠os
            configurarEnviosCompleto();
        }
        
        // ========================================
        // FUNCI√ìN PARA CARGAR FEEDBACKS
        // ========================================
        
        function cargarFeedbacks() {
            console.log('üìã Cargando feedbacks...');
            
            // Verificar si estamos en la secci√≥n de feedbacks
            const feedbacksSection = document.getElementById('feedbacks');
            if (!feedbacksSection || feedbacksSection.style.display === 'none') {
                console.log('‚ö†Ô∏è Secci√≥n de feedbacks no visible, saltando carga');
                return;
            }
            
            // Verificar si los elementos existen
            const feedbacksList = document.getElementById('feedbacksList');
            const totalFeedbacksEl = document.getElementById('totalFeedbacks');
            const promedioRatingEl = document.getElementById('promedioRating');
            const feedbacksRespondidosEl = document.getElementById('feedbacksRespondidos');
            
            if (!feedbacksList) {
                console.log('‚ùå Elemento feedbacksList no encontrado');
                return;
            }
            
            // Simular feedbacks de ejemplo para demostraci√≥n
            const feedbacksEjemplo = [
                {
                    id: 1,
                    usuario: 'Mar√≠a Gonz√°lez',
                    rating: 5,
                    comentario: 'Excelente tienda, muy buena atenci√≥n y productos de calidad.',
                    fecha: '2024-01-15',
                    respondido: false
                },
                {
                    id: 2,
                    usuario: 'Carlos Rodr√≠guez',
                    rating: 4,
                    comentario: 'Buen servicio, aunque la entrega tard√≥ un poco m√°s de lo esperado.',
                    fecha: '2024-01-14',
                    respondido: true,
                    respuesta: 'Gracias por tu feedback. Estamos mejorando nuestros tiempos de entrega.'
                },
                {
                    id: 3,
                    usuario: 'Ana L√≥pez',
                    rating: 5,
                    comentario: 'Productos excelentes y precios muy competitivos. Los recomiendo.',
                    fecha: '2024-01-13',
                    respondido: false
                }
            ];
            
            // Calcular estad√≠sticas
            const totalFeedbacks = feedbacksEjemplo.length;
            const promedioRating = (feedbacksEjemplo.reduce((sum, f) => sum + f.rating, 0) / totalFeedbacks).toFixed(1);
            const feedbacksRespondidos = feedbacksEjemplo.filter(f => f.respondido).length;
            
            // Actualizar estad√≠sticas solo si los elementos existen
            if (totalFeedbacksEl) totalFeedbacksEl.textContent = totalFeedbacks;
            if (promedioRatingEl) promedioRatingEl.textContent = promedioRating;
            if (feedbacksRespondidosEl) feedbacksRespondidosEl.textContent = feedbacksRespondidos;
            if (feedbacksEjemplo.length > 0) {
                feedbacksList.innerHTML = feedbacksEjemplo.map(feedback => `
                    <div class="feedback-item" style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; margin-bottom: 15px; background: white;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                            <div>
                                <h4 style="margin: 0; color: #1f2937; font-size: 1.1rem;">${feedback.usuario}</h4>
                                <div style="display: flex; align-items: center; gap: 5px; margin-top: 5px;">
                                    ${'‚òÖ'.repeat(feedback.rating)}${'‚òÜ'.repeat(5 - feedback.rating)}
                                    <span style="color: #6b7280; font-size: 0.9rem;">${feedback.fecha}</span>
                                </div>
                            </div>
                            <div>
                                ${feedback.respondido ? 
                                    '<span style="background: #10b981; color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.8rem;">Respondido</span>' :
                                    '<span style="background: #f59e0b; color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.8rem;">Pendiente</span>'
                                }
                            </div>
                        </div>
                        
                        <p style="color: #4b5563; line-height: 1.6; margin-bottom: 15px;">${feedback.comentario}</p>
                        
                        ${feedback.respuesta ? `
                            <div style="background: #f3f4f6; padding: 15px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <strong style="color: #1f2937;">Respuesta:</strong>
                                <p style="margin: 5px 0 0 0; color: #4b5563;">${feedback.respuesta}</p>
                            </div>
                        ` : `
                            <div style="text-align: right;">
                                <button class="btn btn-sm btn-primary" onclick="responderFeedback(${feedback.id})" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8); padding: 8px 16px; font-size: 0.9rem;">
                                    <i class="fas fa-reply"></i> Responder
                                </button>
                            </div>
                        `}
                    </div>
                `).join('');
            } else {
                feedbacksList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #6B7280;">
                        <i class="fas fa-comments" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.5;"></i>
                        <h3>No hay feedbacks a√∫n</h3>
                        <p>Los comentarios de tus clientes aparecer√°n aqu√≠</p>
                    </div>
                `;
            }
            
            console.log('‚úÖ Feedbacks cargados:', totalFeedbacks);
        }
        
        function responderFeedback(feedbackId) {
            const respuesta = prompt('Escribe tu respuesta al feedback:');
            if (respuesta && respuesta.trim()) {
                mostrarNotificacion('‚úÖ Respuesta enviada correctamente', 'success');
                // Aqu√≠ podr√≠as enviar la respuesta al servidor
                setTimeout(() => cargarFeedbacks(), 1000); // Recargar para mostrar la respuesta
            }
        }
        
        // ========================================
        // FUNCIONES DE EDITAR Y ELIMINAR PRODUCTOS/SERVICIOS
        // ========================================
        
        function editarProducto(id) {
            console.log('‚úèÔ∏è Editando producto ID:', id);
            
            const modalHTML = `
                <div id="editarProductoModal" class="modal" style="display: flex !important; z-index: 99999 !important;">
                    <div class="modal-content" style="max-width: 600px; background: white; border-radius: 20px; padding: 40px;">
                        <div class="modal-header">
                            <h3><i class="fas fa-edit"></i> Editar Producto</h3>
                            <button onclick="cerrarModal(this)" class="close-btn">&times;</button>
                        </div>
                        
                        <form id="editarProductoForm" onsubmit="guardarProducto(event, ${id})">
                            <div class="form-group">
                                <label for="editNombreProducto">Nombre del Producto:</label>
                                <input type="text" id="editNombreProducto" value="Producto Ejemplo ${id}" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div class="form-group">
                                <label for="editPrecioProducto">Precio:</label>
                                <input type="number" id="editPrecioProducto" value="29.99" step="0.01" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div class="form-group">
                                <label for="editStockProducto">Stock:</label>
                                <input type="number" id="editStockProducto" value="15" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div class="form-group">
                                <label for="editCategoriaProducto">Categor√≠a:</label>
                                <select id="editCategoriaProducto" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                                    <option value="ropa-mujer">üëó Ropa de Mujer</option>
                                    <option value="electronica">üì± Electr√≥nica</option>
                                    <option value="hogar">üè† Hogar</option>
                                    <option value="deportes">‚öΩ Deportes</option>
                                    <option value="libros">üìö Libros</option>
                                </select>
                            </div>
                            
                            <div style="display: flex; gap: 15px; margin-top: 30px;">
                                <button type="submit" style="flex: 1; background: #10b981; color: white; padding: 12px 20px; border: none; border-radius: 10px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease;">
                                    <i class="fas fa-save"></i> Guardar Cambios
                                </button>
                                <button type="button" onclick="cerrarModal(this)" style="flex: 1; background: #6b7280; color: white; padding: 12px 20px; border: none; border-radius: 10px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease;">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        // FUNCI√ìN ELIMINADA - Se usa la versi√≥n funcional de correcciones-admin.js que realmente elimina del localStorage
        
        function editarServicio(id) {
            console.log('‚úèÔ∏è Editando servicio ID:', id);
            
            const modalHTML = `
                <div id="editarServicioModal" class="modal" style="display: flex !important; z-index: 99999 !important;">
                    <div class="modal-content" style="max-width: 600px; background: white; border-radius: 20px; padding: 40px;">
                        <div class="modal-header">
                            <h3><i class="fas fa-edit"></i> Editar Servicio</h3>
                            <button onclick="cerrarModal(this)" class="close-btn">&times;</button>
                        </div>
                        
                        <form id="editarServicioForm" onsubmit="guardarServicio(event, ${id})">
                            <div class="form-group">
                                <label for="editNombreServicio">Nombre del Servicio:</label>
                                <input type="text" id="editNombreServicio" value="Servicio Ejemplo ${id}" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div class="form-group">
                                <label for="editPrecioServicio">Precio:</label>
                                <input type="number" id="editPrecioServicio" value="50.00" step="0.01" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div class="form-group">
                                <label for="editDuracionServicio">Duraci√≥n:</label>
                                <input type="text" id="editDuracionServicio" value="2 horas" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div class="form-group">
                                <label for="editCategoriaServicio">Categor√≠a:</label>
                                <select id="editCategoriaServicio" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                                    <option value="">Selecciona una categor√≠a</option>
                                    <option value="consultoria">üíº Consultor√≠a</option>
                                    <option value="diseno">üé® Dise√±o</option>
                                    <option value="desarrollo">üíª Desarrollo</option>
                                    <option value="marketing">üì£ Marketing</option>
                                    <option value="remis">üöó Remis (Transporte)</option>
                                    <option value="salud">üè• Salud y Bienestar</option>
                                    <option value="educacion">üìö Educaci√≥n</option>
                                    <option value="legal">‚öñÔ∏è Servicios Legales</option>
                                    <option value="contabilidad">üìä Contabilidad</option>
                                    <option value="limpieza">üßπ Limpieza</option>
                                    <option value="reparacion">üîß Reparaciones</option>
                                    <option value="eventos">üéâ Eventos</option>
                                    <option value="coaching">üéØ Coaching</option>
                                    <option value="traduccion">üåê Traducci√≥n</option>
                                    <option value="fotografia">üì∏ Fotograf√≠a</option>
                                    <option value="otro">üîß Otro</option>
                                </select>
                            </div>
                            
                            <div style="display: flex; gap: 15px; margin-top: 30px;">
                                <button type="submit" style="flex: 1; background: #8b5cf6; color: white; padding: 12px 20px; border: none; border-radius: 10px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease;">
                                    <i class="fas fa-save"></i> Guardar Cambios
                                </button>
                                <button type="button" onclick="cerrarModal(this)" style="flex: 1; background: #6b7280; color: white; padding: 12px 20px; border: none; border-radius: 10px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease;">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        // FUNCI√ìN ELIMINADA - Se usa la versi√≥n funcional de correcciones-admin.js que realmente elimina del localStorage
        
        function cerrarModalEditarProducto() {
            const modal = document.getElementById('editarProductoModal');
            if (modal) modal.remove();
        }
        
        function cerrarModalEditarServicio() {
            const modal = document.getElementById('editarServicioModal');
            if (modal) modal.remove();
        }
        
        function guardarProducto(event, id) {
            event.preventDefault();
            console.log('üíæ Guardando producto ID:', id);
            
            const nombre = document.getElementById('editNombreProducto').value;
            const precio = document.getElementById('editPrecioProducto').value;
            const stock = document.getElementById('editStockProducto').value;
            const categoria = document.getElementById('editCategoriaProducto').value;
            
            mostrarNotificacion('‚úÖ Producto actualizado exitosamente', 'success');
            cerrarModalEditarProducto();
            
            // Recargar la lista
            setTimeout(() => cargarProductosEjemplo(), 1000);
        }
        
        function guardarServicio(event, id) {
            event.preventDefault();
            console.log('üíæ Guardando servicio ID:', id);
            
            const nombre = document.getElementById('editNombreServicio').value;
            const precio = document.getElementById('editPrecioServicio').value;
            const duracion = document.getElementById('editDuracionServicio').value;
            const categoria = document.getElementById('editCategoriaServicio').value;
            
            mostrarNotificacion('‚úÖ Servicio actualizado exitosamente', 'success');
            cerrarModalEditarServicio();
            
            // Recargar la lista
            setTimeout(() => cargarServiciosEjemplo(), 1000);
        }
        
        function mostrarModalFeedbackBasico() {
            const modalHTML = `
                    <div id="feedbackModal" class="modal" style="display: flex !important; z-index: 99999 !important;">
                        <div class="modal-content" style="max-width: 600px; z-index: 100000 !important; background: white; border-radius: 20px; padding: 40px;">
                            <div style="text-align: center; margin-bottom: 30px;">
                                <h2 style="color: #7C3AED; margin-bottom: 10px;">
                                    <i class="fas fa-comment-dots"></i> Feedback de Mi Tienda
                                </h2>
                                <p style="color: #6B7280;">Comparte tu experiencia con los clientes</p>
                            </div>
                            
                            <form onsubmit="enviarFeedbackAdmin(event)">
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; font-weight: 600; margin-bottom: 10px; color: #374151;">
                                        <i class="fas fa-star" style="color: #EC4899;"></i> Calificaci√≥n
                                    </label>
                                    <div style="display: flex; gap: 10px; justify-content: center; padding: 20px; background: #F9FAFB; border-radius: 10px;">
                                        <i class="far fa-star" style="font-size: 32px; color: #D1D5DB; cursor: pointer;" onclick="seleccionarEstrellasAdmin(1)"></i>
                                        <i class="far fa-star" style="font-size: 32px; color: #D1D5DB; cursor: pointer;" onclick="seleccionarEstrellasAdmin(2)"></i>
                                        <i class="far fa-star" style="font-size: 32px; color: #D1D5DB; cursor: pointer;" onclick="seleccionarEstrellasAdmin(3)"></i>
                                        <i class="far fa-star" style="font-size: 32px; color: #D1D5DB; cursor: pointer;" onclick="seleccionarEstrellasAdmin(4)"></i>
                                        <i class="far fa-star" style="font-size: 32px; color: #D1D5DB; cursor: pointer;" onclick="seleccionarEstrellasAdmin(5)"></i>
                                    </div>
                                    <input type="hidden" id="feedbackCalificacionAdmin" name="calificacion" required>
                                </div>
                                
                                <div style="margin-bottom: 20px;">
                                    <label for="feedbackComentarioAdmin" style="display: block; font-weight: 600; margin-bottom: 10px; color: #374151;">
                                        <i class="fas fa-comment" style="color: #EC4899;"></i> Tu Opini√≥n
                                    </label>
                                    <textarea id="feedbackComentarioAdmin" name="comentario" rows="5" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-family: inherit;" placeholder="¬øQu√© te parece la experiencia de tu tienda? ¬øQu√© mejorar√≠as?"></textarea>
                                </div>
                                
                                <div style="display: flex; gap: 10px;">
                                    <button type="submit" style="flex: 1; background: linear-gradient(135deg, #7C3AED, #8B5CF6); color: white; border: none; padding: 15px; border-radius: 10px; font-weight: 700; cursor: pointer;">
                                        <i class="fas fa-paper-plane"></i> Enviar Feedback
                                    </button>
                                    <button type="button" onclick="cerrarModal(this)" style="background: #F3F4F6; color: #6B7280; border: none; padding: 15px 25px; border-radius: 10px; font-weight: 700; cursor: pointer;">
                                        Cerrar
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                `;
                
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            console.log('‚úÖ Modal de feedback b√°sico creado');
        }
        
        function seleccionarEstrellasAdmin(calificacion) {
            const estrellas = document.querySelectorAll('#feedbackModal .fa-star');
            estrellas.forEach((estrella, index) => {
                if (index < calificacion) {
                    estrella.classList.remove('far');
                    estrella.classList.add('fas');
                    estrella.style.color = '#FFD700';
                } else {
                    estrella.classList.remove('fas');
                    estrella.classList.add('far');
                    estrella.style.color = '#D1D5DB';
                }
            });
            document.getElementById('feedbackCalificacionAdmin').value = calificacion;
        }
        
        function enviarFeedbackAdmin(event) {
            event.preventDefault();
            const form = event.target;
            const feedback = {
                calificacion: form.calificacion.value,
                comentario: form.comentario.value,
                fecha: new Date().toISOString(),
                usuario: 'Admin de la tienda'
            };
            
            // Guardar en localStorage
            const feedbacks = JSON.parse(localStorage.getItem('cresalia_feedbacks_tienda') || '[]');
            feedbacks.push(feedback);
            localStorage.setItem('cresalia_feedbacks_tienda', JSON.stringify(feedbacks));
            
            mostrarNotificacion('‚úÖ ¬°Feedback enviado! Gracias por tu opini√≥n. üíú', 'success');
            cerrarFeedbackAdmin();
        }
        
        function cerrarFeedbackAdmin() {
            const modal = document.getElementById('feedbackModal');
            if (modal) modal.remove();
        }
        
        // Inicializar todos los sistemas
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ [Admin] Inicializando sistemas adicionales...');
            
            // Esperar un poco para que todos los scripts se carguen
            setTimeout(() => {
                // Verificar qu√© sistemas est√°n disponibles
                const sistemasDisponibles = {
                    feedbacks: typeof FeedbackSystem !== 'undefined',
                    desafios: typeof DesafiosEmocionales !== 'undefined',
                    contacto: typeof ContactoDirectoCarla !== 'undefined',
                    categorias: typeof CategoriasServiciosPopulares !== 'undefined',
                    filtros: typeof FiltrosAvanzados !== 'undefined',
                    bienestar: typeof SistemaBienestarCompleto !== 'undefined',
                    notificaciones: typeof mostrarNotificacionElegante !== 'undefined'
                };
                
                console.log('üìä [Admin] Sistemas disponibles:', sistemasDisponibles);
            
            // Sistema de Bienestar (si existe)
            if (sistemasDisponibles.bienestar) {
                try {
                    // Verificar que la clase est√© disponible
                    if (typeof SistemaBienestarCompleto !== 'undefined') {
                        const sistemaBienestar = new SistemaBienestarCompleto({
                            tenant: { slug: 'ejemplo-tienda' },
                            plan: 'pro',
                            metrics: {}
                        });
                        sistemaBienestar.init();
                        window.sistemaBienestar = sistemaBienestar;
                        console.log('‚úÖ Sistema de Bienestar inicializado');
                    } else {
                        console.log('‚ö†Ô∏è SistemaBienestarCompleto no est√° disponible a√∫n');
                        // Intentar de nuevo despu√©s de un breve delay
                        setTimeout(() => {
                            if (typeof SistemaBienestarCompleto !== 'undefined') {
                                const sistemaBienestar = new SistemaBienestarCompleto({
                                    tenant: { slug: 'ejemplo-tienda' },
                                    plan: 'pro',
                                    metrics: {}
                                });
                                sistemaBienestar.init();
                                window.sistemaBienestar = sistemaBienestar;
                                console.log('‚úÖ Sistema de Bienestar inicializado (retry)');
                            }
                        }, 1000);
                    }
                } catch (error) {
                    console.log('‚ö†Ô∏è Sistema de Bienestar:', error.message);
                }
            }
            
            // Categor√≠as y Servicios - Cargar en selectores
            if (sistemasDisponibles.categorias) {
                console.log('‚úÖ Categor√≠as disponibles:', CategoriasServiciosPopulares.categorias.length);
                console.log('‚úÖ Servicios disponibles:', CategoriasServiciosPopulares.servicios.length);
                
                // Guardar globalmente
                window.categoriasDisponibles = CategoriasServiciosPopulares;
                
                // Funci√≥n para actualizar selectores de categor√≠as y servicios
                window.actualizarSelectoresCategorias = function() {
                    console.log('üîÑ Actualizando selectores de categor√≠as y servicios...');
                    const selectores = document.querySelectorAll('select[name="categoria"], select[name="servicio"], #categoriaProducto, #categoriaServicio, select.form-control');
                    console.log('üìã Selectores encontrados:', selectores.length);
                    
                    selectores.forEach((select, index) => {
                        if (typeof CategoriasServiciosPopulares !== 'undefined') {
                            // Verificar si es un selector de categor√≠as
                            const esCategoria = select.name === 'categoria' || 
                                              select.id === 'categoriaProducto' ||
                                              (select.previousElementSibling && select.previousElementSibling.textContent && select.previousElementSibling.textContent.includes('Categor√≠a'));
                            
                            // Verificar si es un selector de servicios
                            const esServicio = select.name === 'servicio' || 
                                             select.id === 'categoriaServicio' ||
                                             (select.previousElementSibling && select.previousElementSibling.textContent && select.previousElementSibling.textContent.includes('Servicio'));
                            
                            if (esCategoria && !select.dataset.populated) {
                                // Cargar categor√≠as y filtrar iconos tipo "fas fa-"
                                let categoriasRaw = (typeof CategoriasServiciosPopulares !== 'undefined' && CategoriasServiciosPopulares.categorias) ? 
                                    CategoriasServiciosPopulares.categorias : [
                                        {id: 'ropa-mujer', nombre: 'Ropa de Mujer', icono: 'üëó'},
                                        {id: 'electronica', nombre: 'Electr√≥nica', icono: 'üì±'},
                                        {id: 'hogar', nombre: 'Hogar y Jard√≠n', icono: 'üè†'},
                                        {id: 'deportes', nombre: 'Deportes', icono: '‚öΩ'},
                                        {id: 'libros', nombre: 'Libros', icono: 'üìö'},
                                        {id: 'belleza', nombre: 'Belleza', icono: 'üíÑ'},
                                        {id: 'juguetes', nombre: 'Juguetes', icono: 'üß∏'},
                                        {id: 'mascotas', nombre: 'Mascotas', icono: 'üêï'}
                                    ];
                                
                                // Limpiar iconos que sean clases CSS (fas fa-...)
                                const categorias = categoriasRaw.map(cat => ({
                                    ...cat,
                                    icono: (cat.icono && cat.icono.startsWith('fas ')) ? 'üì¶' : cat.icono
                                }));
                                
                                const optionsHTML = categorias.map(cat => 
                                    `<option value="${cat.id}">${cat.icono || 'üì¶'} ${cat.nombre}</option>`
                                ).join('');
                                select.innerHTML = '<option value="">Seleccionar categor√≠a...</option>' + optionsHTML;
                                select.dataset.populated = 'true';
                                console.log(`‚úÖ Selector de CATEGOR√çAS ${index + 1} actualizado con ${categorias.length} categor√≠as`);
                            } else if (esServicio && !select.dataset.populated) {
                                // Cargar servicios y filtrar iconos tipo "fas fa-"
                                let serviciosRaw = (typeof CategoriasServiciosPopulares !== 'undefined' && CategoriasServiciosPopulares.servicios) ? 
                                    CategoriasServiciosPopulares.servicios : [
                                        {id: 'consultoria', nombre: 'Consultor√≠a', icono: 'üîß'},
                                        {id: 'diseno', nombre: 'Dise√±o', icono: 'üé®'},
                                        {id: 'desarrollo', nombre: 'Desarrollo', icono: 'üíª'},
                                        {id: 'marketing', nombre: 'Marketing', icono: 'üì¢'},
                                        {id: 'soporte', nombre: 'Soporte T√©cnico', icono: 'üõ†Ô∏è'},
                                        {id: 'instalacion', nombre: 'Instalaci√≥n', icono: '‚öôÔ∏è'},
                                        {id: 'mantenimiento', nombre: 'Mantenimiento', icono: 'üîß'},
                                        {id: 'capacitacion', nombre: 'Capacitaci√≥n', icono: 'üìö'}
                                    ];
                                
                                // Limpiar iconos que sean clases CSS (fas fa-...)
                                const servicios = serviciosRaw.map(serv => ({
                                    ...serv,
                                    icono: (serv.icono && serv.icono.startsWith('fas ')) ? 'üîß' : serv.icono
                                }));
                                
                                const optionsHTML = servicios.map(serv => 
                                    `<option value="${serv.id}">${serv.icono || 'üîß'} ${serv.nombre}</option>`
                                ).join('');
                                select.innerHTML = '<option value="">Seleccionar servicio...</option>' + optionsHTML;
                                select.dataset.populated = 'true';
                                console.log(`‚úÖ Selector de SERVICIOS ${index + 1} actualizado con ${servicios.length} servicios`);
                            }
                        }
                    });
                };
                
                // Actualizar ahora y cada vez que se muestre un formulario
                setTimeout(() => window.actualizarSelectoresCategorias(), 500);
                setTimeout(() => window.actualizarSelectoresCategorias(), 2000);
                setTimeout(() => window.actualizarSelectoresCategorias(), 4000);
            }
            
            // No cargar feedbacks inicialmente, solo cuando se muestre la secci√≥n
            
            // Funci√≥n de diagn√≥stico para modales - VERSI√ìN CONTROLADA
            window.diagnosticarModales = function() {
                console.log('üîç === DIAGN√ìSTICO DE MODALES ===');
                console.log('üìã Funciones disponibles:');
                console.log('  - mostrarFormularioProducto:', typeof mostrarFormularioProducto !== 'undefined' ? 'S√ç' : 'NO');
                console.log('  - verMiProgreso:', typeof verMiProgreso !== 'undefined' ? 'S√ç' : 'NO');
                console.log('  - verRecursos:', typeof verRecursos !== 'undefined' ? 'S√ç' : 'NO');
                console.log('  - mostrarNotificacion:', typeof mostrarNotificacion !== 'undefined' ? 'S√ç' : 'NO');
                
                console.log('üéØ Elementos DOM:');
                console.log('  - modalProducto:', document.getElementById('modalProducto') ? 'S√ç' : 'NO');
                console.log('  - body:', document.body ? 'S√ç' : 'NO');
                
                console.log('‚úÖ Diagn√≥stico completado');
            };
            
            console.log('üéâ [Admin] Todos los sistemas cargados');
            console.log('üí° Usa diagnosticarModales() para verificar el estado de los modales');
            }, 1000); // Esperar 1 segundo para que todos los scripts se carguen
        });
        
        // ===== FUNCIONES CR√çTICAS QUE FALTABAN =====
        
        // Funci√≥n para mostrar formulario de producto
        // FUNCI√ìN DUPLICADA ELIMINADA - La funci√≥n correcta est√° en l√≠nea 1126
        
        // NOTA: Funci√≥n verMiProgreso() ELIMINADA - ya existe una versi√≥n correcta en l√≠nea 2218
        // No duplicar funciones para evitar conflictos
        
        // NOTA: Funciones verRecursos() y cerrarProgresoModal() ELIMINADAS
        // Ya existen versiones correctas en l√≠neas 2412 y 2402 respectivamente
        // No duplicar funciones para evitar conflictos
        
        // ===== FUNCIONES ADICIONALES =====
        
        // Configurar Env√≠os - VERSI√ìN MEJORADA
        function configurarEnviosCompleto() {
            console.log('üì¶ Configurando servicios de env√≠o...');
            
            // Crear modal usando createElement (m√°s confiable)
            const modal = document.createElement('div');
            modal.id = 'enviosModal';
            modal.className = 'modal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999999 !important;
            `;
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 450px; background: white; border-radius: 20px; padding: 25px; margin: 20px; max-height: 80vh; overflow-y: auto;">
                    <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid #f1f5f9; padding-bottom: 12px;">
                        <h3 style="margin: 0; color: #333; font-size: 1.3rem;"><i class="fas fa-shipping-fast"></i> Configurar Env√≠os</h3>
                        <button onclick="cerrarModal(this)" style="background: none; border: none; font-size: 2rem; cursor: pointer; color: #999;">√ó</button>
                    </div>
                        
                        <div style="margin-top: 20px;">
                            <h4 style="color: #374151; margin-bottom: 15px;">üì¶ Servicios de Env√≠o Disponibles:</h4>
                            
                            <div style="display: grid; gap: 15px;">
                                <div style="background: #f3f4f6; padding: 15px; border-radius: 10px; display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 50px; height: 50px; background: #10b981; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        üöö
                                    </div>
                                    <div style="flex: 1;">
                                        <h5 style="margin: 0; color: #374151;">Env√≠o a Domicilio</h5>
                                        <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">Entrega en la puerta de tu casa</p>
                                    </div>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" checked> Activar
                                    </label>
                                </div>
                                
                                <div style="background: #f3f4f6; padding: 15px; border-radius: 10px; display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 50px; height: 50px; background: #6366f1; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        üè™
                                    </div>
                                    <div style="flex: 1;">
                                        <h5 style="margin: 0; color: #374151;">Retiro en Tienda</h5>
                                        <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">Retira en nuestro local</p>
                                    </div>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" checked> Activar
                                    </label>
                                </div>
                                
                                <div style="background: #f3f4f6; padding: 15px; border-radius: 10px; display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 50px; height: 50px; background: #f59e0b; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        ‚ö°
                                    </div>
                                    <div style="flex: 1;">
                                        <h5 style="margin: 0; color: #374151;">Env√≠o Express</h5>
                                        <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">Entrega en 24 horas</p>
                                    </div>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox"> Activar
                                    </label>
                                </div>
                                
                                <div style="background: #f3f4f6; padding: 15px; border-radius: 10px; display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 50px; height: 50px; background: #8b5cf6; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        üìç
                                    </div>
                                    <div style="flex: 1;">
                                        <h5 style="margin: 0; color: #374151;">Entrega en Puntos Comunes</h5>
                                        <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">Shopping, terminales, plazas</p>
                                    </div>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" id="puntosEntregaCheck"> Activar
                                    </label>
                                </div>
                                
                                
                                <div style="background: #f3f4f6; padding: 15px; border-radius: 10px; display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 50px; height: 50px; background: #059669; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        üõµ
                                    </div>
                                    <div style="flex: 1;">
                                        <h5 style="margin: 0; color: #374151;">Delivery / Moto</h5>
                                        <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">Entrega r√°pida en moto</p>
                                    </div>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" id="deliveryCheck"> Activar
                                    </label>
                                </div>
                                
                                <div style="background: #f3f4f6; padding: 15px; border-radius: 10px; display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 50px; height: 50px; background: #7c3aed; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        üöô
                                    </div>
                                    <div style="flex: 1;">
                                        <h5 style="margin: 0; color: #374151;">Transporte de Carga</h5>
                                        <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">Para productos pesados o voluminosos</p>
                                    </div>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" id="transporteCargaCheck"> Activar
                                    </label>
                                </div>
                                
                            </div>
                            
                            <!-- Configuraciones espec√≠ficas para cada servicio -->
                            <div id="puntosEntregaConfig" style="display: none; margin-top: 20px; padding: 20px; background: #f8fafc; border-radius: 10px; border-left: 4px solid #8b5cf6;">
                                <h5 style="color: #374151; margin-bottom: 15px;">üìç Configurar Puntos de Entrega</h5>
                                
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.9rem;">Puntos Disponibles:</label>
                                    <textarea id="puntosEntrega" placeholder="Ej: Shopping del Sol, Centro Comercial Norte, Terminal de √ìmnibus, Plaza San Mart√≠n..." style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px; min-height: 80px;" onfocus="this.style.borderColor='#8b5cf6';" onblur="this.style.borderColor='#e5e7eb';"></textarea>
                                    <small style="color: #666; font-size: 12px;">Lista los puntos donde puedes hacer entregas (separados por comas)</small>
                                </div>
                                
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.9rem;">Horarios de Entrega:</label>
                                    <input type="text" id="horariosEntrega" placeholder="Ej: Lun-Vie 9:00-18:00, S√°b 9:00-14:00" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px;" onfocus="this.style.borderColor='#8b5cf6';" onblur="this.style.borderColor='#e5e7eb';">
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.9rem;">Contacto para Coordinar:</label>
                                    <input type="text" id="contactoEntrega" placeholder="WhatsApp, tel√©fono o email para coordinar entregas" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px;" onfocus="this.style.borderColor='#8b5cf6';" onblur="this.style.borderColor='#e5e7eb';">
                                </div>
                            </div>
                            
                            
                            <div id="deliveryConfig" style="display: none; margin-top: 20px; padding: 20px; background: #f0fdf4; border-radius: 10px; border-left: 4px solid #059669;">
                                <h5 style="color: #374151; margin-bottom: 15px;">üõµ Configurar Delivery / Moto</h5>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.9rem;">Costo Delivery:</label>
                                        <input type="number" id="costoDelivery" placeholder="$300" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px;" onfocus="this.style.borderColor='#059669';" onblur="this.style.borderColor='#e5e7eb';">
                                    </div>
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.9rem;">Tiempo Estimado:</label>
                                        <input type="text" id="tiempoDelivery" placeholder="30-45 min" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px;" onfocus="this.style.borderColor='#059669';" onblur="this.style.borderColor='#e5e7eb';">
                                    </div>
                                </div>
                                
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.9rem;">√Årea de Delivery:</label>
                                    <textarea id="areaDelivery" placeholder="Ej: 5km a la redonda del centro" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px; min-height: 60px;" onfocus="this.style.borderColor='#059669';" onblur="this.style.borderColor='#e5e7eb';"></textarea>
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151; font-size: 0.9rem;">Contacto Delivery:</label>
                                    <input type="text" id="contactoDelivery" placeholder="WhatsApp para coordinar delivery" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px;" onfocus="this.style.borderColor='#059669';" onblur="this.style.borderColor='#e5e7eb';">
                                </div>
                            </div>
                            
                            
                            <div style="text-align: center; margin-top: 30px;">
                                <button onclick="guardarConfigEnvios()" style="background: #10b981; color: white; padding: 12px 30px; border: none; border-radius: 10px; cursor: pointer; font-size: 1rem; margin-right: 15px;">
                                    <i class="fas fa-save"></i> Guardar Configuraci√≥n
                                </button>
                                <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; padding: 12px 30px; border: none; border-radius: 10px; cursor: pointer; font-size: 1rem;">
                                    <i class="fas fa-times"></i> Cerrar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de env√≠os creado y agregado');
            
            // Forzar visibilidad
            modal.style.display = 'flex';
            modal.style.visibility = 'visible';
            modal.style.opacity = '1';
            console.log('‚úÖ Modal de env√≠os forzado a ser visible');
            
            // Controlar scroll en m√≥vil
            controlarScrollMovil(true);
            
            // Agregar event listeners para mostrar/ocultar configuraciones espec√≠ficas
            setTimeout(() => {
                // Configuraci√≥n de puntos de entrega
                const puntosCheckbox = document.getElementById('puntosEntregaCheck');
                const puntosConfig = document.getElementById('puntosEntregaConfig');
                
                if (puntosCheckbox && puntosConfig) {
                    puntosCheckbox.addEventListener('change', function() {
                        if (this.checked) {
                            puntosConfig.style.display = 'block';
                        } else {
                            puntosConfig.style.display = 'none';
                        }
                    });
                }
                
                // Configuraci√≥n de remiser√≠a
                const remiseriaCheckbox = document.getElementById('remiseriaCheck');
                const remiseriaConfig = document.getElementById('remiseriaConfig');
                
                if (remiseriaCheckbox && remiseriaConfig) {
                    remiseriaCheckbox.addEventListener('change', function() {
                        if (this.checked) {
                            remiseriaConfig.style.display = 'block';
                        } else {
                            remiseriaConfig.style.display = 'none';
                        }
                    });
                }
                
                // Configuraci√≥n de delivery
                const deliveryCheckbox = document.getElementById('deliveryCheck');
                const deliveryConfig = document.getElementById('deliveryConfig');
                
                if (deliveryCheckbox && deliveryConfig) {
                    deliveryCheckbox.addEventListener('change', function() {
                        if (this.checked) {
                            deliveryConfig.style.display = 'block';
                        } else {
                            deliveryConfig.style.display = 'none';
                        }
                    });
                }
                
                // Configuraci√≥n de detail
                const detailCheckbox = document.getElementById('detailCheck');
                const detailConfig = document.getElementById('detailConfig');
                
                if (detailCheckbox && detailConfig) {
                    detailCheckbox.addEventListener('change', function() {
                        if (this.checked) {
                            detailConfig.style.display = 'block';
                        } else {
                            detailConfig.style.display = 'none';
                        }
                    });
                }
            }, 100);
        }
        
        function cerrarEnviosModal() {
            const modal = document.getElementById('enviosModal');
            if (modal) modal.remove();
        }
        
        function guardarConfigEnvios() {
            mostrarNotificacion('‚úÖ Configuraci√≥n de env√≠os guardada exitosamente', 'success');
            setTimeout(() => cerrarEnviosModal(), 1500);
        }
        
        // ===== CONFIGURAR CRESALIA-BOT =====
        function configurarCresaliaBot() {
            console.log('ü§ñ Configurando CRESALIA-BOT...');
            
            // Obtener configuraci√≥n actual
            const configActual = JSON.parse(localStorage.getItem('cresaliaBotConfig') || '{}');
            const planActual = localStorage.getItem('plan-actual') || 'pro';
            
            // Crear modal usando createElement (m√°s confiable)
            const modal = document.createElement('div');
            modal.id = 'botModal';
            modal.className = 'modal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999999 !important;
            `;
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 400px; background: white; border-radius: 20px; padding: 20px; margin: 20px; max-height: 70vh; overflow-y: auto;">
                    <div class="modal-header" style="text-align: center; margin-bottom: 20px;">
                        <h3 style="color: #333; font-size: 1.5rem; margin-bottom: 8px;">
                            <i class="fas fa-robot" style="color: #4facfe;"></i> CRESALIA-BOT
                        </h3>
                        <p style="color: #666; font-size: 0.9rem;">Configura tu asistente virtual inteligente</p>
                        <div style="background: ${planActual === 'pro' ? 'linear-gradient(135deg, #4facfe, #00f2fe)' : 'linear-gradient(135deg, #10B981, #34D399)'}; color: white; padding: 10px 20px; border-radius: 20px; display: inline-block; margin-top: 10px; font-weight: 600;">
                            Plan: ${planActual.toUpperCase()}
                        </div>
                    </div>
                    
                    <!-- Configuraci√≥n de Colores -->
                    <div style="margin-bottom: 30px;">
                        <h4 style="color: #333; margin-bottom: 15px; font-size: 1.2rem;">
                            <i class="fas fa-palette"></i> Personalizaci√≥n de Colores
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    Color Principal:
                                </label>
                                <input type="color" id="botColorPrincipal" value="${configActual.botColorPrincipal || '#4facfe'}" style="width: 100%; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    Color Secundario:
                                </label>
                                <input type="color" id="botColorSecundario" value="${configActual.botColorSecundario || '#00f2fe'}" style="width: 100%; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    Color de Texto:
                                </label>
                                <input type="color" id="botColorTexto" value="${configActual.botColorTexto || '#FFFFFF'}" style="width: 100%; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                            </div>
                        </div>
                        <div style="margin-top: 15px; padding: 15px; border-radius: 10px; background: #F8F9FA; text-align: center;">
                            <div id="vistaPreviaBot" style="background: linear-gradient(135deg, ${configActual.botColorPrincipal || '#4facfe'}, ${configActual.botColorSecundario || '#00f2fe'}); color: ${configActual.botColorTexto || '#FFFFFF'}; padding: 20px; border-radius: 10px; font-weight: 600;">
                                ü§ñ Vista Previa del Bot
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                            <i class="fas fa-user"></i> Nombre del Bot:
                        </label>
                        <input type="text" id="nombreBot" value="${configActual.nombreBot || 'CRESALIA-BOT'}" placeholder="Ej: Asistente de Mi Tienda" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                            <i class="fas fa-comment"></i> Saludo Personalizado:
                        </label>
                        <textarea id="saludoBot" rows="3" placeholder="¬°Hola! Soy tu asistente virtual. ¬øEn qu√© puedo ayudarte hoy?" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem; resize: vertical;">${configActual.saludoBot || '¬°Hola! Soy tu asistente virtual. ¬øEn qu√© puedo ayudarte hoy?'}</textarea>
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                            <i class="fas fa-info-circle"></i> Informaci√≥n de tu Tienda:
                        </label>
                        <textarea id="infoTienda" rows="4" placeholder="Describe tu tienda, productos principales, horarios de atenci√≥n, etc." style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem; resize: vertical;">${configActual.infoTienda || 'Somos una tienda especializada en productos de calidad'}</textarea>
                    </div>
                    
                    <!-- Configuraciones seg√∫n plan -->
                    ${planActual === 'pro' ? `
                    <div style="margin-bottom: 25px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                            <i class="fas fa-cog"></i> Configuraciones Avanzadas:
                        </label>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" id="respuestasAutomaticas" ${configActual.respuestasAutomaticas !== false ? 'checked' : ''} style="transform: scale(1.2);">
                                <span>Respuestas autom√°ticas</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" id="horariosAtencion" ${configActual.horariosAtencion !== false ? 'checked' : ''} style="transform: scale(1.2);">
                                <span>Respetar horarios</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" id="aprendizajeIA" ${configActual.aprendizajeIA ? 'checked' : ''} style="transform: scale(1.2);">
                                <span>Aprendizaje IA</span>
                            </label>
                        </div>
                    </div>
                    ` : `
                    <div style="margin-bottom: 25px;">
                        <div style="background: #FEF3C7; padding: 20px; border-radius: 12px; border-left: 4px solid #F59E0B;">
                            <h4 style="color: #92400E; margin: 0 0 10px 0;">üîí Funciones Premium</h4>
                            <p style="color: #92400E; margin: 0 0 15px 0;">Respuestas autom√°ticas y aprendizaje IA disponibles solo en Plan Pro</p>
                            <button onclick="mostrarNotificacion('üí≥ Actualiza a Plan Pro para acceder a funciones avanzadas del bot', 'info')" style="background: #F59E0B; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                Actualizar a Pro
                            </button>
                        </div>
                    </div>
                    `}
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="guardarConfigBot()" style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 15px 35px; border: none; border-radius: 12px; cursor: pointer; font-size: 1.1rem; font-weight: 600; margin-right: 15px;">
                            <i class="fas fa-save"></i> Guardar Configuraci√≥n
                        </button>
                        <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; padding: 15px 35px; border: none; border-radius: 12px; cursor: pointer; font-size: 1.1rem; font-weight: 600;">
                            <i class="fas fa-times"></i> Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de bot agregado al DOM');
            
            // Forzar visibilidad
            modal.style.display = 'flex';
            modal.style.visibility = 'visible';
            modal.style.opacity = '1';
            console.log('‚úÖ Modal de bot forzado a ser visible');
            
            // Controlar scroll en m√≥vil
            controlarScrollMovil(true);
            
            // Agregar event listeners para vista previa en tiempo real
            document.getElementById('botColorPrincipal').addEventListener('input', actualizarVistaPreviaBot);
            document.getElementById('botColorSecundario').addEventListener('input', actualizarVistaPreviaBot);
            document.getElementById('botColorTexto').addEventListener('input', actualizarVistaPreviaBot);
            
            console.log('‚úÖ Modal de bot creado y agregado');
        }
        
        function actualizarVistaPreviaBot() {
            const colorPrincipal = document.getElementById('botColorPrincipal').value;
            const colorSecundario = document.getElementById('botColorSecundario').value;
            const colorTexto = document.getElementById('botColorTexto').value;
            
            const vistaPrevia = document.getElementById('vistaPreviaBot');
            vistaPrevia.style.background = `linear-gradient(135deg, ${colorPrincipal}, ${colorSecundario})`;
            vistaPrevia.style.color = colorTexto;
        }
        
        function cerrarBotModal() {
            const modal = document.getElementById('botModal');
            if (modal) modal.remove();
        }
        
        function guardarConfigBot() {
            const nombreBot = document.getElementById('nombreBot').value || 'CRESALIA-BOT';
            const saludoBot = document.getElementById('saludoBot').value || '¬°Hola! ¬øEn qu√© puedo ayudarte?';
            const infoTienda = document.getElementById('infoTienda').value;
            const planActual = localStorage.getItem('plan-actual') || 'pro';
            
            // Guardar configuraci√≥n en localStorage
            const configBot = {
                nombreBot: nombreBot,
                saludoBot: saludoBot,
                infoTienda: infoTienda,
                botColorPrincipal: document.getElementById('botColorPrincipal').value,
                botColorSecundario: document.getElementById('botColorSecundario').value,
                botColorTexto: document.getElementById('botColorTexto').value,
                activo: true,
                fechaConfiguracion: new Date().toISOString()
            };
            
            // Agregar configuraciones avanzadas solo si es plan Pro
            if (planActual === 'pro') {
                configBot.respuestasAutomaticas = document.getElementById('respuestasAutomaticas').checked;
                configBot.horariosAtencion = document.getElementById('horariosAtencion').checked;
                configBot.aprendizajeIA = document.getElementById('aprendizajeIA').checked;
            }
            
            localStorage.setItem('cresaliaBotConfig', JSON.stringify(configBot));
            
            mostrarNotificacion('‚úÖ CRESALIA-BOT configurado exitosamente', 'success');
            setTimeout(() => cerrarBotModal(), 1500);
        }
        
        // ===== GESTIONAR SUSCRIPCIONES =====
        function gestionarSuscripciones() {
            console.log('üí≥ Gestionando suscripciones...');
            
            // Obtener datos de suscripci√≥n actual
            const planActual = localStorage.getItem('plan-actual') || 'pro';
            const fechaInicio = localStorage.getItem('fecha-inicio-suscripcion') || new Date().toISOString();
            const fechaProximoPago = new Date(new Date(fechaInicio).getTime() + 30 * 24 * 60 * 60 * 1000);
            const diasRestantes = Math.ceil((fechaProximoPago - new Date()) / (1000 * 60 * 60 * 24));
            
            // Crear modal usando createElement (m√°s confiable)
            const modal = document.createElement('div');
            modal.id = 'suscripcionesModal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999999 !important;
            `;
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 700px; background: white; border-radius: 20px; padding: 40px; margin: 20px; max-height: 80vh; overflow-y: auto;">
                    <div class="modal-header" style="text-align: center; margin-bottom: 30px;">
                        <h3 style="color: #333; font-size: 1.8rem; margin-bottom: 10px;">
                            <i class="fas fa-credit-card" style="color: #8B5CF6;"></i> Gesti√≥n de Suscripci√≥n
                        </h3>
                        <p style="color: #666; font-size: 1rem;">Administra tu plan y m√©todos de pago</p>
                    </div>
                    
                    <!-- Plan Actual -->
                    <div style="background: linear-gradient(135deg, #8B5CF6, #A78BFA); color: white; padding: 25px; border-radius: 15px; margin-bottom: 25px; text-align: center;">
                        <h4 style="margin: 0 0 15px 0; font-size: 1.3rem;">
                            <i class="fas fa-crown"></i> Plan Actual: ${planActual.toUpperCase()}
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
                            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                                <div style="font-size: 1.5rem; font-weight: bold;">${diasRestantes}</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">D√≠as Restantes</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                                <div style="font-size: 1.5rem; font-weight: bold;">$${planActual === 'pro' ? '29' : '19'}</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">Precio Mensual</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                                <div style="font-size: 1.5rem; font-weight: bold;">${fechaProximoPago.toLocaleDateString()}</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">Pr√≥ximo Pago</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Alertas de Renovaci√≥n -->
                    ${diasRestantes <= 2 ? `
                    <div style="background: #FEF3C7; border: 2px solid #F59E0B; padding: 20px; border-radius: 12px; margin-bottom: 25px;">
                        <h4 style="color: #92400E; margin: 0 0 10px 0; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-exclamation-triangle"></i> ¬°Renovaci√≥n Pr√≥xima!
                        </h4>
                        <p style="color: #92400E; margin: 0; font-size: 0.95rem;">
                            Tu suscripci√≥n se renovar√° autom√°ticamente en ${diasRestantes} d√≠a${diasRestantes === 1 ? '' : 's'}. 
                            Si no deseas continuar, puedes cancelar ahora.
                        </p>
                    </div>
                    ` : ''}
                    
                    <!-- M√©todos de Pago -->
                    <div style="margin-bottom: 25px;">
                        <h4 style="color: #333; margin-bottom: 15px; font-size: 1.1rem;">
                            <i class="fas fa-credit-card"></i> M√©todos de Pago
                        </h4>
                        <div style="display: grid; gap: 12px;">
                            <div style="background: #F8F9FA; padding: 15px; border-radius: 10px; border: 2px solid #E5E7EB; display: flex; align-items: center; gap: 12px;">
                                <i class="fab fa-cc-visa" style="font-size: 1.5rem; color: #1A1F71;"></i>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; color: #333;">Visa **** 1234</div>
                                    <div style="font-size: 0.85rem; color: #666;">M√©todo principal</div>
                                </div>
                                <button style="background: #8B5CF6; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 0.85rem;">
                                    Cambiar
                                </button>
                            </div>
                            <div style="background: #F8F9FA; padding: 15px; border-radius: 10px; border: 2px solid #E5E7EB; display: flex; align-items: center; gap: 12px;">
                                <i class="fab fa-paypal" style="font-size: 1.5rem; color: #0070BA;"></i>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; color: #333;">PayPal</div>
                                    <div style="font-size: 0.85rem; color: #666;">M√©todo alternativo</div>
                                </div>
                                <button style="background: #8B5CF6; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 0.85rem;">
                                    Agregar
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Acciones -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 30px;">
                        <button onclick="cambiarPlan()" style="background: linear-gradient(135deg, #10B981, #34D399); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-sync-alt"></i> Cambiar Plan
                        </button>
                        <button onclick="actualizarPago()" style="background: linear-gradient(135deg, #3B82F6, #60A5FA); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-credit-card"></i> Actualizar Pago
                        </button>
                        <button onclick="cancelarSuscripcion()" style="background: linear-gradient(135deg, #EF4444, #F87171); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-times"></i> Cancelar Suscripci√≥n
                        </button>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; padding: 12px 30px; border: none; border-radius: 10px; cursor: pointer; font-size: 1rem; font-weight: 600;">
                            <i class="fas fa-times"></i> Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de suscripciones creado y agregado');
        }
        
        function cerrarSuscripcionesModal() {
            const modal = document.getElementById('suscripcionesModal');
            if (modal) modal.remove();
        }
        
        function cambiarPlan() {
            mostrarNotificacion('üîÑ Redirigiendo a cambio de plan...', 'info');
            // Aqu√≠ ir√≠a la l√≥gica para cambiar de plan
        }
        
        function actualizarPago() {
            mostrarNotificacion('üí≥ Redirigiendo a actualizaci√≥n de pago...', 'info');
            // Aqu√≠ ir√≠a la l√≥gica para actualizar m√©todo de pago
        }
        
        function cancelarSuscripcion() {
            if (confirm('¬øEst√°s seguro de que quieres cancelar tu suscripci√≥n? Perder√°s acceso a las funciones premium.')) {
                mostrarNotificacion('‚ùå Suscripci√≥n cancelada. Acceso hasta el final del per√≠odo actual.', 'warning');
                // Aqu√≠ ir√≠a la l√≥gica para cancelar suscripci√≥n
            }
        }
        
        // ===== MEDIOS DE PAGO =====
        window.mostrarMediosPago = function() {
            console.log('üí≥ Mostrando configuraci√≥n de medios de pago...');
            
            // Cargar configuraci√≥n existente
            const datosPago = JSON.parse(localStorage.getItem('datos_pago_tienda') || '{}');
            
            // Crear modal
            const modal = document.createElement('div');
            modal.id = 'mediosPagoModal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999999 !important;
            `;
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px; background: white; border-radius: 20px; padding: 40px; margin: 20px; max-height: 90vh; overflow-y: auto;">
                    <div class="modal-header" style="text-align: center; margin-bottom: 30px;">
                        <h3 style="color: #333; font-size: 1.8rem; margin-bottom: 10px;">
                            <i class="fas fa-credit-card" style="color: #10B981;"></i> Medios de Pago
                        </h3>
                        <p style="color: #666; font-size: 1rem;">Configura los medios de pago que aceptas</p>
                    </div>
                    
                    <form id="formMediosPago" style="display: grid; gap: 20px;">
                        <!-- Mercado Pago -->
                        <div style="border: 2px solid #e5e7eb; border-radius: 12px; padding: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                <i class="fab fa-cc-mastercard" style="font-size: 1.5rem; color: #00A0DF;"></i>
                                <h4 style="margin: 0; color: #333;">Mercado Pago</h4>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="mercadopago" ${datosPago.mercadopago ? 'checked' : ''} style="width: 20px; height: 20px; cursor: pointer;">
                                    <span style="font-weight: 600;">Acepto Mercado Pago</span>
                                </label>
                            </div>
                            <div style="display: grid; gap: 10px;">
                                <input type="text" id="mp_alias" placeholder="Alias de Mercado Pago" value="${datosPago.mp_alias || ''}" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                                <input type="text" id="mp_cbu" placeholder="CBU" value="${datosPago.mp_cbu || ''}" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                                <input type="text" id="mp_cvu" placeholder="CVU" value="${datosPago.mp_cvu || ''}" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            </div>
                        </div>
                        
                        <!-- Transferencia Bancaria -->
                        <div style="border: 2px solid #e5e7eb; border-radius: 12px; padding: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                <i class="fas fa-university" style="font-size: 1.5rem; color: #8B5CF6;"></i>
                                <h4 style="margin: 0; color: #333;">Transferencia Bancaria</h4>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="transferencia" ${datosPago.transferencia ? 'checked' : ''} style="width: 20px; height: 20px; cursor: pointer;">
                                    <span style="font-weight: 600;">Acepto Transferencia</span>
                                </label>
                            </div>
                            <div style="display: grid; gap: 10px;">
                                <input type="text" id="banco" placeholder="Banco" value="${datosPago.banco || ''}" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                                <input type="text" id="titular" placeholder="Titular de la cuenta" value="${datosPago.titular || ''}" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                                <input type="text" id="cbu" placeholder="CBU" value="${datosPago.cbu || ''}" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                                <input type="text" id="alias" placeholder="Alias" value="${datosPago.alias || ''}" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            </div>
                        </div>
                        
                        <!-- Efectivo -->
                        <div style="border: 2px solid #e5e7eb; border-radius: 12px; padding: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                <i class="fas fa-money-bill-wave" style="font-size: 1.5rem; color: #10B981;"></i>
                                <h4 style="margin: 0; color: #333;">Efectivo</h4>
                            </div>
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="efectivo" ${datosPago.efectivo ? 'checked' : ''} style="width: 20px; height: 20px; cursor: pointer;">
                                <span style="font-weight: 600;">Acepto Efectivo</span>
                            </label>
                        </div>
                        
                        <!-- Criptomonedas -->
                        <div style="border: 2px solid #e5e7eb; border-radius: 12px; padding: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                <i class="fab fa-bitcoin" style="font-size: 1.5rem; color: #F7931A;"></i>
                                <h4 style="margin: 0; color: #333;">Criptomonedas</h4>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="cripto" ${datosPago.cripto ? 'checked' : ''} style="width: 20px; height: 20px; cursor: pointer;">
                                    <span style="font-weight: 600;">Acepto Criptomonedas</span>
                                </label>
                            </div>
                            <input type="text" id="wallet" placeholder="Direcci√≥n de billetera" value="${datosPago.wallet || ''}" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                        </div>
                        
                        <!-- Botones -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
                            <button type="button" onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                            <button type="submit" style="background: linear-gradient(135deg, #10B981, #059669); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-save"></i> Guardar
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Manejar env√≠o del formulario
            document.getElementById('formMediosPago').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const nuevosDatos = {
                    mercadopago: document.getElementById('mercadopago').checked,
                    mp_alias: document.getElementById('mp_alias').value,
                    mp_cbu: document.getElementById('mp_cbu').value,
                    mp_cvu: document.getElementById('mp_cvu').value,
                    transferencia: document.getElementById('transferencia').checked,
                    banco: document.getElementById('banco').value,
                    titular: document.getElementById('titular').value,
                    cbu: document.getElementById('cbu').value,
                    alias: document.getElementById('alias').value,
                    efectivo: document.getElementById('efectivo').checked,
                    cripto: document.getElementById('cripto').checked,
                    wallet: document.getElementById('wallet').value
                };
                
                localStorage.setItem('datos_pago_tienda', JSON.stringify(nuevosDatos));
                mostrarNotificacion('‚úÖ Medios de pago guardados exitosamente', 'success');
                cerrarModal(modal.querySelector('button'));
            });
            
            console.log('‚úÖ Modal de medios de pago creado');
        };
        
        // ===== PACK DE INICIO =====
        function abrirPackInicio() {
            console.log('üéÅ Abriendo Pack de Inicio...');
            
            // Crear modal usando createElement (m√°s confiable)
            const modal = document.createElement('div');
            modal.id = 'packInicioModal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999999 !important;
            `;
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px; background: white; border-radius: 20px; padding: 40px; margin: 20px; max-height: 85vh; overflow-y: auto;">
                    <div class="modal-header" style="text-align: center; margin-bottom: 30px;">
                        <h3 style="color: #333; font-size: 2rem; margin-bottom: 10px;">
                            <i class="fas fa-gift" style="color: #F59E0B;"></i> Pack de Inicio Gratuito
                        </h3>
                        <p style="color: #666; font-size: 1.1rem;">Todo lo que necesitas para comenzar tu emprendimiento</p>
                    </div>
                    
                    <!-- Recursos Disponibles -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        
                        <!-- Logo B√°sico -->
                        <div style="background: linear-gradient(135deg, #FEF3C7, #FDE68A); padding: 25px; border-radius: 15px; border-left: 5px solid #F59E0B;">
                            <h4 style="color: #92400E; margin: 0 0 15px 0; font-size: 1.2rem;">
                                <i class="fas fa-palette"></i> Logo B√°sico Generado
                            </h4>
                            <p style="color: #92400E; margin-bottom: 15px; font-size: 0.95rem;">
                                Logo personalizado con el nombre de tu tienda, listo para usar.
                            </p>
                            <button onclick="descargarLogo()" style="background: #F59E0B; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-download"></i> Descargar Logo
                            </button>
                        </div>
                        
                        <!-- Banners para Redes -->
                        <div style="background: linear-gradient(135deg, #DBEAFE, #BFDBFE); padding: 25px; border-radius: 15px; border-left: 5px solid #3B82F6;">
                            <h4 style="color: #1E40AF; margin: 0 0 15px 0; font-size: 1.2rem;">
                                <i class="fas fa-image"></i> Banners para Redes
                            </h4>
                            <p style="color: #1E40AF; margin-bottom: 15px; font-size: 0.95rem;">
                                Banners para Instagram, Facebook y WhatsApp con tu marca.
                            </p>
                            <button onclick="descargarBanners()" style="background: #3B82F6; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-download"></i> Descargar Banners
                            </button>
                        </div>
                        
                        <!-- Plantillas de Posts -->
                        <div style="background: linear-gradient(135deg, #D1FAE5, #A7F3D0); padding: 25px; border-radius: 15px; border-left: 5px solid #10B981;">
                            <h4 style="color: #065F46; margin: 0 0 15px 0; font-size: 1.2rem;">
                                <i class="fas fa-file-alt"></i> Plantillas de Posts
                            </h4>
                            <p style="color: #065F46; margin-bottom: 15px; font-size: 0.95rem;">
                                Plantillas editables para promocionar tus productos.
                            </p>
                            <button onclick="descargarPlantillas()" style="background: #10B981; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-download"></i> Descargar Plantillas
                            </button>
                        </div>
                        
                        <!-- Gu√≠a de Inicio -->
                        <div style="background: linear-gradient(135deg, #F3E8FF, #DDD6FE); padding: 25px; border-radius: 15px; border-left: 5px solid #8B5CF6;">
                            <h4 style="color: #6D28D9; margin: 0 0 15px 0; font-size: 1.2rem;">
                                <i class="fas fa-book"></i> Gu√≠a de Inicio Completa
                            </h4>
                            <p style="color: #6D28D9; margin-bottom: 15px; font-size: 0.95rem;">
                                Gu√≠a paso a paso para configurar tu tienda y comenzar a vender.
                            </p>
                            <button onclick="descargarGuia()" style="background: #8B5CF6; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-download"></i> Descargar Gu√≠a
                            </button>
                        </div>
                    </div>
                    
                    <!-- Informaci√≥n Adicional -->
                    <div style="background: #F8F9FA; padding: 20px; border-radius: 12px; margin-bottom: 25px;">
                        <h4 style="color: #333; margin: 0 0 10px 0; font-size: 1.1rem;">
                            <i class="fas fa-info-circle"></i> Informaci√≥n del Pack
                        </h4>
                        <ul style="color: #666; margin: 0; padding-left: 20px; font-size: 0.95rem;">
                            <li><strong>Duraci√≥n:</strong> 4 d√≠as de acceso completo</li>
                            <li><strong>Formato:</strong> Archivos editables (PNG, PDF, DOCX)</li>
                            <li><strong>Personalizaci√≥n:</strong> Adaptados al nombre de tu tienda</li>
                            <li><strong>Soporte:</strong> Incluye tutoriales de uso</li>
                        </ul>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; padding: 15px 35px; border: none; border-radius: 12px; cursor: pointer; font-size: 1.1rem; font-weight: 600;">
                            <i class="fas fa-times"></i> Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de Pack de Inicio creado y agregado');
        }
        
        function cerrarPackInicio() {
            const modal = document.getElementById('packInicioModal');
            if (modal) modal.remove();
        }
        
        function descargarLogo() {
            mostrarNotificacion('üé® Descargando logo personalizado...', 'info');
            
            // Crear un canvas para generar el logo
            const canvas = document.createElement('canvas');
            canvas.width = 400;
            canvas.height = 200;
            const ctx = canvas.getContext('2d');
            
            // Fondo del logo
            const gradient = ctx.createLinearGradient(0, 0, 400, 200);
            gradient.addColorStop(0, '#8B5CF6');
            gradient.addColorStop(1, '#A78BFA');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 400, 200);
            
            // Texto del logo
            ctx.fillStyle = 'white';
            ctx.font = 'bold 36px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('CRESALIA', 200, 120);
            
            ctx.font = '18px Arial';
            ctx.fillText('Tu Tienda Online', 200, 150);
            
            // Descargar como PNG
            canvas.toBlob(function(blob) {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'cresalia-logo.png';
                a.click();
                URL.revokeObjectURL(url);
                mostrarNotificacion('‚úÖ Logo descargado exitosamente', 'success');
            });
        }
        
        function descargarBanners() {
            mostrarNotificacion('üñºÔ∏è Descargando banners para redes sociales...', 'info');
            
            // Crear banners para diferentes redes
            const redes = [
                { nombre: 'Instagram', width: 1080, height: 1080 },
                { nombre: 'Facebook', width: 1200, height: 630 },
                { nombre: 'WhatsApp', width: 800, height: 800 }
            ];
            
            redes.forEach((red, index) => {
                setTimeout(() => {
                    const canvas = document.createElement('canvas');
                    canvas.width = red.width;
                    canvas.height = red.height;
                    const ctx = canvas.getContext('2d');
                    
                    // Fondo del banner
                    const gradient = ctx.createLinearGradient(0, 0, red.width, red.height);
                    gradient.addColorStop(0, '#8B5CF6');
                    gradient.addColorStop(1, '#A78BFA');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(0, 0, red.width, red.height);
                    
                    // Texto del banner
                    ctx.fillStyle = 'white';
                    ctx.font = `bold ${red.width/20}px Arial`;
                    ctx.textAlign = 'center';
                    ctx.fillText('CRESALIA', red.width/2, red.height/2 - 20);
                    
                    ctx.font = `${red.width/40}px Arial`;
                    ctx.fillText('Crea tu tienda online', red.width/2, red.height/2 + 20);
                    
                    // Descargar
                    canvas.toBlob(function(blob) {
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `cresalia-banner-${red.nombre}.png`;
                        a.click();
                        URL.revokeObjectURL(url);
                    });
                }, index * 500);
            });
            
            setTimeout(() => {
                mostrarNotificacion('‚úÖ Banners descargados exitosamente', 'success');
            }, redes.length * 500);
        }
        
        function descargarPlantillas() {
            mostrarNotificacion('üìÑ Descargando plantillas de posts...', 'info');
            
            // Crear contenido HTML para la plantilla
            const contenido = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Plantillas de Posts - Cresalia</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }
                        .template { background: white; padding: 30px; margin: 20px 0; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
                        .header { background: linear-gradient(135deg, #8B5CF6, #A78BFA); color: white; padding: 20px; border-radius: 10px; text-align: center; margin-bottom: 20px; }
                        .content { padding: 20px; }
                        .cta-button { background: #8B5CF6; color: white; padding: 15px 30px; border-radius: 8px; text-decoration: none; display: inline-block; margin: 10px 0; }
                    </style>
                </head>
                <body>
                    <div class="template">
                        <div class="header">
                            <h1>üéâ ¬°Nuevo Producto Disponible!</h1>
                        </div>
                        <div class="content">
                            <h2>Descubre nuestro √∫ltimo producto</h2>
                            <p>¬°Perfecto para ti! Calidad garantizada y env√≠o gratis.</p>
                            <a href="#" class="cta-button">Ver Producto</a>
                        </div>
                    </div>
                    
                    <div class="template">
                        <div class="header">
                            <h1>üõçÔ∏è ¬°Oferta Especial!</h1>
                        </div>
                        <div class="content">
                            <h2>Descuento del 20%</h2>
                            <p>Por tiempo limitado. ¬°No te lo pierdas!</p>
                            <a href="#" class="cta-button">Aprovechar Oferta</a>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            // Crear y descargar archivo
            const blob = new Blob([contenido], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'plantillas-posts-cresalia.html';
            a.click();
            URL.revokeObjectURL(url);
            
            mostrarNotificacion('‚úÖ Plantillas descargadas exitosamente', 'success');
        }
        
        function descargarGuia() {
            mostrarNotificacion('üìö Descargando gu√≠a de inicio...', 'info');
            
            // Crear contenido de la gu√≠a
            const contenido = `
                # Gu√≠a de Inicio - Cresalia
                
                ## üöÄ Bienvenido a tu nueva tienda online
                
                ### Paso 1: Configuraci√≥n B√°sica
                1. Personaliza el nombre de tu tienda
                2. Agrega tu logo y colores
                3. Configura tus datos de contacto
                
                ### Paso 2: Agregar Productos
                1. Haz clic en "Productos" en el men√∫
                2. Completa la informaci√≥n de cada producto
                3. Sube fotos de calidad
                
                ### Paso 3: Configurar Env√≠os
                1. Ve a "Configuraci√≥n" > "Env√≠os"
                2. Define tus zonas de cobertura
                3. Establece precios de env√≠o
                
                ### Paso 4: Promocionar tu Tienda
                1. Usa los banners descargados
                2. Comparte en redes sociales
                3. Utiliza las plantillas de posts
                
                ## üí° Consejos Importantes
                - Mant√©n fotos de productos de alta calidad
                - Responde r√°pidamente a tus clientes
                - Actualiza regularmente tu inventario
                
                ## üÜò ¬øNecesitas Ayuda?
                - Usa el widget de bienestar para recursos
                - Contacta soporte desde la configuraci√≥n
                - Revisa la gu√≠a completa en nuestro sitio
                
                ¬°√âxito con tu emprendimiento! üíú
            `;
            
            // Crear y descargar archivo
            const blob = new Blob([contenido], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'guia-inicio-cresalia.txt';
            a.click();
            URL.revokeObjectURL(url);
            
            mostrarNotificacion('‚úÖ Gu√≠a descargada exitosamente', 'success');
        }
        
        // ===== CONFIGURAR SERVICIO DE AYUDA =====
        function configurarServicioAyuda() {
            console.log('üÜò Configurando Servicio de Ayuda...');
            
            // Obtener configuraci√≥n actual
            const configActual = JSON.parse(localStorage.getItem('servicioAyudaConfig') || '{}');
            const planActual = localStorage.getItem('plan-actual') || 'pro';
            
            // Crear modal usando createElement (m√°s confiable)
            const modal = document.createElement('div');
            modal.id = 'servicioAyudaModal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999999 !important;
            `;
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px; background: white; border-radius: 20px; padding: 40px; margin: 20px; max-height: 85vh; overflow-y: auto;">
                    <div class="modal-header" style="text-align: center; margin-bottom: 30px;">
                        <h3 style="color: #333; font-size: 1.8rem; margin-bottom: 10px;">
                            <i class="fas fa-headset" style="color: #EC4899;"></i> Servicio de Ayuda
                        </h3>
                        <p style="color: #666; font-size: 1rem;">Configura tu sistema de soporte personalizado</p>
                        <div style="background: ${planActual === 'pro' ? 'linear-gradient(135deg, #8B5CF6, #A78BFA)' : 'linear-gradient(135deg, #10B981, #34D399)'}; color: white; padding: 10px 20px; border-radius: 20px; display: inline-block; margin-top: 10px; font-weight: 600;">
                            Plan: ${planActual.toUpperCase()}
                        </div>
                    </div>
                    
                    <!-- Configuraci√≥n de Colores -->
                    <div style="margin-bottom: 30px;">
                        <h4 style="color: #333; margin-bottom: 15px; font-size: 1.2rem;">
                            <i class="fas fa-palette"></i> Personalizaci√≥n de Colores
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    Color Principal:
                                </label>
                                <input type="color" id="colorPrincipal" value="${configActual.colorPrincipal || '#EC4899'}" style="width: 100%; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    Color Secundario:
                                </label>
                                <input type="color" id="colorSecundario" value="${configActual.colorSecundario || '#F9A8D4'}" style="width: 100%; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    Color de Texto:
                                </label>
                                <input type="color" id="colorTexto" value="${configActual.colorTexto || '#FFFFFF'}" style="width: 100%; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                            </div>
                        </div>
                        <div style="margin-top: 15px; padding: 15px; border-radius: 10px; background: #F8F9FA; text-align: center;">
                            <div id="vistaPreviaColores" style="background: linear-gradient(135deg, ${configActual.colorPrincipal || '#EC4899'}, ${configActual.colorSecundario || '#F9A8D4'}); color: ${configActual.colorTexto || '#FFFFFF'}; padding: 20px; border-radius: 10px; font-weight: 600;">
                                Vista Previa del Servicio de Ayuda
                            </div>
                        </div>
                    </div>
                    
                    <!-- Configuraci√≥n B√°sica -->
                    <div style="margin-bottom: 30px;">
                        <h4 style="color: #333; margin-bottom: 15px; font-size: 1.2rem;">
                            <i class="fas fa-cog"></i> Configuraci√≥n B√°sica
                        </h4>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    Nombre del Servicio:
                                </label>
                                <input type="text" id="nombreServicio" value="${configActual.nombreServicio || 'Servicio de Ayuda'}" placeholder="Ej: Soporte al Cliente" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    Mensaje de Bienvenida:
                                </label>
                                <textarea id="mensajeBienvenida" rows="3" placeholder="¬°Hola! ¬øEn qu√© puedo ayudarte hoy?" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem; resize: vertical;">${configActual.mensajeBienvenida || '¬°Hola! ¬øEn qu√© puedo ayudarte hoy?'}</textarea>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    Horarios de Atenci√≥n:
                                </label>
                                <input type="text" id="horariosAtencion" value="${configActual.horariosAtencion || 'Lunes a Viernes 9:00 - 18:00'}" placeholder="Ej: Lunes a Viernes 9:00 - 18:00" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem;">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Respuestas Autom√°ticas (Solo Pro) -->
                    ${planActual === 'pro' ? `
                    <div style="margin-bottom: 30px;">
                        <h4 style="color: #333; margin-bottom: 15px; font-size: 1.2rem;">
                            <i class="fas fa-robot"></i> Respuestas Autom√°ticas
                        </h4>
                        <div style="background: #F0F9FF; padding: 20px; border-radius: 12px; border-left: 4px solid #3B82F6;">
                            <h5 style="color: #1E40AF; margin: 0 0 10px 0;">Funciones Premium Disponibles:</h5>
                            <ul style="color: #1E40AF; margin: 0; padding-left: 20px;">
                                <li>Respuestas autom√°ticas por horario</li>
                                <li>Mensajes personalizados por categor√≠a</li>
                                <li>Integraci√≥n con chatbot</li>
                                <li>Historial de conversaciones</li>
                            </ul>
                        </div>
                    </div>
                    ` : `
                    <div style="margin-bottom: 30px;">
                        <div style="background: #FEF3C7; padding: 20px; border-radius: 12px; border-left: 4px solid #F59E0B;">
                            <h4 style="color: #92400E; margin: 0 0 10px 0;">üîí Funciones Premium</h4>
                            <p style="color: #92400E; margin: 0 0 15px 0;">Respuestas autom√°ticas disponibles solo en Plan Pro</p>
                            <button onclick="mostrarNotificacion('üí≥ Actualiza a Plan Pro para acceder a respuestas autom√°ticas', 'info')" style="background: #F59E0B; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                Actualizar a Pro
                            </button>
                        </div>
                    </div>
                    `}
                    
                    <!-- Acciones -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 30px;">
                        <button onclick="guardarConfigServicioAyuda()" style="background: linear-gradient(135deg, #EC4899, #F9A8D4); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-save"></i> Guardar Configuraci√≥n
                        </button>
                        <button onclick="previewServicioAyuda()" style="background: linear-gradient(135deg, #3B82F6, #60A5FA); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-eye"></i> Vista Previa
                        </button>
                        <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-times"></i> Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Agregar event listeners para vista previa en tiempo real
            document.getElementById('colorPrincipal').addEventListener('input', actualizarVistaPrevia);
            document.getElementById('colorSecundario').addEventListener('input', actualizarVistaPrevia);
            document.getElementById('colorTexto').addEventListener('input', actualizarVistaPrevia);
            
            console.log('‚úÖ Modal de Servicio de Ayuda creado y agregado');
        }
        
        function actualizarVistaPrevia() {
            const colorPrincipal = document.getElementById('colorPrincipal').value;
            const colorSecundario = document.getElementById('colorSecundario').value;
            const colorTexto = document.getElementById('colorTexto').value;
            
            const vistaPrevia = document.getElementById('vistaPreviaColores');
            vistaPrevia.style.background = `linear-gradient(135deg, ${colorPrincipal}, ${colorSecundario})`;
            vistaPrevia.style.color = colorTexto;
        }
        
        function cerrarServicioAyuda() {
            const modal = document.getElementById('servicioAyudaModal');
            if (modal) modal.remove();
        }
        
        function guardarConfigServicioAyuda() {
            const config = {
                nombreServicio: document.getElementById('nombreServicio').value || 'Servicio de Ayuda',
                mensajeBienvenida: document.getElementById('mensajeBienvenida').value || '¬°Hola! ¬øEn qu√© puedo ayudarte hoy?',
                horariosAtencion: document.getElementById('horariosAtencion').value || 'Lunes a Viernes 9:00 - 18:00',
                colorPrincipal: document.getElementById('colorPrincipal').value,
                colorSecundario: document.getElementById('colorSecundario').value,
                colorTexto: document.getElementById('colorTexto').value,
                activo: true,
                fechaConfiguracion: new Date().toISOString()
            };
            
            localStorage.setItem('servicioAyudaConfig', JSON.stringify(config));
            mostrarNotificacion('‚úÖ Servicio de Ayuda configurado exitosamente', 'success');
            setTimeout(() => cerrarServicioAyuda(), 1500);
        }
        
        function previewServicioAyuda() {
            mostrarNotificacion('üëÅÔ∏è Vista previa del Servicio de Ayuda disponible en la tienda', 'info');
        }
        
        // ===== NAVEGACI√ìN A P√ÅGINAS EXTERNAS =====
        function abrirComunidadVendedores() {
            console.log('üë• Abriendo Comunidad de Vendedores...');
            
            // Abrir en nueva pesta√±a - ruta correcta desde tiendas/ejemplo-tienda/
            window.open('../../panel-comunidad-vendedores.html', '_blank');
            
            mostrarNotificacion('üë• Abriendo Comunidad de Vendedores en nueva pesta√±a...', 'info');
        }
        
        // Funci√≥n de Panel de Auditor√≠a removida - Solo para super admin
        
        function abrirComunidadCompradores() {
            console.log('üõí Abriendo Comunidad de Compradores...');
            
            // Verificar si estamos en el contexto correcto
            const currentPath = window.location.pathname;
            const basePath = currentPath.includes('/tiendas/') ? '../' : '';
            
            // Abrir en nueva pesta√±a
            window.open(`${basePath}panel-comunidad-compradores.html`, '_blank');
            
            mostrarNotificacion('üõí Abriendo Comunidad de Compradores en nueva pesta√±a...', 'info');
        }
        
        // ===== CONFIGURAR INFORMACI√ìN DE LA EMPRESA =====
        function configurarInfoEmpresa() {
            console.log('üè¢ Configurando informaci√≥n de la empresa...');
            
            // Obtener configuraci√≥n actual
            const configActual = JSON.parse(localStorage.getItem('infoEmpresaConfig') || '{}');
            const planActual = localStorage.getItem('plan-actual') || 'pro';
            
            // Crear modal usando createElement (m√°s confiable)
            const modal = document.createElement('div');
            modal.id = 'infoEmpresaModal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999999 !important;
            `;
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 700px; background: white; border-radius: 20px; padding: 40px; margin: 20px; max-height: 85vh; overflow-y: auto;">
                    <div class="modal-header" style="text-align: center; margin-bottom: 30px;">
                        <h3 style="color: #333; font-size: 1.8rem; margin-bottom: 10px;">
                            <i class="fas fa-calendar-alt" style="color: #06B6D4;"></i> Informaci√≥n de la Empresa
                        </h3>
                        <p style="color: #666; font-size: 1rem;">Configura los datos que aparecer√°n en tu tienda y footer</p>
                        <div style="background: ${planActual === 'pro' ? 'linear-gradient(135deg, #06B6D4, #0891B2)' : 'linear-gradient(135deg, #10B981, #34D399)'}; color: white; padding: 10px 20px; border-radius: 20px; display: inline-block; margin-top: 10px; font-weight: 600;">
                            Plan: ${planActual.toUpperCase()}
                        </div>
                    </div>
                    
                    <!-- Informaci√≥n B√°sica -->
                    <div style="margin-bottom: 30px;">
                        <h4 style="color: #333; margin-bottom: 15px; font-size: 1.2rem;">
                            <i class="fas fa-building"></i> Informaci√≥n B√°sica
                        </h4>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    Nombre de la Empresa/Emprendimiento:
                                </label>
                                <input type="text" id="nombreEmpresa" value="${configActual.nombreEmpresa || ''}" placeholder="Ej: Mi Tienda Online" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    A√±o de Creaci√≥n:
                                </label>
                                <input type="number" id="anoCreacion" value="${configActual.anoCreacion || new Date().getFullYear()}" min="1900" max="${new Date().getFullYear()}" placeholder="${new Date().getFullYear()}" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    Descripci√≥n de la Empresa:
                                </label>
                                <textarea id="descripcionEmpresa" rows="3" placeholder="Breve descripci√≥n de tu empresa o emprendimiento..." style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem; resize: vertical;">${configActual.descripcionEmpresa || ''}</textarea>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Redes Sociales -->
                    <div style="margin-bottom: 30px;">
                        <h4 style="color: #333; margin-bottom: 15px; font-size: 1.2rem;">
                            <i class="fas fa-share-alt"></i> Redes Sociales
                        </h4>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    <i class="fab fa-instagram" style="color: #E4405F;"></i> Instagram:
                                </label>
                                <input type="url" id="instagram" value="${configActual.instagram || ''}" placeholder="https://instagram.com/tu_tienda" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    <i class="fab fa-facebook" style="color: #1877F2;"></i> Facebook:
                                </label>
                                <input type="url" id="facebook" value="${configActual.facebook || ''}" placeholder="https://facebook.com/tu_tienda" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    <i class="fab fa-whatsapp" style="color: #25D366;"></i> WhatsApp:
                                </label>
                                <input type="tel" id="whatsapp" value="${configActual.whatsapp || ''}" placeholder="+54 9 11 1234-5678" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                                    <i class="fas fa-envelope" style="color: #6B7280;"></i> Email:
                                </label>
                                <input type="email" id="email" value="${configActual.email || ''}" placeholder="contacto@tutienda.com" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px; font-size: 1rem;">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Vista Previa del Footer -->
                    <div style="margin-bottom: 30px;">
                        <h4 style="color: #333; margin-bottom: 15px; font-size: 1.2rem;">
                            <i class="fas fa-eye"></i> Vista Previa del Footer
                        </h4>
                        <div id="vistaPreviaFooter" style="background: #F8F9FA; padding: 20px; border-radius: 12px; border: 2px solid #E5E7EB;">
                            <div style="text-align: center; margin-bottom: 15px;">
                                <h5 style="color: #333; margin: 0 0 5px 0;">${configActual.nombreEmpresa || 'Tu Empresa'}</h5>
                                <p style="color: #666; margin: 0; font-size: 0.9rem;">Desde ${configActual.anoCreacion || new Date().getFullYear()}</p>
                            </div>
                            <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 15px;">
                                ${configActual.instagram ? `<a href="${configActual.instagram}" style="color: #E4405F; text-decoration: none;"><i class="fab fa-instagram"></i></a>` : ''}
                                ${configActual.facebook ? `<a href="${configActual.facebook}" style="color: #1877F2; text-decoration: none;"><i class="fab fa-facebook"></i></a>` : ''}
                                ${configActual.whatsapp ? `<a href="https://wa.me/${configActual.whatsapp.replace(/[^0-9]/g, '')}" style="color: #25D366; text-decoration: none;"><i class="fab fa-whatsapp"></i></a>` : ''}
                                ${configActual.email ? `<a href="mailto:${configActual.email}" style="color: #6B7280; text-decoration: none;"><i class="fas fa-envelope"></i></a>` : ''}
                            </div>
                            <div style="text-align: center; color: #999; font-size: 0.8rem;">
                                ¬© ${new Date().getFullYear()} ${configActual.nombreEmpresa || 'Tu Empresa'}. Todos los derechos reservados.
                            </div>
                        </div>
                    </div>
                    
                    <!-- Informaci√≥n Beta -->
                    <div style="background: linear-gradient(135deg, #FEF3C7, #FDE68A); border: 2px solid #F59E0B; border-radius: 15px; padding: 20px; margin: 30px 0;">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                            <div style="background: #F59E0B; color: white; padding: 8px 12px; border-radius: 20px; font-weight: 600; font-size: 0.9rem;">
                                üöÄ FASE BETA
                            </div>
                            <h4 style="color: #92400E; margin: 0; font-size: 1.1rem;">
                                ¬°Estamos en desarrollo activo!
                            </h4>
                        </div>
                        <div style="color: #92400E; line-height: 1.6;">
                            <p style="margin: 0 0 10px 0; font-weight: 600;">
                                üìù <strong>Tu feedback es invaluable</strong>
                            </p>
                            <p style="margin: 0 0 10px 0;">
                                Estamos constantemente agregando nuevas funcionalidades basadas en tus sugerencias y necesidades. 
                                Cada actualizaci√≥n incluye mejoras que nos ayudas a identificar.
                            </p>
                            <p style="margin: 0; font-size: 0.9rem; font-style: italic;">
                                üí° <strong>¬øTienes ideas o sugerencias?</strong> Env√≠anos tu feedback desde la secci√≥n de contacto.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Acciones -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 30px;">
                        <button onclick="guardarInfoEmpresa()" style="background: linear-gradient(135deg, #06B6D4, #0891B2); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-save"></i> Guardar Informaci√≥n
                        </button>
                        <button onclick="sincronizarConTienda()" style="background: linear-gradient(135deg, #10B981, #34D399); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-sync"></i> Sincronizar con Tienda
                        </button>
                        <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-times"></i> Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Agregar event listeners para vista previa en tiempo real
            document.getElementById('nombreEmpresa').addEventListener('input', actualizarVistaPreviaFooter);
            document.getElementById('anoCreacion').addEventListener('input', actualizarVistaPreviaFooter);
            document.getElementById('instagram').addEventListener('input', actualizarVistaPreviaFooter);
            document.getElementById('facebook').addEventListener('input', actualizarVistaPreviaFooter);
            document.getElementById('whatsapp').addEventListener('input', actualizarVistaPreviaFooter);
            document.getElementById('email').addEventListener('input', actualizarVistaPreviaFooter);
            
            console.log('‚úÖ Modal de informaci√≥n de empresa creado y agregado');
        }
        
        function actualizarVistaPreviaFooter() {
            const nombreEmpresa = document.getElementById('nombreEmpresa').value || 'Tu Empresa';
            const anoCreacion = document.getElementById('anoCreacion').value || new Date().getFullYear();
            const instagram = document.getElementById('instagram').value;
            const facebook = document.getElementById('facebook').value;
            const whatsapp = document.getElementById('whatsapp').value;
            const email = document.getElementById('email').value;
            
            const vistaPrevia = document.getElementById('vistaPreviaFooter');
            vistaPrevia.innerHTML = `
                <div style="text-align: center; margin-bottom: 15px;">
                    <h5 style="color: #333; margin: 0 0 5px 0;">${nombreEmpresa}</h5>
                    <p style="color: #666; margin: 0; font-size: 0.9rem;">Desde ${anoCreacion}</p>
                </div>
                <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 15px;">
                    ${instagram ? `<a href="${instagram}" style="color: #E4405F; text-decoration: none;"><i class="fab fa-instagram"></i></a>` : ''}
                    ${facebook ? `<a href="${facebook}" style="color: #1877F2; text-decoration: none;"><i class="fab fa-facebook"></i></a>` : ''}
                    ${whatsapp ? `<a href="https://wa.me/${whatsapp.replace(/[^0-9]/g, '')}" style="color: #25D366; text-decoration: none;"><i class="fab fa-whatsapp"></i></a>` : ''}
                    ${email ? `<a href="mailto:${email}" style="color: #6B7280; text-decoration: none;"><i class="fas fa-envelope"></i></a>` : ''}
                </div>
                <div style="text-align: center; color: #999; font-size: 0.8rem;">
                    ¬© ${new Date().getFullYear()} ${nombreEmpresa}. Todos los derechos reservados.
                </div>
            `;
        }
        
        function cerrarInfoEmpresa() {
            const modal = document.getElementById('infoEmpresaModal');
            if (modal) modal.remove();
        }
        
        function guardarInfoEmpresa() {
            const config = {
                nombreEmpresa: document.getElementById('nombreEmpresa').value,
                anoCreacion: parseInt(document.getElementById('anoCreacion').value),
                descripcionEmpresa: document.getElementById('descripcionEmpresa').value,
                instagram: document.getElementById('instagram').value,
                facebook: document.getElementById('facebook').value,
                whatsapp: document.getElementById('whatsapp').value,
                email: document.getElementById('email').value,
                activo: true,
                fechaConfiguracion: new Date().toISOString()
            };
            
            localStorage.setItem('infoEmpresaConfig', JSON.stringify(config));
            
            // Sincronizar autom√°ticamente
            sincronizarConTienda();
            
            mostrarNotificacion('‚úÖ Informaci√≥n de empresa guardada y sincronizada', 'success');
            setTimeout(() => cerrarInfoEmpresa(), 1500);
        }
        
        function sincronizarConTienda() {
            console.log('üîÑ Sincronizando informaci√≥n con la tienda...');
            
            // Aqu√≠ se sincronizar√≠a con el index.html y otros archivos
            // Por ahora, solo mostramos notificaci√≥n
            mostrarNotificacion('üîÑ Informaci√≥n sincronizada con la tienda autom√°ticamente', 'info');
            
            // En una implementaci√≥n real, aqu√≠ se har√≠an llamadas para actualizar:
            // - El index.html con la nueva informaci√≥n
            // - El footer con redes sociales
            // - El cat√°logo con datos de la empresa
            // - Cualquier otro archivo que necesite esta informaci√≥n
        }
        
        // Ver Analytics (seg√∫n plan)
        function verAnalyticsDuplicada() {
            // NOTA: Esta funci√≥n est√° duplicada, la activa est√° en la l√≠nea 3609
            const planActual = localStorage.getItem('plan-actual') || 'pro';
            const planNombre = planActual.toLowerCase();
            
            console.log('üìä Plan detectado:', planNombre);
            
            // Verificar si tiene acceso
            if (planNombre === 'free' || planNombre === 'basic' || planNombre === 'starter') {
                mostrarNotificacion(`
üîí Analytics Avanzados - Plan Pro Requerido

Los an√°lisis y m√©tricas avanzadas est√°n disponibles en:
‚úÖ Plan Pro
‚úÖ Plan Enterprise

Tu plan actual: ${planNombre}

¬øQuer√©s actualizar tu plan para acceder a m√©tricas detalladas?
                `, 'info');
                return;
            }
            
            // Si tiene acceso, mostrar analytics en modal
            mostrarAnalyticsDetallado();
        }
        
        // ========================================
        // FUNCIONES DE ANALYTICS PARA ADMIN
        // ========================================
        
        
        function verAnalyticsAdmin() {
            // Verificar plan
            const planActual = localStorage.getItem('plan-actual') || 'free';
            const planesConAnalytics = ['pro', 'enterprise'];
            
            if (!planesConAnalytics.includes(planActual.toLowerCase())) {
                mostrarNotificacion('üìä Analytics Premium disponible solo para planes Pro y Enterprise', 'warning');
                return;
            }
            
            // Mostrar analytics detallado en modal
            mostrarAnalyticsDetallado();
        }
        
        function mostrarAnalyticsDetallado() {
            console.log('üìä Mostrando analytics detallado en modal');
            
            // Remover modal existente si hay uno
            const modalExistente = document.getElementById('analyticsModal');
            if (modalExistente) {
                modalExistente.remove();
            }
            
            const modalHTML = `
                <div id="analyticsModal" style="display: flex !important; position: fixed !important; top: 0 !important; left: 0 !important; width: 100% !important; height: 100% !important; z-index: 2147483647 !important; background: rgba(0,0,0,0.7) !important; align-items: center !important; justify-content: center !important;">
                    <div onclick="event.stopPropagation()" style="max-width: 1200px; width: 90%; max-height: 90vh; background: white; border-radius: 20px; padding: 40px; margin: 20px; overflow-y: auto; overflow-x: hidden; position: relative; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <h2 style="color: #374151; font-size: 2.5rem; margin: 0; background: linear-gradient(135deg, #6366f1, #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                                üìä Analytics Detallado
                            </h2>
                            <p style="color: #6B7280; margin-top: 10px;">M√©tricas completas de tu tienda</p>
                        </div>
                        
                        <!-- M√©tricas principales -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 40px;">
                            <div style="background: linear-gradient(135deg, #667eea, #764ba2); padding: 25px; border-radius: 15px; text-align: center; color: white;">
                                <h3 style="margin: 0 0 10px 0; font-size: 1.2rem;">üì¶ Productos</h3>
                                <p style="font-size: 3rem; font-weight: bold; margin: 0;">${document.querySelectorAll('.producto-card, .producto-item').length}</p>
                                <p style="margin: 5px 0 0 0; opacity: 0.9;">Productos activos</p>
                            </div>
                            <div style="background: linear-gradient(135deg, #f093fb, #f5576c); padding: 25px; border-radius: 15px; text-align: center; color: white;">
                                <h3 style="margin: 0 0 10px 0; font-size: 1.2rem;">üîß Servicios</h3>
                                <p style="font-size: 3rem; font-weight: bold; margin: 0;">${document.querySelectorAll('.servicio-card, .servicio-item').length}</p>
                                <p style="margin: 5px 0 0 0; opacity: 0.9;">Servicios disponibles</p>
                            </div>
                            <div style="background: linear-gradient(135deg, #4facfe, #00f2fe); padding: 25px; border-radius: 15px; text-align: center; color: white;">
                                <h3 style="margin: 0 0 10px 0; font-size: 1.2rem;">üè∑Ô∏è Ofertas</h3>
                                <p style="font-size: 3rem; font-weight: bold; margin: 0;">${document.querySelectorAll('.oferta-card, .oferta-item').length}</p>
                                <p style="margin: 5px 0 0 0; opacity: 0.9;">Ofertas activas</p>
                            </div>
                            <div style="background: linear-gradient(135deg, #43e97b, #38f9d7); padding: 25px; border-radius: 15px; text-align: center; color: white;">
                                <h3 style="margin: 0 0 10px 0; font-size: 1.2rem;">üí¨ Feedbacks</h3>
                                <p style="font-size: 3rem; font-weight: bold; margin: 0;">${document.querySelectorAll('.feedback-card, .feedback-item').length}</p>
                                <p style="margin: 5px 0 0 0; opacity: 0.9;">Comentarios recibidos</p>
                            </div>
                        </div>
                        
                        <!-- Gr√°ficos simulados -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 40px;">
                            <div style="background: #f8fafc; padding: 25px; border-radius: 15px; border: 2px solid #e2e8f0;">
                                <h3 style="color: #374151; margin: 0 0 20px 0; text-align: center;">üìà Ventas por Mes</h3>
                                <div style="height: 200px; background: linear-gradient(45deg, #667eea, #764ba2); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem;">
                                    üìä Gr√°fico de Ventas
                                </div>
                            </div>
                            <div style="background: #f8fafc; padding: 25px; border-radius: 15px; border: 2px solid #e2e8f0;">
                                <h3 style="color: #374151; margin: 0 0 20px 0; text-align: center;">üéØ Conversi√≥n</h3>
                                <div style="height: 200px; background: linear-gradient(45deg, #f093fb, #f5576c); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem;">
                                    üéØ Gr√°fico de Conversi√≥n
                                </div>
                            </div>
                        </div>
                        
                        <!-- M√©tricas adicionales -->
                        <div style="background: #f8fafc; padding: 25px; border-radius: 15px; margin-bottom: 30px;">
                            <h3 style="color: #374151; margin: 0 0 20px 0; text-align: center;">üìä M√©tricas Adicionales</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                                <div style="text-align: center;">
                                    <p style="font-size: 2rem; margin: 0; color: #6366f1; font-weight: bold;">85%</p>
                                    <p style="margin: 5px 0 0 0; color: #6b7280;">Satisfacci√≥n del cliente</p>
                                </div>
                                <div style="text-align: center;">
                                    <p style="font-size: 2rem; margin: 0; color: #10b981; font-weight: bold;">2.3s</p>
                                    <p style="margin: 5px 0 0 0; color: #6b7280;">Tiempo de carga promedio</p>
                                </div>
                                <div style="text-align: center;">
                                    <p style="font-size: 2rem; margin: 0; color: #f59e0b; font-weight: bold;">92%</p>
                                    <p style="margin: 5px 0 0 0; color: #6b7280;">Disponibilidad del sitio</p>
                                </div>
                                <div style="text-align: center;">
                                    <p style="font-size: 2rem; margin: 0; color: #ef4444; font-weight: bold;">15%</p>
                                    <p style="margin: 5px 0 0 0; color: #6b7280;">Tasa de rebote</p>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center;">
                            <button onclick="cerrarModal(this)" style="background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; padding: 15px 40px; border: none; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: 600; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(99, 102, 241, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                <i class="fas fa-times"></i> Cerrar Analytics
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            console.log('‚úÖ Modal de analytics agregado al DOM');
            
            // Agregar evento para cerrar al hacer click fuera
            setTimeout(() => {
                const modal = document.getElementById('analyticsModal');
                if (modal) {
                    modal.addEventListener('click', function(e) {
                        if (e.target.id === 'analyticsModal') {
                            cerrarModalAnalytics();
                        }
                    });
                    console.log('‚úÖ Modal de analytics visible y eventos configurados');
                }
            }, 50);
        }
        
        function cerrarModalAnalytics() {
            const modal = document.getElementById('analyticsModal');
            if (modal) {
                modal.remove();
                // Asegurar que el body pueda scrollear
                document.body.style.overflow = '';
                console.log('‚úÖ Modal de analytics cerrado');
            }
        }
        
        function verMetricasAdmin() {
            // Obtener m√©tricas de la tienda
            const productos = document.querySelectorAll('.producto-card, .producto-item').length;
            const servicios = document.querySelectorAll('.servicio-card, .servicio-item').length;
            const ofertas = document.querySelectorAll('.oferta-card, .oferta-item').length;
            const visitas = Math.floor(Math.random() * 1000) + 500;
            
            const mensaje = `
                üìä M√©tricas de tu Tienda:
                
                üë• Visitas: ${visitas.toLocaleString()}
                üì¶ Productos: ${productos}
                üîß Servicios: ${servicios}
                üè∑Ô∏è Ofertas: ${ofertas}
                
                üìà Tendencias:
                ‚Ä¢ Productos m√°s vistos: Tecnolog√≠a
                ‚Ä¢ Horario pico: 14:00 - 18:00
                ‚Ä¢ Dispositivo principal: M√≥vil (65%)
            `;
            
            mostrarNotificacion(mensaje, 'info');
        }
        
        function verReportesAdmin() {
            // Generar reporte
            const fechaActual = new Date().toLocaleDateString('es-ES');
            const productos = document.querySelectorAll('.producto-card, .producto-item').length;
            const servicios = document.querySelectorAll('.servicio-card, .servicio-item').length;
            const ofertas = document.querySelectorAll('.oferta-card, .oferta-item').length;
            const visitas = Math.floor(Math.random() * 1000) + 500;
            
            const reporte = `
                üìã REPORTE DE TIENDA - ${fechaActual}
                
                üì¶ Productos Activos: ${productos}
                üîß Servicios: ${servicios}
                üè∑Ô∏è Ofertas: ${ofertas}
                üë• Visitas Estimadas: ${visitas.toLocaleString()}
                
                üìà An√°lisis:
                ‚Ä¢ Conversi√≥n: 3.2%
                ‚Ä¢ Tiempo promedio en sitio: 4:32 min
                ‚Ä¢ Producto m√°s vendido: Tecnolog√≠a
                ‚Ä¢ Horario pico: 14:00 - 18:00
                
                üí° Recomendaciones:
                ‚Ä¢ Optimizar horarios de mayor tr√°fico
                ‚Ä¢ Aumentar inventario de productos populares
                ‚Ä¢ Mejorar SEO para categor√≠as principales
            `;
            
            // Crear modal de reporte
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.style.zIndex = '99999';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px; max-height: 80vh; overflow-y: auto;">
                    <div class="modal-header">
                        <h3><i class="fas fa-chart-bar"></i> Reporte de Tienda</h3>
                        <button class="close-btn" onclick="cerrarModal(this)">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <pre style="white-space: pre-wrap; font-family: 'Courier New', monospace; background: #f8f9fa; padding: 20px; border-radius: 8px; font-size: 14px; line-height: 1.6;">${reporte}</pre>
                    </div>
                    <div class="modal-footer" style="display: flex; gap: 10px; justify-content: flex-end; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                        <button class="btn btn-secondary" onclick="cerrarModal(this)">Cerrar</button>
                        <button class="btn btn-primary" onclick="window.print(); cerrarModal(this)">
                            <i class="fas fa-print"></i> Imprimir
                        </button>
                        <button class="btn btn-success" onclick="descargarReporteAdmin()">
                            <i class="fas fa-download"></i> Descargar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function descargarReporteAdmin() {
            const fechaActual = new Date().toLocaleDateString('es-ES');
            const productos = document.querySelectorAll('.producto-card, .producto-item').length;
            const servicios = document.querySelectorAll('.servicio-card, .servicio-item').length;
            const ofertas = document.querySelectorAll('.oferta-card, .oferta-item').length;
            const visitas = Math.floor(Math.random() * 1000) + 500;
            
            const contenido = `
REPORTE DE TIENDA - ${fechaActual}
=====================================

Productos Activos: ${productos}
Servicios: ${servicios}
Ofertas: ${ofertas}
Visitas Estimadas: ${visitas.toLocaleString()}

AN√ÅLISIS:
‚Ä¢ Conversi√≥n: 3.2%
‚Ä¢ Tiempo promedio en sitio: 4:32 min
‚Ä¢ Producto m√°s vendido: Tecnolog√≠a
‚Ä¢ Horario pico: 14:00 - 18:00

RECOMENDACIONES:
‚Ä¢ Optimizar horarios de mayor tr√°fico
‚Ä¢ Aumentar inventario de productos populares
‚Ä¢ Mejorar SEO para categor√≠as principales

Generado por Cresalia Analytics
            `;
            
            const blob = new Blob([contenido], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `reporte-tienda-${fechaActual.replace(/\//g, '-')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            // Cerrar modal
            document.querySelector('.modal').remove();
            mostrarNotificacion('üìÑ Reporte descargado exitosamente', 'success');
        }
        
        // ==================== FUNCIONES DE ANALYTICS Y REPORTES ====================
        
        // M√©tricas R√°pidas - Modal simple con estad√≠sticas principales
        function abrirMetricasRapidas() {
            console.log('üìä NUEVA - Abriendo m√©tricas r√°pidas...');
            
            // Primero cerrar cualquier modal existente
            const modalExistente = document.getElementById('metricasRapidasModal');
            if (modalExistente) {
                modalExistente.remove();
            }
            
            const modal = document.createElement('div');
            modal.id = 'metricasRapidasModal';
            modal.style.cssText = 'position: fixed !important; top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important; background: rgba(0,0,0,0.8) !important; display: flex !important; align-items: center !important; justify-content: center !important; z-index: 2147483647 !important; animation: fadeIn 0.3s;';
            
            // Generar datos simulados (en producci√≥n vendr√≠an de la base de datos)
            const stats = {
                visitas: Math.floor(Math.random() * 2000) + 500,
                ventas: Math.floor(Math.random() * 50) + 10,
                productos: Math.floor(Math.random() * 20) + 5,
                ingresos: (Math.random() * 5000 + 1000).toFixed(2)
            };
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 16px; max-width: 500px; width: 92%; max-height: 85vh; overflow-y: auto; animation: slideUpModal 0.4s ease;">
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; text-align: center; border-radius: 16px 16px 0 0;">
                        <h2 style="margin: 0 0 6px 0; font-size: 1.4rem;">üìä M√©tricas R√°pidas</h2>
                        <p style="margin: 0; opacity: 0.9; font-size: 0.9rem;">Resumen de rendimiento de tu tienda</p>
                    </div>
                    
                    <div style="padding: 20px;">
                        <!-- Grid de m√©tricas -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin-bottom: 20px;">
                            <div style="background: linear-gradient(135deg, #3B82F6, #1D4ED8); color: white; padding: 15px; border-radius: 12px; text-align: center;">
                                <i class="fas fa-eye" style="font-size: 1.8rem; margin-bottom: 8px; opacity: 0.8;"></i>
                                <h3 style="margin: 0 0 5px 0; font-size: 1.5rem; font-weight: bold;">${stats.visitas}</h3>
                                <p style="margin: 0; opacity: 0.9; font-size: 0.75rem;">Visitas del Mes</p>
                            </div>
                            
                            <div style="background: linear-gradient(135deg, #10B981, #059669); color: white; padding: 15px; border-radius: 12px; text-align: center;">
                                <i class="fas fa-shopping-bag" style="font-size: 1.8rem; margin-bottom: 8px; opacity: 0.8;"></i>
                                <h3 style="margin: 0 0 5px 0; font-size: 1.5rem; font-weight: bold;">${stats.ventas}</h3>
                                <p style="margin: 0; opacity: 0.9; font-size: 0.75rem;">Ventas Realizadas</p>
                            </div>
                            
                            <div style="background: linear-gradient(135deg, #F59E0B, #D97706); color: white; padding: 15px; border-radius: 12px; text-align: center;">
                                <i class="fas fa-box" style="font-size: 1.8rem; margin-bottom: 8px; opacity: 0.8;"></i>
                                <h3 style="margin: 0 0 5px 0; font-size: 1.5rem; font-weight: bold;">${stats.productos}</h3>
                                <p style="margin: 0; opacity: 0.9; font-size: 0.75rem;">Productos Activos</p>
                            </div>
                            
                            <div style="background: linear-gradient(135deg, #8B5CF6, #7C3AED); color: white; padding: 15px; border-radius: 12px; text-align: center;">
                                <i class="fas fa-dollar-sign" style="font-size: 1.8rem; margin-bottom: 8px; opacity: 0.8;"></i>
                                <h3 style="margin: 0 0 5px 0; font-size: 1.5rem; font-weight: bold;">$${stats.ingresos}</h3>
                                <p style="margin: 0; opacity: 0.9; font-size: 0.75rem;">Ingresos del Mes</p>
                            </div>
                        </div>
                        
                        <!-- Botones de acci√≥n -->
                        <div style="text-align: center; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                            <button onclick="abrirReporteCompleto()" style="background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; padding: 10px 18px; border: none; border-radius: 10px; cursor: pointer; font-size: 0.9rem; font-weight: 600; transition: all 0.3s ease;">
                                <i class="fas fa-chart-line"></i> Ver Reporte
                            </button>
                            <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; padding: 10px 18px; border: none; border-radius: 10px; cursor: pointer; font-size: 0.9rem; font-weight: 600; transition: all 0.3s ease;">
                                <i class="fas fa-times"></i> Cerrar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Agregar evento para cerrar clickeando fuera del modal
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
            
            // Agregar evento para cerrar con Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const modalActual = document.getElementById('metricasRapidasModal');
                    if (modalActual) modalActual.remove();
                }
            });
            
            // Animar entrada de las m√©tricas
            setTimeout(() => {
                const cards = modal.querySelectorAll('[style*="linear-gradient"]');
                cards.forEach((card, i) => {
                    setTimeout(() => {
                        card.style.animation = 'slideInUp 0.6s ease forwards';
                    }, i * 150);
                });
            }, 200);
            
            console.log('‚úÖ Modal de m√©tricas creado y a√±adido al DOM');
        }
        
        // Reporte Completo - Muestra analytics detallados en modal
        function abrirReporteCompleto() {
            console.log('üìã Abriendo reporte completo...');
            
            // Verificar plan del usuario (usando el nombre correcto de localStorage)
            const planActual = localStorage.getItem('plan-actual') || 'pro';
            const planNombre = planActual.toLowerCase();
            
            console.log('üìä Plan detectado:', planNombre);
            
            if (planNombre === 'free' || planNombre === 'basic') {
                mostrarNotificacion(`
üîí Reportes Completos - Plan Pro Requerido

Los reportes detallados est√°n disponibles en:
‚úÖ Plan Pro - Reportes avanzados
‚úÖ Plan Enterprise - An√°lisis completos
‚úÖ Plan Enterprise Custom - Todo ilimitado

üí° Contacta a soporte para upgrade de plan`, 'warning', 8000);
                return;
            }
            
            // Si tiene plan adecuado, cerrar modal actual y mostrar analytics
            const modalActual = document.getElementById('metricasRapidasModal');
            if (modalActual) {
                modalActual.remove();
            }
            
            // Mostrar analytics detallados en modal
            mostrarAnalyticsDetallado();
            mostrarNotificacion('üìä Cargando panel completo de analytics...', 'success');
        }
        
        // An√°lisis de Ventas - Modal simple con datos de ejemplo
        function abrirAnalisisVentas() {
            console.log('üõí Abriendo an√°lisis de ventas...');
            
            const modal = document.createElement('div');
            modal.id = 'analisisVentasModal';
            modal.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; z-index: 2147483647; animation: fadeIn 0.3s;';
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 24px; max-width: 900px; width: 95%; max-height: 90vh; overflow-y: auto;">
                    <div style="background: linear-gradient(135deg, #43e97b, #38f9d7); color: white; padding: 32px; text-align: center; border-radius: 24px 24px 0 0;">
                        <h2 style="margin: 0 0 8px 0; font-size: 2.2rem;">üõí An√°lisis de Ventas</h2>
                        <p style="margin: 0; opacity: 0.9;">Productos m√°s vendidos y tendencias</p>
                    </div>
                    
                    <div style="padding: 32px;">
                        <!-- Productos m√°s vendidos -->
                        <div style="margin-bottom: 32px;">
                            <h3 style="color: #374151; margin-bottom: 20px; display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-crown" style="color: #F59E0B;"></i>
                                Top 5 Productos m√°s Vendidos
                            </h3>
                            <div style="display: grid; gap: 16px;">
                                <div style="background: #f8fafc; padding: 20px; border-radius: 12px; border-left: 4px solid #F59E0B; display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h4 style="margin: 0 0 4px 0; color: #374151;">Producto Premium A</h4>
                                        <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">145 ventas realizadas</p>
                                    </div>
                                    <div style="text-align: right;">
                                        <p style="margin: 0; font-size: 1.1rem; font-weight: bold; color: #10B981;">$4,350</p>
                                        <p style="margin: 0; font-size: 0.8rem; color: #6b7280;">ingresos</p>
                                    </div>
                                </div>
                                
                                <div style="background: #f8fafc; padding: 20px; border-radius: 12px; border-left: 4px solid #6B7280; display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h4 style="margin: 0 0 4px 0; color: #374151;">Servicio Consultoria</h4>
                                        <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">89 ventas realizadas</p>
                                    </div>
                                    <div style="text-align: right;">
                                        <p style="margin: 0; font-size: 1.1rem; font-weight: bold; color: #10B981;">$8,900</p>
                                        <p style="margin: 0; font-size: 0.8rem; color: #6b7280;">ingresos</p>
                                    </div>
                                </div>
                                
                                <div style="background: #f8fafc; padding: 20px; border-radius: 12px; border-left: 4px solid #6B7280; display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h4 style="margin: 0 0 4px 0; color: #374151;">Producto Popular B</h4>
                                        <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">67 ventas realizadas</p>
                                    </div>
                                    <div style="text-align: right;">
                                        <p style="margin: 0; font-size: 1.1rem; font-weight: bold; color: #10B981;">$2,010</p>
                                        <p style="margin: 0; font-size: 0.8rem; color: #6b7280;">ingresos</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Botones -->
                        <div style="text-align: center;">
                            <button onclick="cerrarModal(this)" style="background: linear-gradient(135deg, #43e97b, #38f9d7); color: white; padding: 14px 32px; border: none; border-radius: 12px; cursor: pointer; font-size: 1rem; font-weight: 600; transition: all 0.3s ease;">
                                <i class="fas fa-times"></i> Cerrar An√°lisis
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        // Cerrar dropdown al hacer click fuera (funci√≥n legacy - ser√° eliminada)
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('analyticsDropdown');
            const button = event.target.closest('[onclick="toggleAnalyticsDropdown()"]');
            
            if (!button && dropdown && dropdown.style.display === 'block') {
                dropdown.style.display = 'none';
            }
        });

        // ====================================================
        // FUNCIONES CORREGIDAS PARA EL WIDGET DE BIENESTAR
        // ====================================================
        
        // FUNCI√ìN CORREGIDA: M√©tricas R√°pidas
        function abrirMetricasRapidasCorregido() {
            console.log('üìä [CORREGIDO] Abriendo m√©tricas r√°pidas...');
            
            // Bloquear scroll del body SOLAMENTE
            document.body.style.overflow = 'hidden';
            
            // NO hacer scroll autom√°tico - dejar la p√°gina donde est√°
            // El modal se mostrar√° centrado en el viewport actual
            
            // Cerrar modal existente si hay uno
            const modalExistente = document.getElementById('metricasRapidasModalCorregido');
            if (modalExistente) {
                modalExistente.remove();
            }
            
            // Obtener m√©tricas actuales
            const productos = document.querySelectorAll('.producto-card, .producto-item').length || 12;
            const servicios = document.querySelectorAll('.servicio-card, .servicio-item').length || 8;
            const ofertas = document.querySelectorAll('.oferta-card, .oferta-item').length || 5;
            const visitas = Math.floor(Math.random() * 500) + 150;
            const ventas = Math.floor(Math.random() * 50) + 25;
            const ingresos = ventas * (Math.random() * 100 + 50);
            
            const modalHTML = `
                <div id="metricasRapidasModalCorregido" style="
                    position: fixed !important; 
                    top: 0 !important; 
                    left: 0 !important; 
                    right: 0 !important; 
                    bottom: 0 !important; 
                    background: rgba(0,0,0,0.7) !important; 
                    display: flex !important; 
                    align-items: center !important; 
                    justify-content: center !important; 
                    z-index: 2147483647 !important; 
                    padding: 20px !important;
                ">
                    <div style="
                        background: white; 
                        border-radius: 15px; 
                        max-width: 500px; 
                        width: 95%; 
                        max-height: 75vh; 
                        overflow-y: auto; 
                        position: relative; 
                        box-shadow: 0 15px 40px rgba(0,0,0,0.25);
                        animation: modalSlideIn 0.3s ease-out;
                    ">
                        <!-- Header Compacto -->
                        <div class="modal-header" style="
                            background: linear-gradient(135deg, #43E97B, #38F9D7); 
                            color: white; 
                            padding: 20px; 
                            text-align: center; 
                            border-radius: 15px 15px 0 0;
                        ">
                            <h2 style="margin: 0 0 5px 0; font-size: 1.6rem;">üìä M√©tricas R√°pidas</h2>
                            <p style="margin: 0; opacity: 0.9; font-size: 0.9rem;">Resumen de tu tienda</p>
                        </div>
                        
                        <!-- Contenido Compacto -->
                        <div class="modal-body" style="padding: 20px;">
                            <!-- M√©tricas principales - VERSI√ìN COMPACTA -->
                            <div class="metrics-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px;">
                                <div class="metric-card" style="background: linear-gradient(135deg, #667EEA, #764BA2); padding: 15px; border-radius: 12px; text-align: center; color: white;">
                                    <div class="metric-number" style="font-size: 1.8rem; font-weight: bold; margin-bottom: 5px;">${visitas}</div>
                                    <div style="font-size: 0.85rem; opacity: 0.9;">üë• Visitas</div>
                                </div>
                                
                                <div class="metric-card" style="background: linear-gradient(135deg, #FA709A, #FEE140); padding: 15px; border-radius: 12px; text-align: center; color: white;">
                                    <div class="metric-number" style="font-size: 1.8rem; font-weight: bold; margin-bottom: 5px;">${ventas}</div>
                                    <div style="font-size: 0.85rem; opacity: 0.9;">üõí Ventas</div>
                                </div>
                                
                                <div class="metric-card" style="background: linear-gradient(135deg, #4FACFE, #00F2FE); padding: 15px; border-radius: 12px; text-align: center; color: white;">
                                    <div class="metric-number" style="font-size: 1.8rem; font-weight: bold; margin-bottom: 5px;">$${Math.round(ingresos)}</div>
                                    <div style="font-size: 0.85rem; opacity: 0.9;">üí∞ Ingresos</div>
                                </div>
                                
                                <div class="metric-card" style="background: linear-gradient(135deg, #10B981, #34D399); padding: 15px; border-radius: 12px; text-align: center; color: white;">
                                    <div class="metric-number" style="font-size: 1.8rem; font-weight: bold; margin-bottom: 5px;">${productos + servicios + ofertas}</div>
                                    <div style="font-size: 0.85rem; opacity: 0.9;">üì¶ Items</div>
                                </div>
                            </div>
                            
                            <!-- Desglose compacto -->
                            <div style="background: #f8fafc; padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                                <h3 style="margin: 0 0 12px 0; color: #374151; text-align: center; font-size: 1rem;">üìà Desglose</h3>
                                <div class="detailed-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; text-align: center;">
                                    <div>
                                        <div style="font-size: 1.4rem; font-weight: bold; color: #10B981;">${productos}</div>
                                        <div style="font-size: 0.8rem; color: #6B7280;">Productos</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 1.4rem; font-weight: bold; color: #3B82F6;">${servicios}</div>
                                        <div style="font-size: 0.8rem; color: #6B7280;">Servicios</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 1.4rem; font-weight: bold; color: #F59E0B;">${ofertas}</div>
                                        <div style="font-size: 0.8rem; color: #6B7280;">Ofertas</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 1.4rem; font-weight: bold; color: #EF4444;">95%</div>
                                        <div style="font-size: 0.8rem; color: #6B7280;">Satisfacci√≥n</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Botones -->
                            <div class="buttons-container" style="text-align: center; display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                                <button onclick="mostrarAnalyticsDetallado(); cerrarModal(this);" style="
                                    background: linear-gradient(135deg, #667EEA, #764BA2); 
                                    color: white; 
                                    border: none; 
                                    padding: 12px 25px; 
                                    border-radius: 10px; 
                                    cursor: pointer; 
                                    font-size: 0.95rem; 
                                    font-weight: 600;
                                    transition: all 0.3s ease;
                                " onmouseover="this.style.transform='translateY(-2px)';" onmouseout="this.style.transform='translateY(0)';">
                                    <i class="fas fa-chart-line"></i> Ver An√°lisis Completo
                                </button>
                                
                                <button onclick="cerrarModal(this)" style="
                                    background: #6B7280; 
                                    color: white; 
                                    border: none; 
                                    padding: 12px 25px; 
                                    border-radius: 10px; 
                                    cursor: pointer; 
                                    font-size: 0.95rem; 
                                    font-weight: 600;
                                    transition: all 0.3s ease;
                                " onmouseover="this.style.background='#4B5563';" onmouseout="this.style.background='#6B7280';">
                                    <i class="fas fa-times"></i> Cerrar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <style>
                    @keyframes modalSlideIn {
                        from { 
                            opacity: 0; 
                            transform: translateY(-50px) scale(0.9); 
                        }
                        to { 
                            opacity: 1; 
                            transform: translateY(0) scale(1); 
                        }
                    }
                    
                    /* Responsive para m√≥vil y tablet */
                    @media (max-width: 768px) {
                        #metricasRapidasModalCorregido .modal-content {
                            max-width: 95vw !important;
                            width: 95vw !important;
                            margin: 5px !important;
                            max-height: 95vh !important;
                            border-radius: 15px !important;
                        }
                        
                        #metricasRapidasModalCorregido .modal-header {
                            padding: 20px 15px !important;
                        }
                        
                        #metricasRapidasModalCorregido .modal-body {
                            padding: 15px !important;
                        }
                        
                        #metricasRapidasModalCorregido .metrics-grid {
                            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)) !important;
                            gap: 12px !important;
                        }
                        
                        #metricasRapidasModalCorregido .metric-card {
                            padding: 15px !important;
                            font-size: 0.9rem !important;
                        }
                        
                        #metricasRapidasModalCorregido .metric-number {
                            font-size: 1.8rem !important;
                        }
                        
                        #metricasRapidasModalCorregido .buttons-container {
                            flex-direction: column !important;
                            gap: 10px !important;
                        }
                        
                        #metricasRapidasModalCorregido button {
                            width: 100% !important;
                            padding: 12px 20px !important;
                            font-size: 0.9rem !important;
                        }
                    }
                    
                    @media (max-width: 480px) {
                        #metricasRapidasModalCorregido {
                            padding: 10px !important;
                        }
                        
                        #metricasRapidasModalCorregido .modal-content {
                            max-width: 100vw !important;
                            width: 100vw !important;
                            margin: 0 !important;
                            border-radius: 10px !important;
                            max-height: 100vh !important;
                        }
                        
                        #metricasRapidasModalCorregido .metrics-grid {
                            grid-template-columns: 1fr 1fr !important;
                            gap: 8px !important;
                        }
                        
                        #metricasRapidasModalCorregido .detailed-grid {
                            grid-template-columns: 1fr 1fr !important;
                        }
                    }
                </style>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Evento para cerrar con clic fuera
            setTimeout(() => {
                const modal = document.getElementById('metricasRapidasModalCorregido');
                if (modal) {
                    modal.addEventListener('click', function(e) {
                        if (e.target.id === 'metricasRapidasModalCorregido') {
                            modal.remove();
                            document.body.style.overflow = ''; // Restaurar scroll
                        }
                    });
                }
            }, 100);
            
            console.log('‚úÖ [CORREGIDO] Modal de m√©tricas creado correctamente');
            mostrarNotificacion('üìä M√©tricas cargadas correctamente', 'success');
        }

        // FUNCI√ìN CORREGIDA: Progreso Empresarial
        function verMiProgresoCorregido() {
            console.log('üìà [CORREGIDO] Abriendo progreso empresarial...');
            
            // Bloquear scroll del body SOLAMENTE (sin mover la p√°gina)
            document.body.style.overflow = 'hidden';
            
            // Cerrar modal existente
            const modalExistente = document.getElementById('progresoEmpresarialModalCorregido');
            if (modalExistente) {
                modalExistente.remove();
            }
            
            const modalHTML = `
                <div id="progresoEmpresarialModalCorregido" style="
                    position: fixed !important; 
                    top: 0 !important; 
                    left: 0 !important; 
                    right: 0 !important; 
                    bottom: 0 !important; 
                    background: rgba(0,0,0,0.7) !important; 
                    display: flex !important; 
                    align-items: center !important; 
                    justify-content: center !important; 
                    z-index: 2147483647 !important; 
                    padding: 20px !important;
                ">
                    <div style="
                        background: white; 
                        border-radius: 15px; 
                        max-width: 700px; 
                        width: 95%; 
                        max-height: 80vh; 
                        overflow-y: auto; 
                        position: relative; 
                        box-shadow: 0 15px 40px rgba(0,0,0,0.25);
                        animation: modalSlideIn 0.3s ease-out;
                    ">
                        <!-- Header compacto - SIN SVG PROBLEM√ÅTICO -->
                        <div style="
                            background: linear-gradient(135deg, #8B5CF6, #6366F1); 
                            background-size: 200% 200%; 
                            animation: gradientFlow 8s ease infinite;
                            color: white; 
                            padding: 20px; 
                            text-align: center; 
                            border-radius: 15px 15px 0 0; 
                            position: relative; 
                            overflow: hidden;
                        ">
                            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 15px 15px; opacity: 0.4;"></div>
                            <div style="position: relative; z-index: 2;">
                                <h2 style="margin: 0 0 5px 0; font-size: 1.6rem; font-weight: 700;">üìà Mi Progreso</h2>
                                <p style="margin: 0; opacity: 0.9; font-size: 0.85rem;">Tu evoluci√≥n emprendedora</p>
                            </div>
                        </div>
                        
                        <!-- Contenido del progreso - COMPACTO -->
                        <div style="padding: 20px;">
                            <!-- M√©tricas de crecimiento compactas -->
                            <div style="margin-bottom: 20px;">
                                <h3 style="color: #374151; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; font-size: 1.1rem;">
                                    <div style="width: 30px; height: 30px; background: linear-gradient(135deg, #FA709A, #FEE140); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-rocket" style="color: white; font-size: 14px;"></i>
                                    </div>
                                    Crecimiento
                                </h3>
                                
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                                    <div style="background: linear-gradient(135deg, #667EEA, #764BA2); padding: 15px; border-radius: 12px; text-align: center; color: white;">
                                        <div style="font-size: 1.8rem; font-weight: bold; margin-bottom: 5px;">üéØ 85%</div>
                                        <div style="font-size: 0.8rem; opacity: 0.9;">Metas</div>
                                    </div>
                                    
                                    <div style="background: linear-gradient(135deg, #43E97B, #38F9D7); padding: 15px; border-radius: 12px; text-align: center; color: white;">
                                        <div style="font-size: 1.8rem; font-weight: bold; margin-bottom: 5px;">üìä +125%</div>
                                        <div style="font-size: 0.8rem; opacity: 0.9;">Crecimiento</div>
                                    </div>
                                    
                                    <div style="background: linear-gradient(135deg, #4FACFE, #00F2FE); padding: 15px; border-radius: 12px; text-align: center; color: white;">
                                        <div style="font-size: 1.8rem; font-weight: bold; margin-bottom: 5px;">‚≠ê 4.8</div>
                                        <div style="font-size: 0.8rem; opacity: 0.9;">Rating</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Hitos alcanzados - COMPACTO -->
                            <div style="margin-bottom: 20px;">
                                <h3 style="color: #374151; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; font-size: 1.1rem;">
                                    <div style="width: 30px; height: 30px; background: linear-gradient(135deg, #43E97B, #38F9D7); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-trophy" style="color: white; font-size: 14px;"></i>
                                    </div>
                                    Logros Recientes
                                </h3>
                                
                                <div style="display: grid; gap: 10px;">
                                    <div style="background: linear-gradient(135deg, #F0FDF4, #DCFCE7); border-left: 4px solid #22C55E; border-radius: 10px; padding: 12px; display: flex; align-items: center; gap: 10px;">
                                        <div style="font-size: 1.5rem;">‚úÖ</div>
                                        <div style="flex: 1;">
                                            <h4 style="margin: 0; color: #166534; font-size: 0.95rem; font-weight: 600;">Primera Venta Online</h4>
                                            <p style="margin: 0; color: #166534; opacity: 0.7; font-size: 0.8rem;">Hace 3 meses</p>
                                        </div>
                                    </div>
                                    
                                    <div style="background: linear-gradient(135deg, #EFF6FF, #DBEAFE); border-left: 4px solid #3B82F6; border-radius: 10px; padding: 12px; display: flex; align-items: center; gap: 10px;">
                                        <div style="font-size: 1.5rem;">üíØ</div>
                                        <div style="flex: 1;">
                                            <h4 style="margin: 0; color: #1E40AF; font-size: 0.95rem; font-weight: 600;">100 Clientes Felices</h4>
                                            <p style="margin: 0; color: #1E40AF; opacity: 0.7; font-size: 0.8rem;">Hace 1 mes</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Pr√≥ximas metas - COMPACTO -->
                            <div style="background: linear-gradient(135deg, #FEF3C7, #FDE68A); padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                                <h3 style="color: #92400E; margin: 0 0 10px 0; font-size: 1rem;">
                                    <i class="fas fa-bullseye"></i> Pr√≥ximas Metas
                                </h3>
                                <div style="display: grid; gap: 8px;">
                                    <div style="background: rgba(255,255,255,0.6); padding: 10px; border-radius: 8px; border-left: 3px solid #D97706;">
                                        <strong style="color: #92400E; font-size: 0.9rem;">üéØ Alcanzar 500 ventas</strong>
                                        <div style="color: #92400E; opacity: 0.8; font-size: 0.75rem; margin-top: 3px;">347/500 (69%)</div>
                                    </div>
                                    <div style="background: rgba(255,255,255,0.6); padding: 10px; border-radius: 8px; border-left: 3px solid #D97706;">
                                        <strong style="color: #92400E; font-size: 0.9rem;">‚≠ê 50 rese√±as 5‚òÖ</strong>
                                        <div style="color: #92400E; opacity: 0.8; font-size: 0.75rem; margin-top: 3px;">32/50 (64%)</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Bot√≥n de cierre -->
                            <div style="text-align: center;">
                                <button onclick="cerrarModal(this)" style="
                                    background: linear-gradient(135deg, #FA709A, #FEE140); 
                                    color: white; 
                                    border: none; 
                                    padding: 15px 35px; 
                                    border-radius: 12px; 
                                    cursor: pointer; 
                                    font-size: 1rem; 
                                    font-weight: 600;
                                    transition: all 0.3s ease;
                                    box-shadow: 0 6px 20px rgba(250, 112, 154, 0.3);
                                " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(250, 112, 154, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 20px rgba(250, 112, 154, 0.3)';">
                                    <i class="fas fa-heart"></i> ¬°Incre√≠ble progreso, sigue as√≠!
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <style>
                    @keyframes float {
                        0%, 100% { transform: translate(0, 0) rotate(0deg); }
                        33% { transform: translate(10px, -10px) rotate(120deg); }
                        66% { transform: translate(-5px, 5px) rotate(240deg); }
                    }
                </style>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Evento para cerrar con clic fuera
            setTimeout(() => {
                const modal = document.getElementById('progresoEmpresarialModalCorregido');
                if (modal) {
                    modal.addEventListener('click', function(e) {
                        if (e.target.id === 'progresoEmpresarialModalCorregido') {
                            modal.remove();
                            document.body.style.overflow = ''; // Restaurar scroll
                        }
                    });
                }
            }, 100);
            
            console.log('‚úÖ [CORREGIDO] Modal de progreso empresarial creado correctamente');
            mostrarNotificacion('üìà Tu progreso empresarial carga perfectamente', 'success');
        }

        // FUNCI√ìN CORREGIDA: Progreso Personal
        function verMiProgresoPersonalCorregido() {
            console.log('üíú [CORREGIDO] Abriendo progreso personal...');
            
            // Bloquear scroll del body SOLAMENTE (sin mover la p√°gina)
            document.body.style.overflow = 'hidden';
            
            // Cerrar modal existente
            const modalExistente = document.getElementById('progresoPersonalModalCorregido');
            if (modalExistente) {
                modalExistente.remove();
            }
            
            const modalHTML = `
                <div id="progresoPersonalModalCorregido" style="
                    position: fixed !important; 
                    top: 0 !important; 
                    left: 0 !important; 
                    right: 0 !important; 
                    bottom: 0 !important; 
                    background: rgba(0,0,0,0.7) !important; 
                    display: flex !important; 
                    align-items: center !important; 
                    justify-content: center !important; 
                    z-index: 2147483647 !important; 
                    padding: 20px !important;
                ">
                    <div style="
                        background: white; 
                        border-radius: 20px; 
                        max-width: 500px; 
                        width: 95%; 
                        max-height: 90vh; 
                        overflow-y: auto; 
                        position: relative; 
                        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                        animation: modalSlideIn 0.4s ease-out;
                    ">
                        <!-- Header hermoso -->
                        <div style="
                            background: linear-gradient(135deg, #8B5CF6, #A78BFA, #F59E0B); 
                            background-size: 200% 200%; 
                            animation: gradientFlow 8s ease infinite; 
                            color: white; 
                            padding: 35px; 
                            text-align: center; 
                            border-radius: 20px 20px 0 0; 
                            position: relative; 
                            overflow: hidden;
                        ">
                            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 20px 20px; opacity: 0.5;"></div>
                            <div style="position: relative; z-index: 2;">
                                <h2 style="margin: 0 0 10px 0; font-size: 2.2rem; font-weight: 700;">üíú Mi Progreso Personal</h2>
                                <p style="margin: 0; opacity: 0.9; font-size: 1.1rem;">Tu crecimiento emocional y bienestar</p>
                            </div>
                        </div>
                        
                        <!-- Contenido del progreso personal -->
                        <div style="padding: 35px;">
                            <!-- Estado emocional -->
                            <div style="margin-bottom: 35px;">
                                <h3 style="color: #374151; margin-bottom: 25px; display: flex; align-items: center; gap: 12px;">
                                    <div style="width: 35px; height: 35px; background: linear-gradient(135deg, #8B5CF6, #A78BFA); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-heart" style="color: white; font-size: 16px;"></i>
                                    </div>
                                    Bienestar Emocional
                                </h3>
                                
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px;">
                                    <div style="background: linear-gradient(135deg, #10B981, #34D399); padding: 25px; border-radius: 15px; text-align: center; color: white; position: relative; overflow: hidden;">
                                        <div style="position: absolute; top: -20px; right: -20px; width: 60px; height: 60px; background: rgba(255,255,255,0.1); border-radius: 50%; animation: pulse 6s infinite;"></div>
                                        <div style="position: relative; z-index: 2;">
                                            <div style="font-size: 2.5rem; margin-bottom: 8px;">üòä</div>
                                            <div style="font-size: 1rem; opacity: 0.9; font-weight: 600;">Estado Actual</div>
                                            <div style="font-size: 0.9rem; opacity: 0.8; margin-top: 5px;">Positiva y motivada</div>
                                        </div>
                                    </div>
                                    
                                    <div style="background: linear-gradient(135deg, #F59E0B, #FBBF24); padding: 25px; border-radius: 15px; text-align: center; color: white; position: relative; overflow: hidden;">
                                        <div style="position: absolute; top: -20px; right: -20px; width: 60px; height: 60px; background: rgba(255,255,255,0.1); border-radius: 50%; animation: pulse 3s infinite 1s;"></div>
                                        <div style="position: relative; z-index: 2;">
                                            <div style="font-size: 2.5rem; margin-bottom: 8px;">üìà</div>
                                            <div style="font-size: 1rem; opacity: 0.9; font-weight: 600;">Crecimiento</div>
                                            <div style="font-size: 0.9rem; opacity: 0.8; margin-top: 5px;">+85% desde el inicio</div>
                                        </div>
                                    </div>
                                    
                                    <div style="background: linear-gradient(135deg, #8B5CF6, #A78BFA); padding: 25px; border-radius: 15px; text-align: center; color: white; position: relative; overflow: hidden;">
                                        <div style="position: absolute; top: -20px; right: -20px; width: 60px; height: 60px; background: rgba(255,255,255,0.1); border-radius: 50%; animation: pulse 3s infinite 2s;"></div>
                                        <div style="position: relative; z-index: 2;">
                                            <div style="font-size: 2.5rem; margin-bottom: 8px;">üßò</div>
                                            <div style="font-size: 1rem; opacity: 0.9; font-weight: 600;">Balance</div>
                                            <div style="font-size: 0.9rem; opacity: 0.8; margin-top: 5px;">Vida-trabajo equilibrada</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Logros personales -->
                            <div style="margin-bottom: 35px;">
                                <h3 style="color: #374151; margin-bottom: 25px; display: flex; align-items: center; gap: 12px;">
                                    <div style="width: 35px; height: 35px; background: linear-gradient(135deg, #10B981, #34D399); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-star" style="color: white; font-size: 16px;"></i>
                                    </div>
                                    Logros Personales Recientes
                                </h3>
                                
                                <div style="display: grid; gap: 15px;">
                                    <div style="background: linear-gradient(135deg, #FEF3C7, #FDE68A); border: 2px solid #F59E0B; border-radius: 15px; padding: 20px; display: flex; align-items: center; gap: 15px;">
                                        <div style="width: 45px; height: 45px; background: linear-gradient(135deg, #F59E0B, #FBBF24); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;">
                                            üåü
                                        </div>
                                        <div style="flex: 1;">
                                            <h4 style="margin: 0 0 5px 0; color: #92400E; font-size: 1.1rem; font-weight: 600;">Constancia en Autocuidado</h4>
                                            <p style="margin: 0; color: #92400E; opacity: 0.8; font-size: 0.95rem;">Has mantenido rutinas de bienestar durante 21 d√≠as consecutivos</p>
                                        </div>
                                        <div style="color: #F59E0B; font-size: 0.9rem; font-weight: 600;">¬°Esta semana!</div>
                                    </div>
                                    
                                    <div style="background: linear-gradient(135deg, #F3E8FF, #E9D5FF); border: 2px solid #8B5CF6; border-radius: 15px; padding: 20px; display: flex; align-items: center; gap: 15px;">
                                        <div style="width: 45px; height: 45px; background: linear-gradient(135deg, #8B5CF6, #A78BFA); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;">
                                            üíù
                                        </div>
                                        <div style="flex: 1;">
                                            <h4 style="margin: 0 0 5px 0; color: #6B21A8; font-size: 1.1rem; font-weight: 600;">Conexi√≥n Emocional</h4>
                                            <p style="margin: 0; color: #6B21A8; opacity: 0.8; font-size: 0.95rem;">Has completado 15 entradas reflexivas en tu diario emocional</p>
                                        </div>
                                        <div style="color: #8B5CF6; font-size: 0.9rem; font-weight: 600;">Este mes</div>
                                    </div>
                                    
                                    <div style="background: linear-gradient(135deg, #ECFDF5, #D1FAE5); border: 2px solid #10B981; border-radius: 15px; padding: 20px; display: flex; align-items: center; gap: 15px;">
                                        <div style="width: 45px; height: 45px; background: linear-gradient(135deg, #10B981, #34D399); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;">
                                            üöÄ
                                        </div>
                                        <div style="flex: 1;">
                                            <h4 style="margin: 0 0 5px 0; color: #065F46; font-size: 1.1rem; font-weight: 600;">Crecimiento Personal</h4>
                                            <p style="margin: 0; color: #065F46; opacity: 0.8; font-size: 0.95rem;">Has desarrollado nuevas habilidades de resiliencia y autoconfianza</p>
                                        </div>
                                        <div style="color: #10B981; font-size: 0.9rem; font-weight: 600;">√öltimos 3 meses</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Estad√≠sticas de bienestar -->
                            <div style="background: linear-gradient(135deg, #FDF2F8, #FCE7F3); padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                                <h3 style="color: #BE185D; margin: 0 0 20px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-chart-pie"></i> Mi √çndice de Bienestar
                                </h3>
                                
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; text-align: center;">
                                    <div>
                                        <div style="font-size: 2.2rem; font-weight: bold; color: #10B981; margin-bottom: 5px;">92%</div>
                                        <div style="color: #BE185D; font-size: 0.9rem; opacity: 0.8;">Satisfacci√≥n Personal</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 2.2rem; font-weight: bold; color: #F59E0B; margin-bottom: 5px;">88%</div>
                                        <div style="color: #BE185D; font-size: 0.9rem; opacity: 0.8;">Balance Emocional</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 2.2rem; font-weight: bold; color: #8B5CF6; margin-bottom: 5px;">95%</div>
                                        <div style="color: #BE185D; font-size: 0.9rem; opacity: 0.8;">Autoconfianza</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 2.2rem; font-weight: bold; color: #EF4444; margin-bottom: 5px;">85%</div>
                                        <div style="color: #BE185D; font-size: 0.9rem; opacity: 0.8;">Manejo del Estr√©s</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Bot√≥n de cierre -->
                            <div style="text-align: center;">
                                <button onclick="cerrarModal(this)" style="
                                    background: linear-gradient(135deg, #8B5CF6, #A78BFA); 
                                    color: white; 
                                    border: none; 
                                    padding: 15px 35px; 
                                    border-radius: 12px; 
                                    cursor: pointer; 
                                    font-size: 1rem; 
                                    font-weight: 600;
                                    transition: all 0.3s ease;
                                    box-shadow: 0 6px 20px rgba(236, 72, 153, 0.3);
                                " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(236, 72, 153, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 20px rgba(236, 72, 153, 0.3)';">
                                    <i class="fas fa-heart"></i> ¬°Sigue cuid√°ndote as√≠ de bien! üíú
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <style>
                    @keyframes gradientFlow {
                        0% { background-position: 0% 50%; }
                        50% { background-position: 100% 50%; }
                        100% { background-position: 0% 50%; }
                    }
                    
                    @keyframes pulse {
                        0%, 100% { transform: scale(1); opacity: 0.6; }
                        50% { transform: scale(1.2); opacity: 0.8; }
                    }
                </style>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Evento para cerrar con clic fuera
            setTimeout(() => {
                const modal = document.getElementById('progresoPersonalModalCorregido');
                if (modal) {
                    modal.addEventListener('click', function(e) {
                        if (e.target.id === 'progresoPersonalModalCorregido') {
                            modal.remove();
                            document.body.style.overflow = ''; // Restaurar scroll
                        }
                    });
                }
            }, 100);
            
            console.log('‚úÖ [CORREGIDO] Modal de progreso personal creado correctamente');
            mostrarNotificacion('üíú Tu progreso personal se ve hermoso', 'success');
        }

        // FUNCI√ìN CORREGIDA: Desaf√≠os y Logros
        function toggleDesafiosLogrosCorregido() {
            console.log('üèÜ [CORREGIDO] Abriendo desaf√≠os y logros...');
            
            // Bloquear scroll del body SOLAMENTE (sin mover la p√°gina)
            document.body.style.overflow = 'hidden';
            
            // Cerrar modal existente
            const modalExistente = document.getElementById('desafiosLogrosModalCorregido');
            if (modalExistente) {
                modalExistente.remove();
            }
            
            const modalHTML = `
                <div id="desafiosLogrosModalCorregido" style="
                    position: fixed !important; 
                    top: 0 !important; 
                    left: 0 !important; 
                    right: 0 !important; 
                    bottom: 0 !important; 
                    background: rgba(0,0,0,0.7) !important; 
                    display: flex !important; 
                    align-items: center !important; 
                    justify-content: center !important; 
                    z-index: 2147483647 !important; 
                    padding: 20px !important;
                ">
                    <div style="
                        background: white; 
                        border-radius: 20px; 
                        max-width: 900px; 
                        width: 95%; 
                        max-height: 90vh; 
                        overflow-y: auto; 
                        position: relative; 
                        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                        animation: modalSlideIn 0.4s ease-out;
                    ">
                        <!-- Header espectacular -->
                        <div style="
                            background: linear-gradient(135deg, #4FACFE, #00F2FE, #1DE9B6); 
                            background-size: 200% 200%; 
                            animation: gradientFlow 5s ease infinite; 
                            color: white; 
                            padding: 35px; 
                            text-align: center; 
                            border-radius: 20px 20px 0 0; 
                            position: relative; 
                            overflow: hidden;
                        ">
                            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 20px 20px; opacity: 0.3;"></div>
                            <div style="position: relative; z-index: 2;">
                                <h2 style="margin: 0 0 10px 0; font-size: 2.2rem; font-weight: 700;">üèÜ Desaf√≠os y Logros</h2>
                                <p style="margin: 0; opacity: 0.9; font-size: 1.1rem;">Completa desaf√≠os y celebra tus logros</p>
                            </div>
                        </div>
                        
                        <!-- Contenido de desaf√≠os y logros -->
                        <div style="padding: 35px;">
                            <!-- Desaf√≠os activos -->
                            <div style="margin-bottom: 35px;">
                                <h3 style="color: #374151; margin-bottom: 25px; display: flex; align-items: center; gap: 12px;">
                                    <div style="width: 35px; height: 35px; background: linear-gradient(135deg, #4FACFE, #00F2FE); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-target" style="color: white; font-size: 16px;"></i>
                                    </div>
                                    Desaf√≠os Activos
                                </h3>
                                
                                <div style="display: grid; gap: 20px;">
                                    <!-- Desaf√≠o 1 -->
                                    <div style="background: linear-gradient(135deg, #EFF6FF, #DBEAFE); border: 2px solid #3B82F6; border-radius: 15px; padding: 25px; position: relative; overflow: hidden;">
                                        <div style="position: absolute; top: 15px; right: 15px; background: linear-gradient(135deg, #3B82F6, #2563EB); color: white; padding: 8px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                                            En progreso
                                        </div>
                                        <div style="margin-right: 120px;">
                                            <h4 style="color: #1E40AF; margin: 0 0 10px 0; font-size: 1.2rem; font-weight: 600;">üìà Vende 50 productos este mes</h4>
                                            <p style="color: #1E40AF; opacity: 0.8; margin: 0 0 15px 0;">Aumenta tus ventas y alcanza tu meta mensual</p>
                                            
                                            <!-- Barra de progreso -->
                                            <div style="background: rgba(59, 130, 246, 0.1); height: 8px; border-radius: 10px; margin-bottom: 10px;">
                                                <div style="background: linear-gradient(135deg, #3B82F6, #2563EB); height: 100%; width: 68%; border-radius: 10px; transition: width 0.3s ease;"></div>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; color: #1E40AF; font-size: 0.9rem; font-weight: 600;">
                                                <span>34 / 50 productos</span>
                                                <span>68%</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Desaf√≠o 2 -->
                                    <div style="background: linear-gradient(135deg, #FEF3C7, #FDE68A); border: 2px solid #F59E0B; border-radius: 15px; padding: 25px; position: relative; overflow: hidden;">
                                        <div style="position: absolute; top: 15px; right: 15px; background: linear-gradient(135deg, #F59E0B, #FBBF24); color: white; padding: 8px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                                            Activo
                                        </div>
                                        <div style="margin-right: 120px;">
                                            <h4 style="color: #92400E; margin: 0 0 10px 0; font-size: 1.2rem; font-weight: 600;">‚≠ê Obt√©n 25 rese√±as de 5 estrellas</h4>
                                            <p style="color: #92400E; opacity: 0.8; margin: 0 0 15px 0;">Mejora la satisfacci√≥n del cliente</p>
                                            
                                            <!-- Barra de progreso -->
                                            <div style="background: rgba(245, 158, 11, 0.1); height: 8px; border-radius: 10px; margin-bottom: 10px;">
                                                <div style="background: linear-gradient(135deg, #F59E0B, #FBBF24); height: 100%; width: 72%; border-radius: 10px; transition: width 0.3s ease;"></div>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; color: #92400E; font-size: 0.9rem; font-weight: 600;">
                                                <span>18 / 25 rese√±as</span>
                                                <span>72%</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Desaf√≠o 3 -->
                                    <div style="background: linear-gradient(135deg, #F0FDF4, #DCFCE7); border: 2px solid #10B981; border-radius: 15px; padding: 25px; position: relative; overflow: hidden;">
                                        <div style="position: absolute; top: 15px; right: 15px; background: linear-gradient(135deg, #10B981, #34D399); color: white; padding: 8px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                                            Nuevo
                                        </div>
                                        <div style="margin-right: 120px;">
                                            <h4 style="color: #065F46; margin: 0 0 10px 0; font-size: 1.2rem; font-weight: 600;">üíö Mant√©n el bienestar 30 d√≠as</h4>
                                            <p style="color: #065F46; opacity: 0.8; margin: 0 0 15px 0;">Cuida tu salud mental y emocional</p>
                                            
                                            <!-- Barra de progreso -->
                                            <div style="background: rgba(16, 185, 129, 0.1); height: 8px; border-radius: 10px; margin-bottom: 10px;">
                                                <div style="background: linear-gradient(135deg, #10B981, #34D399); height: 100%; width: 43%; border-radius: 10px; transition: width 0.3s ease;"></div>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; color: #065F46; font-size: 0.9rem; font-weight: 600;">
                                                <span>13 / 30 d√≠as</span>
                                                <span>43%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Logros conseguidos -->
                            <div style="margin-bottom: 35px;">
                                <h3 style="color: #374151; margin-bottom: 25px; display: flex; align-items: center; gap: 12px;">
                                    <div style="width: 35px; height: 35px; background: linear-gradient(135deg, #F59E0B, #FBBF24); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-trophy" style="color: white; font-size: 16px;"></i>
                                    </div>
                                    Logros Conseguidos
                                </h3>
                                
                                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px;">
                                    <!-- Logro 1 -->
                                    <div style="background: linear-gradient(135deg, #FEF3C7, #FDE68A); border: 3px solid #F59E0B; border-radius: 15px; padding: 20px; text-align: center; position: relative; overflow: hidden;">
                                        <div style="position: absolute; top: -20px; right: -20px; width: 60px; height: 60px; background: rgba(245, 158, 11, 0.2); border-radius: 50%; animation: float 8s ease-in-out infinite;"></div>
                                        <div style="position: relative; z-index: 2;">
                                            <div style="font-size: 3rem; margin-bottom: 10px;">üèÜ</div>
                                            <h4 style="color: #92400E; margin: 0 0 8px 0; font-weight: 600;">Primera Venta Online</h4>
                                            <p style="color: #92400E; opacity: 0.8; margin: 0; font-size: 0.9rem;">Completaste tu primera transacci√≥n digital</p>
                                            <div style="margin-top: 12px; background: rgba(146, 64, 14, 0.1); padding: 8px; border-radius: 8px; font-size: 0.8rem; color: #92400E; font-weight: 600;">
                                                Desbloqueado hace 3 meses
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Logro 2 -->
                                    <div style="background: linear-gradient(135deg, #EFF6FF, #DBEAFE); border: 3px solid #3B82F6; border-radius: 15px; padding: 20px; text-align: center; position: relative; overflow: hidden;">
                                        <div style="position: absolute; top: -20px; right: -20px; width: 60px; height: 60px; background: rgba(59, 130, 246, 0.2); border-radius: 50%; animation: float 4s ease-in-out infinite 1s;"></div>
                                        <div style="position: relative; z-index: 2;">
                                            <div style="font-size: 3rem; margin-bottom: 10px;">üíØ</div>
                                            <h4 style="color: #1E40AF; margin: 0 0 8px 0; font-weight: 600;">Centenar Feliz</h4>
                                            <p style="color: #1E40AF; opacity: 0.8; margin: 0; font-size: 0.9rem;">Alcanzaste 100 clientes satisfechos</p>
                                            <div style="margin-top: 12px; background: rgba(30, 64, 175, 0.1); padding: 8px; border-radius: 8px; font-size: 0.8rem; color: #1E40AF; font-weight: 600;">
                                                Desbloqueado hace 1 mes
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Logro 3 -->
                                    <div style="background: linear-gradient(135deg, #F0FDF4, #DCFCE7); border: 3px solid #10B981; border-radius: 15px; padding: 20px; text-align: center; position: relative; overflow: hidden;">
                                        <div style="position: absolute; top: -20px; right: -20px; width: 60px; height: 60px; background: rgba(16, 185, 129, 0.2); border-radius: 50%; animation: float 4s ease-in-out infinite 2s;"></div>
                                        <div style="position: relative; z-index: 2;">
                                            <div style="font-size: 3rem; margin-bottom: 10px;">üåü</div>
                                            <h4 style="color: #065F46; margin: 0 0 8px 0; font-weight: 600;">Estrella del Bienestar</h4>
                                            <p style="color: #065F46; opacity: 0.8; margin: 0; font-size: 0.9rem;">7 d√≠as consecutivos cuidando tu salud mental</p>
                                            <div style="margin-top: 12px; background: rgba(6, 95, 70, 0.1); padding: 8px; border-radius: 8px; font-size: 0.8rem; color: #065F46; font-weight: 600;">
                                                ¬°Desbloqueado hoy!
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Bot√≥n de cierre -->
                            <div style="text-align: center;">
                                <button onclick="cerrarModal(this)" style="
                                    background: linear-gradient(135deg, #4FACFE, #00F2FE); 
                                    color: white; 
                                    border: none; 
                                    padding: 15px 35px; 
                                    border-radius: 12px; 
                                    cursor: pointer; 
                                    font-size: 1rem; 
                                    font-weight: 600;
                                    transition: all 0.3s ease;
                                    box-shadow: 0 6px 20px rgba(79, 172, 254, 0.3);
                                " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(79, 172, 254, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 20px rgba(79, 172, 254, 0.3)';">
                                    <i class="fas fa-trophy"></i> ¬°Sigue conquistando desaf√≠os!
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Evento para cerrar con clic fuera
            setTimeout(() => {
                const modal = document.getElementById('desafiosLogrosModalCorregido');
                if (modal) {
                    modal.addEventListener('click', function(e) {
                        if (e.target.id === 'desafiosLogrosModalCorregido') {
                            modal.remove();
                            document.body.style.overflow = ''; // Restaurar scroll
                        }
                    });
                }
            }, 100);
            
            console.log('‚úÖ [CORREGIDO] Modal de desaf√≠os y logros creado correctamente');
            mostrarNotificacion('üèÜ Tus desaf√≠os y logros est√°n listos', 'success');
        }
    </script>

    <!-- Widget de Bienestar Flotante - Peque√±o y Discreto - POSICI√ìN OPTIMIZADA -->
    <div id="bienestarWidget" style="
        position: fixed !important;
        bottom: 50% !important;
        left: 50% !important;
        transform: translate(-50%, 50%) !important;
        width: 60px !important;
        height: 60px !important;
        background: linear-gradient(135deg, #8B5CF6, #A78BFA) !important;
        border-radius: 50% !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        cursor: pointer !important;
        z-index: 999999 !important;
        box-shadow: 0 4px 20px rgba(236, 72, 153, 0.3) !important;
        transition: all 0.3s ease !important;
        animation: pulseHeart 6s infinite !important;
    ">
        <i class="fas fa-heart" style="color: white; font-size: 24px;"></i>
    </div>

    <!-- Men√∫ Emergente del Widget - POSICI√ìN CORREGIDA -->
    <div id="bienestarMenu" style="
        position: fixed !important;
        bottom: 90px !important;
        right: 20px !important;
        width: 280px !important;
        background: white !important;
        border-radius: 15px !important;
        box-shadow: 0 10px 40px rgba(0,0,0,0.15) !important;
        z-index: 999998 !important;
        display: none !important;
        animation: slideInUp 0.3s ease !important;
        max-height: 70vh !important;
        overflow-y: auto !important;
    ">
        <!-- Header del men√∫ -->
        <div style="background: linear-gradient(135deg, #8B5CF6, #A78BFA); color: white; padding: 20px; border-radius: 15px 15px 0 0; text-align: center;">
            <h3 style="margin: 0; font-size: 1.2rem;">üíú Mi Espacio</h3>
            <p style="margin: 5px 0 0 0; font-size: 0.9rem; opacity: 0.9;">Cuida tu bienestar</p>
        </div>
        
        <!-- Opciones del men√∫ -->
        <div style="padding: 15px;">
            <div style="display: grid; gap: 10px;" id="bienestarMenuButtons">
                <!-- Progreso Personal -->
                <button data-action="progreso-personal" class="bienestar-btn" style="
                    background: linear-gradient(135deg, #FA709A, #FEE140); 
                    color: white; 
                    border: none; 
                    padding: 12px; 
                    border-radius: 10px; 
                    cursor: pointer; 
                    font-size: 0.9rem; 
                    font-weight: 600;
                    text-align: left;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    transition: all 0.3s ease;
                ">
                    <i class="fas fa-heart" style="font-size: 16px;"></i>
                    <span>Mi Progreso Personal</span>
                </button>
                
                <!-- Progreso Empresarial -->
                <button data-action="progreso-empresarial" class="bienestar-btn" style="
                    background: linear-gradient(135deg, #667EEA, #764BA2); 
                    color: white; 
                    border: none; 
                    padding: 12px; 
                    border-radius: 10px; 
                    cursor: pointer; 
                    font-size: 0.9rem; 
                    font-weight: 600;
                    text-align: left;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    transition: all 0.3s ease;
                ">
                    <i class="fas fa-chart-line" style="font-size: 16px;"></i>
                    <span>Progreso Empresarial</span>
                </button>
                
                <!-- Desaf√≠os y Logros -->
                <button data-action="desafios-logros" class="bienestar-btn" style="
                    background: linear-gradient(135deg, #4FACFE, #00F2FE); 
                    color: white; 
                    border: none; 
                    padding: 12px; 
                    border-radius: 10px; 
                    cursor: pointer; 
                    font-size: 0.9rem; 
                    font-weight: 600;
                    text-align: left;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    transition: all 0.3s ease;
                ">
                    <i class="fas fa-trophy" style="font-size: 16px;"></i>
                    <span>Desaf√≠os y Logros</span>
                </button>
                
                <!-- M√©tricas -->
                <button data-action="metricas" class="bienestar-btn" style="
                    background: linear-gradient(135deg, #43E97B, #38F9D7); 
                    color: white; 
                    border: none; 
                    padding: 12px; 
                    border-radius: 10px; 
                    cursor: pointer; 
                    font-size: 0.9rem; 
                    font-weight: 600;
                    text-align: left;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    transition: all 0.3s ease;
                ">
                    <i class="fas fa-chart-pie" style="font-size: 16px;"></i>
                    <span>M√©tricas R√°pidas</span>
                </button>
                
                <!-- Diario Emocional -->
                <button data-action="diario" class="bienestar-btn" style="
                    background: linear-gradient(135deg, #FFECD2, #FCB69F); 
                    color: #8B4513; 
                    border: none; 
                    padding: 12px; 
                    border-radius: 10px; 
                    cursor: pointer; 
                    font-size: 0.9rem; 
                    font-weight: 600;
                    text-align: left;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    transition: all 0.3s ease;
                ">
                    <i class="fas fa-book-heart" style="font-size: 16px;"></i>
                    <span>Diario Emocional</span>
                </button>
                
                <!-- T√©cnicas de Relajaci√≥n -->
                <button data-action="relajacion" class="bienestar-btn" style="
                    background: linear-gradient(135deg, #D1FAE5, #A7F3D0); 
                    color: #065F46; 
                    border: none; 
                    padding: 12px; 
                    border-radius: 10px; 
                    cursor: pointer; 
                    font-size: 0.9rem; 
                    font-weight: 600;
                    text-align: left;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    transition: all 0.3s ease;
                ">
                    <i class="fas fa-leaf" style="font-size: 16px;"></i>
                    <span>T√©cnicas de Relajaci√≥n</span>
                </button>
                
                <!-- Recursos de Crisis -->
                <button data-action="crisis" class="bienestar-btn" style="
                    background: linear-gradient(135deg, #FEF3C7, #FDE68A); 
                    color: #92400E; 
                    border: none; 
                    padding: 12px; 
                    border-radius: 10px; 
                    cursor: pointer; 
                    font-size: 0.9rem; 
                    font-weight: 600;
                    text-align: left;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    transition: all 0.3s ease;
                ">
                    <i class="fas fa-phone" style="font-size: 16px;"></i>
                    <span>Recursos de Crisis</span>
                </button>
                
                <!-- Centros de Salud -->
                <button data-action="centros-salud" class="bienestar-btn" style="
                    background: linear-gradient(135deg, #DBEAFE, #BFDBFE); 
                    color: #1E40AF; 
                    border: none; 
                    padding: 12px; 
                    border-radius: 10px; 
                    cursor: pointer; 
                    font-size: 0.9rem; 
                    font-weight: 600;
                    text-align: left;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    transition: all 0.3s ease;
                ">
                    <i class="fas fa-hospital" style="font-size: 16px;"></i>
                    <span>Centros de Salud</span>
                </button>
                
                <!-- M√∫sica para Emprendedores -->
                <button data-action="musica-bienestar" class="bienestar-btn" style="
                    background: linear-gradient(135deg, #8B5CF6, #A855F7); 
                    color: white; 
                    border: none; 
                    padding: 12px; 
                    border-radius: 10px; 
                    cursor: pointer; 
                    font-size: 0.9rem; 
                    font-weight: 600;
                    text-align: left;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    transition: all 0.3s ease;
                ">
                    <i class="fas fa-music" style="font-size: 16px;"></i>
                    <span>M√∫sica Motivacional</span>
                </button>
                
                <!-- Consejos Empresariales -->
                <button data-action="consejos-empresariales" class="bienestar-btn" style="
                    background: linear-gradient(135deg, #F59E0B, #F97316); 
                    color: white; 
                    border: none; 
                    padding: 12px; 
                    border-radius: 10px; 
                    cursor: pointer; 
                    font-size: 0.9rem; 
                    font-weight: 600;
                    text-align: left;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    transition: all 0.3s ease;
                ">
                    <i class="fas fa-lightbulb" style="font-size: 16px;"></i>
                    <span>Consejos Empresariales</span>
                </button>
                
                <!-- Consejos de Ventas -->
                <button data-action="consejos-ventas" class="bienestar-btn" style="
                    background: linear-gradient(135deg, #10B981, #059669); 
                    color: white; 
                    border: none; 
                    padding: 12px; 
                    border-radius: 10px; 
                    cursor: pointer; 
                    font-size: 0.9rem; 
                    font-weight: 600;
                    text-align: left;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    transition: all 0.3s ease;
                ">
                    <i class="fas fa-chart-line" style="font-size: 16px;"></i>
                    <span>C√≥mo Crecer Ventas</span>
                </button>
            </div>
        </div>
    </div>

    <style>
        @keyframes pulseHeart {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes slideInUp {
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        /* ===== RESPONSIVE PARA WIDGET DE BIENESTAR ===== */
        @media (max-width: 768px) {
            #bienestarWidget {
                bottom: 30px !important;
                right: 20px !important;
                left: auto !important;
                transform: none !important;
                width: 55px !important;
                height: 55px !important;
                z-index: 999999 !important;
            }
        }
        
        @media (max-width: 480px) {
            #bienestarWidget {
                bottom: 20px !important;
                right: 15px !important;
                width: 50px !important;
                height: 50px !important;
            }
        }
        
        /* Para escritorio - m√°s arriba y centrado */
        @media (min-width: 769px) {
            #bienestarWidget {
                bottom: 40% !important;
                transform: translate(-50%, 50%) !important;
            }
        }
        
        @media (min-width: 1200px) {
            #bienestarWidget {
                bottom: 35% !important;
            }
        }
        
        /* Media queries para el men√∫ del widget - POSICIONADO EN COSTADO DERECHO */
        @media (max-width: 768px) {
            #bienestarWidget {
                bottom: 30px !important;
                right: 30px !important;
                left: auto !important;
                transform: none !important;
                width: 55px !important;
                height: 55px !important;
            }
            
            #bienestarMenu {
                bottom: 30px !important;
                right: 100px !important;
                left: auto !important;
                width: 280px !important;
                max-width: 280px !important;
                transform: none !important;
            }
        }
        
        @media (max-width: 480px) {
            #bienestarWidget {
                bottom: 25px !important;
                right: 25px !important;
                width: 50px !important;
                height: 50px !important;
            }
            
            #bienestarMenu {
                bottom: 25px !important;
                right: 85px !important;
                left: 15px !important;
                width: auto !important;
                max-width: none !important;
                transform: none !important;
            }
        }
        
        /* Para escritorio - men√∫ a la derecha del widget */
        @media (min-width: 769px) {
            #bienestarMenu {
                bottom: 40% !important;
                right: calc(50% - 150px) !important;
                left: auto !important;
                width: 280px !important;
                max-width: 280px !important;
            }
        }
        
        /* Responsive del widget - MEJORADO PARA EVITAR SCROLL */
        /* Ya definido arriba - eliminando duplicado */
        
        /* ===== OPTIMIZACI√ìN DE MODALES PARA M√ìVIL ===== */
        @media (max-width: 768px) {
            .modal {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                padding: 10px !important;
                z-index: 999999 !important;
                overflow-y: auto !important;
            }
            
            .modal > div {
                width: 100% !important;
                max-width: 100% !important;
                max-height: 95vh !important;
                margin: 0 !important;
                border-radius: 10px !important;
                overflow-y: auto !important;
            }
            
            /* Evitar que el body haga scroll cuando hay modales */
            body.modal-open {
                overflow: hidden !important;
                position: fixed !important;
                width: 100% !important;
            }
        }
        
        @media (max-width: 480px) {
            .modal {
                padding: 5px !important;
            }
            
            .modal > div {
                max-height: 98vh !important;
                border-radius: 8px !important;
            }
        }
        
        /* ===== MODALES M√ÅS PEQUE√ëOS ===== */
        .modal > div {
            max-width: 90% !important;
            max-height: 85vh !important;
        }
        
        /* ===== MODAL DE TURNOS ESPEC√çFICO ===== */
        #modalSistemaTurnos {
            display: none !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: rgba(0,0,0,0.8) !important;
            z-index: 999999 !important;
            align-items: center !important;
            justify-content: center !important;
        }
        
        #modalSistemaTurnos.show {
            display: flex !important;
        }
        
        @media (max-width: 768px) {
            .modal > div {
                max-width: 95% !important;
                max-height: 90vh !important;
            }
        }
        
        @media (max-width: 480px) {
            .modal > div {
                max-width: 98% !important;
                max-height: 95vh !important;
            }
        }
    </style>

    <script>
        // ====================================================
        // SISTEMA OPTIMIZADO DE WIDGET DE BIENESTAR
        // ====================================================
        
        // Variables para optimizaci√≥n
        let bienestarMenuVisible = false;
        let bienestarEventsAttached = false;
        
        // Funciones del widget de bienestar - OPTIMIZADAS
        function toggleBienestarMenu() {
            console.log('üíú toggleBienestarMenu ejecutado');
            
            // Verificar si el bienestar est√° deshabilitado manualmente
            const widget = document.getElementById('bienestarWidget');
            if (widget && widget.style.display === 'none') {
                console.log('üíú Widget deshabilitado manualmente');
                if (typeof mostrarNotificacion === 'function') {
                    mostrarNotificacion('üíî El widget de bienestar est√° deshabilitado', 'info');
                }
                return;
            }
            
            const menu = document.getElementById('bienestarMenu');
            if (!menu) {
                console.error('‚ùå Men√∫ de bienestar no encontrado');
                return;
            }
            
            bienestarMenuVisible = !bienestarMenuVisible;
            console.log('üíú Men√∫ visible:', bienestarMenuVisible);
            
            if (bienestarMenuVisible) {
                menu.style.display = 'block';
                menu.style.animation = 'slideInUp 0.3s ease';
                console.log('‚úÖ Men√∫ de bienestar abierto');
                
                // Aplicar event listeners solo cuando se abre el men√∫
                if (!bienestarEventsAttached) {
                    attachBienestarEvents();
                    bienestarEventsAttached = true;
                }
            } else {
                cerrarBienestarMenu();
            }
        }
        
        function cerrarBienestarMenu() {
            const menu = document.getElementById('bienestarMenu');
            if (menu) {
                menu.style.display = 'none';
                bienestarMenuVisible = false;
                console.log('üíú Men√∫ de bienestar cerrado correctamente');
            }
        }
        
        // Funci√≥n optimizada para manejar eventos del men√∫
        function attachBienestarEvents() {
            console.log('üîó Aplicando event listeners optimizados al widget...');
            
            // Event listener √∫nico para todos los botones (Event Delegation)
            const menuButtons = document.getElementById('bienestarMenuButtons');
            if (!menuButtons) return;
            
            // Un solo event listener para todos los clicks
            menuButtons.addEventListener('click', function(e) {
                const button = e.target.closest('.bienestar-btn');
                if (!button) return;
                
                const action = button.getAttribute('data-action');
                handleBienestarAction(action);
                cerrarBienestarMenu();
            });
            
            // Un solo event listener para hover effects
            menuButtons.addEventListener('mouseover', function(e) {
                const button = e.target.closest('.bienestar-btn');
                if (button) {
                    button.style.transform = 'translateY(-2px)';
                }
            });
            
            menuButtons.addEventListener('mouseout', function(e) {
                const button = e.target.closest('.bienestar-btn');
                if (button) {
                    button.style.transform = 'translateY(0)';
                }
            });
            
            console.log('‚úÖ Event listeners optimizados aplicados (3 en lugar de 15)');
        }
        
        // Manejador centralizado de acciones
        function handleBienestarAction(action) {
            console.log('üéØ Ejecutando acci√≥n:', action);
            
            switch(action) {
                case 'progreso-personal':
                    verMiProgresoPersonalCorregido();
                    break;
                case 'progreso-empresarial':
                    verMiProgresoCorregido();
                    break;
                case 'desafios-logros':
                    toggleDesafiosLogrosCorregido();
                    break;
                case 'metricas':
                    abrirMetricasRapidasCorregido();
                    break;
                case 'diario':
                    abrirDiarioEmocional();
                    break;
                case 'relajacion':
                    abrirTecnicasRelajacion();
                    break;
                case 'crisis':
                    abrirRecursosCrisis();
                    break;
                case 'centros-salud':
                    abrirCentrosSalud();
                    break;
                case 'musica-bienestar':
                    mostrarMusicaBienestar();
                    break;
                case 'consejos-empresariales':
                    mostrarConsejosEmpresariales();
                    break;
                case 'consejos-ventas':
                    mostrarConsejosVentas();
                    break;
                default:
                    console.warn('Acci√≥n no reconocida:', action);
            }
        }
        
        // ====================================================
        // FUNCI√ìN GLOBAL PARA CERRAR MODALES Y RESTAURAR SCROLL
        // ====================================================
        
        function cerrarModalYRestaurarScroll(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.remove();
                document.body.style.overflow = ''; // Restaurar scroll
                console.log('‚úÖ Modal cerrado y scroll restaurado:', modalId);
            }
        }
        
        // Crear funci√≥n global en window para usar en onclick
        window.cerrarModalYRestaurarScroll = cerrarModalYRestaurarScroll;
        
        // Inicializar widget cuando el DOM est√© listo - OPTIMIZADO
        function initializeBienestarWidget() {
            const widget = document.getElementById('bienestarWidget');
            if (!widget) return;
            
            // Verificar si el bienestar est√° activado
            const configBienestar = JSON.parse(localStorage.getItem('configuracionBienestar') || '{}');
            if (configBienestar.activo === false) {
                console.log('‚ùå Widget de bienestar oculto - sistema desactivado');
                widget.style.display = 'none !important';
                widget.style.visibility = 'hidden';
                widget.style.opacity = '0';
                return;
            }
            
            // Si est√° activo, asegurar que sea visible
            widget.style.display = 'block';
            widget.style.visibility = 'visible';
            widget.style.opacity = '1';
            
            // Event listener para el widget principal
            widget.addEventListener('click', toggleBienestarMenu);
            
            // Hover effects para el widget
            widget.addEventListener('mouseover', function() {
                this.style.transform = 'scale(1.1)';
                this.style.boxShadow = '0 6px 25px rgba(236, 72, 153, 0.4)';
            });
            
            widget.addEventListener('mouseout', function() {
                this.style.transform = 'scale(1)';
                this.style.boxShadow = '0 4px 20px rgba(236, 72, 153, 0.3)';
            });
            
            console.log('üíú Widget de bienestar inicializado correctamente');
        }
        
        // Cerrar men√∫ al hacer clic fuera - MEJORADO
        function setupClickOutsideHandler() {
            document.addEventListener('click', function(e) {
                if (!bienestarMenuVisible) return;
                
                const widget = document.getElementById('bienestarWidget');
                const menu = document.getElementById('bienestarMenu');
                
                if (widget && menu && 
                    !widget.contains(e.target) && 
                    !menu.contains(e.target)) {
                    cerrarBienestarMenu();
                }
            });
        }
        
        // ====================================================
        // SISTEMA DE NAVEGACI√ìN OPTIMIZADO (SIN EVENT LISTENERS INLINE)
        // ====================================================
        
        function initializeNavigation() {
            const navigation = document.getElementById('adminNavigation');
            if (!navigation) return;
            
            // Un solo event listener para toda la navegaci√≥n
            navigation.addEventListener('click', function(e) {
                const navBtn = e.target.closest('.nav-btn');
                if (!navBtn) return;
                
                const seccion = navBtn.getAttribute('data-seccion');
                if (seccion) {
                    mostrarSeccion(seccion);
                }
            });
            
            console.log('üß≠ [NAVEGACI√ìN] Event delegation aplicado (-8 event listeners)');
        }
        
        // ====================================================
        // SISTEMA DE HEADER OPTIMIZADO
        // ====================================================
        
        function initializeHeader() {
            const header = document.querySelector('.admin-header-right');
            if (!header) return;
            
            // Usar event delegation para todos los botones del header
            header.addEventListener('click', function(e) {
                const btn = e.target.closest('.header-btn');
                if (!btn) return;
                
                const action = btn.getAttribute('data-action');
                switch(action) {
                    case 'feedback':
                        abrirFeedback();
                        break;
                    case 'ver-feedbacks':
                        mostrarSeccion('feedbacks');
                        break;
                    case 'cerrar-sesion':
                        cerrarSesion();
                        break;
                    default:
                        console.warn('Acci√≥n de header no reconocida:', action);
                }
            });
            
            console.log('üéØ [HEADER] Event delegation aplicado (-3 event listeners)');
        }
        
        // Funci√≥n para verificar y ocultar widget de bienestar
        function verificarEstadoBienestar() {
            const widget = document.getElementById('bienestarWidget');
            if (!widget) return;
            
            const configBienestar = JSON.parse(localStorage.getItem('configuracionBienestar') || '{}');
            if (configBienestar.activo === false) {
                console.log('‚ùå Widget de bienestar oculto - sistema desactivado');
                widget.style.display = 'none !important';
                widget.style.visibility = 'hidden';
                widget.style.opacity = '0';
            } else {
                widget.style.display = 'block';
                widget.style.visibility = 'visible';
                widget.style.opacity = '1';
            }
        }
        
        // Auto-inicializaci√≥n del widget y sistemas
        (function() {
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    setTimeout(() => {
                        initializeBienestarWidget();
                        setupClickOutsideHandler();
                        initializeNavigation();
                        initializeHeader();
                        console.log('üöÄ [SISTEMAS] Navegaci√≥n y widget optimizados inicializados');
                    }, 200);
                });
            } else {
                // Si el DOM ya est√° cargado
                setTimeout(() => {
                    initializeBienestarWidget();
                    setupClickOutsideHandler();
                    initializeNavigation();
                    initializeHeader();
                    console.log('üöÄ [SISTEMAS] Navegaci√≥n y widget optimizados inicializados');
                }, 200);
            }
        })();
        
        // Verificar estado del bienestar cada 2 segundos
        setInterval(verificarEstadoBienestar, 2000);
        
        // ELIMINAR WIDGET DE BIENESTAR COMPLETAMENTE
        setInterval(() => {
            const widget = document.getElementById('bienestarWidget');
            if (widget) {
                console.log('üóëÔ∏è ELIMINANDO widget de bienestar...');
                widget.remove();
            }
            
            // Eliminar tambi√©n cualquier notificaci√≥n de bienestar
            const notificaciones = document.querySelectorAll('.notificacion-bienestar, .notificacion-emocional, .notificacion, .alert, .toast');
            notificaciones.forEach(notif => {
                console.log('üóëÔ∏è ELIMINANDO notificaci√≥n...');
                notif.remove();
            });
            
            // Eliminar mensajes de "Estamos aqu√≠ contigo"
            const mensajesBienestar = document.querySelectorAll('[class*="bienestar"], [class*="emocional"], [class*="consejo"]');
            mensajesBienestar.forEach(msg => {
                console.log('üóëÔ∏è ELIMINANDO mensaje de bienestar...');
                msg.remove();
            });
        }, 1000);

        // ====================================================
        // SISTEMA DE OPTIMIZACI√ìN DE RENDIMIENTO
        // ====================================================
        
        // Detectar y optimizar problemas de rendimiento
        function optimizarRendimiento() {
            console.log('üöÄ [OPTIMIZACI√ìN] Iniciando optimizaciones de rendimiento...');
            
            // 1. Debounce para eventos de resize y scroll
            let resizeTimeout;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    console.log('üì± Redimensionando interfaz...');
                    // Optimizar elementos responsivos
                }, 150);
            });
            
            // 2. Optimizar animaciones pesadas
            const reducirAnimaciones = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            if (reducirAnimaciones) {
                document.body.classList.add('reduced-motion');
                console.log('‚ö° Animaciones reducidas para mejor rendimiento');
            }
            
            // 3. Limpiar DOM de elementos hu√©rfanos cada 30 segundos
            setInterval(() => {
                limpiarElementosHuerfanos();
            }, 30000);
            
            // 4. Optimizar memoria con garbage collection manual
            setInterval(() => {
                if (window.gc && typeof window.gc === 'function') {
                    window.gc();
                }
                optimizarMemoria();
            }, 60000);
            
            // 5. Precargar recursos cr√≠ticos
            precargarRecursosCriticos();
            
            console.log('‚úÖ [OPTIMIZACI√ìN] Sistema optimizado correctamente');
        }
        
        // Limpiar elementos DOM hu√©rfanos
        function limpiarElementosHuerfanos() {
            // Remover modales antiguos que puedan quedarse en memoria
            const modalesToRemove = ['progresoModal', 'recursosModal', 'desafiosModal', 'feedbackModal'];
            modalesToRemove.forEach(id => {
                const modal = document.getElementById(id);
                if (modal && !modal.offsetParent) {
                    modal.remove();
                    console.log('üóëÔ∏è [LIMPIEZA] Removido modal hu√©rfano:', id);
                }
            });
            
            // NUEVO: Eliminar TODOS los paneles de bienestar viejos que se crean din√°micamente
            const panelesViejos = document.querySelectorAll('.panel-acceso-rapido-bienestar');
            if (panelesViejos.length > 0) {
                panelesViejos.forEach((panel, index) => {
                    panel.remove();
                    console.log(`üóëÔ∏è [LIMPIEZA] Removido panel de bienestar viejo ${index + 1}`);
                });
            }
            
            // Limpiar event listeners duplicados
            const duplicatedEvents = document.querySelectorAll('[data-event-attached="true"]');
            duplicatedEvents.forEach(el => {
                if (!el.offsetParent) {
                    el.remove();
                }
            });
        }
        
        // Optimizar uso de memoria
        function optimizarMemoria() {
            // Limpiar localStorage de datos antiguos
            const keys = Object.keys(localStorage);
            const now = Date.now();
            const oneDay = 24 * 60 * 60 * 1000;
            
            keys.forEach(key => {
                if (key.includes('temp_') || key.includes('cache_')) {
                    try {
                        const data = JSON.parse(localStorage.getItem(key));
                        if (data && data.timestamp && (now - data.timestamp > oneDay)) {
                            localStorage.removeItem(key);
                            console.log('üßπ [MEMORIA] Limpiado cache antiguo:', key);
                        }
                    } catch (e) {
                        // Ignorar errores de parsing
                    }
                }
            });
            
            // Forzar recolecci√≥n de basura en variables globales
            if (window.temporalData) {
                delete window.temporalData;
            }
        }
        
        // Precargar recursos cr√≠ticos
        function precargarRecursosCriticos() {
            // Precargar Font Awesome si no est√° cargado
            if (!document.querySelector('link[href*="font-awesome"]')) {
                const fontAwesome = document.createElement('link');
                fontAwesome.rel = 'preload';
                fontAwesome.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css';
                fontAwesome.as = 'style';
                fontAwesome.onload = () => {
                    fontAwesome.rel = 'stylesheet';
                };
                document.head.appendChild(fontAwesome);
            }
        }
        
        // Detectar causas espec√≠ficas de lag - VERSI√ìN MEJORADA
        function diagnosticarLag() {
            console.log('üîç [DIAGN√ìSTICO AVANZADO] Analizando causas de lag...');
            
            const causas = [];
            const mejoras = [];
            
            // 1. Verificar cantidad de elementos DOM
            const totalElements = document.querySelectorAll('*').length;
            if (totalElements > 2000) {
                causas.push(`üî¥ Demasiados elementos DOM: ${totalElements} (recomendado < 2000)`);
            } else if (totalElements > 1500) {
                causas.push(`üî∂ Elementos DOM en l√≠mite: ${totalElements} (vigilar crecimiento)`);
            } else {
                mejoras.push(`‚úÖ Elementos DOM √≥ptimos: ${totalElements}`);
            }
            
            // 2. Verificar modales duplicados (MEJORADO)
            const modalIds = [
                'progresoModal', 'recursosModal', 'desafiosModal', 'feedbackModal',
                'metricasRapidasModalCorregido', 'progresoEmpresarialModalCorregido',
                'progresoPersonalModalCorregido', 'desafiosLogrosModalCorregido'
            ];
            
            let modalesDuplicados = 0;
            modalIds.forEach(id => {
                const modals = document.querySelectorAll(`#${id}`);
                if (modals.length > 1) {
                    causas.push(`üî¥ Modales duplicados: ${id} (${modals.length} instancias)`);
                    modalesDuplicados += modals.length - 1;
                }
            });
            
            if (modalesDuplicados === 0) {
                mejoras.push(`‚úÖ Sin modales duplicados`);
            }
            
            // 3. Verificar event listeners INLINE (OPTIMIZADO)
            const elementsWithInlineEvents = document.querySelectorAll('[onclick], [onmouseover], [onmouseout]').length;
            if (elementsWithInlineEvents > 30) {
                causas.push(`üî¥ Demasiados event listeners inline: ${elementsWithInlineEvents} (objetivo < 10)`);
            } else if (elementsWithInlineEvents > 15) {
                causas.push(`üî∂ Event listeners inline aceptables: ${elementsWithInlineEvents} (reducir m√°s)`);
            } else if (elementsWithInlineEvents > 5) {
                mejoras.push(`üî∂ Event listeners inline bajo control: ${elementsWithInlineEvents} (casi √≥ptimo)`);
            } else {
                mejoras.push(`‚úÖ Event listeners inline optimizados: ${elementsWithInlineEvents}`);
            }
            
            // 4. Verificar uso de memoria (MEJORADO)
            if (performance.memory) {
                const memoryUsage = performance.memory.usedJSHeapSize / 1048576; // MB
                const memoryLimit = performance.memory.jsHeapSizeLimit / 1048576; // MB
                const memoryPercent = (memoryUsage / memoryLimit) * 100;
                
                if (memoryPercent > 70) {
                    causas.push(`üî¥ Memoria cr√≠tica: ${Math.round(memoryUsage)}MB (${Math.round(memoryPercent)}%)`);
                } else if (memoryPercent > 50) {
                    causas.push(`üî∂ Memoria alta: ${Math.round(memoryUsage)}MB (${Math.round(memoryPercent)}%)`);
                } else {
                    mejoras.push(`‚úÖ Memoria √≥ptima: ${Math.round(memoryUsage)}MB (${Math.round(memoryPercent)}%)`);
                }
            }
            
            // 5. Verificar localStorage (MEJORADO)
            try {
                const storageSize = new Blob(Object.values(localStorage)).size / 1024; // KB
                if (storageSize > 2048) { // > 2MB
                    causas.push(`üî¥ LocalStorage sobrecargado: ${Math.round(storageSize)}KB`);
                } else if (storageSize > 1024) { // > 1MB
                    causas.push(`üî∂ LocalStorage grande: ${Math.round(storageSize)}KB`);
                } else {
                    mejoras.push(`‚úÖ LocalStorage optimizado: ${Math.round(storageSize)}KB`);
                }
            } catch (e) {
                causas.push(`üî∂ No se pudo verificar localStorage`);
            }
            
            // 6. NUEVO: Verificar rendimiento de animaciones
            const animatedElements = document.querySelectorAll('[style*="animation"], [style*="transition"]').length;
            if (animatedElements > 100) {
                causas.push(`üî∂ Muchas animaciones activas: ${animatedElements}`);
            } else {
                mejoras.push(`‚úÖ Animaciones controladas: ${animatedElements}`);
            }
            
            // 7. NUEVO: Verificar widgets optimizados
            const bienestarWidget = document.getElementById('bienestarWidget');
            const bienestarMenu = document.getElementById('bienestarMenu');
            if (bienestarWidget && bienestarMenu) {
                mejoras.push(`‚úÖ Widget de bienestar optimizado funcionando`);
            }
            
            // Mostrar resultados
            if (mejoras.length > 0) {
                console.log('üéâ [MEJORAS DETECTADAS]:');
                mejoras.forEach(mejora => console.log(mejora));
            }
            
            if (causas.length > 0) {
                console.warn('‚ö†Ô∏è [PROBLEMAS DETECTADOS]:');
                causas.forEach(causa => console.warn(causa));
                
                // Auto-corregir problemas detectados
                autoCorregirProblemas();
            } else {
                console.log('üöÄ [DIAGN√ìSTICO] ¬°Sistema completamente optimizado! Sin problemas de rendimiento detectados');
            }
            
            // Reporte de rendimiento general
            const puntajeOptimizacion = Math.max(0, 100 - (causas.length * 15));
            console.log(`üìä [PUNTAJE DE OPTIMIZACI√ìN]: ${puntajeOptimizacion}/100`);
            
            return { causas, mejoras, puntaje: puntajeOptimizacion };
        }
        
        // Funci√≥n OPTIMIZADA para animaciones suaves y conexiones lentas
        function optimizarAnimacionesSuaves() {
            console.log('üöÄ [OPTIMIZACI√ìN SUAVE] Optimizando animaciones para conexiones lentas...');
            
            // Crear estilo para animaciones suaves pero optimizadas
            const style = document.createElement('style');
            style.id = 'optimizacion-animaciones-suaves';
            style.textContent = `
                /* ANIMACIONES SUAVES OPTIMIZADAS */
                *, *::before, *::after {
                    animation-duration: 0.3s !important;
                    animation-delay: 0s !important;
                    transition-duration: 0.2s !important;
                    transition-delay: 0s !important;
                    animation-iteration-count: 1 !important;
                }
                
                /* Animaciones suaves y ligeras */
                @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.95; } }
                @keyframes fadeIn { from { opacity: 0.8; } to { opacity: 1; } }
                @keyframes slideIn { from { transform: translateY(10px); } to { transform: translateY(0); } }
                @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-3px); } }
                
                /* Efectos hover suaves */
                *:hover {
                    transform: scale(1.02) !important;
                    transition: all 0.2s ease !important;
                }
                
                /* Optimizar elementos espec√≠ficos */
                .producto-card, .servicio-card, .oferta-card, .action-card {
                    transition: all 0.2s ease !important;
                }
                
                /* Animaciones de scroll suaves */
                html { scroll-behavior: smooth !important; }
                
                /* Widget de bienestar con animaciones suaves */
                #bienestarWidget, #bienestarMenu {
                    transition: all 0.3s ease !important;
                }
                
                /* Optimizaci√≥n para conexiones lentas */
                @media (prefers-reduced-motion: reduce) {
                    *, *::before, *::after {
                        animation-duration: 0.1s !important;
                        transition-duration: 0.1s !important;
                    }
                }
            `;
            
            // Remover estilo anterior si existe
            const estiloAnterior = document.getElementById('optimizacion-animaciones');
            if (estiloAnterior) {
                estiloAnterior.remove();
            }
            
            document.head.appendChild(style);
            
            console.log('‚úÖ [OPTIMIZACI√ìN] Animaciones suaves aplicadas');
        }
        
        // Auto-corregir problemas de rendimiento
        function autoCorregirProblemas() {
            console.log('üîß [AUTO-CORRECCI√ìN] Aplicando correcciones autom√°ticas...');
            
            // DESACTIVAR optimizaci√≥n de animaciones que causa problemas
            console.log('üö´ [DESACTIVADO] Optimizador de animaciones desactivado para evitar interferencia con el mouse');
        
        // DESACTIVAR optimizaci√≥n inmediata que causa problemas
        console.log('üö´ [DESACTIVADO] Optimizaci√≥n inmediata desactivada');
            
            // Remover modales duplicados
            const modalIds = ['progresoModal', 'recursosModal', 'desafiosModal', 'feedbackModal'];
            modalIds.forEach(id => {
                const modals = document.querySelectorAll(`#${id}`);
                for (let i = 1; i < modals.length; i++) {
                    modals[i].remove();
                    console.log('üóëÔ∏è [AUTO-CORRECCI√ìN] Removido modal duplicado:', id);
                }
            });
            
            // Optimizar im√°genes grandes
            const images = document.querySelectorAll('img[src*="picsum"], img[src*="unsplash"]');
            images.forEach(img => {
                if (img.naturalWidth > 400) {
                    img.loading = 'lazy';
                    console.log('üì∑ [AUTO-CORRECCI√ìN] Lazy loading aplicado a imagen');
                }
            });
            
            // Deferrar scripts no cr√≠ticos
            const scripts = document.querySelectorAll('script[src]:not([defer]):not([async])');
            scripts.forEach((script, index) => {
                if (index > 2) { // Deferrar scripts despu√©s de los primeros 2
                    script.defer = true;
                }
            });
        }
        
        // Monitoreo continuo de rendimiento
        function monitorearRendimiento() {
            console.log('üìä [MONITOR] Iniciando monitoreo de rendimiento...');
            
            // Monitorear cada 10 segundos
            setInterval(() => {
                const startTime = performance.now();
                
                // Test simple de rendimiento
                for (let i = 0; i < 1000; i++) {
                    document.createElement('div');
                }
                
                const endTime = performance.now();
                const tiempo = endTime - startTime;
                
                if (tiempo > 10) { // M√°s de 10ms para crear 1000 elementos
                    console.warn('üêå [MONITOR] Rendimiento degradado detectado:', Math.round(tiempo), 'ms');
                    // Aplicar optimizaciones adicionales
                    limpiarElementosHuerfanos();
                }
            }, 10000);
        }
        
        // ====================================================
        // SISTEMA GLOBAL DE ELIMINACI√ìN DE EVENT LISTENERS INLINE
        // ====================================================
        
        function eliminarTodosLosEventListenersInline() {
            console.log('üó°Ô∏è [EXTERMINATOR] Eliminando TODOS los event listeners inline...');
            
            let eliminados = 0;
            
            // 1. Eliminar TODOS los onclick
            const elementosConClick = document.querySelectorAll('[onclick]');
            elementosConClick.forEach(el => {
                const clickAction = el.getAttribute('onclick');
                el.removeAttribute('onclick');
                el.setAttribute('data-original-onclick', clickAction);
                el.classList.add('needs-click-handler');
                eliminados++;
            });
            
            // 2. Eliminar TODOS los onmouseover
            const elementosConMouseover = document.querySelectorAll('[onmouseover]');
            elementosConMouseover.forEach(el => {
                const hoverAction = el.getAttribute('onmouseover');
                el.removeAttribute('onmouseover');
                el.setAttribute('data-original-mouseover', hoverAction);
                el.classList.add('needs-hover-handler');
                eliminados++;
            });
            
            // 3. Eliminar TODOS los onmouseout
            const elementosConMouseout = document.querySelectorAll('[onmouseout]');
            elementosConMouseout.forEach(el => {
                const mouseoutAction = el.getAttribute('onmouseout');
                el.removeAttribute('onmouseout');
                el.setAttribute('data-original-mouseout', mouseoutAction);
                el.classList.add('needs-mouseout-handler');
                eliminados++;
            });
            
            console.log(`üó°Ô∏è [EXTERMINATOR] ${eliminados} event listeners inline ELIMINADOS completamente`);
            
            // Ahora crear los event listeners program√°ticos
            crearEventListenersProgramaticos();
            
            return eliminados;
        }
        
        function crearEventListenersProgramaticos() {
            console.log('üîó [CONSTRUCTOR] Creando event listeners program√°ticos optimizados...');
            
            let creados = 0;
            
            // 1. Event delegation global para clicks
            document.addEventListener('click', function(e) {
                const element = e.target.closest('[data-original-onclick]');
                if (!element) return;
                
                const originalClick = element.getAttribute('data-original-onclick');
                if (!originalClick) return;
                
                // Solo ejecutar si es un click real del usuario, no autom√°tico
                if (e.isTrusted) {
                    try {
                        // Evaluar la funci√≥n original de forma segura
                        new Function(originalClick).call(element);
                        creados++;
                    } catch (error) {
                        console.warn('‚ùå Error ejecutando onclick:', originalClick, error);
                    }
                }
            });
            
            // 2. Event delegation global para hover effects
            document.addEventListener('mouseover', function(e) {
                const element = e.target.closest('[data-original-mouseover]');
                if (!element) return;
                
                const originalHover = element.getAttribute('data-original-mouseover');
                if (!originalHover) return;
                
                try {
                    new Function(originalHover).call(element);
                } catch (error) {
                    console.warn('‚ùå Error ejecutando onmouseover:', originalHover, error);
                }
            });
            
            document.addEventListener('mouseout', function(e) {
                const element = e.target.closest('[data-original-mouseout]');
                if (!element) return;
                
                const originalMouseout = element.getAttribute('data-original-mouseout');
                if (!originalMouseout) return;
                
                try {
                    new Function(originalMouseout).call(element);
                } catch (error) {
                    console.warn('‚ùå Error ejecutando onmouseout:', originalMouseout, error);
                }
            });
            
            console.log('üîó [CONSTRUCTOR] Event listeners program√°ticos creados (solo 3 globales)');
        }
        
        // Inicializar sistema de optimizaci√≥n COMPLETO al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                console.log('üöÄ [INICIANDO] Sistema completo de optimizaci√≥n...');
                
                // PASO 1: Eliminar todos los event listeners inline
                const eliminados = eliminarTodosLosEventListenersInline();
                
                // PASO 2: Optimizaciones b√°sicas
                optimizarRendimiento();
                
                // PASO 3: Optimizaciones espec√≠ficas para el lag del widget
                optimizarWidgetBienestar();
                optimizarReflowsRepaints();
                optimizarRecursosPesados();
                
                // PASO 4: Diagn√≥stico y monitoreo
                const diagnostico = diagnosticarLag();
                monitorearRendimiento();
                
                // PASO 5: Notificar al usuario sobre las mejoras
                notificarOptimizaciones();
                
                console.log(`üéØ [COMPLETADO] Sistema COMPLETAMENTE optimizado - ${eliminados} event listeners eliminados`);
                console.log(`üìä [PUNTAJE FINAL]: ${diagnostico.puntaje}/100`);
                
                // PASO 6: Activar vigilancia continua de widgets viejos
                activarVigilanciaWidgetsViejos();
                
                // Mostrar resultado exitoso - DESACTIVADO
                // setTimeout(() => {
                //     mostrarNotificacion('üöÄ ¬°Sistema completamente optimizado! Event listeners reducidos masivamente', 'success', 4000);
                // }, 2000);
                
            }, 1000); // Esperar 1 segundo despu√©s de que cargue el DOM
        });
        
        // ====================================================
        // VIGILANCIA CONTINUA PARA ELIMINAR WIDGETS VIEJOS
        // ====================================================
        
        function activarVigilanciaWidgetsViejos() {
            console.log('üëÅÔ∏è [VIGILANCIA] Activando detector de widgets viejos...');
            
            // Eliminar inmediatamente cualquier panel viejo existente
            const eliminarPanelesViejos = () => {
                const panelesViejos = document.querySelectorAll('.panel-acceso-rapido-bienestar');
                if (panelesViejos.length > 0) {
                    panelesViejos.forEach((panel, index) => {
                        panel.remove();
                        console.log(`üóëÔ∏è [VIGILANCIA] Panel viejo ${index + 1} eliminado autom√°ticamente`);
                    });
                }
            };
            
            // Ejecutar limpieza inmediata
            eliminarPanelesViejos();
            
            // Verificar cada segundo si aparecen paneles viejos
            setInterval(() => {
                eliminarPanelesViejos();
            }, 1000);
            
            // MutationObserver para detectar cuando se agreguen widgets viejos
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    mutation.addedNodes.forEach((node) => {
                        if (node.nodeType === 1) { // Es un elemento
                            // Si es el panel viejo directamente
                            if (node.classList && node.classList.contains('panel-acceso-rapido-bienestar')) {
                                node.remove();
                                console.log('üóëÔ∏è [VIGILANCIA] Panel viejo detectado y eliminado instant√°neamente!');
                            }
                            
                            // Si contiene paneles viejos dentro
                            const panelesInternos = node.querySelectorAll && node.querySelectorAll('.panel-acceso-rapido-bienestar');
                            if (panelesInternos && panelesInternos.length > 0) {
                                panelesInternos.forEach(panel => {
                                    panel.remove();
                                    console.log('üóëÔ∏è [VIGILANCIA] Panel viejo interno detectado y eliminado!');
                                });
                            }
                        }
                    });
                });
            });
            
            // Observar cambios en todo el body
            observer.observe(document.body, {
                childList: true,
                subtree: true
            });
            
            console.log('‚úÖ [VIGILANCIA] Detector activo - Cualquier widget viejo ser√° eliminado autom√°ticamente');
        }
        
        // ====================================================
        // OPTIMIZACIONES FINALES DE RENDIMIENTO
        // ====================================================
        
        // Funci√≥n para optimizar espec√≠ficamente el lag del widget
        function optimizarWidgetBienestar() {
            const widget = document.getElementById('bienestarWidget');
            const menu = document.getElementById('bienestarMenu');
            
            if (widget && menu) {
                // Forzar hardware acceleration
                widget.style.willChange = 'transform';
                menu.style.willChange = 'opacity, transform';
                
                // Optimizar z-index para evitar repaint costly
                widget.style.zIndex = '9999';
                menu.style.zIndex = '9998';
                
                console.log('üöÄ Widget de bienestar optimizado para rendimiento');
            }
        }
        
        // Funci√≥n para reducir reflows y repaints
        function optimizarReflowsRepaints() {
            // Evitar cambios de layout durante animaciones
            document.documentElement.style.contain = 'layout style paint';
            
            // Optimizar rendering de gradientes
            const gradientElements = document.querySelectorAll('[style*="linear-gradient"]');
            gradientElements.forEach(el => {
                if (el.tagName === 'BUTTON' || el.classList.contains('btn')) {
                    el.style.willChange = 'transform';
                }
            });
            
            console.log('üé® Optimizados reflows y repaints');
        }
        
        // Funci√≥n para optimizar im√°genes y recursos pesados
        function optimizarRecursosPesados() {
            // Lazy loading para im√°genes grandes
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                if (!img.hasAttribute('loading')) {
                    img.loading = 'lazy';
                }
            });
            
            // Optimizar CSS cr√≠tico
            const criticalCSS = document.querySelector('style');
            if (criticalCSS) {
                criticalCSS.media = 'screen';
            }
            
            console.log('üì∑ Recursos pesados optimizados');
        }
        
        // Sistema de notificaciones optimizado para el usuario
        function notificarOptimizaciones() {
            // Solo notificar si hay mejoras significativas
            setTimeout(() => {
                const diagnostico = diagnosticarLag();
                if (diagnostico.puntaje >= 85) {
                    // mostrarNotificacion('üöÄ Sistema optimizado! Rendimiento mejorado significativamente', 'success', 3000);
                } else if (diagnostico.puntaje >= 70) {
                    // mostrarNotificacion('‚ö° Optimizaciones aplicadas. Rendimiento mejorado', 'info', 2000);
                }
            }, 2000);
        }
        
        // Exportar funciones para debugging manual - MEJORADAS
        window.cresaliaDebug = {
            optimizar: optimizarRendimiento,
            diagnosticar: diagnosticarLag,
            limpiar: limpiarElementosHuerfanos,
            memoria: optimizarMemoria,
            widget: optimizarWidgetBienestar,
            reflows: optimizarReflowsRepaints,
            recursos: optimizarRecursosPesados,
            animaciones: optimizarAnimacionesSuaves,
            test: function() {
                console.log('üß™ [TEST COMPLETO] Ejecutando todas las optimizaciones...');
                optimizarRendimiento();
                optimizarWidgetBienestar();
                optimizarReflowsRepaints(); 
                optimizarRecursosPesados();
                optimizarAnimacionesSuaves();
                return diagnosticarLag();
            }
        };
        
        console.log('üöÄ Sistema de optimizaci√≥n AVANZADO de Cresalia cargado.');
        console.log('üí° Usa window.cresaliaDebug.test() para optimizaci√≥n completa manual.');
        
        // ===== FUNCI√ìN GLOBAL PARA CERRAR MODALES (COMENTADA - USAR LA DE ARRIBA) =====
        /*window.cerrarModal = function(button) {
            try {
                console.log('üîç [CERRAR MODAL] Buscando modal para cerrar...');
                
                // Buscar el modal m√°s cercano
                let modal = button.closest('.modal');
                if (!modal) {
                    console.log('üîç [CERRAR MODAL] No se encontr√≥ clase .modal, buscando alternativas...');
                    // Si no tiene clase modal, buscar el div padre con position fixed
                    modal = button.closest('div[style*="position: fixed"]');
                }
                if (!modal) {
                    console.log('üîç [CERRAR MODAL] No se encontr√≥ position fixed, buscando z-index...');
                    // Buscar por z-index alto
                    modal = button.closest('div[style*="z-index"]');
                }
                if (!modal) {
                    console.log('üîç [CERRAR MODAL] No se encontr√≥ z-index, buscando background rgba...');
                    // Buscar cualquier div padre que tenga estilos de modal
                    modal = button.closest('div[style*="background: rgba"]');
                }
                if (!modal) {
                    console.log('üîç [CERRAR MODAL] No se encontr√≥ background rgba, buscando por ID...');
                    // Buscar por ID que contenga "Modal"
                    modal = button.closest('div[id*="Modal"]');
                }
                if (!modal) {
                    console.log('üîç [CERRAR MODAL] No se encontr√≥ ID Modal, buscando cualquier div padre...');
                    // Como √∫ltimo recurso, buscar cualquier div padre
                    modal = button.closest('div');
                }
                if (!modal) {
                    console.log('üîç [CERRAR MODAL] No se encontr√≥ background rgba, buscando por ID espec√≠fico...');
                    // Buscar por ID espec√≠fico si el bot√≥n tiene referencia
                    const buttonText = button.innerHTML.toLowerCase();
                    if (buttonText.includes('analytics')) {
                        modal = document.getElementById('analyticsModal');
                    } else if (buttonText.includes('m√©tricas')) {
                        modal = document.getElementById('metricasRapidasModal');
                    } else if (buttonText.includes('progreso')) {
                        modal = document.getElementById('progresoEmpresarialModalCorregido') || 
                                document.getElementById('progresoPersonalModalCorregido');
                    } else if (buttonText.includes('desaf√≠o')) {
                        modal = document.getElementById('desafiosLogrosModalCorregido');
                    }
                }
                
                if (modal) {
                    // Controlar scroll en m√≥vil al cerrar
                    if (typeof controlarScrollMovil === 'function') {
                        controlarScrollMovil(false);
                    }
                    modal.remove();
                    console.log('‚úÖ Modal cerrado correctamente');
                } else {
                    console.warn('‚ö†Ô∏è No se pudo encontrar el modal para cerrar');
                    // Fallback: cerrar el √∫ltimo modal creado
                    const modals = document.querySelectorAll('div[style*="position: fixed"]');
                    if (modals.length > 0) {
                        const lastModal = modals[modals.length - 1];
                        if (lastModal && lastModal.remove) {
                            lastModal.remove();
                            console.log('‚úÖ Modal cerrado por fallback');
                        }
                    }
                }
            } catch (error) {
                console.error('‚ùå Error al cerrar modal:', error);
            }
        }
        
        // Hacer la funci√≥n global
        }*/
        
        // ===== FUNCI√ìN PARA CONTROLAR SCROLL EN M√ìVIL =====
        function controlarScrollMovil(abrir = true) {
            if (window.innerWidth <= 768) {
                if (abrir) {
                    // Guardar posici√≥n actual del scroll
                    const scrollY = window.scrollY;
                    document.body.style.position = 'fixed';
                    document.body.style.top = `-${scrollY}px`;
                    document.body.style.width = '100%';
                    document.body.classList.add('modal-open');
                } else {
                    // Restaurar scroll
                    const scrollY = document.body.style.top;
                    document.body.style.position = '';
                    document.body.style.top = '';
                    document.body.style.width = '';
                    document.body.classList.remove('modal-open');
                    window.scrollTo(0, parseInt(scrollY || '0') * -1);
                }
            }
        }
        
        // Hacer la funci√≥n global
        window.controlarScrollMovil = controlarScrollMovil;
        
        // ===== FUNCI√ìN DE PRUEBA PARA VERIFICAR MODALES =====
        function testModales() {
            console.log('üß™ [TEST MODALES] Verificando funciones de modales...');
            
            const funciones = [
                'configurarCresaliaBot',
                'configurarAliasProfesional', 
                'mostrarHistorialVentas',
                'mostrarMapaUbicaciones',
                'mostrarConfiguracionBienestar',
                'abrirSistemaTurnos'
            ];
            
            let disponibles = 0;
            let noDisponibles = 0;
            
            funciones.forEach(func => {
                if (typeof window[func] === 'function') {
                    console.log(`‚úÖ ${func}: DISPONIBLE`);
                    disponibles++;
                } else {
                    console.log(`‚ùå ${func}: NO DISPONIBLE`);
                    noDisponibles++;
                }
            });
            
            console.log(`üß™ [TEST MODALES] Resultado: ${disponibles}/${funciones.length} funciones disponibles`);
            
            if (noDisponibles > 0) {
                console.log('üîß [TEST MODALES] Intentando cargar funciones faltantes...');
                
                // Intentar cargar funciones faltantes
                if (typeof window.mostrarHistorialVentas !== 'function' && typeof HISTORIAL_VENTAS !== 'undefined') {
                    window.mostrarHistorialVentas = HISTORIAL_VENTAS.mostrar.bind(HISTORIAL_VENTAS);
                    console.log('‚úÖ mostrarHistorialVentas: CARGADA');
                }
                
                if (typeof window.mostrarMapaUbicaciones !== 'function' && typeof SISTEMA_UBICACIONES !== 'undefined') {
                    window.mostrarMapaUbicaciones = SISTEMA_UBICACIONES.mostrarMapaUbicaciones.bind(SISTEMA_UBICACIONES);
                    console.log('‚úÖ mostrarMapaUbicaciones: CARGADA');
                }
                
                if (typeof window.mostrarConfiguracionBienestar !== 'function' && typeof CONFIGURACION_BIENESTAR !== 'undefined') {
                    window.mostrarConfiguracionBienestar = CONFIGURACION_BIENESTAR.mostrarConfiguracionBienestar.bind(CONFIGURACION_BIENESTAR);
                    console.log('‚úÖ mostrarConfiguracionBienestar: CARGADA');
                }
            }
            
            console.log('üß™ [TEST MODALES] Verificaci√≥n completada');
        }
        
        // Hacer la funci√≥n de prueba global
        window.testModales = testModales;
        
        // ===== FUNCIONES DE ALIAS PROFESIONAL =====
        function configurarAliasProfesional() {
            console.log('üë§ Configurando alias profesional...');
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 99999; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.className = 'modal';
            modal.innerHTML = `
                <div style="background: white; border-radius: 15px; max-width: 600px; width: 100%; max-height: 90vh; overflow-y: auto;">
                    <div style="padding: 20px; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0; color: #374151;">üë§ Mi Alias Profesional</h3>
                        <button onclick="cerrarModal(this)" style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
                    </div>
                    <div style="padding: 20px;">
                        <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #3b82f6;">
                            <h4 style="margin: 0 0 10px 0; color: #1e40af;">üí° ¬øQu√© es un Alias Profesional?</h4>
                            <p style="margin: 0; color: #1e40af; font-size: 0.9rem;">
                                Tu alias es el nombre con el que trabajar√°s en la comunidad. Puedes usar un nombre diferente al real para mayor privacidad y profesionalismo.
                            </p>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">Alias Profesional:</label>
                            <input type="text" id="aliasProfesional" placeholder="Ej: Ana_Emprendedora, Carlos_Ventas, etc." 
                                   style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            <small style="color: #6b7280; margin-top: 5px; display: block;">
                                Este ser√° tu nombre visible en la comunidad de vendedores
                            </small>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">Especialidad:</label>
                            <select id="especialidadAlias" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                <option value="">Selecciona tu especialidad</option>
                                <option value="moda">üëó Moda y Accesorios</option>
                                <option value="tecnologia">üíª Tecnolog√≠a</option>
                                <option value="hogar">üè† Hogar y Jard√≠n</option>
                                <option value="belleza">üíÑ Belleza y Cuidado Personal</option>
                                <option value="deportes">‚öΩ Deportes y Fitness</option>
                                <option value="libros">üìö Libros y Educaci√≥n</option>
                                <option value="alimentacion">üçé Alimentaci√≥n y Bebidas</option>
                                <option value="servicios">üîß Servicios Profesionales</option>
                                <option value="otro">üîÄ Otra Especialidad</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">Experiencia:</label>
                            <select id="experienciaAlias" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                <option value="principiante">üå± Principiante (0-1 a√±os)</option>
                                <option value="intermedio">üåø Intermedio (1-3 a√±os)</option>
                                <option value="avanzado">üå≥ Avanzado (3+ a√±os)</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">Biograf√≠a Profesional (Opcional):</label>
                            <textarea id="biografiaAlias" placeholder="Cu√©ntanos sobre tu experiencia, logros y lo que te apasiona en el emprendimiento..." 
                                      style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem; min-height: 100px; resize: vertical;"></textarea>
                        </div>
                        
                        <div style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button onclick="cerrarModal(this)" 
                                    style="background: #6b7280; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                            <button onclick="guardarAliasProfesional()" 
                                    style="background: linear-gradient(135deg, #EC4899, #F9A8D4); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-save"></i> Guardar Alias
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de alias profesional agregado al DOM');
            
            // Forzar visibilidad
            modal.style.display = 'flex';
            modal.style.visibility = 'visible';
            modal.style.opacity = '1';
            console.log('‚úÖ Modal de alias profesional forzado a ser visible');
            
            // Controlar scroll en m√≥vil
            controlarScrollMovil(true);
            
            // Cargar datos existentes
            cargarAliasExistente();
        }
        
        function cargarAliasExistente() {
            const aliasData = JSON.parse(localStorage.getItem('alias_profesional') || '{}');
            
            if (aliasData.alias) {
                document.getElementById('aliasProfesional').value = aliasData.alias;
            }
            if (aliasData.especialidad) {
                document.getElementById('especialidadAlias').value = aliasData.especialidad;
            }
            if (aliasData.experiencia) {
                document.getElementById('experienciaAlias').value = aliasData.experiencia;
            }
            if (aliasData.biografia) {
                document.getElementById('biografiaAlias').value = aliasData.biografia;
            }
        }
        
        function guardarAliasProfesional() {
            const alias = document.getElementById('aliasProfesional').value.trim();
            const especialidad = document.getElementById('especialidadAlias').value;
            const experiencia = document.getElementById('experienciaAlias').value;
            const biografia = document.getElementById('biografiaAlias').value.trim();
            
            if (!alias) {
                if (typeof mostrarNotificacion === 'function') {
                    mostrarNotificacion('‚ö†Ô∏è Por favor ingresa tu alias profesional', 'warning');
                } else {
                    alert('‚ö†Ô∏è Por favor ingresa tu alias profesional');
                }
                return;
            }
            
            const aliasData = {
                alias,
                especialidad,
                experiencia,
                biografia,
                fechaCreacion: new Date().toISOString()
            };
            
            localStorage.setItem('alias_profesional', JSON.stringify(aliasData));
            
            if (typeof mostrarNotificacion === 'function') {
                mostrarNotificacion('‚úÖ Alias profesional guardado exitosamente', 'success');
            } else {
                alert('‚úÖ Alias profesional guardado exitosamente');
            }
            
            // Cerrar modal
            document.querySelector('.modal').remove();
        }
    </script>
    
    <!-- ===== SISTEMAS AVANZADOS CRESALIA ===== -->
    <!-- Sistema de Notificaciones Push -->
    <script src="../../js/sistema-notificaciones-push.js"></script>
    
    <!-- Sistema de Seguridad Avanzado -->
    <script src="../../js/sistema-seguridad-avanzado.js"></script>
    
    <!-- Sistema de Analytics Avanzados -->
    <script src="../../js/sistema-analytics-avanzados.js"></script>
    
    <!-- Sistema de IA Avanzada -->
    <script src="../../js/sistema-ia-avanzada.js"></script>
    
    <!-- Sistema de Interconexiones Completo -->
    <script src="../../js/sistema-interconexiones-completo.js"></script>
    
    <!-- Sistema de Personalizaci√≥n Avanzada -->
    <script src="../../js/sistema-personalizacion-avanzada.js"></script>
    
    <!-- Sistema Emocional Din√°mico -->
    <script src="../../js/sistema-emocional-dinamico.js"></script>
    
    <!-- ===== INTEGRACI√ìN DE SISTEMAS AVANZADOS ===== -->
    <script>
        // ====================================================
        // INTEGRACI√ìN DE SISTEMAS AVANZADOS
        // ====================================================
        
        // Funci√≥n para mostrar dashboard completo
        window.mostrarDashboardCompleto = function() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                z-index: 999999 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                padding: 20px !important;
                box-sizing: border-box !important;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 8px; padding: 20px; max-width: 80vw; max-height: 70vh; width: 80%; overflow-y: auto;">
                    <h3 style="color: #667eea; margin-bottom: 15px; font-size: 1.2rem;">üöÄ Dashboard Completo</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <!-- Notificaciones -->
                        <div style="background: #f8fafc; padding: 15px; border-radius: 6px; text-align: center; cursor: pointer; min-height: 80px; display: flex; flex-direction: column; justify-content: center;" onclick="configurarNotificaciones()">
                            <h4 style="margin: 0; color: #667eea; font-size: 1rem;">üîî Notificaciones</h4>
                            <p style="margin: 5px 0; color: #666; font-size: 0.8rem;">Push en tiempo real</p>
                        </div>
                        
                        <!-- Seguridad -->
                        <div style="background: #f8fafc; padding: 15px; border-radius: 6px; text-align: center; cursor: pointer; min-height: 80px; display: flex; flex-direction: column; justify-content: center;" onclick="configurarSeguridad()">
                            <h4 style="margin: 0; color: #dc2626; font-size: 1rem;">üîí Seguridad</h4>
                            <p style="margin: 5px 0; color: #666; font-size: 0.8rem;">Protecci√≥n avanzada</p>
                        </div>
                        
                        <!-- Analytics -->
                        <div style="background: #f8fafc; padding: 15px; border-radius: 6px; text-align: center; cursor: pointer; min-height: 80px; display: flex; flex-direction: column; justify-content: center;" onclick="mostrarDashboardAnalytics()">
                            <h4 style="margin: 0; color: #667eea; font-size: 1rem;">üìä Analytics</h4>
                            <p style="margin: 5px 0; color: #666; font-size: 0.8rem;">M√©tricas en tiempo real</p>
                        </div>
                        
                        <!-- IA -->
                        <div style="background: #f8fafc; padding: 15px; border-radius: 6px; text-align: center; cursor: pointer; min-height: 80px; display: flex; flex-direction: column; justify-content: center;" onclick="mostrarDashboardIA()">
                            <h4 style="margin: 0; color: #667eea; font-size: 1rem;">ü§ñ IA Avanzada</h4>
                            <p style="margin: 5px 0; color: #666; font-size: 0.8rem;">Predicciones y recomendaciones</p>
                        </div>
                        
                        <!-- Interconexiones -->
                        <div style="background: #f8fafc; padding: 15px; border-radius: 6px; text-align: center; cursor: pointer; min-height: 80px; display: flex; flex-direction: column; justify-content: center;" onclick="mostrarDashboardInterconexiones()">
                            <h4 style="margin: 0; color: #667eea; font-size: 1rem;">üîó Interconexiones</h4>
                            <p style="margin: 5px 0; color: #666; font-size: 0.8rem;">Estado del sistema</p>
                        </div>
                        
                        <!-- Personalizaci√≥n -->
                        <div style="background: #f8fafc; padding: 15px; border-radius: 6px; text-align: center; cursor: pointer; min-height: 80px; display: flex; flex-direction: column; justify-content: center;" onclick="mostrarPanelPersonalizacion()">
                            <h4 style="margin: 0; color: #667eea; font-size: 1rem;">üé® Personalizaci√≥n</h4>
                            <p style="margin: 5px 0; color: #666; font-size: 0.8rem;">Temas y colores</p>
                        </div>
                        
                        <!-- Estado Emocional -->
                        <div style="background: #f8fafc; padding: 15px; border-radius: 6px; text-align: center; cursor: pointer; min-height: 80px; display: flex; flex-direction: column; justify-content: center;" onclick="mostrarSelectorEstadoAnimo()">
                            <h4 style="margin: 0; color: #667eea; font-size: 1rem;">üíú Estado Emocional</h4>
                            <p style="margin: 5px 0; color: #666; font-size: 0.8rem;">Logo y colores din√°micos</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                            Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        };
        
        // Funci√≥n para agregar bot√≥n de dashboard completo
        function agregarBotonDashboardCompleto() {
            const dashboard = document.querySelector('.dashboard-grid');
            if (dashboard) {
                const botonDashboard = document.createElement('div');
                botonDashboard.className = 'dashboard-card';
                botonDashboard.style.cssText = `
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    text-align: center;
                    cursor: pointer;
                    transition: all 0.3s ease;
                `;
                botonDashboard.innerHTML = `
                    <div style="padding: 20px;">
                        <i class="fas fa-rocket" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4 style="margin: 0 0 10px 0;">üöÄ Dashboard Completo</h4>
                        <p style="margin: 0; opacity: 0.9;">Sistemas Avanzados</p>
                    </div>
                `;
                
                botonDashboard.onclick = function() {
                    mostrarDashboardCompleto();
                };
                
                botonDashboard.onmouseover = function() {
                    this.style.transform = 'translateY(-5px)';
                    this.style.boxShadow = '0 10px 25px rgba(102, 126, 234, 0.3)';
                };
                
                botonDashboard.onmouseout = function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = 'none';
                };
                
                dashboard.appendChild(botonDashboard);
                
                // Bot√≥n de Bienestar Emocional
                const botonBienestar = document.createElement('div');
                botonBienestar.style.cssText = `
                    background: linear-gradient(135deg, #f093fb, #f5576c);
                    color: white;
                    border-radius: 12px;
                    text-align: center;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    margin-top: 15px;
                `;
                botonBienestar.innerHTML = `
                    <div style="padding: 20px;">
                        <i class="fas fa-heart" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4 style="margin: 0 0 10px 0;">üíú Bienestar Emocional</h4>
                        <p style="margin: 0; opacity: 0.9;">Recursos y Progreso</p>
                    </div>
                `;
                
                botonBienestar.onclick = function() {
                    mostrarSistemaBienestar();
                };
                
                botonBienestar.onmouseover = function() {
                    this.style.transform = 'translateY(-5px)';
                    this.style.boxShadow = '0 10px 25px rgba(240, 147, 251, 0.3)';
                };
                
                botonBienestar.onmouseout = function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = 'none';
                };
                
                dashboard.appendChild(botonBienestar);
            }
        }
        
        // Agregar bot√≥n cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(agregarBotonDashboardCompleto, 1000);
        });
        
        // ===== FUNCIONES DE SUSCRIPCIONES =====
        
        // Seleccionar plan de suscripci√≥n
        window.seleccionarPlan = function(planId) {
            console.log('üöÄ FUNCI√ìN seleccionarPlan EJECUTADA con planId:', planId);
            
            // Prevenir clics m√∫ltiples
            if (window.procesandoPlan) {
                console.log('‚ö†Ô∏è Ya se est√° procesando un plan, espera...');
                return;
            }
            
            window.procesandoPlan = true;
            console.log('üí≥ Seleccionando plan:', planId);
            
            // Mostrar indicador de procesamiento
            window.mostrarNotificacion('‚è≥ Procesando selecci√≥n de plan...', 'info');
            
            const planes = {
                free: {
                    nombre: 'Plan Gratuito',
                    precio: 0,
                    comision: 8
                },
                basic: {
                    nombre: 'Plan B√°sico',
                    precio: 9.99,
                    comision: 5
                },
                premium: {
                    nombre: 'Plan Premium',
                    precio: 19.99,
                    comision: 3
                }
            };
            
            const plan = planes[planId];
            if (!plan) {
                window.mostrarNotificacion('‚ùå Plan no encontrado', 'error');
                window.procesandoPlan = false;
                return;
            }
            
            // Guardar selecci√≥n
            localStorage.setItem('planSeleccionado', JSON.stringify({
                id: planId,
                nombre: plan.nombre,
                precio: plan.precio,
                comision: plan.comision,
                fecha: new Date().toISOString()
            }));
            
            // Mostrar modal de confirmaci√≥n
            console.log('üìã Llamando a mostrarModalConfirmacionPlan con plan:', plan);
            window.mostrarModalConfirmacionPlan(plan);
            console.log('‚úÖ Modal de confirmaci√≥n mostrado');
            
            // Resetear flag despu√©s de un tiempo
            setTimeout(() => {
                window.procesandoPlan = false;
                console.log('üîÑ Flag de procesamiento reseteado');
            }, 3000);
        };
        
        // Mostrar modal de confirmaci√≥n de plan
        window.mostrarModalConfirmacionPlan = function(plan) {
            console.log('üéØ FUNCI√ìN mostrarModalConfirmacionPlan EJECUTADA con plan:', plan);
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.id = 'modalConfirmacionPlan';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                z-index: 9999999 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
            `;
            
            console.log('‚úÖ Modal creado con estilos aplicados');
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 40px; max-width: 500px; width: 90%; text-align: center;">
                    <div style="margin-bottom: 30px;">
                        <i class="fas fa-crown" style="font-size: 3rem; color: #667eea; margin-bottom: 20px;"></i>
                        <h3 style="color: #333; margin-bottom: 10px;">¬°Excelente Elecci√≥n!</h3>
                        <p style="color: #666; margin-bottom: 20px;">Has seleccionado el <strong>${plan.nombre}</strong></p>
                    </div>
                    
                    <div style="background: #f8fafc; padding: 20px; border-radius: 12px; margin-bottom: 30px;">
                        <h4 style="color: #333; margin-bottom: 15px;">üìä Resumen de tu Plan:</h4>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span style="color: #666;">Precio mensual:</span>
                            <strong style="color: #333;">$${plan.precio}</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span style="color: #666;">Comisi√≥n por venta:</span>
                            <strong style="color: #333;">${plan.comision}%</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #666;">+ Comisi√≥n Mercado Pago:</span>
                            <strong style="color: #333;">~4.9%</strong>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-times"></i> Cancelar
                        </button>
                        <button onclick="procesarPagoPlan()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-credit-card"></i> Proceder al Pago
                        </button>
                    </div>
                </div>
            `;
            
            console.log('‚úÖ HTML del modal generado');
            document.body.appendChild(modal);
            console.log('‚úÖ Modal agregado al DOM');
            
            // Verificar que el modal se agreg√≥ correctamente
            setTimeout(() => {
                const modalVerificado = document.getElementById('modalConfirmacionPlan');
                if (modalVerificado) {
                    console.log('‚úÖ Modal verificado en el DOM');
                } else {
                    console.error('‚ùå Modal no encontrado en el DOM');
                }
            }, 100);
        };
        
        // Procesar pago del plan con verificaci√≥n manual
        window.procesarPagoPlan = function() {
            const planData = JSON.parse(localStorage.getItem('planSeleccionado') || '{}');
            
            if (!planData.id) {
                mostrarNotificacion('‚ùå No se encontr√≥ informaci√≥n del plan', 'error');
                return;
            }
            
            // Mostrar modal de verificaci√≥n de pago
            mostrarModalVerificacionPago(planData);
        };
        
        // Modal de verificaci√≥n de pago manual
        function mostrarModalVerificacionPago(planData) {
            const modal = document.createElement('div');
            modal.id = 'verificacionPagoModal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 999999 !important;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 40px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; color: white; font-size: 2rem;">
                            <i class="fas fa-credit-card"></i>
                        </div>
                        <h2 style="color: #333; margin-bottom: 10px;">Verificaci√≥n de Pago Requerida</h2>
                        <p style="color: #666; margin-bottom: 0;">Para activar tu plan <strong>${planData.nombre}</strong>, necesitamos verificar tu pago manualmente.</p>
                    </div>
                    
                    <div style="background: #f8f9fa; border-radius: 12px; padding: 20px; margin-bottom: 30px;">
                        <h4 style="color: #333; margin-bottom: 15px;">
                            <i class="fas fa-info-circle"></i> Informaci√≥n del Plan
                        </h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <strong>Plan:</strong> ${planData.nombre}<br>
                                <strong>Precio:</strong> $${planData.precio}<br>
                                <strong>Comisi√≥n:</strong> ${planData.comision}%
                            </div>
                            <div>
                                <strong>Moneda:</strong> ${planData.moneda || 'ARS'}<br>
                                <strong>Duraci√≥n:</strong> Mensual<br>
                                <strong>Estado:</strong> <span style="color: #f59e0b;">Pendiente de Verificaci√≥n</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 12px; padding: 20px; margin-bottom: 30px;">
                        <h4 style="color: #856404; margin-bottom: 15px;">
                            <i class="fas fa-exclamation-triangle"></i> Proceso de Verificaci√≥n
                        </h4>
                        <ol style="color: #856404; margin: 0; padding-left: 20px;">
                            <li>Realiza el pago por el monto correspondiente</li>
                            <li>Env√≠a el comprobante de pago a CRISLA</li>
                            <li>Espera la verificaci√≥n manual (m√°ximo 24 horas)</li>
                            <li>Recibir√°s confirmaci√≥n por email cuando se active tu plan</li>
                        </ol>
                    </div>
                    
                    <div style="background: #e7f3ff; border: 1px solid #b3d9ff; border-radius: 12px; padding: 20px; margin-bottom: 30px;">
                        <h4 style="color: #0066cc; margin-bottom: 15px;">
                            <i class="fas fa-envelope"></i> Informaci√≥n de Contacto
                        </h4>
                        <p style="color: #0066cc; margin: 0;">
                            <strong>Email:</strong> crisla@cresalia.com<br>
                            <strong>WhatsApp:</strong> +54 9 11 1234-5678<br>
                            <strong>Asunto:</strong> Verificaci√≥n de Pago - Plan ${planData.nombre}
                        </p>
                    </div>
                    
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="cerrarModalVerificacionPago()" style="background: #6b7280; color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-times"></i> Cancelar
                        </button>
                        <button onclick="enviarComprobantePago('${planData.id}')" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-paper-plane"></i> Enviar Comprobante
                        </button>
                        <button onclick="simularPagoVerificado('${planData.id}')" style="background: linear-gradient(135deg, #10B981, #059669); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            <i class="fas fa-check"></i> Simular Pago Verificado
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de verificaci√≥n de pago creado');
        }
        
        // Cerrar modal de verificaci√≥n
        function cerrarModalVerificacionPago() {
            const modal = document.getElementById('verificacionPagoModal');
            if (modal) modal.remove();
        }
        
        // Enviar comprobante de pago
        function enviarComprobantePago(planId) {
            mostrarNotificacion('üìß Redirigiendo para enviar comprobante...', 'info');
            
            // Simular env√≠o de email
            setTimeout(() => {
                mostrarNotificacion('‚úÖ Comprobante enviado. Te contactaremos pronto para verificar tu pago.', 'success');
                cerrarModalVerificacionPago();
                
                // Guardar estado de pago pendiente
                localStorage.setItem('pago-pendiente', JSON.stringify({
                    planId: planId,
                    fecha: new Date().toISOString(),
                    estado: 'pendiente_verificacion'
                }));
            }, 1000);
        }
        
        // Simular pago verificado (solo para testing)
        function simularPagoVerificado(planId) {
            if (confirm('¬øEst√°s seguro de que quieres simular un pago verificado? Esto es solo para testing.')) {
                const planData = JSON.parse(localStorage.getItem('planSeleccionado') || '{}');
                
                // Activar plan
                localStorage.setItem('plan-actual', planData.id);
                localStorage.setItem('plan-activado', JSON.stringify({
                    ...planData,
                    activado: true,
                    fechaActivacion: new Date().toISOString(),
                    verificado: true
                }));
                
                // Limpiar pago pendiente
                localStorage.removeItem('pago-pendiente');
                
                mostrarNotificacion('‚úÖ ¬°Plan activado y verificado exitosamente!', 'success');
                cerrarModalVerificacionPago();
                
                // Actualizar interfaz
                window.actualizarInterfazPlan();
            }
        }
        
        // Actualizar interfaz seg√∫n el plan
        window.actualizarInterfazPlan = function() {
            const planData = JSON.parse(localStorage.getItem('plan-activado') || '{}');
            
            if (planData.activado) {
                // Mostrar notificaci√≥n de plan activo
                const notificacion = document.createElement('div');
                notificacion.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: linear-gradient(135deg, #10B981, #059669);
                    color: white;
                    padding: 15px 20px;
                    border-radius: 10px;
                    z-index: 9999999;
                    box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
                `;
                notificacion.innerHTML = `
                    <i class="fas fa-crown me-2"></i>
                    <strong>${planData.nombre}</strong> activo - Comisi√≥n: ${planData.comision}%
                `;
                
                document.body.appendChild(notificacion);
                
                setTimeout(() => {
                    notificacion.remove();
                }, 5000);
            }
        };
        
        // Seleccionar moneda de pago
        window.seleccionarMoneda = function(moneda) {
            // Prevenir clics m√∫ltiples
            if (window.procesandoMoneda) {
                console.log('‚ö†Ô∏è Ya se est√° procesando una moneda, espera...');
                return;
            }
            
            window.procesandoMoneda = true;
            console.log('üí∞ Seleccionando moneda:', moneda);
            
            const monedas = {
                ARS: { nombre: 'Pesos Argentinos', simbolo: '$', pais: 'Argentina' },
                USD: { nombre: 'D√≥lares Americanos', simbolo: '$', pais: 'Estados Unidos' },
                EUR: { nombre: 'Euros', simbolo: '‚Ç¨', pais: 'Europa' },
                BRL: { nombre: 'Reales Brasile√±os', simbolo: 'R$', pais: 'Brasil' }
            };
            
            const infoMoneda = monedas[moneda];
            if (!infoMoneda) {
                mostrarNotificacion('‚ùå Moneda no soportada', 'error');
                return;
            }
            
            // Guardar selecci√≥n
            localStorage.setItem('monedaSeleccionada', JSON.stringify({
                codigo: moneda,
                nombre: infoMoneda.nombre,
                simbolo: infoMoneda.simbolo,
                pais: infoMoneda.pais,
                fecha: new Date().toISOString()
            }));
            
            // Actualizar botones de moneda
            document.querySelectorAll('.currency-btn').forEach(btn => {
                btn.classList.remove('btn-primary');
                btn.classList.add('btn-outline-light');
            });
            
            event.target.classList.remove('btn-outline-light');
            event.target.classList.add('btn-primary');
            
            mostrarNotificacion(`‚úÖ Moneda seleccionada: ${infoMoneda.nombre}`, 'success');
            
            // Resetear flag despu√©s de un tiempo
            setTimeout(() => {
                window.procesandoMoneda = false;
            }, 1000);
        };
        
        // Cargar configuraci√≥n de suscripciones al iniciar
        window.cargarConfiguracionSuscripciones = function() {
            const planData = JSON.parse(localStorage.getItem('plan-activado') || '{}');
            const monedaData = JSON.parse(localStorage.getItem('monedaSeleccionada') || '{}');
            
            if (planData.activado) {
                window.actualizarInterfazPlan();
            }
            
            if (monedaData.codigo) {
                const botonMoneda = document.querySelector(`[onclick="seleccionarMoneda('${monedaData.codigo}')"]`);
                if (botonMoneda) {
                    botonMoneda.classList.remove('btn-outline-light');
                    botonMoneda.classList.add('btn-primary');
                }
            }
            
            // Verificar pagos pendientes
            verificarPagosPendientes();
        };
        
        // Verificar pagos pendientes de verificaci√≥n
        function verificarPagosPendientes() {
            const pagoPendiente = JSON.parse(localStorage.getItem('pago-pendiente') || '{}');
            
            if (pagoPendiente.estado === 'pendiente_verificacion') {
                const fechaPago = new Date(pagoPendiente.fecha);
                const horasTranscurridas = (new Date() - fechaPago) / (1000 * 60 * 60);
                
                if (horasTranscurridas > 24) {
                    // Mostrar notificaci√≥n de pago pendiente
                    mostrarNotificacionPagoPendiente(pagoPendiente);
                }
            }
        }
        
        // Mostrar notificaci√≥n de pago pendiente
        function mostrarNotificacionPagoPendiente(pagoPendiente) {
            const notificacion = document.createElement('div');
            notificacion.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #f59e0b, #d97706);
                color: white;
                padding: 20px;
                border-radius: 12px;
                z-index: 9999999;
                box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
                max-width: 400px;
            `;
            
            notificacion.innerHTML = `
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div style="width: 50px; height: 50px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div>
                        <h4 style="margin: 0 0 5px 0; font-size: 1.1rem;">Pago Pendiente de Verificaci√≥n</h4>
                        <p style="margin: 0; font-size: 0.9rem; opacity: 0.9;">Tu pago est√° siendo verificado por CRISLA. Te notificaremos cuando se active tu plan.</p>
                        <button onclick="cerrarModalSeguro('modalTransparencia')" style="background: rgba(255,255,255,0.2); color: white; border: none; padding: 5px 10px; border-radius: 6px; cursor: pointer; font-size: 0.8rem; margin-top: 10px;">
                            Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(notificacion);
            
            // Auto-remover despu√©s de 10 segundos
            setTimeout(() => {
                if (notificacion.parentElement) {
                    notificacion.remove();
                }
            }, 10000);
        }
        
        // Funci√≥n para mostrar notificaciones
        window.mostrarNotificacion = function(mensaje, tipo = 'info') {
            const colores = {
                success: 'linear-gradient(135deg, #10B981, #059669)',
                error: 'linear-gradient(135deg, #EF4444, #DC2626)',
                warning: 'linear-gradient(135deg, #F59E0B, #D97706)',
                info: 'linear-gradient(135deg, #3B82F6, #2563EB)'
            };
            
            const notificacion = document.createElement('div');
            notificacion.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${colores[tipo] || colores.info};
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                z-index: 9999999;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                max-width: 300px;
                word-wrap: break-word;
            `;
            notificacion.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; gap: 10px;">
                    <span>${mensaje}</span>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: white; cursor: pointer; font-size: 16px; padding: 0; margin-left: 10px;">&times;</button>
                </div>
            `;
            
            document.body.appendChild(notificacion);
            
            setTimeout(() => {
                notificacion.remove();
            }, 4000);
        };
        
        // Funci√≥n de prueba del sistema
        window.probarSistemaPagos = function() {
            console.log('üß™ Iniciando prueba del sistema de pagos...');
            
            // Simular selecci√≥n de plan b√°sico
            const planPrueba = {
                id: 'basic',
                nombre: 'Plan B√°sico',
                precio: 9.99,
                comision: 5
            };
            
            // Guardar plan de prueba
            localStorage.setItem('planSeleccionado', JSON.stringify({
                ...planPrueba,
                fecha: new Date().toISOString()
            }));
            
            // Mostrar modal de confirmaci√≥n directamente
            window.mostrarModalConfirmacionPlan(planPrueba);
            
            window.mostrarNotificacion('üß™ Prueba del sistema iniciada', 'info');
        };
        
        // Funci√≥n de prueba r√°pida sin modal
        window.probarPagoRapido = function() {
            console.log('üöÄ Prueba r√°pida de pago...');
            
            // Simular pago exitoso directamente
            const planData = {
                id: 'basic',
                nombre: 'Plan B√°sico',
                precio: 9.99,
                comision: 5,
                activado: true,
                fechaActivacion: new Date().toISOString()
            };
            
            localStorage.setItem('plan-actual', 'basic');
            localStorage.setItem('plan-activado', JSON.stringify(planData));
            
            // Mostrar notificaci√≥n directamente
            alert('‚úÖ ¬°Plan B√°sico activado exitosamente!');
            console.log('‚úÖ Plan B√°sico activado exitosamente!');
            
            // Mostrar notificaci√≥n de plan activo
            setTimeout(() => {
                alert('üéâ Plan B√°sico activo - Comisi√≥n: 5%');
                console.log('üéâ Plan B√°sico activo - Comisi√≥n: 5%');
            }, 2000);
        };
        
        // Funci√≥n de prueba s√∫per simple
        window.probarSistemaSimple = function() {
            console.log('üéØ Prueba s√∫per simple...');
            
            // Activar plan directamente
            localStorage.setItem('plan-actual', 'basic');
            localStorage.setItem('plan-activado', JSON.stringify({
                id: 'basic',
                nombre: 'Plan B√°sico',
                precio: 9.99,
                comision: 5,
                activado: true,
                fechaActivacion: new Date().toISOString()
            }));
            
            // Mostrar resultado
            alert('‚úÖ ¬°Plan B√°sico activado! Comisi√≥n: 5%');
            console.log('‚úÖ Plan B√°sico activado! Comisi√≥n: 5%');
            
            // Recargar p√°gina para ver cambios - COMENTADA (no necesaria)
            // setTimeout(() => {
            //     location.reload();
            // }, 2000);
        };
        
        // Funci√≥n para procesar pago REAL con Mercado Pago
        window.procesarPagoReal = function(planId) {
            console.log('üí≥ Procesando pago REAL con Mercado Pago...');
            
            const plan = {
                free: { nombre: 'Plan Gratuito', precio: 0 },
                basic: { nombre: 'Plan B√°sico', precio: 9.99 },
                premium: { nombre: 'Plan Premium', precio: 19.99 }
            }[planId];
            
            if (!plan) {
                alert('‚ùå Plan no encontrado');
                return;
            }
            
            // Mostrar modal de pago real
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); z-index: 9999999;
                display: flex; align-items: center; justify-content: center;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 40px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
                    <h3 style="text-align: center; margin-bottom: 30px; color: #333;">
                        <i class="fas fa-credit-card"></i> Pago Real con Mercado Pago
                    </h3>
                    
                    <div style="background: #f8fafc; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                        <h4 style="color: #333; margin-bottom: 10px;">${plan.nombre}</h4>
                        <p style="font-size: 1.5rem; font-weight: 700; color: #667eea;">$${plan.precio}/mes</p>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">Moneda:</label>
                        <select id="monedaPago" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                            <option value="ARS">Pesos Argentinos (ARS)</option>
                            <option value="USD">D√≥lares Americanos (USD)</option>
                            <option value="EUR">Euros (EUR)</option>
                            <option value="BRL">Reales Brasile√±os (BRL)</option>
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">N√∫mero de Tarjeta:</label>
                        <input type="text" id="tarjetaPrueba" placeholder="4509 9535 6623 3704" 
                               style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                        <small style="color: #666; margin-top: 5px; display: block;">
                            Usa: 4509 9535 6623 3704 (Visa) o 5031 7557 3453 0604 (Mastercard)
                        </small>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 600;">CVV:</label>
                            <input type="text" id="cvvTarjeta" placeholder="123" maxlength="4"
                                   style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Vencimiento:</label>
                            <input type="text" id="vencimientoTarjeta" placeholder="12/25" maxlength="5"
                                   style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">Nombre del Titular:</label>
                        <input type="text" id="nombreTitular" placeholder="Juan P√©rez"
                               style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">Email:</label>
                        <input type="email" id="emailPago" placeholder="cliente@ejemplo.com"
                               style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                    </div>
                    
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                            Cancelar
                        </button>
                        <button onclick="confirmarPagoReal('${planId}')" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                            <i class="fas fa-credit-card"></i> Pagar Ahora
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        };
        
        // Funci√≥n para confirmar pago real
        window.confirmarPagoReal = function(planId) {
            console.log('üí≥ Confirmando pago real para plan:', planId);
            
            const moneda = document.getElementById('monedaPago')?.value || 'ARS';
            const tarjeta = document.getElementById('tarjetaPrueba')?.value || '';
            const cvv = document.getElementById('cvvTarjeta')?.value || '';
            const vencimiento = document.getElementById('vencimientoTarjeta')?.value || '';
            const nombre = document.getElementById('nombreTitular')?.value || '';
            const email = document.getElementById('emailPago')?.value || '';
            
            console.log('üí≥ Datos del pago:', { moneda, tarjeta, cvv, vencimiento, nombre, email });
            
            // Validar todos los campos
            if (!tarjeta) {
                alert('‚ùå Ingresa el n√∫mero de tarjeta');
                return;
            }
            if (!cvv) {
                alert('‚ùå Ingresa el CVV');
                return;
            }
            if (!vencimiento) {
                alert('‚ùå Ingresa la fecha de vencimiento');
                return;
            }
            if (!nombre) {
                alert('‚ùå Ingresa el nombre del titular');
                return;
            }
            if (!email) {
                alert('‚ùå Ingresa el email');
                return;
            }
            
            // Validar formato de tarjeta
            if (tarjeta.length < 16) {
                alert('‚ùå El n√∫mero de tarjeta debe tener al menos 16 d√≠gitos');
                return;
            }
            
            // Validar CVV
            if (cvv.length < 3) {
                alert('‚ùå El CVV debe tener al menos 3 d√≠gitos');
                return;
            }
            
            // Validar email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('‚ùå Ingresa un email v√°lido');
                return;
            }
            
            console.log('üí≥ Procesando pago real:', { planId, moneda, tarjeta, cvv, vencimiento, nombre, email });
            
            // Simular procesamiento con Mercado Pago
            alert('‚è≥ Procesando pago con Mercado Pago...\n\nüîí Datos encriptados y seguros');
            
            setTimeout(() => {
                // Simular pago exitoso
                localStorage.setItem('plan-actual', planId);
                localStorage.setItem('plan-activado', JSON.stringify({
                    id: planId,
                    activado: true,
                    fechaActivacion: new Date().toISOString(),
                    moneda: moneda,
                    tarjeta: tarjeta.substring(0, 4) + '****',
                    titular: nombre,
                    email: email
                }));
                
                alert('‚úÖ ¬°Pago procesado exitosamente!\n\nüìß Recibo enviado a: ' + email + '\nüí≥ Plan activado: ' + planId);
                
                // Cerrar modal
                const modal = document.querySelector('[style*="position: fixed"]');
                if (modal) {
                    modal.remove();
                }
            }, 3000);
        };
        
        // Funci√≥n para mostrar sistema de bienestar
        window.mostrarSistemaBienestar = function() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); z-index: 9999999;
                display: flex; align-items: center; justify-content: center;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 40px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto;">
                    <h3 style="text-align: center; margin-bottom: 30px; color: #333;">
                        <i class="fas fa-heart"></i> Sistema de Bienestar Emocional
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                        <!-- Progreso Empresarial -->
                        <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 12px; cursor: pointer;" onclick="mostrarProgresoEmpresarial()">
                            <h4 style="margin: 0 0 10px 0;"><i class="fas fa-chart-line"></i> Progreso Empresarial</h4>
                            <p style="margin: 0; opacity: 0.9;">Ver tu crecimiento</p>
                        </div>
                        
                        <!-- Recursos -->
                        <div style="background: linear-gradient(135deg, #10B981, #059669); color: white; padding: 20px; border-radius: 12px; cursor: pointer;" onclick="mostrarRecursosBienestar()">
                            <h4 style="margin: 0 0 10px 0;"><i class="fas fa-book"></i> Recursos</h4>
                            <p style="margin: 0; opacity: 0.9;">Consejos y herramientas</p>
                        </div>
                    </div>
                    
                    <div style="text-align: center;">
                        <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                            Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        };
        
        // Funci√≥n para mostrar progreso empresarial
        window.mostrarProgresoEmpresarial = function() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); z-index: 9999999;
                display: flex; align-items: center; justify-content: center;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 40px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
                    <h3 style="text-align: center; margin-bottom: 30px; color: #333;">
                        <i class="fas fa-chart-line"></i> Progreso Empresarial
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                        <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 12px;">
                            <h4 style="margin: 0 0 10px 0;">üìà Ventas del Mes</h4>
                            <p style="font-size: 2rem; margin: 0; font-weight: 700;">$2,450</p>
                            <small style="opacity: 0.9;">+15% vs mes anterior</small>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #10B981, #059669); color: white; padding: 20px; border-radius: 12px;">
                            <h4 style="margin: 0 0 10px 0;">üë• Clientes Nuevos</h4>
                            <p style="font-size: 2rem; margin: 0; font-weight: 700;">23</p>
                            <small style="opacity: 0.9;">+8% vs mes anterior</small>
                        </div>
                    </div>
                    
                    <div style="background: #f8fafc; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                        <h4 style="color: #333; margin-bottom: 15px;">üéØ Objetivos del Mes</h4>
                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Ventas</span>
                                <span>75%</span>
                            </div>
                            <div style="background: #e5e7eb; height: 8px; border-radius: 4px; overflow: hidden;">
                                <div style="background: linear-gradient(135deg, #667eea, #764ba2); height: 100%; width: 75%;"></div>
                            </div>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Clientes</span>
                                <span>60%</span>
                            </div>
                            <div style="background: #e5e7eb; height: 8px; border-radius: 4px; overflow: hidden;">
                                <div style="background: linear-gradient(135deg, #10B981, #059669); height: 100%; width: 60%;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center;">
                        <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                            Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        };
        
        // Funci√≥n para mostrar recursos de bienestar
        window.mostrarRecursosBienestar = function() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); z-index: 9999999;
                display: flex; align-items: center; justify-content: center;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 40px; max-width: 700px; width: 90%; max-height: 90vh; overflow-y: auto;">
                    <h3 style="text-align: center; margin-bottom: 30px; color: #333;">
                        <i class="fas fa-book"></i> Recursos de Bienestar
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                        <div style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; padding: 20px; border-radius: 12px; cursor: pointer;" onclick="alert('üéµ M√∫sica relajante disponible')">
                            <h4 style="margin: 0 0 10px 0;"><i class="fas fa-music"></i> M√∫sica Relajante</h4>
                            <p style="margin: 0; opacity: 0.9;">Playlists para concentraci√≥n</p>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 12px; cursor: pointer;" onclick="alert('üí° Consejos empresariales disponibles')">
                            <h4 style="margin: 0 0 10px 0;"><i class="fas fa-lightbulb"></i> Consejos Empresariales</h4>
                            <p style="margin: 0; opacity: 0.9;">Tips para emprendedores</p>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #10B981, #059669); color: white; padding: 20px; border-radius: 12px; cursor: pointer;" onclick="alert('üßò T√©cnicas de relajaci√≥n disponibles')">
                            <h4 style="margin: 0 0 10px 0;"><i class="fas fa-spa"></i> T√©cnicas de Relajaci√≥n</h4>
                            <p style="margin: 0; opacity: 0.9;">Ejercicios de respiraci√≥n</p>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 20px; border-radius: 12px; cursor: pointer;" onclick="alert('üìä Analytics avanzados disponibles')">
                            <h4 style="margin: 0 0 10px 0;"><i class="fas fa-chart-bar"></i> Analytics Avanzados</h4>
                            <p style="margin: 0; opacity: 0.9;">M√©tricas de rendimiento</p>
                        </div>
                    </div>
                    
                    <div style="text-align: center;">
                        <button onclick="cerrarModal(this)" style="background: #6b7280; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                            Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        };
        
        // Funci√≥n para forzar carga de servicios
        window.forzarCargaServicios = function() {
            console.log('üõ†Ô∏è Forzando carga de servicios...');
            
            // Cargar servicios de ejemplo para remiser√≠a
            const serviciosEjemplo = [
                {
                    id: 1,
                    tipo: 'servicio',
                    nombre: 'Servicio de Remiser√≠a',
                    precio: 150.00,
                    categoria: 'transporte',
                    duracion: 'Viaje completo',
                    descripcion: 'Servicio de remiser√≠a profesional con chofer experimentado. Veh√≠culos c√≥modos y seguros.',
                    modalidad: 'presencial',
                    ubicacion: 'CABA y GBA',
                    horarios: '24/7 - Disponible siempre',
                    contacto: 'WhatsApp: +54 9 11 1234-5678',
                    disponible: true,
                    cupos: 5
                },
                {
                    id: 2,
                    tipo: 'servicio',
                    nombre: 'Terapia de Relajaci√≥n',
                    precio: 40.00,
                    categoria: 'bienestar',
                    duracion: '45 minutos',
                    descripcion: 'T√©cnicas de relajaci√≥n y meditaci√≥n',
                    modalidad: 'online',
                    ubicacion: 'Zoom/Meet',
                    horarios: 'Martes y Jueves 14:00-16:00',
                    contacto: 'Email: terapia@ejemplo.com',
                    disponible: true,
                    cupos: 5
                },
                {
                    id: 3,
                    tipo: 'servicio',
                    nombre: 'Coaching Empresarial',
                    precio: 80.00,
                    categoria: 'empresarial',
                    duracion: '90 minutos',
                    descripcion: 'Asesor√≠a para emprendedores y empresarios',
                    modalidad: 'mixto',
                    ubicacion: 'Oficina o Online',
                    horarios: 'Lunes a Viernes 10:00-17:00',
                    contacto: 'Tel: +54 9 11 9876-5432',
                    disponible: true,
                    cupos: 3
                },
                {
                    id: 4,
                    tipo: 'servicio',
                    nombre: 'Sesi√≥n de Yoga',
                    precio: 30.00,
                    categoria: 'fitness',
                    duracion: '60 minutos',
                    descripcion: 'Clase de yoga para principiantes',
                    modalidad: 'presencial',
                    ubicacion: 'Estudio de Yoga',
                    horarios: 'S√°bados 9:00-10:00',
                    contacto: 'WhatsApp: +54 9 11 5555-1234',
                    disponible: true,
                    cupos: 15
                }
            ];
            
            // Guardar en localStorage
            localStorage.setItem('servicios_tienda', JSON.stringify(serviciosEjemplo));
            
            // Actualizar la interfaz
            const serviciosLista = document.getElementById('serviciosLista');
            if (serviciosLista) {
                serviciosLista.innerHTML = serviciosEjemplo.map(servicio => `
                    <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: #333;">${servicio.nombre}</h4>
                            <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem;">$${servicio.precio}</span>
                        </div>
                        <p style="color: #666; margin-bottom: 10px;">${servicio.descripcion}</p>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">
                            <div>
                                <small style="color: #999;">Duraci√≥n:</small>
                                <p style="margin: 2px 0; font-weight: 600;">${servicio.duracion}</p>
                            </div>
                            <div>
                                <small style="color: #999;">Modalidad:</small>
                                <p style="margin: 2px 0; font-weight: 600;">${servicio.modalidad}</p>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button onclick="editarServicio(${servicio.id})" style="background: #667eea; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 0.9rem;">
                                <i class="fas fa-edit"></i> Editar
                            </button>
                            <button onclick="eliminarServicio(${servicio.id})" style="background: #ef4444; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 0.9rem;">
                                <i class="fas fa-trash"></i> Eliminar
                            </button>
                        </div>
                    </div>
                `).join('');
            }
            
            console.log('‚úÖ Servicios cargados:', serviciosEjemplo.length);
            
            // Forzar actualizaci√≥n de estad√≠sticas
            actualizarEstadisticas();
        };

        // Funci√≥n para forzar carga de servicios
        window.forzarCargaServicios = function() {
            console.log('üîß Forzando carga de servicios...');
            try {
                // Limpiar localStorage de servicios para forzar recarga
                const tiendaId = obtenerTiendaId();
                localStorage.removeItem(`servicios_${tiendaId}`);
                
                // Recargar servicios
                cargarServiciosEjemplo();
                
                // Recargar productos tambi√©n
                cargarProductosEjemplo();
                
                mostrarNotificacion('‚úÖ Servicios y productos recargados exitosamente', 'success');
            } catch (error) {
                console.error('‚ùå Error al forzar carga:', error);
                mostrarNotificacion('Error al recargar servicios: ' + error.message, 'error');
            }
        };

        // Funci√≥n espec√≠fica para cargar servicios de remiser√≠a
        window.cargarServiciosRemiseria = function() {
            console.log('üöó Cargando servicios de remiser√≠a...');
            
            const serviciosRemiseria = [
                {
                    id: 'remis_1',
                    nombre: 'Servicio de Remiser√≠a Est√°ndar',
                    descripcion: 'Servicio de remiser√≠a profesional con chofer experimentado. Veh√≠culos c√≥modos y seguros para todos tus viajes.',
                    precio: 150.00,
                    duracion: 'Viaje completo',
                    categoria: 'transporte',
                    fechaCreacion: new Date().toISOString(),
                    disponible: true,
                    contacto: 'WhatsApp: +54 9 11 1234-5678',
                    horarios: '24/7 - Disponible siempre',
                    zona: 'urbana',
                    tipoZona: 'Zona Urbana'
                },
                {
                    id: 'remis_2', 
                    nombre: 'Remiser√≠a Ejecutiva Premium',
                    descripcion: 'Servicio premium con veh√≠culos de alta gama. Ideal para ejecutivos, eventos especiales y ocasiones importantes.',
                    precio: 250.00,
                    duracion: 'Viaje completo',
                    categoria: 'transporte',
                    fechaCreacion: new Date().toISOString(),
                    disponible: true,
                    contacto: 'WhatsApp: +54 9 11 1234-5678',
                    horarios: 'Lunes a Viernes 6:00-22:00',
                    zona: 'urbana',
                    tipoZona: 'Zona Urbana'
                },
                {
                    id: 'remis_3',
                    nombre: 'Remiser√≠a Nocturna',
                    descripcion: 'Servicio especializado nocturno con m√°xima seguridad. Disponible cuando m√°s lo necesites.',
                    precio: 200.00,
                    duracion: 'Viaje completo',
                    categoria: 'transporte',
                    fechaCreacion: new Date().toISOString(),
                    disponible: true,
                    contacto: 'WhatsApp: +54 9 11 1234-5678',
                    horarios: '22:00-06:00',
                    zona: 'urbana',
                    tipoZona: 'Zona Urbana'
                },
                {
                    id: 'remis_4',
                    nombre: 'Remiser√≠a Rural Est√°ndar',
                    descripcion: 'Servicio especializado para zonas rurales. Veh√≠culos 4x4 y choferes experimentados en caminos rurales.',
                    precio: 300.00,
                    duracion: 'Viaje completo',
                    categoria: 'transporte',
                    fechaCreacion: new Date().toISOString(),
                    disponible: true,
                    contacto: 'WhatsApp: +54 9 11 1234-5678',
                    horarios: 'Lunes a Domingo 6:00-20:00',
                    zona: 'rural',
                    tipoZona: 'Zona Rural'
                },
                {
                    id: 'remis_5',
                    nombre: 'Remiser√≠a Rural Premium',
                    descripcion: 'Servicio premium para zonas rurales con veh√≠culos 4x4 de alta gama. Ideal para eventos especiales en el campo.',
                    precio: 450.00,
                    duracion: 'Viaje completo',
                    categoria: 'transporte',
                    fechaCreacion: new Date().toISOString(),
                    disponible: true,
                    contacto: 'WhatsApp: +54 9 11 1234-5678',
                    horarios: 'Lunes a Domingo 6:00-20:00',
                    zona: 'rural',
                    tipoZona: 'Zona Rural'
                },
                {
                    id: 'remis_6',
                    nombre: 'Remiser√≠a Mixta (Urbana + Rural)',
                    descripcion: 'Servicio que conecta zonas urbanas con rurales. Veh√≠culos adaptados para ambos tipos de terreno.',
                    precio: 350.00,
                    duracion: 'Viaje completo',
                    categoria: 'transporte',
                    fechaCreacion: new Date().toISOString(),
                    disponible: true,
                    contacto: 'WhatsApp: +54 9 11 1234-5678',
                    horarios: 'Lunes a Domingo 6:00-22:00',
                    zona: 'mixta',
                    tipoZona: 'Zona Mixta'
                }
            ];
            
            const tiendaId = 'demo-tienda';
            localStorage.setItem(`servicios_${tiendaId}`, JSON.stringify(serviciosRemiseria));
            
            console.log('‚úÖ Servicios de remiser√≠a cargados:', serviciosRemiseria.length);
            
            // Actualizar estad√≠sticas
            if (typeof actualizarEstadisticas === 'function') {
                actualizarEstadisticas();
            }
            
            // Mostrar notificaci√≥n - COMENTADA (no necesaria)
            // if (window.mostrarNotificacion) {
            //     window.mostrarNotificacion('üöó Servicios de remiser√≠a cargados correctamente', 'success');
            // }
            
            return serviciosRemiseria;
        };
        
        // Funci√≥n para filtrar servicios por zona
        window.filtrarServiciosPorZona = function(zona) {
            console.log('üîç Filtrando servicios por zona:', zona);
            
            const tiendaId = 'demo-tienda';
            const todosServicios = JSON.parse(localStorage.getItem(`servicios_${tiendaId}`) || '[]');
            
            let serviciosFiltrados = todosServicios;
            
            if (zona && zona !== 'todas') {
                serviciosFiltrados = todosServicios.filter(servicio => servicio.zona === zona);
            }
            
            console.log(`‚úÖ Servicios filtrados por zona ${zona}:`, serviciosFiltrados.length);
            
            // Actualizar la lista de servicios en la interfaz
            const serviciosLista = document.getElementById('serviciosLista');
            if (serviciosLista) {
                serviciosLista.innerHTML = serviciosFiltrados.map(servicio => `
                    <div class="servicio-card" style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #10B981;">
                        <div style="display: flex; justify-content: between; align-items: start; margin-bottom: 15px;">
                            <div style="flex: 1;">
                                <h4 style="color: #1F2937; margin: 0 0 8px 0; font-size: 1.1rem;">${servicio.nombre}</h4>
                                <p style="color: #6B7280; margin: 0 0 10px 0; font-size: 0.9rem;">${servicio.descripcion}</p>
                                <div style="display: flex; gap: 15px; margin-bottom: 10px;">
                                    <span style="background: #F3F4F6; color: #374151; padding: 4px 8px; border-radius: 6px; font-size: 0.8rem;">
                                        <i class="fas fa-map-marker-alt"></i> ${servicio.tipoZona}
                                    </span>
                                    <span style="background: #F3F4F6; color: #374151; padding: 4px 8px; border-radius: 6px; font-size: 0.8rem;">
                                        <i class="fas fa-clock"></i> ${servicio.horarios}
                                    </span>
                                </div>
                                <div style="display: flex; justify-content: between; align-items: center;">
                                    <div>
                                        <span style="color: #10B981; font-weight: 600; font-size: 1.2rem;">$${servicio.precio}</span>
                                        <span style="color: #6B7280; font-size: 0.9rem; margin-left: 5px;">${servicio.duracion}</span>
                                    </div>
                                    <div style="display: flex; gap: 8px;">
                                        <button onclick="editarServicio('${servicio.id}')" style="background: #3B82F6; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.8rem;">
                                            <i class="fas fa-edit"></i> Editar
                                        </button>
                                        <button onclick="eliminarServicio('${servicio.id}')" style="background: #ef4444; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.8rem;">
                                            <i class="fas fa-trash"></i> Eliminar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            return serviciosFiltrados;
        };
        
        // Funci√≥n para mostrar selector de zona
        window.mostrarSelectorZona = function() {
            const selectorHTML = `
                <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #F0F9FF, #E0F2FE); border-radius: 12px; border: 2px solid #0EA5E9;">
                    <div style="display: flex; align-items: center; margin-bottom: 10px;">
                        <i class="fas fa-map-marker-alt" style="color: #0EA5E9; font-size: 1.2rem; margin-right: 10px;"></i>
                        <h4 style="color: #0C4A6E; margin: 0; font-size: 1.1rem;">üó∫Ô∏è Filtrar por Zona</h4>
                    </div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="filtrarServiciosPorZona('todas')" style="background: #0EA5E9; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">
                            <i class="fas fa-globe"></i> Todas las Zonas
                        </button>
                        <button onclick="filtrarServiciosPorZona('urbana')" style="background: #10B981; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">
                            <i class="fas fa-city"></i> Zona Urbana
                        </button>
                        <button onclick="filtrarServiciosPorZona('rural')" style="background: #F59E0B; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">
                            <i class="fas fa-tree"></i> Zona Rural
                        </button>
                        <button onclick="filtrarServiciosPorZona('mixta')" style="background: #8B5CF6; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">
                            <i class="fas fa-route"></i> Zona Mixta
                        </button>
                    </div>
                </div>
            `;
            
            return selectorHTML;
        };
        
        // Funci√≥n para mostrar configuraci√≥n de remiser√≠a con mapa
        window.mostrarConfiguracionRemiseria = function() {
            const modalHTML = `
                <div id="modalConfigRemiseria" class="modal" style="display: flex !important; z-index: 99999 !important;">
                    <div class="modal-content" style="max-width: 500px; z-index: 100000 !important; background: white; border-radius: 20px; padding: 40px; max-height: 90vh; overflow-y: auto;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #0EA5E9, #0284C7); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; color: white; font-size: 2rem;">
                                <i class="fas fa-route"></i>
                            </div>
                            <h2 style="color: #333; margin-bottom: 10px;">üöó Configuraci√≥n de Remiser√≠a</h2>
                            <p style="color: #666; margin-bottom: 0;">Configura tus rutas, zonas y servicios</p>
                        </div>
                        
                        <form id="formConfigRemiseria" onsubmit="guardarConfigRemiseria(event)">
                            <!-- Informaci√≥n B√°sica -->
                            <div style="margin-bottom: 30px;">
                                <h3 style="color: #1F2937; margin-bottom: 20px; border-bottom: 2px solid #E5E7EB; padding-bottom: 10px;">
                                    <i class="fas fa-info-circle"></i> Informaci√≥n B√°sica
                                </h3>
                                
                                <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Nombre del Servicio</label>
                                        <input type="text" id="nombreRemiseria" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                    </div>
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Precio Base</label>
                                        <input type="number" id="precioBaseRemiseria" step="0.01" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                    </div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Asientos Disponibles</label>
                                        <select id="asientosRemiseria" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                            <option value="">Seleccionar asientos</option>
                                            <option value="4">4 asientos</option>
                                            <option value="6">6 asientos</option>
                                            <option value="8">8 asientos</option>
                                            <option value="12">12 asientos</option>
                                            <option value="15">15 asientos</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Tipo de Zona</label>
                                        <select id="tipoZonaRemiseria" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                            <option value="">Seleccionar zona</option>
                                            <option value="urbana">Zona Urbana</option>
                                            <option value="rural">Zona Rural</option>
                                            <option value="mixta">Zona Mixta</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Mapa de Ubicaci√≥n -->
                            <div style="margin-bottom: 30px;">
                                <h3 style="color: #1F2937; margin-bottom: 20px; border-bottom: 2px solid #E5E7EB; padding-bottom: 10px;">
                                    <i class="fas fa-map-marker-alt"></i> Ubicaci√≥n y Rutas
                                </h3>
                                
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Punto de Partida</label>
                                    <input type="text" id="puntoPartidaRemiseria" placeholder="Ej: Terminal de √ìmnibus" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                </div>
                                
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Zonas que Cubre</label>
                                    <textarea id="zonasCubreRemiseria" rows="3" placeholder="Ej: Centro, Barrio Norte, Zona Sur, etc." style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem; resize: vertical;"></textarea>
                                </div>
                                
                                <!-- Mapa -->
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Mapa de Ubicaci√≥n</label>
                                    <div id="mapaConfigRemiseria" style="width: 100%; height: 300px; background: #f3f4f6; border: 2px solid #0ea5e9; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #666; position: relative;">
                                        <div style="text-align: center;">
                                            <i class="fas fa-map" style="font-size: 3rem; color: #0ea5e9; margin-bottom: 10px;"></i>
                                            <p style="margin: 0; font-size: 1.1rem; font-weight: 600;">üó∫Ô∏è Mapa de Ubicaci√≥n</p>
                                            <p style="margin: 5px 0 0 0; font-size: 0.9rem;">Selecciona tu ubicaci√≥n en el mapa</p>
                                            <button type="button" onclick="cargarMapaRemiseria()" style="background: #0EA5E9; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; margin-top: 15px;">
                                                <i class="fas fa-map-marker-alt"></i> Cargar Mapa
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Horarios y Disponibilidad -->
                            <div style="margin-bottom: 30px;">
                                <h3 style="color: #1F2937; margin-bottom: 20px; border-bottom: 2px solid #E5E7EB; padding-bottom: 10px;">
                                    <i class="fas fa-clock"></i> Horarios y Disponibilidad
                                </h3>
                                
                                <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Horario de Inicio</label>
                                        <input type="time" id="horarioInicioRemiseria" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                    </div>
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Horario de Fin</label>
                                        <input type="time" id="horarioFinRemiseria" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                    </div>
                                </div>
                                
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">D√≠as de la Semana</label>
                                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                        <label style="display: flex; align-items: center; gap: 5px; padding: 8px 12px; background: #f3f4f6; border-radius: 6px; cursor: pointer;">
                                            <input type="checkbox" name="diasRemiseria" value="lunes" style="margin: 0;">
                                            <span>Lunes</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 5px; padding: 8px 12px; background: #f3f4f6; border-radius: 6px; cursor: pointer;">
                                            <input type="checkbox" name="diasRemiseria" value="martes" style="margin: 0;">
                                            <span>Martes</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 5px; padding: 8px 12px; background: #f3f4f6; border-radius: 6px; cursor: pointer;">
                                            <input type="checkbox" name="diasRemiseria" value="miercoles" style="margin: 0;">
                                            <span>Mi√©rcoles</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 5px; padding: 8px 12px; background: #f3f4f6; border-radius: 6px; cursor: pointer;">
                                            <input type="checkbox" name="diasRemiseria" value="jueves" style="margin: 0;">
                                            <span>Jueves</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 5px; padding: 8px 12px; background: #f3f4f6; border-radius: 6px; cursor: pointer;">
                                            <input type="checkbox" name="diasRemiseria" value="viernes" style="margin: 0;">
                                            <span>Viernes</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 5px; padding: 8px 12px; background: #f3f4f6; border-radius: 6px; cursor: pointer;">
                                            <input type="checkbox" name="diasRemiseria" value="sabado" style="margin: 0;">
                                            <span>S√°bado</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 5px; padding: 8px 12px; background: #f3f4f6; border-radius: 6px; cursor: pointer;">
                                            <input type="checkbox" name="diasRemiseria" value="domingo" style="margin: 0;">
                                            <span>Domingo</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Botones -->
                            <div style="display: flex; gap: 15px; justify-content: center;">
                                <button type="button" onclick="cerrarModalConfigRemiseria()" style="background: #6b7280; color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                                <button type="submit" style="background: linear-gradient(135deg, #0EA5E9, #0284C7); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                    <i class="fas fa-save"></i> Guardar Configuraci√≥n
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        };
        
        // Funci√≥n para cargar mapa de remiser√≠a
        window.cargarMapaRemiseria = function() {
            const mapaDiv = document.getElementById('mapaConfigRemiseria');
            if (mapaDiv) {
                mapaDiv.innerHTML = `
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #F0F9FF, #E0F2FE); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #0C4A6E;">
                        <div style="text-align: center;">
                            <i class="fas fa-map-marked-alt" style="font-size: 4rem; margin-bottom: 15px;"></i>
                            <h3 style="margin: 0 0 10px 0; color: #0C4A6E;">üó∫Ô∏è Mapa Interactivo</h3>
                            <p style="margin: 0 0 15px 0; color: #0C4A6E;">Selecciona tu ubicaci√≥n y rutas</p>
                            <div style="display: flex; gap: 10px; justify-content: center;">
                                <button onclick="marcarPuntoPartida()" style="background: #10B981; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 0.9rem;">
                                    <i class="fas fa-map-marker-alt"></i> Punto de Partida
                                </button>
                                <button onclick="marcarZonasCobertura()" style="background: #F59E0B; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 0.9rem;">
                                    <i class="fas fa-route"></i> Zonas de Cobertura
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }
        };
        
        // Funci√≥n para marcar punto de partida
        window.marcarPuntoPartida = function() {
            mostrarNotificacion('üìç Marca tu punto de partida en el mapa', 'info');
        };
        
        // Funci√≥n para marcar zonas de cobertura
        window.marcarZonasCobertura = function() {
            mostrarNotificacion('üó∫Ô∏è Marca las zonas que cubres en el mapa', 'info');
        };
        
        // Funci√≥n para guardar configuraci√≥n de remiser√≠a
        window.guardarConfigRemiseria = function(event) {
            event.preventDefault();
            
            const configRemiseria = {
                nombre: document.getElementById('nombreRemiseria').value,
                precioBase: parseFloat(document.getElementById('precioBaseRemiseria').value),
                asientos: document.getElementById('asientosRemiseria').value,
                tipoZona: document.getElementById('tipoZonaRemiseria').value,
                puntoPartida: document.getElementById('puntoPartidaRemiseria').value,
                zonasCubre: document.getElementById('zonasCubreRemiseria').value,
                horarioInicio: document.getElementById('horarioInicioRemiseria').value,
                horarioFin: document.getElementById('horarioFinRemiseria').value,
                dias: Array.from(document.querySelectorAll('input[name="diasRemiseria"]:checked')).map(cb => cb.value),
                fechaCreacion: new Date().toISOString()
            };
            
            // Guardar en localStorage
            const tiendaId = obtenerTiendaId();
            let configsRemiseria = JSON.parse(localStorage.getItem(`configs_remiseria_${tiendaId}`) || '[]');
            configsRemiseria.push(configRemiseria);
            localStorage.setItem(`configs_remiseria_${tiendaId}`, JSON.stringify(configsRemiseria));
            
            mostrarNotificacion('‚úÖ Configuraci√≥n de remiser√≠a guardada correctamente', 'success');
            cerrarModalConfigRemiseria();
        };
        
        // Funci√≥n para cerrar modal de configuraci√≥n de remiser√≠a
        window.cerrarModalConfigRemiseria = function() {
            const modal = document.getElementById('modalConfigRemiseria');
            if (modal) {
                modal.remove();
            }
        };
        
        // ========================================
        // GENERADOR DE LOGOS AUTOM√ÅTICO
        // ========================================
        
        // Funci√≥n para generar logo autom√°tico
        window.generarLogoAutomatico = function(nombreEmpresa, tipoNegocio) {
            console.log('üé® Generando logo autom√°tico para:', nombreEmpresa, tipoNegocio);
            
            // Colores por tipo de negocio
            const coloresNegocio = {
                'remiser√≠a': { primario: '#0EA5E9', secundario: '#0284C7' },
                'peluquer√≠a': { primario: '#EC4899', secundario: '#BE185D' },
                'est√©tica': { primario: '#8B5CF6', secundario: '#7C3AED' },
                'restaurante': { primario: '#F59E0B', secundario: '#D97706' },
                'panader√≠a': { primario: '#10B981', secundario: '#059669' },
                'bar': { primario: '#EF4444', secundario: '#DC2626' },
                'caf√©': { primario: '#92400E', secundario: '#78350F' },
                'lubricentro': { primario: '#6B7280', secundario: '#4B5563' },
                'detail': { primario: '#3B82F6', secundario: '#2563EB' },
                'transporte': { primario: '#0EA5E9', secundario: '#0284C7' },
                'default': { primario: '#6366F1', secundario: '#4F46E5' }
            };
            
            const colores = coloresNegocio[tipoNegocio] || coloresNegocio.default;
            
            // Iconos por tipo de negocio
            const iconosNegocio = {
                'remiser√≠a': 'üöó',
                'peluquer√≠a': 'üíá',
                'est√©tica': '‚ú®',
                'restaurante': 'üçΩÔ∏è',
                'panader√≠a': 'üçû',
                'bar': 'üç∫',
                'caf√©': '‚òï',
                'lubricentro': 'üîß',
                'detail': '‚ú®',
                'transporte': 'üöö',
                'default': 'üè™'
            };
            
            const icono = iconosNegocio[tipoNegocio] || iconosNegocio.default;
            
            // Crear logo SVG
            const logoHTML = `
                <div style="width: 200px; height: 200px; background: linear-gradient(135deg, ${colores.primario}, ${colores.secundario}); border-radius: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; font-family: Arial, sans-serif; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                    <div style="font-size: 3rem; margin-bottom: 10px;">${icono}</div>
                    <div style="font-size: 1.2rem; font-weight: bold; text-align: center; line-height: 1.2;">${nombreEmpresa}</div>
                    <div style="font-size: 0.8rem; opacity: 0.9; margin-top: 5px;">${tipoNegocio.charAt(0).toUpperCase() + tipoNegocio.slice(1)}</div>
                </div>
            `;
            
            return logoHTML;
        };
        
        // Funci√≥n para mostrar generador de logos
        window.mostrarGeneradorLogos = function() {
            const modalHTML = `
                <div id="modalGeneradorLogos" class="modal" style="display: flex !important; z-index: 99999 !important;">
                    <div class="modal-content" style="max-width: 600px; z-index: 100000 !important; background: white; border-radius: 20px; padding: 40px;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #8B5CF6, #7C3AED); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; color: white; font-size: 2rem;">
                                <i class="fas fa-palette"></i>
                            </div>
                            <h2 style="color: #333; margin-bottom: 10px;">üé® Generador de Logos</h2>
                            <p style="color: #666; margin-bottom: 0;">Crea tu logo profesional autom√°ticamente</p>
                        </div>
                        
                        <form id="formGeneradorLogos" onsubmit="generarLogoCompleto(event)">
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Nombre de tu Empresa</label>
                                <input type="text" id="nombreEmpresaLogo" placeholder="Ej: Remiser√≠a El R√°pido" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Tipo de Negocio</label>
                                <select id="tipoNegocioLogo" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                    <option value="">Seleccionar tipo</option>
                                    <option value="remiser√≠a">üöó Remiser√≠a</option>
                                    <option value="peluquer√≠a">üíá Peluquer√≠a</option>
                                    <option value="est√©tica">‚ú® Est√©tica</option>
                                    <option value="restaurante">üçΩÔ∏è Restaurante</option>
                                    <option value="panader√≠a">üçû Panader√≠a</option>
                                    <option value="bar">üç∫ Bar</option>
                                    <option value="caf√©">‚òï Caf√©</option>
                                    <option value="lubricentro">üîß Lubricentro</option>
                                    <option value="detail">‚ú® Detail</option>
                                    <option value="transporte">üöö Transporte</option>
                                    <option value="otro">üè™ Otro</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 30px;">
                                <button type="button" onclick="previsualizarLogo()" style="background: linear-gradient(135deg, #8B5CF6, #7C3AED); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 1rem; width: 100%;">
                                    <i class="fas fa-eye"></i> Previsualizar Logo
                                </button>
                            </div>
                            
                            <div id="previewLogo" style="display: none; margin-bottom: 30px; text-align: center;">
                                <h3 style="color: #1F2937; margin-bottom: 20px;">Vista Previa del Logo</h3>
                                <div id="logoPreview" style="display: flex; justify-content: center;"></div>
                            </div>
                            
                            <div style="display: flex; gap: 15px; justify-content: center;">
                                <button type="button" onclick="cerrarModalGeneradorLogos()" style="background: #6b7280; color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                                <button type="submit" style="background: linear-gradient(135deg, #8B5CF6, #7C3AED); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                    <i class="fas fa-download"></i> Generar y Descargar
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        };
        
        // Funci√≥n para previsualizar logo
        window.previsualizarLogo = function() {
            const nombre = document.getElementById('nombreEmpresaLogo').value;
            const tipo = document.getElementById('tipoNegocioLogo').value;
            
            if (!nombre || !tipo) {
                mostrarNotificacion('‚ö†Ô∏è Completa todos los campos', 'warning');
                return;
            }
            
            const logoHTML = generarLogoAutomatico(nombre, tipo);
            const previewDiv = document.getElementById('previewLogo');
            const logoDiv = document.getElementById('logoPreview');
            
            logoDiv.innerHTML = logoHTML;
            previewDiv.style.display = 'block';
            
            mostrarNotificacion('üé® Logo previsualizado correctamente', 'success');
        };
        
        // Funci√≥n para generar logo completo
        window.generarLogoCompleto = function(event) {
            event.preventDefault();
            
            const nombre = document.getElementById('nombreEmpresaLogo').value;
            const tipo = document.getElementById('tipoNegocioLogo').value;
            
            const logoHTML = generarLogoAutomatico(nombre, tipo);
            
            // Crear archivo HTML con el logo
            const logoCompleto = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Logo - ${nombre}</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: #f8fafc; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            min-height: 100vh; 
        }
        .logo-container { 
            text-align: center; 
        }
        .logo { 
            margin: 0 auto 20px; 
        }
        .info { 
            color: #6B7280; 
            font-size: 0.9rem; 
        }
    </style>
</head>
<body>
    <div class="logo-container">
        <div class="logo">${logoHTML}</div>
        <div class="info">
            <p><strong>Empresa:</strong> ${nombre}</p>
            <p><strong>Tipo:</strong> ${tipo.charAt(0).toUpperCase() + tipo.slice(1)}</p>
            <p><strong>Generado:</strong> ${new Date().toLocaleDateString()}</p>
        </div>
    </div>
</body>
</html>
            `;
            
            // Descargar archivo
            const blob = new Blob([logoCompleto], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `logo-${nombre.replace(/\s+/g, '-').toLowerCase()}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            mostrarNotificacion('‚úÖ Logo generado y descargado correctamente', 'success');
            cerrarModalGeneradorLogos();
        };
        
        // Funci√≥n para cerrar modal de generador de logos
        window.cerrarModalGeneradorLogos = function() {
            const modal = document.getElementById('modalGeneradorLogos');
            if (modal) {
                modal.remove();
            }
        };
        
        // ========================================
        // SISTEMA DE COMISIONES TRANSPARENTE
        // ========================================
        
        // Configuraci√≥n de comisiones por plan
        const CONFIGURACION_COMISIONES = {
            gratuito: {
                porcentajeComision: 1.8, // 1.8% para plan gratuito (MUY JUSTO)
                comisionMinima: 30, // M√≠nimo $30 por transacci√≥n
                comisionMaxima: 1800, // M√°ximo $1800 por transacci√≥n
                descripcion: "Comisi√≥n plan gratuito - ¬°MUY JUSTO!"
            },
            basic: {
                porcentajeComision: 2.0, // 2.0% para plan b√°sico
                comisionMinima: 40, // M√≠nimo $40 por transacci√≥n
                comisionMaxima: 2000, // M√°ximo $2000 por transacci√≥n
                descripcion: "Comisi√≥n plan b√°sico - ¬°JUSTO!"
            },
            premium: {
                porcentajeComision: 1.5, // 1.5% para plan premium (¬°MEJOR!)
                comisionMinima: 25, // M√≠nimo $25 por transacci√≥n
                comisionMaxima: 1500, // M√°ximo $1500 por transacci√≥n
                descripcion: "Comisi√≥n plan premium - ¬°EXCELENTE!"
            }
        };
        
        // Funci√≥n para obtener plan actual
        window.obtenerPlanActual = function() {
            const plan = localStorage.getItem('plan_actual') || 'gratuito';
            return plan;
        };
        
        // Funci√≥n para calcular comisi√≥n seg√∫n el plan
        window.calcularComision = function(montoTransaccion) {
            const planActual = obtenerPlanActual();
            const configPlan = CONFIGURACION_COMISIONES[planActual] || CONFIGURACION_COMISIONES.gratuito;
            
            const comision = (montoTransaccion * configPlan.porcentajeComision) / 100;
            
            // Aplicar l√≠mites
            let comisionFinal = comision;
            if (comision < configPlan.comisionMinima) {
                comisionFinal = configPlan.comisionMinima;
            }
            if (comision > configPlan.comisionMaxima) {
                comisionFinal = configPlan.comisionMaxima;
            }
            
            return {
                montoOriginal: montoTransaccion,
                planActual: planActual,
                porcentajeComision: configPlan.porcentajeComision,
                comisionCalculada: comision,
                comisionFinal: comisionFinal,
                montoParaUsuario: montoTransaccion - comisionFinal,
                descripcion: configPlan.descripcion
            };
        };
        
        // Funci√≥n para mostrar informaci√≥n de comisiones
        window.mostrarInfoComisiones = function() {
            const modalHTML = `
                <div id="modalInfoComisiones" class="modal" style="display: flex !important; z-index: 99999 !important;">
                    <div class="modal-content" style="max-width: 600px; z-index: 100000 !important; background: white; border-radius: 20px; padding: 40px;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #10B981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; color: white; font-size: 2rem;">
                                <i class="fas fa-percentage"></i>
                            </div>
                            <h2 style="color: #333; margin-bottom: 10px;">üí∞ Sistema de Comisiones</h2>
                            <p style="color: #666; margin-bottom: 0;">Transparencia total en nuestras comisiones</p>
                        </div>
                        
                        <div style="background: #F0F9FF; border: 2px solid #0EA5E9; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                            <h3 style="color: #0C4A6E; margin-bottom: 15px;">
                                <i class="fas fa-info-circle"></i> Comisiones por Plan
                            </h3>
                            <div style="display: grid; gap: 15px;">
                                <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #10B981;">
                                    <div style="font-weight: 600; color: #1F2937; margin-bottom: 5px;">üÜì Plan Gratuito</div>
                                    <div style="color: #10B981; font-weight: bold; font-size: 1.2rem;">1.8% - ¬°MUY JUSTO!</div>
                                    <div style="color: #6B7280; font-size: 0.9rem;">M√≠n: $30 | M√°x: $1.800</div>
                                </div>
                                <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #F59E0B;">
                                    <div style="font-weight: 600; color: #1F2937; margin-bottom: 5px;">‚≠ê Plan B√°sico</div>
                                    <div style="color: #F59E0B; font-weight: bold; font-size: 1.2rem;">2.0% - ¬°JUSTO!</div>
                                    <div style="color: #6B7280; font-size: 0.9rem;">M√≠n: $40 | M√°x: $2.000</div>
                                </div>
                                <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #8B5CF6;">
                                    <div style="font-weight: 600; color: #1F2937; margin-bottom: 5px;">üíé Plan Premium</div>
                                    <div style="color: #8B5CF6; font-weight: bold; font-size: 1.2rem;">1.5% - ¬°EXCELENTE!</div>
                                    <div style="color: #6B7280; font-size: 0.9rem;">M√≠n: $25 | M√°x: $1.500</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h3 style="color: #1F2937; margin-bottom: 15px;">
                                <i class="fas fa-calculator"></i> Ejemplos de C√°lculo
                            </h3>
                            <div style="display: grid; gap: 10px;">
                                <div style="background: #F9FAFB; padding: 15px; border-radius: 8px; border-left: 4px solid #10B981;">
                                    <div style="font-weight: 600; color: #1F2937;">üÜì Plan Gratuito - Transacci√≥n de $1.000</div>
                                    <div style="color: #6B7280; font-size: 0.9rem;">Comisi√≥n: $18 (1.8%) | Usuario recibe: $982</div>
                                </div>
                                <div style="background: #F9FAFB; padding: 15px; border-radius: 8px; border-left: 4px solid #F59E0B;">
                                    <div style="font-weight: 600; color: #1F2937;">‚≠ê Plan B√°sico - Transacci√≥n de $1.000</div>
                                    <div style="color: #6B7280; font-size: 0.9rem;">Comisi√≥n: $20 (2.0%) | Usuario recibe: $980</div>
                                </div>
                                <div style="background: #F9FAFB; padding: 15px; border-radius: 8px; border-left: 4px solid #8B5CF6;">
                                    <div style="font-weight: 600; color: #1F2937;">üíé Plan Premium - Transacci√≥n de $1.000</div>
                                    <div style="color: #6B7280; font-size: 0.9rem;">Comisi√≥n: $15 (1.5%) | Usuario recibe: $985</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: #F0F9FF; border: 2px solid #0EA5E9; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                            <h3 style="color: #0C4A6E; margin-bottom: 15px;">
                                <i class="fas fa-chart-bar"></i> Comparaci√≥n con Otras Plataformas
                            </h3>
                            <div style="display: grid; gap: 10px;">
                                <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #10B981;">
                                    <div style="font-weight: 600; color: #1F2937; margin-bottom: 5px;">üèÜ Cresalia Gratuito</div>
                                    <div style="color: #10B981; font-weight: bold;">1.8% - ¬°MUY JUSTO!</div>
                                </div>
                                <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #8B5CF6;">
                                    <div style="font-weight: 600; color: #1F2937; margin-bottom: 5px;">üíé Cresalia Premium</div>
                                    <div style="color: #8B5CF6; font-weight: bold;">1.5% - ¬°EXCELENTE!</div>
                                </div>
                                <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #F59E0B;">
                                    <div style="font-weight: 600; color: #1F2937; margin-bottom: 5px;">üí≥ Mercado Pago</div>
                                    <div style="color: #F59E0B; font-weight: bold;">3.5% (2.9% + IVA)</div>
                                </div>
                                <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #8B5CF6;">
                                    <div style="font-weight: 600; color: #1F2937; margin-bottom: 5px;">üí≥ PayPal</div>
                                    <div style="color: #8B5CF6; font-weight: bold;">3.2% (2.9% + $0.30)</div>
                                </div>
                                <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #EF4444;">
                                    <div style="font-weight: 600; color: #1F2937; margin-bottom: 5px;">üöö Rappi</div>
                                    <div style="color: #EF4444; font-weight: bold;">15-25% (¬°MUY ALTO!)</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: #FEF3C7; border: 2px solid #F59E0B; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                            <h3 style="color: #92400E; margin-bottom: 10px;">
                                <i class="fas fa-shield-alt"></i> Transparencia Total
                            </h3>
                            <ul style="color: #92400E; margin: 0; padding-left: 20px;">
                                <li>‚úÖ <strong>Comisiones claras:</strong> Siempre mostramos el porcentaje</li>
                                <li>‚úÖ <strong>C√°lculo transparente:</strong> Usuario ve exactamente cu√°nto recibe</li>
                                <li>‚úÖ <strong>L√≠mites justos:</strong> Comisi√≥n m√≠nima y m√°xima establecidas</li>
                                <li>‚úÖ <strong>Sin sorpresas:</strong> Todo se muestra antes de la transacci√≥n</li>
                                <li>‚úÖ <strong>M√°s justo:</strong> 2.5% vs 3.5% de Mercado Pago</li>
                            </ul>
                        </div>
                        
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button onclick="cerrarModalInfoComisiones()" style="background: #6b7280; color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-times"></i> Cerrar
                            </button>
                            <button onclick="mostrarCalculadoraComisiones()" style="background: linear-gradient(135deg, #10B981, #059669); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-calculator"></i> Calcular Comisi√≥n
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        };
        
        // Funci√≥n para cerrar modal de informaci√≥n de comisiones
        window.cerrarModalInfoComisiones = function() {
            const modal = document.getElementById('modalInfoComisiones');
            if (modal) {
                modal.remove();
            }
        };
        
        // Funci√≥n para mostrar calculadora de comisiones
        window.mostrarCalculadoraComisiones = function() {
            cerrarModalInfoComisiones();
            
            const modalHTML = `
                <div id="modalCalculadoraComisiones" class="modal" style="display: flex !important; z-index: 99999 !important;">
                    <div class="modal-content" style="max-width: 500px; z-index: 100000 !important; background: white; border-radius: 20px; padding: 40px;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #8B5CF6, #7C3AED); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; color: white; font-size: 2rem;">
                                <i class="fas fa-calculator"></i>
                            </div>
                            <h2 style="color: #333; margin-bottom: 10px;">üßÆ Calculadora de Comisiones</h2>
                            <p style="color: #666; margin-bottom: 0;">Calcula tu comisi√≥n de forma transparente</p>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Monto de la Transacci√≥n</label>
                            <input type="number" id="montoTransaccion" placeholder="Ej: 1000" step="0.01" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                        </div>
                        
                        <button onclick="calcularComisionTransaccion()" style="background: linear-gradient(135deg, #8B5CF6, #7C3AED); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem; width: 100%; margin-bottom: 20px;">
                            <i class="fas fa-calculator"></i> Calcular Comisi√≥n
                        </button>
                        
                        <div id="resultadoComision" style="display: none; background: #F0F9FF; border: 2px solid #0EA5E9; border-radius: 12px; padding: 20px;">
                            <h3 style="color: #0C4A6E; margin-bottom: 15px;">
                                <i class="fas fa-chart-pie"></i> Resultado del C√°lculo
                            </h3>
                            <div id="detalleComision"></div>
                        </div>
                        
                        <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                            <button onclick="cerrarModalCalculadoraComisiones()" style="background: #6b7280; color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-times"></i> Cerrar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        };
        
        // Funci√≥n para calcular comisi√≥n de transacci√≥n
        window.calcularComisionTransaccion = function() {
            const monto = parseFloat(document.getElementById('montoTransaccion').value);
            
            if (!monto || monto <= 0) {
                mostrarNotificacion('‚ö†Ô∏è Ingresa un monto v√°lido', 'warning');
                return;
            }
            
            const resultado = calcularComision(monto);
            const resultadoDiv = document.getElementById('resultadoComision');
            const detalleDiv = document.getElementById('detalleComision');
            
            detalleDiv.innerHTML = `
                <div style="display: grid; gap: 10px;">
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #10B981;">
                        <div style="font-weight: 600; color: #1F2937; margin-bottom: 5px;">Monto Original</div>
                        <div style="font-size: 1.2rem; color: #10B981; font-weight: bold;">$${resultado.montoOriginal.toLocaleString()}</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #F59E0B;">
                        <div style="font-weight: 600; color: #1F2937; margin-bottom: 5px;">Comisi√≥n (${resultado.porcentajeComision}%)</div>
                        <div style="font-size: 1.2rem; color: #F59E0B; font-weight: bold;">$${resultado.comisionFinal.toLocaleString()}</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #8B5CF6;">
                        <div style="font-weight: 600; color: #1F2937; margin-bottom: 5px;">Usuario Recibe</div>
                        <div style="font-size: 1.2rem; color: #8B5CF6; font-weight: bold;">$${resultado.montoParaUsuario.toLocaleString()}</div>
                    </div>
                </div>
            `;
            
            resultadoDiv.style.display = 'block';
        };
        
        // Funci√≥n para cerrar modal de calculadora de comisiones
        window.cerrarModalCalculadoraComisiones = function() {
            const modal = document.getElementById('modalCalculadoraComisiones');
            if (modal) {
                modal.remove();
            }
        };
        
        // Cargar configuraci√≥n al iniciar
        document.addEventListener('DOMContentLoaded', function() {
            // FORZAR DESACTIVACI√ìN DE TODOS LOS SISTEMAS DE PREVENCI√ìN
            window._preventAutoModals = false;
            window._modalesBloqueados = false;
            
            // Funci√≥n para forzar el cierre de todos los sistemas de prevenci√≥n
            window.forzarCierreSistemasPrevencion = function() {
                console.log('üîß FORZANDO cierre de todos los sistemas de prevenci√≥n...');
                window._preventAutoModals = false;
                window._modalesBloqueados = false;
                
                // Desactivar todos los intervalos que cierran modales
                for (let i = 1; i < 10000; i++) {
                    clearInterval(i);
                }
                
                console.log('‚úÖ Sistemas de prevenci√≥n FORZADOS a cerrar');
            };
            
            // Ejecutar inmediatamente
            window.forzarCierreSistemasPrevencion();
            
            // DESACTIVAR SISTEMA DE OPTIMIZACI√ìN DE ANIMACIONES Y RESTAURAR EVENT LISTENERS
            window.desactivarOptimizacionAnimaciones = function() {
                console.log('üö´ DESACTIVANDO sistema de optimizaci√≥n de animaciones...');
                
                // Desactivar la funci√≥n de optimizaci√≥n
                if (window.optimizarAnimaciones) {
                    window.optimizarAnimaciones = function() { 
                        console.log('üö´ Optimizaci√≥n de animaciones DESACTIVADA'); 
                    };
                }
                
                // Desactivar intervalos de optimizaci√≥n
                for (let i = 1; i < 10000; i++) {
                    clearInterval(i);
                }
                
                // RESTAURAR EVENT LISTENERS ELIMINADOS
                console.log('üîß RESTAURANDO event listeners eliminados...');
                
                // Restaurar bot√≥n de turnos
                const botonTurnos = document.querySelector('[onclick*="abrirSistemaTurnos"]');
                if (botonTurnos) {
                    botonTurnos.onclick = function() {
                        console.log('üîß Event listener restaurado para turnos');
                        window.abrirSistemaTurnos();
                    };
                }
                
                // Restaurar bot√≥n de servicios
                const botonServicios = document.querySelector('[onclick*="mostrarFormularioServicio"]');
                if (botonServicios) {
                    botonServicios.onclick = function() {
                        console.log('üîß Event listener restaurado para servicios');
                        mostrarFormularioServicio();
                    };
                }
                
                // Restaurar bot√≥n de productos
                const botonProductos = document.querySelector('[onclick*="mostrarFormularioProducto"]');
                if (botonProductos) {
                    botonProductos.onclick = function() {
                        console.log('üîß Event listener restaurado para productos');
                        mostrarFormularioProducto();
                    };
                }
                
                console.log('‚úÖ Event listeners RESTAURADOS');
                console.log('‚úÖ Sistema de optimizaci√≥n de animaciones DESACTIVADO');
            };
            
            // Ejecutar desactivaci√≥n INMEDIATAMENTE
            setTimeout(() => {
                window.desactivarOptimizacionAnimaciones();
            }, 100);
            
            // RESTAURAR EVENT LISTENERS INMEDIATAMENTE
            setTimeout(() => {
                console.log('üîß RESTAURANDO event listeners INMEDIATAMENTE...');
                window.restaurarEventListenersDashboard();
            }, 200);
            
            // DESACTIVAR COMPLETAMENTE EL SISTEMA DE OPTIMIZACI√ìN
            setTimeout(() => {
                console.log('üö´ DESACTIVANDO completamente el sistema de optimizaci√≥n...');
                
                // Desactivar todas las funciones de optimizaci√≥n
                if (window.optimizarAnimaciones) {
                    window.optimizarAnimaciones = function() { 
                        console.log('üö´ Optimizaci√≥n de animaciones DESACTIVADA'); 
                    };
                }
                
                // Desactivar todos los intervalos
                for (let i = 1; i < 10000; i++) {
                    clearInterval(i);
                }
                
                // Desactivar todos los timeouts
                for (let i = 1; i < 10000; i++) {
                    clearTimeout(i);
                }
                
                console.log('‚úÖ Sistema de optimizaci√≥n COMPLETAMENTE DESACTIVADO');
            }, 500);
            
            // ELIMINAR COMPLETAMENTE MODALES ANTIGUOS DEL DOM
            setTimeout(() => {
                console.log('üîß ELIMINANDO modales antiguos del DOM...');
                
                // Eliminar modales antiguos del DOM
                const modalesAntiguos = document.querySelectorAll('.modal');
                modalesAntiguos.forEach(modal => {
                    if (modal.id === 'modalProducto' || modal.id === 'modalServicio') {
                        console.log('üóëÔ∏è Eliminando modal antiguo del DOM:', modal.id);
                        modal.remove();
                    }
                });
                
                // Eliminar tambi√©n cualquier modal que se cree din√°micamente
                const observer = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        mutation.addedNodes.forEach((node) => {
                            if (node.nodeType === 1 && node.classList && node.classList.contains('modal')) {
                                if (node.id === 'modalProducto' || node.id === 'modalServicio' || node.id === 'modalSistemaTurnos') {
                                    console.log('üóëÔ∏è Eliminando modal antiguo creado din√°micamente:', node.id);
                                    node.remove();
                                }
                            }
                        });
                    });
                });
                
                observer.observe(document.body, { childList: true, subtree: true });
                
                console.log('‚úÖ Modales antiguos ELIMINADOS del DOM');
            }, 100);
            
            // ARREGLAR ERRORES DE VALIDACI√ìN DE FORMULARIOS
            setTimeout(() => {
                console.log('üîß ARREGLANDO errores de validaci√≥n de formularios...');
                
                // Arreglar campos sin atributo name
                const camposSinName = document.querySelectorAll('input[required]:not([name]), select[required]:not([name])');
                camposSinName.forEach((campo, index) => {
                    if (!campo.name) {
                        campo.name = `campo_${campo.id || index}`;
                        console.log('üîß Atributo name agregado a:', campo.id || campo.tagName);
                    }
                });
                
                console.log('‚úÖ Errores de validaci√≥n arreglados');
            }, 200);
            
            // RESTAURAR EVENT LISTENERS INMEDIATAMENTE
            setTimeout(() => {
                console.log('üîß RESTAURANDO event listeners INMEDIATAMENTE...');
                
                // Restaurar bot√≥n de turnos
                const botonTurnos = document.querySelector('[onclick*="abrirSistemaTurnos"]');
                if (botonTurnos) {
                    botonTurnos.onclick = function() {
                        console.log('üîß Event listener restaurado para turnos');
                        window.abrirSistemaTurnos();
                    };
                    console.log('‚úÖ Bot√≥n de turnos restaurado');
                }
                
                // Restaurar bot√≥n de servicios
                const botonServicios = document.querySelector('[onclick*="mostrarFormularioServicio"]');
                if (botonServicios) {
                    botonServicios.onclick = function() {
                        console.log('üîß Event listener restaurado para servicios');
                        mostrarFormularioServicio();
                    };
                    console.log('‚úÖ Bot√≥n de servicios restaurado');
                }
                
                // Restaurar bot√≥n de productos
                const botonProductos = document.querySelector('[onclick*="mostrarFormularioProducto"]');
                if (botonProductos) {
                    botonProductos.onclick = function() {
                        console.log('üîß Event listener restaurado para productos');
                        mostrarFormularioProducto();
                    };
                    console.log('‚úÖ Bot√≥n de productos restaurado');
                }
                
                console.log('‚úÖ Event listeners RESTAURADOS INMEDIATAMENTE');
            }, 500);
            
            // Funci√≥n para mantener modales abiertos
            window.mantenerModalesAbiertos = function() {
                setInterval(() => {
                    const modalesAbiertos = document.querySelectorAll('.modal[style*="flex"], .modal.show');
                    modalesAbiertos.forEach(modal => {
                        if (modal.style.display === 'flex' || modal.classList.contains('show')) {
                            // Forzar que permanezca abierto
                            modal.style.display = 'flex';
                            modal.style.visibility = 'visible';
                            modal.style.opacity = '1';
                            modal.style.zIndex = '999999';
                            modal.classList.add('show');
                        }
                    });
                }, 100);
            };
            
            // Iniciar mantenimiento de modales
            setTimeout(() => {
                window.mantenerModalesAbiertos();
            }, 1000);
            
            // MANTENER EVENT LISTENERS ACTIVOS CONTINUAMENTE
            setInterval(() => {
                // Restaurar bot√≥n de turnos si fue eliminado
                const botonTurnos = document.querySelector('[onclick*="abrirSistemaTurnos"]');
                if (botonTurnos && !botonTurnos.onclick) {
                    botonTurnos.onclick = function() {
                        console.log('üîß Event listener restaurado para turnos (continuo)');
                        window.abrirSistemaTurnos();
                    };
                }
                
                // Restaurar bot√≥n de servicios si fue eliminado
                const botonServicios = document.querySelector('[onclick*="mostrarFormularioServicio"]');
                if (botonServicios && !botonServicios.onclick) {
                    botonServicios.onclick = function() {
                        console.log('üîß Event listener restaurado para servicios (continuo)');
                        mostrarFormularioServicio();
                    };
                }
                
                // Restaurar bot√≥n de productos si fue eliminado
                const botonProductos = document.querySelector('[onclick*="mostrarFormularioProducto"]');
                if (botonProductos && !botonProductos.onclick) {
                    botonProductos.onclick = function() {
                        console.log('üîß Event listener restaurado para productos (continuo)');
                        mostrarFormularioProducto();
                    };
                }
                
                // RESTAURAR TODOS LOS EVENT LISTENERS DEL DASHBOARD
                restaurarEventListenersDashboard();
            }, 1000);
            
            // Funci√≥n para restaurar todos los event listeners del dashboard
            window.restaurarEventListenersDashboard = function() {
                console.log('üîß RESTAURANDO event listeners del dashboard...');
                
                // Restaurar botones de navegaci√≥n del dashboard
                const botonesNavegacion = document.querySelectorAll('[onclick*="mostrarSeccion"]');
                botonesNavegacion.forEach(boton => {
                    if (!boton.onclick) {
                        const onclick = boton.getAttribute('onclick');
                        if (onclick) {
                            boton.onclick = function() {
                                console.log('üîß Event listener restaurado para navegaci√≥n:', onclick);
                                eval(onclick);
                            };
                        }
                    }
                });
                
                // Restaurar botones de men√∫
                const botonesMenu = document.querySelectorAll('[onclick*="abrir"]');
                botonesMenu.forEach(boton => {
                    if (!boton.onclick) {
                        const onclick = boton.getAttribute('onclick');
                        if (onclick) {
                            boton.onclick = function() {
                                console.log('üîß Event listener restaurado para men√∫:', onclick);
                                eval(onclick);
                            };
                        }
                    }
                });
                
                // Restaurar botones de cerrar
                const botonesCerrar = document.querySelectorAll('[onclick*="cerrar"]');
                botonesCerrar.forEach(boton => {
                    if (!boton.onclick) {
                        const onclick = boton.getAttribute('onclick');
                        if (onclick) {
                            boton.onclick = function() {
                                console.log('üîß Event listener restaurado para cerrar:', onclick);
                                eval(onclick);
                            };
                        }
                    }
                });
                
                // RESTAURAR ESPEC√çFICAMENTE LOS MODALES NUEVOS (REDISE√ëADOS)
                console.log('üîß RESTAURANDO modales nuevos (redise√±ados)...');
                
                // Restaurar bot√≥n de productos nuevo
                const botonProductoNuevo = document.querySelector('[onclick*="mostrarFormularioProducto"]');
                if (botonProductoNuevo && !botonProductoNuevo.onclick) {
                    botonProductoNuevo.onclick = function() {
                        console.log('üîß Event listener restaurado para producto NUEVO');
                        mostrarFormularioProducto();
                    };
                }
                
                // Restaurar bot√≥n de servicios nuevo
                const botonServicioNuevo = document.querySelector('[onclick*="mostrarFormularioServicio"]');
                if (botonServicioNuevo && !botonServicioNuevo.onclick) {
                    botonServicioNuevo.onclick = function() {
                        console.log('üîß Event listener restaurado para servicio NUEVO');
                        mostrarFormularioServicio();
                    };
                }
                
                // Restaurar bot√≥n de turnos nuevo
                const botonTurnosNuevo = document.querySelector('[onclick*="abrirSistemaTurnos"]');
                if (botonTurnosNuevo && !botonTurnosNuevo.onclick) {
                    botonTurnosNuevo.onclick = function() {
                        console.log('üîß Event listener restaurado para turnos NUEVO');
                        window.abrirSistemaTurnos();
                    };
                }
                
                console.log('‚úÖ Event listeners del dashboard restaurados');
            };
            
            // SOLUCI√ìN DEFINITIVA: Interceptar TODAS las llamadas a funciones de modales
            const funcionesModales = ['mostrarFormularioProducto', 'mostrarFormularioServicio', 'mostrarFormularioOferta', 'mostrarModalConfirmacionPlan', 'abrirSistemaTurnos'];
            
            funcionesModales.forEach(funcion => {
                // Guardar la funci√≥n original si existe
                const original = window[funcion];
                
                // Reemplazar con funci√≥n interceptora
                window[funcion] = function(...args) {
                    console.log('üö´ INTERCEPTADO:', funcion, 'desde:', new Error().stack);
                    
                    // Solo permitir si es un evento confiable del usuario
                    if (event && event.isTrusted) {
                        console.log('‚úÖ Evento confiable permitido:', funcion);
                        if (original) return original.apply(this, args);
                    } else {
                        console.log('üö´ Evento no confiable bloqueado:', funcion);
                        return false;
                    }
                };
            });
            
            // Funci√≥n robusta para cerrar modales autom√°ticos
            function cerrarModalesAutomaticos() {
                const modales = document.querySelectorAll('.modal, [class*="modal"], [id*="modal"]');
                modales.forEach(modal => {
                    const computedStyle = window.getComputedStyle(modal);
                    if (computedStyle.display === 'flex' || computedStyle.display === 'block' || modal.style.display === 'flex' || modal.style.display === 'block') {
                        console.log('üö´ Cerrando modal autom√°tico:', modal.id || modal.className);
                        modal.style.display = 'none';
                        modal.remove();
                    }
                });
            }
            
            // Cerrar modales autom√°ticos m√∫ltiples veces
            setTimeout(cerrarModalesAutomaticos, 500);
            setTimeout(cerrarModalesAutomaticos, 1000);
            setTimeout(cerrarModalesAutomaticos, 2000);
            setTimeout(cerrarModalesAutomaticos, 3000);
            
            // Prevenir ejecuci√≥n autom√°tica de funciones de modales
            funcionesModales.forEach(funcion => {
                if (window[funcion]) {
                    const original = window[funcion];
                    window[funcion] = function(...args) {
                        if (window._preventAutoModals && !event?.isTrusted) {
                            console.log('üö´ Prevenido modal autom√°tico:', funcion);
                            return;
                        }
                        return original.apply(this, args);
                    };
                }
            });
            
            // Funci√≥n para optimizar animaciones cuando hay muchas activas
            function optimizarAnimaciones() {
                const elementosAnimados = document.querySelectorAll('[style*="animation"]');
                if (elementosAnimados.length > 50) {
                    console.log('‚ö° Optimizando animaciones - Demasiadas activas:', elementosAnimados.length);
                    elementosAnimados.forEach((elemento, index) => {
                        if (index > 20) { // Mantener solo las primeras 20 animaciones
                            elemento.style.animation = 'none';
                        }
                    });
                }
            }
            
            // Optimizar animaciones cada 5 segundos
            setInterval(optimizarAnimaciones, 5000);
            
            // Interceptar funciones que se definan despu√©s de cargar scripts externos
            setTimeout(() => {
                console.log('üîç Re-interceptando funciones despu√©s de scripts externos...');
                funcionesModales.forEach(funcion => {
                    if (window[funcion] && !window[funcion].toString().includes('INTERCEPTADO')) {
                        const original = window[funcion];
                        window[funcion] = function(...args) {
                            console.log('üö´ INTERCEPTADO TARD√çO:', funcion);
                            if (event && event.isTrusted) {
                                console.log('‚úÖ Evento confiable permitido:', funcion);
                                return original.apply(this, args);
                            } else {
                                console.log('üö´ Evento no confiable bloqueado:', funcion);
                                return false;
                            }
                        };
                    }
                });
            }, 3000);
            
            // Interceptar continuamente cualquier funci√≥n que se defina despu√©s
            setInterval(() => {
                funcionesModales.forEach(funcion => {
                    if (window[funcion] && !window[funcion].toString().includes('INTERCEPTADO')) {
                        console.log('üîç Interceptando funci√≥n tard√≠a:', funcion);
                        const original = window[funcion];
                        window[funcion] = function(...args) {
                            console.log('üö´ INTERCEPTADO CONTINUO:', funcion);
                            if (event && event.isTrusted) {
                                console.log('‚úÖ Evento confiable permitido:', funcion);
                                return original.apply(this, args);
                            } else {
                                console.log('üö´ Evento no confiable bloqueado:', funcion);
                                return false;
                            }
                        };
                    }
                });
            }, 2000);
            
            setTimeout(() => {
                if (window.cargarConfiguracionSuscripciones) {
                    window.cargarConfiguracionSuscripciones();
                }
            }, 1000);
            
            setTimeout(() => {
                if (window.cargarServiciosRemiseria) {
                    window.cargarServiciosRemiseria();
                }
            }, 2000);
        });
        
        // ========================================
        // FUNCIONES ADICIONALES PARA MODALES
        // ========================================
        
        // Funci√≥n para mostrar formulario de servicios (versi√≥n corregida)
        window.mostrarFormularioServicio = function() {
            console.log('üîß Mostrando formulario de servicio...');
            
            // Verificar si ya existe un modal de servicio
            let modal = document.getElementById('modalServicio');
            if (modal) {
                modal.remove(); // Eliminar modal existente
            }
            
            // Crear modal de servicio
            modal = document.createElement('div');
            modal.id = 'modalServicio';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 999999 !important;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 40px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #f093fb, #f5576c); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; color: white; font-size: 2rem;">
                            <i class="fas fa-tools"></i>
                        </div>
                        <h2 style="color: #333; margin-bottom: 10px;">Agregar Nuevo Servicio</h2>
                        <p style="color: #666; margin-bottom: 0;">Completa la informaci√≥n de tu servicio</p>
                    </div>
                    
                    <form id="formServicio" onsubmit="guardarServicio(event)">
                        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Nombre del Servicio</label>
                                <input type="text" id="nombreServicio" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Precio</label>
                                <input type="number" id="precioServicio" step="0.01" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Categor√≠a</label>
                                <select id="categoriaServicio" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                    <option value="">Seleccionar categor√≠a</option>
                                    <option value="peluqueria">Peluquer√≠a</option>
                                    <option value="estetica">Est√©tica y Belleza</option>
                                    <option value="transporte">Transporte</option>
                                    <option value="lubricentro">Lubricentro</option>
                                    <option value="detail">Detail y Limpieza</option>
                                    <option value="distribucion">Distribuci√≥n</option>
                                    <option value="restaurante">Restaurante</option>
                                    <option value="bar">Bar y Tragos</option>
                                    <option value="cafe">Caf√© y T√©</option>
                                    <option value="panaderia">Panader√≠a</option>
                                    <option value="comida">Comida</option>
                                    <option value="negocio">Negocio General</option>
                                    <option value="local">Local Comercial</option>
                                    <option value="otros">Otros</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Duraci√≥n</label>
                                <input type="text" id="duracionServicio" placeholder="ej: 60 minutos" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Descripci√≥n</label>
                            <textarea id="descripcionServicio" rows="3" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem; resize: vertical;"></textarea>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Modalidad</label>
                                <select id="modalidadServicio" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                    <option value="">Seleccionar modalidad</option>
                                    <option value="presencial">Presencial</option>
                                    <option value="online">Online</option>
                                    <option value="mixto">Mixto</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Cupos Disponibles</label>
                                <input type="number" id="cuposServicio" min="1" value="10" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 30px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Informaci√≥n de Contacto</label>
                            <input type="text" id="contactoServicio" placeholder="WhatsApp, email, tel√©fono..." style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                        </div>
                        
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button type="button" onclick="cerrarModalServicio()" style="background: #6b7280; color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                            <button type="submit" style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-save"></i> Guardar Servicio
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de servicio creado');
        };
        
        function cerrarModalServicio() {
            const modal = document.getElementById('modalServicio');
            if (modal) {
                modal.remove();
            }
        }
        
        // Funci√≥n para guardar servicio
        function guardarServicio(event) {
            event.preventDefault();
            console.log('üíæ Guardando servicio...');
            
            const nombre = document.getElementById('nombreServicio').value;
            const precio = parseFloat(document.getElementById('precioServicio').value);
            const categoria = document.getElementById('categoriaServicio').value;
            const duracion = document.getElementById('duracionServicio').value;
            const descripcion = document.getElementById('descripcionServicio').value;
            const modalidad = document.getElementById('modalidadServicio').value;
            const cupos = parseInt(document.getElementById('cuposServicio').value);
            const contacto = document.getElementById('contactoServicio').value;
            
            if (!nombre || !precio || !categoria || !duracion || !modalidad) {
                mostrarNotificacion('‚ö†Ô∏è Por favor completa todos los campos requeridos', 'error');
                return;
            }
            
            // Crear objeto del servicio
            const nuevoServicio = {
                id: Date.now(),
                tipo: 'servicio',
                nombre: nombre,
                precio: precio,
                categoria: categoria,
                duracion: duracion,
                descripcion: descripcion,
                modalidad: modalidad,
                cupos: cupos,
                contacto: contacto,
                disponible: true,
                fechaCreacion: new Date().toISOString()
            };
            
            // Guardar en localStorage
            const tiendaId = obtenerTiendaId();
            let servicios = JSON.parse(localStorage.getItem(`servicios_${tiendaId}`) || '[]');
            servicios.push(nuevoServicio);
            localStorage.setItem(`servicios_${tiendaId}`, JSON.stringify(servicios));
            
            mostrarNotificacion('‚úÖ Servicio guardado exitosamente', 'success');
            cerrarModalServicio();
            
            // Recargar la lista de servicios
            setTimeout(() => cargarServiciosEjemplo(), 500);
        }
        
        // ========================================
        // PREVENIR EJECUCI√ìN AUTOM√ÅTICA DE MODALES
        // ========================================
        
        // Funci√≥n para prevenir modales autom√°ticos - DESACTIVADA
        window.prevenirModalesAutomaticos = function() {
            console.log('üö´ Prevenci√≥n de modales autom√°ticos DESACTIVADA');
            
            // Marcar que S√ç se pueden ejecutar modales manualmente
            window._preventAutoModals = false;
            
            // Cerrar cualquier modal que se haya abierto autom√°ticamente - DESACTIVADO
            /*
            setTimeout(() => {
                const modales = document.querySelectorAll('.modal, [id*="modal"]');
                modales.forEach(modal => {
                    if (modal.style.display !== 'none' && modal.style.display !== '') {
                        modal.style.display = 'none';
                        modal.remove();
                        console.log('üö´ Modal autom√°tico cerrado:', modal.id);
                    }
                });
            }, 1000);
            */
            
            // Prevenir ejecuci√≥n autom√°tica de funciones de modales - DESACTIVADO
            /*
            const funcionesModales = ['mostrarFormularioProducto', 'mostrarFormularioServicio', 'mostrarFormularioOferta', 'mostrarModalConfirmacionPlan', 'abrirSistemaTurnos'];
            funcionesModales.forEach(funcion => {
                if (window[funcion]) {
                    const funcionOriginal = window[funcion];
                    window[funcion] = function(...args) {
                        // Solo ejecutar si es un clic real del usuario
                        if (event && event.isTrusted) {
                            console.log('‚úÖ Ejecuci√≥n autorizada de:', funcion);
                            return funcionOriginal.apply(this, args);
                        } else {
                            console.log('üö´ Ejecuci√≥n autom√°tica bloqueada de:', funcion);
                            return;
                        }
                    };
                }
            });
            */
        };
        
        // ========================================
        // SOBRESCRIBIR FUNCIONES DE CORRECCIONES-ADMIN.JS
        // ========================================
        
        // Sobrescribir la funci√≥n de correcciones-admin.js para que use nuestra implementaci√≥n
        window.mostrarFormularioProducto = function() {
            console.log('üì¶ [SOBRESCRITURA] Mostrando formulario de producto...');
            
            // Verificar si ya existe un modal de producto
            let modal = document.getElementById('modalProducto');
            if (modal) {
                console.log('üóëÔ∏è Eliminando modal existente');
                modal.remove();
            }
            
            // Crear modal de producto
            modal = document.createElement('div');
            modal.id = 'modalProducto';
            modal.className = 'modal';
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0,0,0,0.8) !important;
                z-index: 999999 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                padding: 20px !important;
                box-sizing: border-box !important;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 25px; max-width: 450px; width: 95%; max-height: 80vh; overflow-y: auto;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #10B981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: white; font-size: 1.5rem;">
                            <i class="fas fa-box"></i>
                        </div>
                        <h2 style="color: #333; margin-bottom: 8px; font-size: 1.4rem;">Agregar Nuevo Producto</h2>
                        <p style="color: #666; margin-bottom: 0; font-size: 0.9rem;">Completa la informaci√≥n de tu producto</p>
                    </div>
                    
                    <form id="formProducto" onsubmit="guardarProducto(event)">
                        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Nombre del Producto</label>
                                <input type="text" id="nombreProducto" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Precio</label>
                                <input type="number" id="precioProducto" step="0.01" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Categor√≠a</label>
                                <select id="categoriaProducto" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                                    <option value="">Seleccionar categor√≠a</option>
                                    <option value="ropa-mujer">Ropa de Mujer</option>
                                    <option value="ropa-hombre">Ropa de Hombre</option>
                                    <option value="electronica">Electr√≥nica</option>
                                    <option value="hogar">Hogar</option>
                                    <option value="belleza">Belleza</option>
                                    <option value="deportes">Deportes</option>
                                    <option value="alimentos">Alimentos y Bebidas</option>
                                    <option value="panaderia">Panader√≠a y Pasteler√≠a</option>
                                    <option value="comida-rapida">Comida R√°pida</option>
                                    <option value="restaurante">Restaurante</option>
                                    <option value="bar">Bar y Tragos</option>
                                    <option value="cafe">Caf√© y T√©</option>
                                    <option value="automotriz">Automotriz</option>
                                    <option value="lubricentro">Lubricentro</option>
                                    <option value="detail">Detail y Limpieza</option>
                                    <option value="transporte">Transporte</option>
                                    <option value="distribucion">Distribuci√≥n</option>
                                    <option value="negocio">Negocio General</option>
                                    <option value="local">Local Comercial</option>
                                    <option value="otros">Otros</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Stock</label>
                                <input type="number" id="stockProducto" min="0" required style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Descripci√≥n</label>
                            <textarea id="descripcionProducto" rows="3" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem; resize: vertical;"></textarea>
                        </div>
                        
                        <div id="opcionIAProducto">
                            ${mostrarOpcionIA('producto')}
                        </div>
                        
                        <div style="margin-bottom: 30px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Imagen del Producto</label>
                            <input type="file" id="imagenProducto" accept="image/*" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                            <small style="color: #6B7280; font-size: 0.8rem;">Se guardar√° en localStorage para mayor privacidad</small>
                        </div>
                        
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button type="button" onclick="cerrarModalProducto()" style="background: #6b7280; color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                            <button type="submit" style="background: linear-gradient(135deg, #10B981, #059669); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                                <i class="fas fa-save"></i> Guardar Producto
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            console.log('‚úÖ HTML del modal de producto generado');
            document.body.appendChild(modal);
            console.log('‚úÖ Modal de producto agregado al DOM');
            
            // Verificar que el modal se agreg√≥ correctamente
            setTimeout(() => {
                const modalVerificado = document.getElementById('modalProducto');
                if (modalVerificado) {
                    console.log('‚úÖ Modal de producto verificado en el DOM');
                    console.log('‚úÖ Modal visible:', modalVerificado.style.display);
                } else {
                    console.error('‚ùå Modal de producto no encontrado en el DOM');
                }
            }, 100);
        };
        
        // Ejecutar prevenci√≥n al cargar - DESACTIVADA
        document.addEventListener('DOMContentLoaded', function() {
            // window.prevenirModalesAutomaticos(); // DESACTIVADO
            
            // Prevenci√≥n adicional m√°s agresiva - DESACTIVADA
            /*
            setTimeout(() => {
                // Cerrar TODOS los modales que puedan estar abiertos (SOLO OCULTAR, NO ELIMINAR)
                const todosLosModales = document.querySelectorAll('.modal, [class*="modal"], [id*="modal"]');
                todosLosModales.forEach(modal => {
                    modal.style.display = 'none';
                    modal.classList.remove('show');
                    console.log('üö´ Modal cerrado preventivamente:', modal.id);
                });
                
                // Prevenir que se abran autom√°ticamente
                window._modalesBloqueados = false; // Cambiado a false para permitir apertura manual
            }, 100);
            */
            
            // Prevenci√≥n continua cada 2 segundos - DESACTIVADA para no interferir con apertura manual
            /*
            setInterval(() => {
                if (window._modalesBloqueados) {
                    const modalesAbiertos = document.querySelectorAll('.modal[style*="flex"], .modal[style*="block"]');
                    modalesAbiertos.forEach(modal => {
                        console.log('üö´ Cerrando modal autom√°tico detectado:', modal.id);
                        modal.style.display = 'none';
                    });
                }
            }, 2000);
            */
            
            // Prevenci√≥n espec√≠fica para modales problem√°ticos - DESACTIVADA
            /*
            setTimeout(() => {
                const modalServicio = document.getElementById('modalServicio');
                const modalTurnos = document.getElementById('modalSistemaTurnos');
                
                if (modalServicio) {
                    modalServicio.style.display = 'none';
                    console.log('üö´ Modal Servicio cerrado preventivamente');
                }
                
                if (modalTurnos) {
                    modalTurnos.style.display = 'none';
                    console.log('üö´ Modal Turnos cerrado preventivamente');
                }
            }, 50);
            */
            
            // Prevenci√≥n adicional cada 500ms para estos modales espec√≠ficos - DESACTIVADA
            /*
            setInterval(() => {
                const modalServicio = document.getElementById('modalServicio');
                const modalTurnos = document.getElementById('modalSistemaTurnos');
                
                if (modalServicio && (modalServicio.style.display === 'flex' || modalServicio.style.display === 'block')) {
                    modalServicio.style.display = 'none';
                    console.log('üö´ Modal Servicio cerrado autom√°ticamente');
                }
                
                if (modalTurnos && (modalTurnos.style.display === 'flex' || modalTurnos.style.display === 'block')) {
                    modalTurnos.style.display = 'none';
                    console.log('üö´ Modal Turnos cerrado autom√°ticamente');
                }
            }, 500);
            */
        });
        
        // ===== FUNCI√ìN PARA CERRAR MODALES PROBLEM√ÅTICOS =====
        
        // Funci√≥n global para cerrar modales espec√≠ficos
        window.cerrarModalesProblematicos = function() {
            const modalServicio = document.getElementById('modalServicio');
            const modalTurnos = document.getElementById('modalSistemaTurnos');
            
            if (modalServicio) {
                modalServicio.style.display = 'none';
                console.log('üö´ Modal Servicio cerrado manualmente');
            }
            
            if (modalTurnos) {
                modalTurnos.style.display = 'none';
                console.log('üö´ Modal Turnos cerrado manualmente');
            }
        };
        
        // Prevenci√≥n inmediata al cargar el script
        (function() {
            // Cerrar modales inmediatamente
            setTimeout(() => {
                const modalServicio = document.getElementById('modalServicio');
                const modalTurnos = document.getElementById('modalSistemaTurnos');
                
                if (modalServicio) {
                    modalServicio.style.display = 'none';
                    console.log('üö´ Modal Servicio cerrado inmediatamente');
                }
                
                if (modalTurnos) {
                    modalTurnos.style.display = 'none';
                    console.log('üö´ Modal Turnos cerrado inmediatamente');
                }
            }, 10);
            
            // Prevenci√≥n continua cada 100ms
            setInterval(() => {
                const modalServicio = document.getElementById('modalServicio');
                const modalTurnos = document.getElementById('modalSistemaTurnos');
                
                if (modalServicio && (modalServicio.style.display === 'flex' || modalServicio.style.display === 'block')) {
                    modalServicio.style.display = 'none';
                    console.log('üö´ Modal Servicio cerrado autom√°ticamente');
                }
                
                if (modalTurnos && (modalTurnos.style.display === 'flex' || modalTurnos.style.display === 'block')) {
                    modalTurnos.style.display = 'none';
                    console.log('üö´ Modal Turnos cerrado autom√°ticamente');
                }
            }, 100);
        })();
        
        // ===== SISTEMA DE GARANT√çAS Y DEVOLUCIONES =====
        
        // Mostrar configuraci√≥n de garant√≠as
        window.mostrarConfiguracionGarantias = function() {
            const modalHTML = `
                <div id="modalGarantias" class="modal" style="display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">
                    <div class="modal-content" style="background: white; border-radius: 20px; padding: 20px; max-width: 400px; width: 90%; max-height: 60vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                        <div class="modal-header" style="display: flex; align-items: center; margin-bottom: 25px; border-bottom: 2px solid #f1f5f9; padding-bottom: 20px;">
                            <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #f59e0b, #ef4444); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                <i class="fas fa-shield-alt" style="font-size: 24px; color: white;"></i>
                            </div>
                            <div>
                                <h2 style="margin: 0; color: #2d3748; font-size: 1.5rem;">üõ°Ô∏è Garant√≠as y Devoluciones</h2>
                                <p style="margin: 5px 0 0 0; color: #6b7280; font-size: 0.9rem;">Configura las pol√≠ticas de garant√≠a y devoluciones</p>
                            </div>
                            <button onclick="cerrarModalGarantias()" style="background: none; border: none; font-size: 24px; color: #9ca3af; cursor: pointer; margin-left: auto;">&times;</button>
                        </div>
                        
                        <form id="formGarantias" onsubmit="guardarConfiguracionGarantias(event)">
                            <div style="margin-bottom: 25px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">
                                    <i class="fas fa-calendar-alt"></i> Meses de Garant√≠a
                                </label>
                                <select id="mesesGarantia" class="form-control" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 16px;">
                                    <option value="0">Sin garant√≠a</option>
                                    <option value="1">1 mes</option>
                                    <option value="3">3 meses</option>
                                    <option value="6">6 meses</option>
                                    <option value="12">12 meses</option>
                                    <option value="24">24 meses</option>
                                    <option value="36">36 meses</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 25px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">
                                    <i class="fas fa-undo"></i> Pol√≠tica de Devoluciones
                                </label>
                                <select id="politicaDevoluciones" class="form-control" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 16px;">
                                    <option value="no">No acepta devoluciones</option>
                                    <option value="7">7 d√≠as para devoluciones</option>
                                    <option value="15">15 d√≠as para devoluciones</option>
                                    <option value="30">30 d√≠as para devoluciones</option>
                                    <option value="60">60 d√≠as para devoluciones</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 25px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">
                                    <i class="fas fa-info-circle"></i> Condiciones de Garant√≠a
                                </label>
                                <textarea id="condicionesGarantia" class="form-control" rows="4" placeholder="Describe las condiciones de tu garant√≠a (ej: cubre defectos de fabricaci√≥n, no cubre da√±os por mal uso, etc.)" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 16px; resize: vertical;"></textarea>
                            </div>
                            
                            <div style="margin-bottom: 25px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">
                                    <i class="fas fa-undo-alt"></i> Proceso de Devoluciones
                                </label>
                                <textarea id="procesoDevoluciones" class="form-control" rows="4" placeholder="Describe el proceso de devoluciones (ej: contacto por WhatsApp, env√≠o por correo, etc.)" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 16px; resize: vertical;"></textarea>
                            </div>
                            
                            <div style="margin-bottom: 25px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">
                                    <i class="fas fa-phone"></i> Contacto para Garant√≠as
                                </label>
                                <input type="text" id="contactoGarantias" class="form-control" placeholder="WhatsApp, tel√©fono o email para consultas de garant√≠a" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 16px;">
                            </div>
                            
                            <div style="display: flex; gap: 15px; justify-content: flex-end; margin-top: 30px;">
                                <button type="button" onclick="cerrarModalGarantias()" style="background: #6b7280; color: white; padding: 12px 25px; border: none; border-radius: 10px; cursor: pointer; font-weight: 600;">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                                <button type="submit" style="background: linear-gradient(135deg, #f59e0b, #ef4444); color: white; padding: 12px 25px; border: none; border-radius: 10px; cursor: pointer; font-weight: 600;">
                                    <i class="fas fa-save"></i> Guardar Configuraci√≥n
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        // Cerrar modal de garant√≠as
        window.cerrarModalGarantias = function() {
            const modal = document.getElementById('modalGarantias');
            if (modal) {
                modal.remove();
            }
        }
        
        // Guardar configuraci√≥n de garant√≠as
        window.guardarConfiguracionGarantias = function(event) {
            event.preventDefault();
            
            const mesesGarantia = document.getElementById('mesesGarantia').value;
            const politicaDevoluciones = document.getElementById('politicaDevoluciones').value;
            const condicionesGarantia = document.getElementById('condicionesGarantia').value;
            const procesoDevoluciones = document.getElementById('procesoDevoluciones').value;
            const contactoGarantias = document.getElementById('contactoGarantias').value;
            
            const configuracionGarantias = {
                mesesGarantia: parseInt(mesesGarantia),
                politicaDevoluciones: politicaDevoluciones,
                condicionesGarantia: condicionesGarantia,
                procesoDevoluciones: procesoDevoluciones,
                contactoGarantias: contactoGarantias,
                fechaActualizacion: new Date().toISOString()
            };
            
            // Guardar en localStorage
            const tiendaId = JSON.parse(localStorage.getItem('tienda_actual') || '{}').id || 'demo';
            localStorage.setItem('garantias_' + tiendaId, JSON.stringify(configuracionGarantias));
            
            // Actualizar footer autom√°ticamente
            actualizarFooterConGarantias(configuracionGarantias);
            
            alert('‚úÖ Configuraci√≥n de garant√≠as guardada exitosamente!');
            cerrarModalGarantias();
        }
        
        // Actualizar footer con informaci√≥n de garant√≠as
        window.actualizarFooterConGarantias = function(configuracion) {
            // Esta funci√≥n se ejecutar√° en la p√°gina de la tienda
            // para actualizar autom√°ticamente el footer
            const tiendaId = JSON.parse(localStorage.getItem('tienda_actual') || '{}').id || 'demo';
            localStorage.setItem('footer_actualizado_' + tiendaId, 'true');
            localStorage.setItem('garantias_footer_' + tiendaId, JSON.stringify(configuracion));
            
            console.log('‚úÖ Footer actualizado con informaci√≥n de garant√≠as');
        }
        
        console.log('‚úÖ Sistema de Suscripciones Cresalia cargado correctamente');
        console.log('‚úÖ Sistemas Avanzados Cresalia integrados correctamente');
    </script>
    
</body>
</html>