<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google" content="notranslate">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Cresalia - Plataforma E-commerce Multi-tenant</title>
    
    <!-- Meta Security -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      base-uri 'self';
      object-src 'none';
      img-src 'self' data: blob: https: https://via.placeholder.com;
      font-src 'self' data: https: https://fonts.gstatic.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net;
      style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net;
      style-src-elem 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net;
      script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://sdk.mercadopago.com https://vercel.live https://*.vercel.live https://conversations-widget.brevo.com https://brevo.com https://*.brevo.com;
      script-src-elem 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://sdk.mercadopago.com https://vercel.live https://*.vercel.live https://conversations-widget.brevo.com https://brevo.com https://*.brevo.com;
      connect-src 'self' https: https://vercel.live https://conversations-widget.brevo.com https://api.brevo.com https://brevo.com https://*.brevo.com;
      frame-src 'self' https: https://conversations-widget.brevo.com https://brevo.com https://*.brevo.com;
      form-action 'self';
      upgrade-insecure-requests;
    ">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <!-- Favicon - Usando logo completo de Cresalia -->
    <!-- Rutas absolutas y relativas para mejor compatibilidad -->
    <link rel="icon" type="image/png" sizes="32x32" href="assets/logo/logo-cresalia.png?v=6.0">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/logo/logo-cresalia.png?v=6.0">
    <link rel="shortcut icon" type="image/png" href="assets/logo/logo-cresalia.png?v=6.0">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" href="/assets/logo/logo-cresalia.png?v=6.0">
    <meta name="msapplication-TileImage" content="/assets/logo/logo-cresalia.png">
    <meta name="msapplication-TileColor" content="#7C3AED">
    <meta name="theme-color" content="#7C3AED">
    
    <!-- Sistema de Seguridad -->
    <script src="security-system.js?v=2.0"></script>
    <script src="core/proteccion-devtools-avanzada.js?v=2.0"></script>
    <script src="core/proteccion-datos-sensibles.js?v=1.0"></script>
    <script src="core/panel-monitoreo-seguridad.js?v=1.0"></script>
    
    <!-- üì± PWA MANIFEST Y META TAGS -->
    <link rel="manifest" href="/manifest.json?v=6.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Cresalia">
    <meta name="theme-color" content="#7C3AED">
    <meta name="msapplication-TileColor" content="#7C3AED">
    <meta name="msapplication-navbutton-color" content="#7C3AED">
    <meta name="application-name" content="Cresalia">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- Iconos adicionales para escritorio (Windows, macOS, Linux) -->
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="icon" type="image/png" sizes="512x512" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" sizes="192x192" href="/assets/logo/logo-cresalia.png?v=6.0">
    <link rel="apple-touch-icon" sizes="512x512" href="/assets/logo/logo-cresalia.png?v=6.0">
    
    <!-- Meta tags adicionales para mejor soporte en escritorio -->
    <meta name="msapplication-square70x70logo" content="/assets/logo/logo-cresalia.png">
    <meta name="msapplication-square150x150logo" content="/assets/logo/logo-cresalia.png">
    <meta name="msapplication-wide310x150logo" content="/assets/logo/logo-cresalia.png">
    <meta name="msapplication-square310x310logo" content="/assets/logo/logo-cresalia.png">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
            <!-- Google Maps API (opcional) -->
        <!-- <script async defer src="https://maps.googleapis.com/maps/api/js?key=TU_API_KEY&libraries=places"></script> -->
    <!-- Mercado Pago SDK -->
    <script src="https://sdk.mercadopago.com/js/v2"></script>
    
    <link rel="stylesheet" href="styles-cresalia.css?v=5.3">
    <link rel="stylesheet" href="css/buyer-interface-improved.css">
    <link rel="stylesheet" href="css/z-index-layers.css">
    <link rel="stylesheet" href="css/elegant-notifications.css">
    <link rel="stylesheet" href="css/filtros-productos.css?v=1.4">
    <!-- CSS de feedbacks de tiendas - NO necesario en index-cresalia.html (solo en p√°ginas de tiendas) -->
    <!-- <link rel="stylesheet" href="css/sistema-feedbacks.css"> -->
    <link rel="stylesheet" href="css/sistema-desafios-emocionales.css">
    <link rel="stylesheet" href="css/contacto-directo-crisla.css">
    <link rel="stylesheet" href="css/sistema-anti-fraudes.css">
    <link rel="stylesheet" href="css/proteccion-bidireccional.css">
    <link rel="stylesheet" href="css/filtros-avanzados.css">
    
    <style>
        .cumpleaneros-section {
            position: relative;
            padding: 80px 0;
            background: linear-gradient(135deg, rgba(126, 58, 242, 0.08), rgba(14, 165, 233, 0.08));
            overflow: hidden;
        }

        .cumpleaneros-section::before,
        .cumpleaneros-section::after {
            content: "";
            position: absolute;
            width: 280px;
            height: 280px;
            border-radius: 50%;
            background: rgba(126, 58, 242, 0.12);
            filter: blur(120px);
            z-index: 0;
        }

        .cumpleaneros-section::before {
            top: -140px;
            left: -80px;
        }

        .cumpleaneros-section::after {
            bottom: -160px;
            right: -60px;
            background: rgba(14, 165, 233, 0.12);
        }

        .cumpleaneros-header {
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .cumpleaneros-header .section-subtitle {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #7C3AED;
            margin-bottom: 12px;
        }

        .cumpleaneros-header .section-title {
            font-size: 2.4rem;
            font-weight: 700;
            color: #111827;
        }

        .cumpleaneros-header .section-title span {
            color: #7C3AED;
        }

        .cumpleaneros-header .section-description {
            max-width: 640px;
            margin: 16px auto 0;
            color: #4B5563;
            font-size: 1.05rem;
        }

        .cumpleaneros-panel {
            position: relative;
            z-index: 1;
            border-radius: 24px;
            padding: 32px 28px;
            background: #ffffff;
            box-shadow: 0 20px 45px rgba(15, 23, 42, 0.08);
            min-height: 320px;
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .cumpleaneros-panel.servicios {
            background: linear-gradient(160deg, rgba(236, 254, 255, 0.95), rgba(191, 219, 254, 0.7));
        }

        .cumpleaneros-panel .panel-header {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .cumpleaneros-panel .panel-icon {
            width: 56px;
            height: 56px;
            border-radius: 18px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #ffffff;
            background: linear-gradient(135deg, #7C3AED, #A855F7);
            box-shadow: 0 12px 30px rgba(124, 58, 237, 0.25);
        }

        .cumpleaneros-panel.servicios .panel-icon {
            background: linear-gradient(135deg, #0EA5E9, #2563EB);
            box-shadow: 0 12px 30px rgba(14, 165, 233, 0.25);
        }

        .cumpleaneros-panel h3 {
            margin: 0;
            font-size: 1.6rem;
            font-weight: 700;
            color: #111827;
        }

        .cumpleaneros-panel p {
            margin: 0;
            color: #4B5563;
        }

        .cumpleaneros-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .cumpleaneros-card {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 18px 20px;
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(124, 58, 237, 0.12);
            backdrop-filter: blur(12px);
            transition: transform 0.25s ease, box-shadow 0.25s ease;
        }

        .cumpleaneros-panel.servicios .cumpleaneros-card {
            border-color: rgba(14, 165, 233, 0.18);
        }

        .cumpleaneros-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 18px 35px rgba(124, 58, 237, 0.15);
        }

        .cumpleaneros-avatar {
            width: 56px;
            height: 56px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #7C3AED, #F472B6);
            color: #ffffff;
            font-size: 1.5rem;
            font-weight: 600;
            overflow: hidden;
        }

        .cumpleaneros-panel.servicios .cumpleaneros-avatar {
            background: linear-gradient(135deg, #0EA5E9, #38BDF8);
        }

        .cumpleaneros-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cumpleaneros-info {
            flex: 1;
        }

        .cumpleaneros-info h4 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: #111827;
        }

        .cumpleaneros-info .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-top: 6px;
            color: #7C3AED;
            background: rgba(124, 58, 237, 0.12);
        }

        .cumpleaneros-panel.servicios .cumpleaneros-info .badge {
            color: #0EA5E9;
            background: rgba(14, 165, 233, 0.15);
        }

        .cumpleaneros-info .cumpleaneros-meta {
            margin-top: 8px;
            color: #6B7280;
            font-size: 0.92rem;
        }

        .cumpleaneros-dia {
            font-weight: 700;
            color: #7C3AED;
            font-size: 1.2rem;
            min-width: 52px;
            text-align: right;
        }

        .cumpleaneros-panel.servicios .cumpleaneros-dia {
            color: #0EA5E9;
        }

        .cumpleaneros-empty {
            margin: 0;
            padding: 18px;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.8);
            border: 1px dashed rgba(124, 58, 237, 0.18);
            color: #6B7280;
            font-size: 0.95rem;
            text-align: center;
        }

        .cumpleaneros-panel.servicios .cumpleaneros-empty {
            border-color: rgba(14, 165, 233, 0.25);
        }

        .cumpleaneros-consent {
            position: relative;
            z-index: 1;
            display: inline-block;
            margin-top: 28px;
            padding: 10px 18px;
            border-radius: 999px;
            background: rgba(17, 24, 39, 0.75);
            color: #F9FAFB;
            font-size: 0.85rem;
        }

        @media (max-width: 991px) {
            .cumpleaneros-section {
                padding: 60px 0;
            }

            .cumpleaneros-panel {
                padding: 28px 24px;
            }
        }

        @media (max-width: 575px) {
            .cumpleaneros-card {
                align-items: flex-start;
            }

            .cumpleaneros-dia {
                text-align: left;
            }
        }

        /* ===== ESTILOS DE ANIVERSARIOS (Mismo dise√±o que cumplea√±os) ===== */
        .aniversarios-section {
            position: relative;
            padding: 80px 0;
            background: linear-gradient(135deg, rgba(14, 165, 233, 0.08), rgba(16, 185, 129, 0.08));
            overflow: hidden;
        }

        .aniversarios-section::before,
        .aniversarios-section::after {
            content: "";
            position: absolute;
            width: 280px;
            height: 280px;
            border-radius: 50%;
            background: rgba(14, 165, 233, 0.12);
            filter: blur(120px);
            z-index: 0;
        }

        .aniversarios-section::before {
            top: -140px;
            left: -80px;
        }

        .aniversarios-section::after {
            bottom: -160px;
            right: -60px;
            background: rgba(16, 185, 129, 0.12);
        }

        .aniversarios-header {
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .aniversarios-header .section-subtitle {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #0EA5E9;
            margin-bottom: 12px;
        }

        .aniversarios-header .section-title {
            font-size: 2.4rem;
            font-weight: 700;
            color: #111827;
        }

        .aniversarios-header .section-title span {
            color: #0EA5E9;
        }

        .aniversarios-header .section-description {
            max-width: 640px;
            margin: 16px auto 0;
            color: #4B5563;
            font-size: 1.05rem;
        }

        .aniversarios-panel {
            position: relative;
            z-index: 1;
            border-radius: 24px;
            padding: 32px 28px;
            background: #ffffff;
            box-shadow: 0 20px 45px rgba(15, 23, 42, 0.08);
            min-height: 320px;
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .aniversarios-panel.servicios {
            background: linear-gradient(160deg, rgba(236, 254, 255, 0.95), rgba(191, 219, 254, 0.7));
        }

        .aniversarios-panel .panel-header {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .aniversarios-panel .panel-icon {
            width: 56px;
            height: 56px;
            border-radius: 18px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #ffffff;
            background: linear-gradient(135deg, #0EA5E9, #38BDF8);
            box-shadow: 0 12px 30px rgba(14, 165, 233, 0.25);
        }

        .aniversarios-panel.servicios .panel-icon {
            background: linear-gradient(135deg, #10B981, #34D399);
            box-shadow: 0 12px 30px rgba(16, 185, 129, 0.25);
        }

        .aniversarios-panel h3 {
            margin: 0;
            font-size: 1.6rem;
            font-weight: 700;
            color: #111827;
        }

        .aniversarios-panel p {
            margin: 0;
            color: #4B5563;
        }

        .aniversarios-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .aniversario-card {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 18px 20px;
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(14, 165, 233, 0.12);
            backdrop-filter: blur(12px);
            transition: transform 0.25s ease, box-shadow 0.25s ease;
        }

        .aniversarios-panel.servicios .aniversario-card {
            border-color: rgba(16, 185, 129, 0.18);
        }

        .aniversario-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 18px 35px rgba(14, 165, 233, 0.15);
        }

        .aniversario-avatar {
            width: 56px;
            height: 56px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #0EA5E9, #38BDF8);
            color: #ffffff;
            font-size: 1.5rem;
            font-weight: 600;
            overflow: hidden;
            flex-shrink: 0;
        }

        .aniversarios-panel.servicios .aniversario-avatar {
            background: linear-gradient(135deg, #10B981, #34D399);
        }

        .aniversario-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .aniversario-info {
            flex: 1;
        }

        .aniversario-info h4 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: #111827;
        }

        .aniversario-info .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-top: 6px;
            color: #0EA5E9;
            background: rgba(14, 165, 233, 0.12);
        }

        .aniversarios-panel.servicios .aniversario-info .badge {
            color: #10B981;
            background: rgba(16, 185, 129, 0.15);
        }

        .aniversario-info .aniversario-meta {
            margin-top: 8px;
            color: #6B7280;
            font-size: 0.92rem;
        }

        .aniversario-anos {
            font-weight: 700;
            color: #0EA5E9;
            font-size: 1.2rem;
            min-width: 52px;
            text-align: right;
            flex-shrink: 0;
        }

        .aniversarios-panel.servicios .aniversario-anos {
            color: #10B981;
        }

        .aniversarios-empty {
            margin: 0;
            padding: 18px;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.8);
            border: 1px dashed rgba(14, 165, 233, 0.18);
            color: #6B7280;
            font-size: 0.95rem;
            text-align: center;
        }

        .aniversarios-panel.servicios .aniversarios-empty {
            border-color: rgba(16, 185, 129, 0.25);
        }

        .aniversarios-consent {
            position: relative;
            z-index: 1;
            display: inline-block;
            margin-top: 28px;
            padding: 10px 18px;
            border-radius: 999px;
            background: rgba(17, 24, 39, 0.75);
            color: #F9FAFB;
            font-size: 0.85rem;
        }

        @media (max-width: 991px) {
            .aniversarios-section {
                padding: 60px 0;
            }

            .aniversarios-panel {
                padding: 28px 24px;
            }
        }

        @media (max-width: 575px) {
            .aniversario-card {
                align-items: flex-start;
            }

            .aniversario-anos {
                text-align: left;
            }
        }
    </style>
    
    <!-- Click Derecho Personalizado -->
    <script src="js/click-derecho-personalizado.js"></script>
    <!-- Inyecci√≥n de Variables de Entorno (debe ir antes de config-supabase-seguro.js) -->
    <script src="js/inject-env-vars.js"></script>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">
                <div class="logo-container">
                    <img src="assets/logo/logo-cresalia.png" alt="Cresalia" class="logo-image" style="height: 50px; width: auto; max-width: 200px; object-fit: contain;">
                    <div class="logo-glow"></div>
                </div>
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#inicio" data-i18n="nav.inicio">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#productos" data-i18n="nav.productos">Productos</a>
                        <a class="nav-link" href="#servicios" data-i18n="nav.servicios">Servicios</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#ayuda" data-i18n="nav.ayuda">Ayuda</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#contacto" data-i18n="nav.contacto">Contacto</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="toggleCart(); return false;">
                            <i class="fas fa-shopping-cart"></i>
                            <span data-i18n="nav.carrito">Carrito</span>
                            <span id="cartCount" class="cart-count">0</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-outline-primary btn-sm me-2" onclick="toggleUserSystem(); showLoginForm(); return false;" style="margin-top: 0.25rem;">
                            <i class="fas fa-sign-in-alt"></i> Iniciar Sesi√≥n
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-primary btn-sm me-2" onclick="toggleUserSystem(); showRegisterForm(); return false;" style="margin-top: 0.25rem;">
                            <i class="fas fa-user-plus"></i> Comenzar Gratis
                        </button>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link user-nav-btn" href="#" onclick="toggleUserSystem()" style="display: none;" id="userAccountBtn">
                            <i class="fas fa-user-circle"></i>
                            <span id="userButtonText" data-i18n="nav.mi_cuenta">Mi Cuenta</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="toggleLanguageSelector(); return false;" title="Cambiar idioma">
                            <i class="fas fa-globe"></i>
                            <span id="currentLanguageFlag">üá™üá∏</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- √Årea de Alertas de Emergencia Global -->
    <div id="alertas-emergencia-comunidades"></div>

    <!-- ===== CARRITO FLOTANTE PARA M√ìVILES ===== -->
    <div id="floatingCart" class="floating-cart" onclick="toggleCart()">
        <div class="floating-cart-content">
            <div class="floating-cart-icon">
                <i class="fas fa-shopping-cart"></i>
                <span id="floatingCartCount" class="floating-cart-count">0</span>
            </div>
            <div class="floating-cart-info">
                <span class="floating-cart-text">Carrito</span>
                <span id="floatingCartTotal" class="floating-cart-total">$0</span>
            </div>
        </div>
    </div>

    <!-- ===== SISTEMA DE USUARIOS ===== -->
    <div id="userSystem" class="user-system-overlay" style="display: none;">
        <div class="user-system-container">
            <!-- Login Form -->
            <div id="loginForm" class="user-form active">
                <div class="user-form-header">
                    <h3><i class="fas fa-user-circle"></i> Iniciar Sesi√≥n</h3>
                    <p>Accede a tu cuenta para ver tu historial</p>
                </div>
                <form id="loginUserForm">
                                            <div class="form-group">
                            <label for="loginEmail"><i class="fas fa-envelope"></i> Email</label>
                            <input type="email" id="loginEmail" name="loginEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="loginPassword"><i class="fas fa-lock"></i> Contrase√±a</label>
                            <div class="password-input">
                                <input type="password" id="loginPassword" name="loginPassword" required>
                                <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                    <button type="submit" class="user-btn primary">
                        <i class="fas fa-sign-in-alt"></i> Iniciar Sesi√≥n
                    </button>
                </form>
                <div class="user-form-footer">
                    <p>¬øNo tienes cuenta? <a href="#" onclick="showRegisterForm()">Reg√≠strate aqu√≠</a></p>
                    <div style="display: flex; gap: 10px; justify-content: center; margin-top: 15px;">
                        <button class="user-btn secondary" onclick="closeUserSystem()" style="flex: 1;">
                            <i class="fas fa-arrow-left"></i> Volver
                        </button>
                        <button class="user-btn secondary" onclick="closeUserSystem()" style="flex: 1;">
                            <i class="fas fa-times"></i> Cerrar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Register Form -->
            <div id="registerForm" class="user-form">
                <div class="user-form-header">
                    <h3><i class="fas fa-user-plus"></i> Crear Cuenta</h3>
                    <p>Reg√≠strate para acceder a productos, servicios y guardar tu historial</p>
                </div>
                <form id="registerUserForm">
                                            <div class="form-group">
                            <label for="registerName"><i class="fas fa-user"></i> Nombre Completo</label>
                            <input type="text" id="registerName" name="registerName" required>
                        </div>
                        <div class="form-group">
                            <label for="registerEmail"><i class="fas fa-envelope"></i> Email</label>
                            <input type="email" id="registerEmail" name="registerEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="registerPhone"><i class="fas fa-phone"></i> Tel√©fono</label>
                            <input type="tel" id="registerPhone" name="registerPhone" required>
                        </div>
                        <div class="form-group">
                            <label for="registerPassword"><i class="fas fa-lock"></i> Contrase√±a</label>
                            <div class="password-input">
                                <input type="password" id="registerPassword" name="registerPassword" required>
                                <button type="button" class="password-toggle" onclick="togglePassword('registerPassword')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="registerConfirmPassword"><i class="fas fa-lock"></i> Confirmar Contrase√±a</label>
                            <div class="password-input">
                                <input type="password" id="registerConfirmPassword" name="registerConfirmPassword" required>
                                <button type="button" class="password-toggle" onclick="togglePassword('registerConfirmPassword')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                    <button type="submit" class="user-btn primary">
                        <i class="fas fa-user-plus"></i> Crear Cuenta
                    </button>
                </form>
                <div class="user-form-footer">
                    <p>¬øYa tienes cuenta? <a href="#" onclick="showLoginForm()">Inicia sesi√≥n aqu√≠</a></p>
                    <div style="display: flex; gap: 10px; justify-content: center; margin-top: 15px;">
                        <button class="user-btn secondary" onclick="showLoginForm()" style="flex: 1;">
                            <i class="fas fa-arrow-left"></i> Volver
                        </button>
                        <button class="user-btn secondary" onclick="closeUserSystem()" style="flex: 1;">
                            <i class="fas fa-times"></i> Cerrar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Hero Section -->
    <section id="inicio" class="hero-section" style="margin-top: 0 !important; padding-top: 80px !important; height: 100vh !important; min-height: 100vh !important;">
        <div class="container">
            <div class="hero-content">
                <div class="hero-logo-container">
                    <img src="assets/logo/logo-cresalia.png" alt="Cresalia" class="hero-logo">
                    <div class="hero-logo-glow"></div>
                </div>
                <h1>Cresalia</h1>
                <div class="welcome-message">
                    <h2>Bienvenidos a Cresalia</h2>
                </div>
                <p>Empezamos pocos, crecemos mucho - El espacio ideal para desplegar juntos</p>
                <div class="hero-buttons">
                    <a href="#productos" class="btn-hero btn-primary-hero">
                        <i class="fas fa-shopping-bag"></i> Ver Productos
                    </a>
                    <a href="#servicios" class="btn-hero btn-secondary-hero">
                        <i class="fas fa-tools"></i> Ver Servicios
                    </a>
                    <a href="#tiendas" class="btn-hero btn-outline-hero">
                        <i class="fas fa-store"></i> Ver Tiendas
                    </a>
                    <a href="#ofertas" class="btn-hero btn-outline-hero">
                        <i class="fas fa-tags"></i> Ver Ofertas
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Combos y Ofertas Section -->
    <section id="combos-ofertas" class="combos-section">
        <div class="container">
            <div class="section-header">
                <h2><i class="fas fa-gift"></i> Combos y Ofertas Especiales</h2>
                <p>¬°Aprovecha nuestras ofertas exclusivas y combos con descuentos incre√≠bles!</p>
            </div>
            
            <div class="combos-container" id="combosContainer">
                <!-- Los combos se cargar√°n din√°micamente -->
            </div>
        </div>
    </section>

    <!-- Productos Section -->
    <section id="productos" class="productos-section">
        <div class="container">
            <div class="section-header">
                <h2><i class="fas fa-box"></i> Cat√°logo de Productos</h2>
                <p>Descubre los mejores productos de nuestras tiendas asociadas</p>
            </div>
            
            <!-- Sistema de Filtros y B√∫squeda -->
            <div class="filtros-container">
                <div class="row">
                    <!-- B√∫squeda -->
                    <div class="col-lg-4 col-md-6 mb-3">
                        <div class="filtro-card busqueda-card">
                            <label><i class="fas fa-search"></i> Buscar Productos</label>
                            <div class="busqueda-container">
                                <input type="text" id="busquedaProductos" class="form-control busqueda-input" placeholder="Escribe aqu√≠ para buscar productos..." autocomplete="off">
                                <div class="busqueda-suggestions" id="busquedaSuggestions"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Categor√≠as -->
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="filtro-card">
                            <label><i class="fas fa-tags"></i> Categor√≠a</label>
                            <select id="filtroCategoria" class="form-select" onchange="aplicarFiltros()">
                                <option value="">Todas las categor√≠as</option>
                                <option value="tecnologia">üì± Tecnolog√≠a</option>
                                <option value="moda">üëó Moda y Accesorios</option>
                                <option value="hogar">üè† Hogar y Jard√≠n</option>
                                <option value="deportes">‚öΩ Deportes y Fitness</option>
                                <option value="belleza">üíÑ Belleza y Cuidado</option>
                                <option value="salud">üíä Salud y Bienestar</option>
                                <option value="alimentacion">üçé Alimentaci√≥n</option>
                                <option value="automotriz">üöó Automotriz</option>
                                <option value="libros">üìö Libros y Educaci√≥n</option>
                                <option value="juguetes">üß∏ Juguetes y Ni√±os</option>
                                <option value="mascotas">üêï Mascotas</option>
                                <option value="viajes">‚úàÔ∏è Viajes y Turismo</option>
                                <option value="arte">üé® Arte y Manualidades</option>
                                <option value="musica">üéµ M√∫sica e Instrumentos</option>
                                <option value="oficina">üíº Oficina y Negocios</option>
                                <option value="herramientas">üîß Herramientas</option>
                                <option value="jardineria">üå± Jardiner√≠a</option>
                                <option value="fotografia">üì∏ Fotograf√≠a</option>
                                <option value="gaming">üéÆ Gaming</option>
                                <option value="servicios">üîß Servicios</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Rango de Precios -->
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="filtro-card">
                            <label><i class="fas fa-dollar-sign"></i> Rango de Precios</label>
                            <div class="precio-range">
                                <div class="row">
                                    <div class="col-6">
                                        <label>M√≠nimo:</label>
                                        <input type="number" id="precioMin" class="form-control" min="0" max="100000" value="0" placeholder="0" onchange="aplicarFiltros()">
                                    </div>
                                    <div class="col-6">
                                        <label>M√°ximo:</label>
                                        <input type="number" id="precioMax" class="form-control" min="0" max="100000" value="100000" placeholder="100000" onchange="aplicarFiltros()">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ordenamiento -->
                    <div class="col-lg-2 col-md-6 mb-3">
                        <div class="filtro-card">
                            <label><i class="fas fa-sort"></i> Ordenar por</label>
                            <select id="ordenarPor" class="form-select" onchange="aplicarFiltros()">
                                <option value="relevancia">Relevancia</option>
                                <option value="precio-asc">Precio: Menor a Mayor</option>
                                <option value="precio-desc">Precio: Mayor a Menor</option>
                                <option value="nombre-asc">Nombre: A-Z</option>
                                <option value="nombre-desc">Nombre: Z-A</option>
                                <option value="nuevos">M√°s Nuevos</option>
                                <option value="valoracion">Mejor Valorados</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Filtros Avanzados -->
                <div class="filtros-avanzados">
                    <button class="btn btn-outline-primary" type="button" data-bs-toggle="collapse" data-bs-target="#filtrosAvanzados">
                        <i class="fas fa-filter"></i> Filtros Avanzados
                    </button>
                    
                    <div class="collapse" id="filtrosAvanzados">
                        <div class="row mt-3">
                            <div class="col-md-3 mb-3">
                                <label><i class="fas fa-store"></i> Tienda</label>
                                <select id="filtroTienda" class="form-select" onchange="aplicarFiltros()">
                                    <option value="">Todas las tiendas</option>
                                </select>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label><i class="fas fa-star"></i> Valoraci√≥n M√≠nima</label>
                                <select id="filtroValoracion" class="form-select" onchange="aplicarFiltros()">
                                    <option value="">Cualquier valoraci√≥n</option>
                                    <option value="4">4+ estrellas</option>
                                    <option value="3">3+ estrellas</option>
                                    <option value="2">2+ estrellas</option>
                                </select>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label><i class="fas fa-truck"></i> Env√≠o</label>
                                <select id="filtroEnvio" class="form-select" onchange="aplicarFiltros()">
                                    <option value="">Todos</option>
                                    <option value="gratis">Env√≠o Gratis</option>
                                    <option value="rapido">Env√≠o R√°pido</option>
                                    <option value="local">Retiro Local</option>
                                </select>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label><i class="fas fa-badge-check"></i> Estado</label>
                                <select id="filtroEstado" class="form-select" onchange="aplicarFiltros()">
                                    <option value="">Todos</option>
                                    <option value="nuevo">Nuevo</option>
                                    <option value="usado">Usado</option>
                                    <option value="reacondicionado">Reacondicionado</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Resultados y Acciones -->
                <div class="filtros-acciones">
                    <div class="resultados-info">
                        <span id="resultadosCount">0 productos encontrados</span>
                    </div>
                    <div class="filtros-botones">
                        <button class="btn btn-primary" onclick="aplicarFiltros()">
                            <i class="fas fa-search"></i> Buscar
                        </button>
                        <button class="btn btn-outline-secondary" onclick="limpiarFiltros()">
                            <i class="fas fa-times"></i> Limpiar
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Grid de Productos -->
            <div class="productos-grid" id="productosGrid">
                <!-- Los productos se cargar√°n din√°micamente -->
            </div>
            
            <!-- Paginaci√≥n -->
            <div class="paginacion-container">
                <nav aria-label="Paginaci√≥n de productos">
                    <ul class="pagination justify-content-center" id="paginacionProductos">
                        <!-- La paginaci√≥n se generar√° din√°micamente -->
                    </ul>
                </nav>
            </div>
        </div>
    </section>

    <!-- Servicios Section -->
    <section id="servicios" class="servicios-section">
        <div class="container">
            <div class="section-header">
                <h2><i class="fas fa-tools"></i> Servicios Disponibles</h2>
                <p>Encuentra los mejores servicios cerca de ti</p>
            </div>
            
            <!-- Filtros de Servicios -->
            <div class="filtros-container">
                <div class="row">
                    <div class="col-md-3">
                        <div class="filtro-group">
                            <label for="busquedaServicios" class="filtro-label">
                                <i class="fas fa-search"></i> Buscar Servicios
                            </label>
                            <input type="text" id="busquedaServicios" class="form-control busqueda-input" placeholder="Ej: peluquer√≠a, est√©tica, transporte..." autocomplete="off">
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="filtro-group">
                            <label for="categoriaServicio" class="filtro-label">
                                <i class="fas fa-tags"></i> Categor√≠a
                            </label>
                            <select id="categoriaServicio" class="form-select" onchange="aplicarFiltrosServicios()">
                                <option value="">Todas las categor√≠as</option>
                                <option value="peluqueria">Peluquer√≠a</option>
                                <option value="estetica">Est√©tica y Belleza</option>
                                <option value="transporte">Transporte</option>
                                <option value="lubricentro">Lubricentro</option>
                                <option value="detail">Detail y Limpieza</option>
                                <option value="distribucion">Distribuci√≥n</option>
                                <option value="restaurante">Restaurante</option>
                                <option value="bar">Bar y Tragos</option>
                                <option value="cafe">Caf√© y T√©</option>
                                <option value="panaderia">Panader√≠a</option>
                                <option value="comida">Comida</option>
                                <option value="general">Negocio General</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="filtro-group">
                            <label for="precioMinServicio" class="filtro-label">
                                <i class="fas fa-dollar-sign"></i> Precio M√≠n
                            </label>
                            <input type="number" id="precioMinServicio" class="form-control" min="0" max="100000" value="0" placeholder="0" onchange="aplicarFiltrosServicios()">
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="filtro-group">
                            <label for="precioMaxServicio" class="filtro-label">
                                <i class="fas fa-dollar-sign"></i> Precio M√°x
                            </label>
                            <input type="number" id="precioMaxServicio" class="form-control" min="0" max="100000" value="100000" placeholder="100000" onchange="aplicarFiltrosServicios()">
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="filtro-group">
                            <label class="filtro-label">
                                <i class="fas fa-filter"></i> Filtros Especiales
                            </label>
                            <div class="filtros-especiales">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="envioDomicilio" onchange="aplicarFiltrosServicios()">
                                    <label class="form-check-label" for="envioDomicilio">
                                        <i class="fas fa-truck"></i> Env√≠o a domicilio
                                    </label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="masBarato" onchange="aplicarFiltrosServicios()">
                                    <label class="form-check-label" for="masBarato">
                                        <i class="fas fa-tag"></i> M√°s barato
                                    </label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="masCercano" onchange="aplicarFiltrosServicios()">
                                    <label class="form-check-label" for="masCercano">
                                        <i class="fas fa-map-marker-alt"></i> M√°s cercano
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Grid de Servicios -->
            <div class="servicios-grid" id="serviciosGrid">
                <!-- Los servicios se cargar√°n din√°micamente -->
            </div>
            
            <!-- Paginaci√≥n de Servicios -->
            <div class="paginacion-container">
                <nav aria-label="Paginaci√≥n de servicios">
                    <ul class="pagination justify-content-center" id="paginacionServicios">
                        <!-- La paginaci√≥n se generar√° din√°micamente -->
                    </ul>
                </nav>
            </div>
        </div>
    </section>

    <!-- Tiendas Section -->
    <section id="tiendas" class="tiendas-section">
        <div class="container">
            <div class="section-header">
                <h2><i class="fas fa-store"></i> Tiendas Destacadas</h2>
                <p>Descubre las mejores tiendas creadas con Cresalia</p>
            </div>
            
            <!-- Filtros de Tiendas -->
            <div class="filtros-container mb-4" style="background: #F8FAFC; padding: 20px; border-radius: 12px; margin-bottom: 30px;">
                <div class="row">
                    <div class="col-md-3">
                        <div class="filtro-group">
                            <label for="busquedaTiendas" class="filtro-label">
                                <i class="fas fa-search"></i> Buscar Tiendas
                            </label>
                            <input type="text" id="busquedaTiendas" class="form-control busqueda-input" placeholder="Ej: peluquer√≠a, est√©tica..." autocomplete="off">
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="filtro-group">
                            <label class="filtro-label">
                                <i class="fas fa-filter"></i> Filtros
                            </label>
                            <div class="filtros-especiales">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="masCercanoTiendas" onchange="aplicarFiltrosTiendas()">
                                    <label class="form-check-label" for="masCercanoTiendas">
                                        <i class="fas fa-map-marker-alt"></i> M√°s cercano
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-7">
                        <!-- Radio de B√∫squeda -->
                        <div style="padding: 15px; background: #F0F9FF; border-radius: 8px; border: 1px solid #BAE6FD;">
                            <label style="display: flex; align-items: center; gap: 8px; font-weight: 600; color: #0369A1; margin-bottom: 10px;">
                                <i class="fas fa-circle-notch"></i> Radio de B√∫squeda
                            </label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="radioBusquedaTiendas" min="0" max="50" value="0" step="1" 
                                       oninput="document.getElementById('radioBusquedaTiendasValue').textContent = this.value; aplicarFiltrosTiendas();"
                                       style="flex: 1;">
                                <span id="radioBusquedaTiendasValue" style="min-width: 60px; font-weight: 600; color: #0369A1;">0</span>
                                <span style="color: #64748B;">km</span>
                                <button type="button" onclick="document.getElementById('radioBusquedaTiendas').value = 0; document.getElementById('radioBusquedaTiendasValue').textContent = '0'; aplicarFiltrosTiendas();" 
                                        style="padding: 4px 12px; background: #E0F2FE; border: 1px solid #BAE6FD; border-radius: 6px; color: #0369A1; cursor: pointer; font-size: 0.85rem;">
                                    Limpiar
                                </button>
                            </div>
                            <small style="color: #64748B; font-size: 0.85rem; display: block; margin-top: 6px;">
                                <i class="fas fa-info-circle"></i> Mostrar solo tiendas dentro del radio seleccionado
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tiendas-grid" id="tiendasGrid">
                <div class="tienda-card">
                    <div class="tienda-placeholder">
                        <i class="fas fa-store"></i>
                        <h3>Pr√≥ximamente</h3>
                        <p>Las primeras tiendas aparecer√°n aqu√≠ cuando nuestros usuarios comiencen a usarlas</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Ofertas Section -->
    <section id="ofertas" class="ofertas-section">
        <div class="container">
            <div class="section-header">
                <h2><i class="fas fa-tags"></i> Ofertas Especiales</h2>
                <p>Las mejores ofertas de nuestras tiendas asociadas</p>
            </div>
            
            <div class="ofertas-grid" id="ofertasGrid">
                <div class="oferta-card">
                    <div class="oferta-placeholder">
                        <i class="fas fa-tags"></i>
                        <h3>Pr√≥ximamente</h3>
                        <p>Las ofertas aparecer√°n aqu√≠ cuando las tiendas las publiquen</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Secci√≥n: Historias con Coraz√≥n Cresalia -->
    <section id="historias-corazon" class="historias-corazon-section" style="display: none;">
        <div class="container">
            <div class="section-header">
                <div class="historias-logo-container">
                    <img src="assets/logo/logo-cresalia.png" alt="Cresalia" class="historias-logo">
                </div>
                <h2><i class="fas fa-heart"></i> Historias con Coraz√≥n Cresalia</h2>
                <p>Conoc√© las historias de nuestros emprendedores que decidieron compartir su camino con nosotros</p>
            </div>
            
            <div id="historiasGrid" class="historias-grid">
                <!-- Las historias se cargar√°n din√°micamente -->
            </div>
            
            <div id="sinHistorias" class="sin-historias" style="display: none; text-align: center; padding: 60px 20px; color: #64748b;">
                <i class="fas fa-book-open" style="font-size: 4rem; margin-bottom: 20px; opacity: 0.5;"></i>
                <h3 style="color: #475569; margin-bottom: 10px;">A√∫n no hay historias compartidas</h3>
                <p style="font-size: 1.1rem;">Las historias de nuestros emprendedores aparecer√°n aqu√≠ cuando decidan compartirlas</p>
            </div>
        </div>
    </section>




    <!-- Modal de Pago -->
    <div id="modalPago" class="modal-pago-overlay">
        <div id="modalPagoContenido">
            <!-- Contenido del modal de pago se llena din√°micamente -->
        </div>
    </div>




    <!-- Ayuda Section -->
    <section id="ayuda" class="ayuda-section">
        <div class="container">
            <div class="section-header">
                <div class="ayuda-logo-container">
                    <img src="assets/logo/logo-cresalia.png" alt="Cresalia" class="ayuda-logo">
                </div>
                <h2>Centro de Ayuda Cresalia</h2>
                <p>Encuentra respuestas r√°pidas a tus preguntas m√°s frecuentes</p>
            </div>
            
            <div class="ayuda-grid">
                <div class="ayuda-card">
                    <h4><i class="fas fa-clock"></i> Horarios de Atenci√≥n</h4>
                    <p>Lunes a Viernes: 9:00 - 18:00. S√°bados: 10:00 - 14:00. <strong>Domingos: Cerrado</strong></p>
                </div>
                
                <div class="ayuda-card">
                    <h4><i class="fas fa-map-marker-alt"></i> Ubicaci√≥n</h4>
                    <p>Av. Tecnolog√≠a 1234, Buenos Aires, Argentina. Oficina virtual con soporte 24/7.</p>
                </div>
                
                <div class="ayuda-card">
                    <h4><i class="fas fa-phone"></i> Contacto</h4>
                    <p>Tel√©fono: +54 11 1234-5678 | WhatsApp: +54 11 1234-5678 | Email: cresalia25@gmail.com</p>
                </div>
                
                <div class="ayuda-card">
                    <h4><i class="fas fa-credit-card"></i> M√©todos de Pago</h4>
                    <p>Aceptamos efectivo, tarjetas de cr√©dito/d√©bito, transferencias bancarias y cuotas sin inter√©s hasta 12 cuotas.</p>
                </div>
                
                <div class="ayuda-card">
                    <h4><i class="fas fa-shield-alt"></i> Garant√≠a</h4>
                    <p>Todos nuestros productos incluyen garant√≠a de calidad y satisfacci√≥n del cliente.</p>
                </div>
                
                <div class="ayuda-card">
                    <h4><i class="fas fa-truck"></i> Env√≠os</h4>
                    <p>Env√≠os de productos dentro de Argentina. Consult√° por env√≠os internacionales.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contacto Section -->
    <section id="contacto" class="contacto-section">
        <div class="container">
            <div class="section-header">
                <div class="contacto-logo-container">
                    <img src="assets/logo/logo-cresalia.png" alt="Cresalia" class="contacto-logo">
                </div>
                <h2>Contacto Cresalia</h2>
                <p>Estamos aqu√≠ para ayudarte. ¬°Cont√°ctanos hoy mismo!</p>
            </div>
            
            <div class="row justify-content-center">
                <div class="col-lg-10 col-md-12 text-center">
                    <div class="row g-3">
                        <div class="col-lg-4 col-md-6 col-sm-6 mb-3">
                            <div class="contacto-card">
                                <div class="contacto-icon">
                                    <i class="fas fa-phone"></i>
                                </div>
                                <h3>Tel√©fono</h3>
                                <p>+54 11 1234-5678</p>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 col-sm-6 mb-3">
                            <div class="contacto-card">
                                <div class="contacto-icon">
                                    <i class="fab fa-whatsapp"></i>
                                </div>
                                <h3>WhatsApp</h3>
                                <p>+54 11 1234-5678</p>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 col-sm-6 mb-3">
                            <div class="contacto-card contacto-email">
                                <div class="contacto-icon">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <h3>Email</h3>
                                <p class="email-text">cresalia25@gmail.com</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Mapa din√°mico por tienda -->
                <div class="row mt-5">
                    <div class="col-12">
                        <div class="mapa-container">
                            <h3><i class="fas fa-map-marker-alt"></i> Ubicaci√≥n de la Tienda</h3>
                            <div id="mapa-tienda" class="mapa-google">
                                <div class="mapa-placeholder">
                                    <i class="fas fa-store"></i>
                                    <h4>Ubicaci√≥n de la Tienda</h4>
                                    <p>La ubicaci√≥n aparecer√° aqu√≠ cuando visites una tienda espec√≠fica</p>
                                </div>
                            </div>
                            <div class="mapa-info">
                                <p><strong>Direcci√≥n:</strong> Se mostrar√° din√°micamente por tienda</p>
                                <button class="btn btn-primary" onclick="obtenerRuta()" style="display: none;">
                                    <i class="fas fa-route"></i> Obtener Ruta
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <!-- Modal de Carrito de Compras -->
    <div class="cart-modal-overlay" id="cartModal">
        <div class="cart-modal-content">
            <div class="cart-modal-header">
                <h3><i class="fas fa-shopping-cart"></i> Carrito de Compras</h3>
                <button class="cart-modal-close" onclick="cerrarCarrito()" title="Cerrar carrito (ESC)">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="cart-modal-body">
                <div class="cart-items-container" id="cartItems">
                    <!-- Los items del carrito se cargar√°n din√°micamente -->
                    <div class="cart-empty-message" id="cartEmptyMessage">
                        <i class="fas fa-shopping-cart"></i>
                        <h4>Tu carrito est√° vac√≠o</h4>
                        <p>Agrega productos para comenzar tu compra</p>
                    </div>
                </div>
            </div>
            
            <div class="cart-modal-footer">
                <div class="cart-total-section">
                    <div class="cart-subtotal">
                        <span>Subtotal:</span>
                        <span id="cartSubtotal">$0</span>
                    </div>
                    <div class="cart-total">
                        <span>Total:</span>
                        <span id="cartTotal">$0</span>
                    </div>
                </div>
                <div class="cart-actions">
                    <button class="cart-btn-limpiar" onclick="limpiarCarrito()" id="cartBtnLimpiar" style="display: none;">
                        <i class="fas fa-trash"></i> Limpiar Carrito
                    </button>
                    <button class="cart-btn-finalizar" onclick="pagarCarrito()" id="cartBtnFinalizar" style="display: none;">
                        <i class="fas fa-credit-card"></i> Finalizar Compra
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Pago -->
    <div id="modalPago" class="modal-pago-overlay">
        <div id="modalPagoContenido">
            <!-- Contenido del modal de pago se llena din√°micamente -->
        </div>
    </div>

    <!-- Cumplea√±eros del Mes -->
    <section id="cumpleaneros-home" class="cumpleaneros-section">
        <div class="container">
            <div class="cumpleaneros-header">
                <span class="section-subtitle"><i class="fas fa-birthday-cake"></i> Celebramos juntas y juntos</span>
                <h2 class="section-title">Cumplea√±eros del mes de <span data-mes-actual>...</span></h2>
                <p class="section-description">
                    Tiendas y servicios que eligieron compartir su cumplea√±os con la comunidad Cresalia. ¬°Gracias por inspirarnos!
                </p>
            </div>

            <div class="row g-4 mt-4">
                <div class="col-lg-6">
                    <div class="cumpleaneros-panel">
                        <div class="panel-header">
                            <div class="panel-icon">
                                <i class="fas fa-store"></i>
                            </div>
                            <div>
                                <h3>Tiendas</h3>
                                <p>Emprendimientos destacados que celebran este mes.</p>
                            </div>
                        </div>
                        <div class="cumpleaneros-list" data-list-tiendas></div>
                        <p class="cumpleaneros-empty" data-empty-tiendas>
                            A√∫n no hay tiendas cumpliendo a√±os en portada este mes. Si sos parte de Cresalia, activ√° el consentimiento en tu panel y te sumamos.
                        </p>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="cumpleaneros-panel servicios">
                        <div class="panel-header">
                            <div class="panel-icon">
                                <i class="fas fa-hands-helping"></i>
                            </div>
                            <div>
                                <h3>Servicios</h3>
                                <p>Expertas y expertos que regalan su talento todo el a√±o.</p>
                            </div>
                        </div>
                        <div class="cumpleaneros-list" data-list-servicios></div>
                        <p class="cumpleaneros-empty" data-empty-servicios>
                            Todav√≠a no hay servicios cumpliendo a√±os en portada. Activ√° tu consentimiento desde tu panel para aparecer ac√° üíú
                        </p>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12 text-center">
                    <span class="cumpleaneros-consent">
                        Mostramos s√≥lo negocios que autorizaron aparecer en Cumplea√±eros del Mes. Pod√©s activar o desactivar tu presencia cuando quieras.
                    </span>
                </div>
            </div>
        </div>
    </section>

    <!-- Aniversarios con Cresalia -->
    <section id="aniversarios-home" class="aniversarios-section">
        <div class="container">
            <div class="aniversarios-header">
                <span class="section-subtitle">
                    <i class="fas fa-heart"></i> Celebramos juntos nuestro crecimiento
                </span>
                <h2 class="section-title">Aniversarios con Cresalia</h2>
                <p class="section-description">
                    Tiendas y servicios que cumplen a√±os siendo parte de nuestra comunidad. ¬°Gracias por confiar en nosotros y crecer juntos! üíú
                </p>
            </div>

            <div class="row g-4 mt-4">
                <div class="col-lg-6">
                    <div class="aniversarios-panel">
                        <div class="panel-header">
                            <div class="panel-icon">
                                <i class="fas fa-store"></i>
                            </div>
                            <div>
                                <h3>Tiendas</h3>
                                <p>Emprendimientos que cumplen a√±os con nosotros.</p>
                            </div>
                        </div>
                        <div class="aniversarios-list" data-list-tiendas-aniversarios></div>
                        <p class="aniversarios-empty" data-empty-tiendas-aniversarios>
                            A√∫n no hay tiendas cumpliendo aniversarios este mes. ¬°S√© el primero en aparecer aqu√≠! üéâ
                        </p>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="aniversarios-panel servicios">
                        <div class="panel-header">
                            <div class="panel-icon">
                                <i class="fas fa-hands-helping"></i>
                            </div>
                            <div>
                                <h3>Servicios</h3>
                                <p>Profesionales que cumplen a√±os siendo parte de Cresalia.</p>
                            </div>
                        </div>
                        <div class="aniversarios-list" data-list-servicios-aniversarios></div>
                        <p class="aniversarios-empty" data-empty-servicios-aniversarios>
                            Todav√≠a no hay servicios cumpliendo aniversarios este mes. ¬°Tu servicio puede ser el primero! üíú
                        </p>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12 text-center">
                    <span class="aniversarios-consent">
                        Los aniversarios se calculan desde la fecha de creaci√≥n de tu tienda o servicio en Cresalia
                    </span>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <!-- Informaci√≥n de la Empresa -->
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="footer-section">
                        <div class="footer-logo">
                            <img src="assets/logo/logo-cresalia.png" alt="Cresalia" height="60">
                        </div>
                        <h4>Cresalia</h4>
                        <p>Tu plataforma de confianza para crear tu tienda online. Empezamos pocos, crecemos mucho.</p>
                        <div class="footer-info">
                            <p><i class="fas fa-map-marker-alt"></i> Argentina</p>
                            <p><i class="fas fa-phone"></i> +54 11 XXXX-XXXX</p>
                            <p><i class="fas fa-envelope"></i> cresalia25@gmail.com</p>
                        </div>
                    </div>
                </div>
                
                <!-- Enlaces R√°pidos y Donaciones -->
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="footer-section">
                        <h5>Enlaces R√°pidos</h5>
                        <ul class="footer-links">
                            <li><a href="#inicio">Inicio</a></li>
                            <li><a href="cresalia-jobs/index.html">üíº Cresalia Jobs</a></li>
                            <li><a href="cresalia-animales/index.html">üêæ Cresalia Animales</a></li>
                            <li><a href="comunidades/alertas-servicios-publicos/">‚ö° Alertas de Servicios P√∫blicos</a></li>
                            <li><a href="#productos">Productos</a></li>
                            <li><a href="#servicios">Servicios</a></li>
                            <li><a href="#ayuda">Ayuda</a></li>
                            <li><a href="#contacto">Contacto</a></li>
                            <li><a href="legal/terminos-basicos.html">T√©rminos de Servicio</a></li>
                        </ul>
                        
                        <h5 style="margin-top: 30px; color: #10B981;">üíö Donaciones</h5>
                        <ul class="footer-links">
                            <li><a href="cresalia-solidario-emergencias/index.html" style="color: #10B981;">üö® Donar en Emergencias</a></li>
                            <li><a href="cresalia-solidario-emergencias/donar-materiales.html" style="color: #10B981;">üì¶ Donar Materiales</a></li>
                            <li><a href="cresalia-animales/index.html#donaciones" style="color: #10B981;">üêæ Donar a Refugios</a></li>
                        </ul>
                    </div>
                </div>
                
                <!-- Comunidades Cresalia üíú -->
                <div class="col-lg-6 col-md-12 mb-4">
                    <div class="footer-section">
                        <h5>üíú Comunidades Cresalia</h5>
                        <p style="font-size: 0.9rem; color: #9CA3AF; margin-bottom: 15px;">Espacios seguros y an√≥nimos para compartir y encontrar apoyo</p>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <!-- Columna 1 (9 comunidades) -->
                            <div>
                                <ul class="footer-links" style="list-style: none; padding: 0; margin: 0;">
                                    <li style="margin-bottom: 8px;"><a href="comunidades/estres-laboral/" style="color: #667eea; text-decoration: none;">üíº Estr√©s Laboral</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/lgbtq-experiencias/" style="color: #FF6B6B; text-decoration: none;">üè≥Ô∏è‚Äçüåà Experiencias LGBTQ+</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/mujeres-sobrevivientes/" style="color: #C084FC; text-decoration: none;">üíú Mujeres Sobrevivientes</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/hombres-sobrevivientes/" style="color: #3B82F6; text-decoration: none;">üíô Hombres Sobrevivientes</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/anti-bullying/" style="color: #60A5FA; text-decoration: none;">üõ°Ô∏è Anti-Bullying</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/discapacidad/" style="color: #8B5CF6; text-decoration: none;">‚ôø Personas con Discapacidad</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/inmigrantes-racializados/" style="color: #F59E0B; text-decoration: none;">üåç Inmigrantes y Racializados</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/adultos-mayores/" style="color: #F59E0B; text-decoration: none;">üë¥üëµ Adultos Mayores</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/cuidadores/" style="color: #10B981; text-decoration: none;">ü§≤ Cuidadores</a></li>
                                </ul>
                            </div>
                            <!-- Columna 2 (9 comunidades) -->
                            <div>
                                <ul class="footer-links" style="list-style: none; padding: 0; margin: 0;">
                                    <li style="margin-bottom: 8px;"><a href="comunidades/enfermedades-cronicas/" style="color: #EF4444; text-decoration: none;">üè• Enfermedades Cr√≥nicas</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/maternidad/" style="color: #EC4899; text-decoration: none;">ü§± Maternidad</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/desahogo-libre/" style="color: #6B7280; text-decoration: none;">üí≠ Desahogo Libre</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/libertad-emocional/" style="color: #9333EA; text-decoration: none;">üíú Libertad Emocional</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/sanando-abandonos/" style="color: #0EA5E9; text-decoration: none;">ü§ó Sanando Abandonos</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/libertad-economica/" style="color: #10B981; text-decoration: none;">üí∞ Libertad Econ√≥mica</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/espiritualidad-fe/" style="color: #FBBF24; text-decoration: none;">‚ú® Espiritualidad y Fe</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/injusticias-vividas/" style="color: #E5E7EB; text-decoration: none;">‚öñÔ∏è Injusticias Vividas</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/caminando-juntos/" style="color: #059669; text-decoration: none;">üö∂ Caminando Juntos</a></li>
                                </ul>
                            </div>
                            <!-- Columna 3 (10 comunidades) -->
                            <div>
                                <ul class="footer-links" style="list-style: none; padding: 0; margin: 0;">
                                    <li style="margin-bottom: 8px;"><a href="comunidades/bomberos/" style="color: #DC2626; text-decoration: none;">üöí Bomberos</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/duelo-perinatal/" style="color: #9333EA; text-decoration: none;">üíî Duelo Perinatal</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/gamers-videojuegos/" style="color: #7C3AED; text-decoration: none;">üéÆ Gamers y Videojuegos</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/madres-padres-solteros/" style="color: #EC4899; text-decoration: none;">üë®‚Äçüë©‚Äçüëß Madres/Padres Solteros</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/medicos-enfermeros/" style="color: #EF4444; text-decoration: none;">üë®‚Äç‚öïÔ∏èüë©‚Äç‚öïÔ∏è M√©dicos y Enfermeros</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/otakus-anime-manga/" style="color: #EC4899; text-decoration: none;">üéå Otakus, Anime y Manga</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/veterinarios/" style="color: #059669; text-decoration: none;">üêæ Veterinarios</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/viajeros/" style="color: #3B82F6; text-decoration: none;">‚úàÔ∏è Comunidad de Viajeros</a></li>
                                    <li style="margin-bottom: 8px;"><a href="comunidades/experiencias-sobrenaturales/" style="color: #9333EA; text-decoration: none;">‚ú® Experiencias Sobrenaturales</a></li>
                                </ul>
                            </div>
                        </div>
                        <p style="font-size: 0.85rem; color: #6B7280; margin-top: 15px; font-style: italic;">Parte del ecosistema Cresalia üíú</p>
                    </div>
                </div>
                
                <!-- Acerca de Nosotros -->
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="footer-section">
                        <h5>Acerca de Nosotros</h5>
                        <div style="background: linear-gradient(135deg, rgba(124, 58, 237, 0.1), rgba(139, 92, 246, 0.1)); padding: 20px; border-radius: 12px; border-left: 4px solid #7C3AED; margin-bottom: 20px;">
                            <p style="color: #374151; line-height: 1.8; margin-bottom: 15px;">
                                <strong>¬øPor qu√© Cresalia?</strong>
                            </p>
                            <p style="color: #4B5563; line-height: 1.8; font-size: 0.95rem; margin-bottom: 15px;">
                                Creemos que todos merecen una oportunidad para crecer, sin importar de d√≥nde vengan o qu√© hayan vivido. Cresalia naci√≥ para ser m√°s que una plataforma: es un espacio donde emprendedores, compradores y comunidades encuentran apoyo, herramientas y conexi√≥n humana.
                            </p>
                            <p style="color: #4B5563; line-height: 1.8; font-size: 0.95rem; margin-bottom: 15px;">
                                <strong>Nuestro objetivo:</strong> Democratizar el acceso al e-commerce y crear comunidades seguras donde cada voz importa. Trabajamos de forma an√≥nima porque creemos que el impacto real no necesita reconocimiento p√∫blico.
                            </p>
                            <p style="color: #7C3AED; line-height: 1.8; font-size: 0.9rem; font-style: italic; margin: 0;">
                                "Porque ayudar no necesita nombre, solo coraz√≥n" üíú
                            </p>
                        </div>
                        <div style="margin-top: 20px;">
                            <a href="#guia-usuario" onclick="mostrarGuiaUsuario(); return false;" style="color: #7C3AED; text-decoration: none; font-weight: 600; display: inline-flex; align-items: center; gap: 8px;">
                                <i class="fas fa-book"></i> Gu√≠a de Usuario
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Redes Sociales y Contacto -->
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="footer-section">
                        <h5>S√≠guenos</h5>
                        <div class="social-links">
                            <a href="https://www.facebook.com/cresalia.saas" target="_blank" class="social-link facebook">
                                <i class="fab fa-facebook-f"></i>
                                <span>Facebook</span>
                            </a>
                            <a href="https://www.instagram.com/cresalia_empresas" target="_blank" class="social-link instagram">
                                <i class="fab fa-instagram"></i>
                                <span>Instagram</span>
                            </a>
                            <a href="https://www.threads.net/@cresalia_empresas" target="_blank" class="social-link threads">
                                <i class="fab fa-threads"></i>
                                <span>Threads</span>
                            </a>
                            <a href="https://x.com/cresalia_saas" target="_blank" class="social-link x-twitter">
                                <i class="fab fa-x-twitter"></i>
                                <span>X (Twitter)</span>
                            </a>
                            <a href="https://www.tiktok.com/@cresalia_empresas" target="_blank" class="social-link tiktok">
                                <i class="fab fa-tiktok"></i>
                                <span>TikTok</span>
                            </a>
                            <a href="https://www.youtube.com/@cresalia" target="_blank" class="social-link youtube">
                                <i class="fab fa-youtube"></i>
                                <span>YouTube</span>
                            </a>
                            <a href="https://www.linkedin.com/company/cresalia" target="_blank" class="social-link linkedin">
                                <i class="fab fa-linkedin-in"></i>
                                <span>LinkedIn</span>
                            </a>
                            <a href="https://wa.me/541112345678" target="_blank" class="social-link whatsapp">
                                <i class="fab fa-whatsapp"></i>
                                <span>WhatsApp</span>
                            </a>
                        </div>
                        
                        <div class="footer-contact">
                            <h6>Horarios de Atenci√≥n</h6>
                            <p>Lunes a Viernes: 9:00 - 18:00</p>
                            <p>S√°bados: 10:00 - 14:00</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- L√≠nea divisoria -->
            <div class="footer-divider"></div>
            
            <!-- Informaci√≥n adicional -->
            <div class="row">
                <div class="col-md-6">
                    <div class="footer-bottom">
                        <p>&copy; 2025 Cresalia. Todos los derechos reservados.</p>
                        <p style="margin-top: 10px; font-size: 0.9rem; color: #667eea;">
                            <i class="fas fa-heart" style="color: #EC4899;"></i> Powered by <strong>Cresalia</strong>
                        </p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="footer-bottom text-end">
                        <p>Venta por mayor y menor disponible</p>
                        <p style="margin-top: 10px; font-size: 0.9rem; color: #10B981;">
                            <i class="fas fa-hand-holding-heart"></i> Apoyando causas importantes
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>


    <!-- Chatbot IA -->
    <div class="ai-chatbot-container">
        <button class="ai-chatbot-toggle" onclick="toggleAIChatbot(); return false;" type="button">
            <div class="ai-toggle-content">
                <i class="fas fa-brain"></i>
                <span class="ai-toggle-text">Cresalia AI</span>
            </div>
        </button>
        
        <div class="ai-chatbot-modal" id="aiChatbotModal">
            <div class="ai-chatbot-header">
                <div class="ai-header-content">
                    <div class="ai-avatar">
                        <i class="fas fa-brain"></i>
                    </div>
                    <div class="ai-header-info">
                        <h3>Cresalia AI</h3>
                        <span class="ai-status">Asistente Inteligente</span>
                    </div>
                </div>
                <button class="ai-chatbot-close" onclick="toggleAIChatbot(); return false;" type="button">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="ai-chatbot-messages" id="aiChatbotMessages">
                <!-- Los mensajes se agregar√°n din√°micamente -->
            </div>
            
            <div class="ai-chatbot-input">
                <div class="input-container">
                    <input type="text" id="aiChatInput" placeholder="Escribe tu consulta..." onkeypress="handleAIChatKeyPress(event)" onkeydown="if(event.key === 'Enter') { event.preventDefault(); sendAIMessage(); }">
                    <button onclick="sendAIMessage(); return false;" class="send-btn" type="button">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chatbot Cresalia (Servicio de Ayuda) -->
    <div class="chatbot-container">
        <button class="chatbot-toggle" onclick="toggleChatbot(); return false;" type="button">
            <div class="chatbot-toggle-content">
                <i class="fas fa-headset"></i>
                <span class="chatbot-toggle-text">Ayuda</span>
            </div>
        </button>
        
        <div class="chatbot-modal" id="chatbotModal">
            <div class="chatbot-header">
                <div class="chatbot-header-content">
                    <div class="chatbot-avatar">
                        <i class="fas fa-headset"></i>
                    </div>
                    <div class="chatbot-header-info">
                        <h3>Servicio de Ayuda</h3>
                        <span class="chatbot-status">En l√≠nea</span>
                    </div>
                </div>
                <button class="chatbot-close" onclick="toggleChatbot(); return false;" type="button">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="chatbot-messages" id="chatbotMessages">
                <!-- Los mensajes se agregar√°n din√°micamente -->
            </div>
            
            <div class="chatbot-input">
                <div class="input-container">
                    <input type="text" id="chatInput" placeholder="Escribe tu mensaje..." onkeypress="handleChatKeyPress(event)">
                    <button onclick="sendChatbotMessage()" class="send-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal de Pago -->
    <div class="modal-pago-overlay" id="modalPago">
        <div id="modalPagoContenido">
            <!-- El contenido se cargar√° din√°micamente -->
        </div>
    </div>


    <!-- Chatbot de Ayuda -->
    <div class="chatbot-container" id="chatbot">
        <div class="chatbot-header">
            <h4><i class="fas fa-headset"></i> Servicio de Ayuda</h4>
            <button onclick="toggleChatbot()" class="close-chatbot">&times;</button>
        </div>
        <div class="chatbot-messages" id="chatbotMessages">
            <!-- Los mensajes se cargar√°n din√°micamente -->
        </div>
        <div class="chatbot-input">
            <input type="text" id="chatInput" placeholder="Escribe tu mensaje..." onkeypress="handleChatKeyPress(event)">
            <button onclick="sendChatbotMessage()" class="send-btn">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- AI Chatbot -->
    <!-- Chatbot IA duplicado removido - usar solo el de arriba -->

    <!-- Botones flotantes -->
    <button class="chatbot-toggle" onclick="toggleChatbot()">
        <i class="fas fa-headset"></i>
    </button>
    
    <button class="ai-chatbot-toggle" onclick="toggleAIChatbot()">
        <i class="fas fa-robot"></i>
    </button>

    <!-- Chatbot de Ayuda -->
    <div class="chatbot-container" id="chatbotContainer">
        <div class="chatbot-header">
            <h4><i class="fas fa-headset"></i> Soporte Cresalia</h4>
            <button onclick="toggleChatbot()" class="chatbot-close">&times;</button>
        </div>
        <div class="chatbot-messages" id="chatHelpMessages">
            <!-- Los mensajes se agregar√°n din√°micamente -->
        </div>
        <div class="chatbot-input">
            <input type="text" id="chatHelpInput" placeholder="Escribe tu consulta..." onkeypress="if(event.key === 'Enter') sendMessage('help')">
            <button onclick="sendMessage('help')" class="chatbot-send">
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>

    <!-- Chatbot IA -->
    <div class="ai-chatbot-container" id="aiChatbotContainer">
        <div class="chatbot-header">
            <h4><i class="fas fa-robot"></i> Asistente Virtual Cresalia</h4>
            <button onclick="toggleAIChatbot()" class="chatbot-close">&times;</button>
        </div>
        <div class="chatbot-messages" id="chatAIMessages">
            <!-- Los mensajes se agregar√°n din√°micamente -->
        </div>
        <div class="chatbot-input">
            <input type="text" id="chatAIInput" placeholder="Pregunta sobre productos..." onkeypress="if(event.key === 'Enter') sendMessage('ai')">
            <button onclick="sendMessage('ai')" class="chatbot-send">
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>

                    <!-- Modal de Transporte con Google Maps -->
                <div class="modal-transporte-overlay" id="modalTransporte">
                    <div class="modal-transporte">
                        <div class="modal-transporte-header">
                            <h3>Calcular Precio de Transporte</h3>
                            <button onclick="cerrarModalTransporte()" class="cerrar-modal">&times;</button>
                        </div>
                        <div class="modal-transporte-content">
                            <div class="formulario-transporte">
                                <div class="input-group">
                                    <label for="origen">Origen:</label>
                                    <input type="text" id="origen" placeholder="Ingresa tu direcci√≥n de origen">
                                </div>
                                <div class="input-group">
                                    <label for="destino">Destino:</label>
                                    <input type="text" id="destino" placeholder="Ingresa tu direcci√≥n de destino">
                                </div>
                                <div class="input-group">
                                    <label for="tipoViaje">Tipo de Viaje:</label>
                                    <select id="tipoViaje">
                                        <option value="local">Local</option>
                                        <option value="interprovincial">Interprovincial</option>
                                    </select>
                                </div>
                                <div class="mapa-container">
                                    <div id="mapaTransporte" class="mapa-transporte"></div>
                                </div>
                                <div class="resultado-calculo" id="resultadoCalculo">
                                    <div class="distancia-info">
                                        <span>Distancia: <strong id="distanciaCalculada">-</strong></span>
                                        <span>Duraci√≥n: <strong id="duracionCalculada">-</strong></span>
                                    </div>
                                    <div class="precio-final">
                                        <span>Precio Total: <strong id="precioCalculado">$0</strong></span>
                                    </div>
                                </div>
                                <div class="botones-transporte">
                                    <button onclick="calcularRuta()" class="btn-calcular">
                                        <i class="fas fa-calculator"></i> Calcular
                                    </button>
                                    <button onclick="mostrarFormularioReservaTransporte()" class="btn-reservar-transporte" id="btnReservarTransporte" disabled>
                                        <i class="fas fa-calendar-plus"></i> Reservar
                                    </button>
                                </div>
                                
                                <!-- Formulario de reserva de transporte -->
                                <div id="formularioReservaTransporte" class="formulario-reserva-transporte" style="display: none;">
                                    <h4>Datos de Reserva</h4>
                                    <div class="input-group">
                                        <label for="nombreTransporte">Nombre completo:</label>
                                        <input type="text" id="nombreTransporte" required>
                                    </div>
                                    <div class="input-group">
                                        <label for="telefonoTransporte">Tel√©fono:</label>
                                        <input type="tel" id="telefonoTransporte" required>
                                    </div>
                                    <div class="input-group">
                                        <label for="emailTransporte">Email:</label>
                                        <input type="email" id="emailTransporte" required>
                                    </div>
                                    <div class="input-group">
                                        <label for="fechaTransporte">Fecha de viaje:</label>
                                        <input type="date" id="fechaTransporte" required>
                                    </div>
                                    <div class="input-group">
                                        <label for="horaTransporte">Hora de viaje:</label>
                                        <input type="time" id="horaTransporte" required>
                                    </div>
                                    <div class="input-group">
                                        <label for="comentariosTransporte">Comentarios adicionales:</label>
                                        <textarea id="comentariosTransporte" rows="3" placeholder="Especificaciones especiales, equipaje, etc."></textarea>
                                    </div>
                                    <div class="botones-accion">
                                        <button onclick="cancelarReservaTransporte()" class="btn-cancelar-reserva">
                                            <i class="fas fa-times"></i> Cancelar
                                        </button>
                                        <button onclick="confirmarReservaTransporte()" class="btn-confirmar-reserva">
                                            <i class="fas fa-check"></i> Confirmar Reserva
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="i18n-cresalia.js"></script>
    <script src="js/carrito-por-tienda.js"></script>
    <script src="script-cresalia.js?v=9.8"></script>
    <script src="facturacion.js?v=2.7"></script>
    <!-- script duplicado eliminado para evitar redefinir SECURITY_CONFIG -->
    <script src="js/elegant-notifications.js"></script>
    <script src="js/store-backend-connection.js"></script>
    <script src="js/account-type-system.js"></script>
    <script src="js/history-system.js"></script>
    <script src="js/user-status-system.js"></script>
    <script src="js/subscription-system.js"></script>
    <script src="js/simple-payment-system.js"></script>
    <script src="js/crisla-support-integration.js"></script>
    <script src="js/filtros-productos.js?v=1.3"></script>
    
    <!-- Script para forzar ajuste del hero section -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const heroSection = document.getElementById('inicio');
            if (heroSection) {
                // Forzar estilos
                heroSection.style.marginTop = '70px';
                heroSection.style.paddingTop = '0px';
                heroSection.style.height = 'calc(100vh - 70px)';
                heroSection.style.minHeight = 'calc(100vh - 70px)';
                console.log('‚úÖ Hero section ajustado correctamente');
            }
        });
    </script>
    
    <!-- Script para manejar nuevos registros -->
    <script>
        // Manejar par√°metros de URL para nuevos registros
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            
            // Manejar nueva tienda
            if (urlParams.get('nueva-tienda') === 'true') {
                const slug = urlParams.get('slug');
                const nombre = urlParams.get('nombre');
                const id = urlParams.get('id');
                
                if (slug && nombre) {
                    mostrarBienvenidaTienda(nombre, slug, id);
                    // Limpiar URL
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
            }
            
            // Manejar nuevo usuario
            if (urlParams.get('nuevo-usuario') === 'true') {
                const email = urlParams.get('email');
                const nombre = urlParams.get('nombre');
                const id = urlParams.get('id');
                
                if (email && nombre) {
                    mostrarBienvenidaUsuario(nombre, email, id);
                    // Limpiar URL
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
            }
        });
        
        // Mostrar bienvenida para nueva tienda
        function mostrarBienvenidaTienda(nombre, slug, id) {
            const mensaje = `
                <div style="text-align: center; padding: 2rem; background: linear-gradient(135deg, #7C3AED, #A78BFA); color: white; border-radius: 20px; margin: 2rem 0; box-shadow: 0 10px 30px rgba(124, 58, 237, 0.3);">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">üéâ</div>
                    <h2 style="margin-bottom: 1rem; font-weight: 700;">¬°Bienvenida a Cresalia, ${nombre}!</h2>
                    <p style="font-size: 1.1rem; margin-bottom: 1.5rem; opacity: 0.9;">Tu tienda "${nombre}" ha sido creada exitosamente</p>
                    <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem;">
                        <p style="margin: 0; font-weight: 600;">URL de tu tienda:</p>
                        <p style="margin: 0; font-family: monospace; font-size: 1.1rem;">cresalia.com/tienda/${slug}</p>
                    </div>
                    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                        <button onclick="irATienda('${slug}')" style="background: white; color: #7C3AED; border: none; padding: 12px 24px; border-radius: 25px; font-weight: 600; cursor: pointer; transition: all 0.3s;">
                            <i class="fas fa-store"></i> Ver Mi Tienda
                        </button>
                        <button onclick="cerrarBienvenida()" style="background: rgba(255,255,255,0.2); color: white; border: 2px solid white; padding: 12px 24px; border-radius: 25px; font-weight: 600; cursor: pointer; transition: all 0.3s;">
                            <i class="fas fa-times"></i> Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            // Insertar mensaje al inicio del contenido
            const heroSection = document.querySelector('.hero-section .container');
            if (heroSection) {
                heroSection.insertAdjacentHTML('afterbegin', mensaje);
            }
        }
        
        // Mostrar bienvenida para nuevo usuario
        function mostrarBienvenidaUsuario(nombre, email, id) {
            const mensaje = `
                <div style="text-align: center; padding: 2rem; background: linear-gradient(135deg, #EC4899, #F9A8D4); color: white; border-radius: 20px; margin: 2rem 0; box-shadow: 0 10px 30px rgba(236, 72, 153, 0.3);">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">üëã</div>
                    <h2 style="margin-bottom: 1rem; font-weight: 700;">¬°Bienvenido a Cresalia, ${nombre}!</h2>
                    <p style="font-size: 1.1rem; margin-bottom: 1.5rem; opacity: 0.9;">Tu cuenta ha sido creada exitosamente</p>
                    <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem;">
                        <p style="margin: 0; font-weight: 600;">Email registrado:</p>
                        <p style="margin: 0; font-family: monospace; font-size: 1.1rem;">${email}</p>
                    </div>
                    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                        <button onclick="irAMiCuenta('${id}')" style="background: white; color: #EC4899; border: none; padding: 12px 24px; border-radius: 25px; font-weight: 600; cursor: pointer; transition: all 0.3s;">
                            <i class="fas fa-user"></i> Mi Cuenta
                        </button>
                        <button onclick="cerrarBienvenida()" style="background: rgba(255,255,255,0.2); color: white; border: 2px solid white; padding: 12px 24px; border-radius: 25px; font-weight: 600; cursor: pointer; transition: all 0.3s;">
                            <i class="fas fa-times"></i> Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            // Insertar mensaje al inicio del contenido
            const heroSection = document.querySelector('.hero-section .container');
            if (heroSection) {
                heroSection.insertAdjacentHTML('afterbegin', mensaje);
            }
        }
        
        // Funciones auxiliares
        function irATienda(slug) {
            window.open(`tiendas/${slug}/index.html`, '_blank');
        }
        
        function irAMiCuenta(id) {
            window.open(`usuarios/${id}/profile.html`, '_blank');
        }
        
        function cerrarBienvenida() {
            const bienvenida = document.querySelector('.hero-section .container > div:first-child');
            if (bienvenida) {
                bienvenida.remove();
            }
        }
    </script>
    
    <!-- Sistema de Acceso Secreto al Panel de Administraci√≥n -->
    <script>
        // ===== VARIABLE GLOBAL PARA ACCESO SECRETO =====
        let adminAccessAttempted = false;
        
        // ===== DETECCI√ìN DE COMBINACI√ìN SECRETA =====
        document.addEventListener('keydown', function(event) {
            // Detectar Ctrl + Alt + A (Panel de Administraci√≥n General)
            if (event.ctrlKey && event.altKey && event.key.toLowerCase() === 'a') {
                // Prevenir comportamiento por defecto
                event.preventDefault();
                event.stopPropagation();
                
                // Evitar m√∫ltiples activaciones
                if (adminAccessAttempted) return;
                adminAccessAttempted = true;
                
                // ¬°COMBINACI√ìN CORRECTA!
                console.log('üîê Acceso secreto detectado - Redirigiendo al panel de administraci√≥n...');
                mostrarNotificacionSecreta('üîì Acceso concedido - Redirigiendo al panel de administraci√≥n...', 'success');
                
                // Guardar estado del carrito antes de redirigir
                if (typeof carrito !== 'undefined' && carrito.length > 0) {
                    localStorage.setItem('carritoBackup', JSON.stringify(carrito));
                    console.log('üíæ Carrito guardado antes de redirecci√≥n');
                }
                
                // Redirigir al panel de administraci√≥n con delay
                setTimeout(() => {
                    try {
                        // Usar window.open para abrir en nueva pesta√±a
                        window.open('admin-cresalia.html', '_blank');
                        console.log('üîê Panel de administraci√≥n abierto en nueva pesta√±a');
                    } catch (error) {
                        console.error('Error en redirecci√≥n:', error);
                        // Fallback a redirecci√≥n normal
                        window.location.href = 'admin-cresalia.html';
                    }
                }, 2000);
                
                // Resetear despu√©s de 3 segundos
                setTimeout(() => {
                    adminAccessAttempted = false;
                }, 3000);
            }
            
            // üéØ NUEVO: Acceso exclusivo para CRISLA - Sistema de Atenci√≥n al Cliente
            // Combinaci√≥n secreta: Ctrl + Alt + Shift + C (CRISLA)
            if (event.ctrlKey && event.altKey && event.shiftKey && event.key.toLowerCase() === 'c') {
                // Prevenir comportamiento por defecto
                event.preventDefault();
                event.stopPropagation();
                
                // Evitar m√∫ltiples activaciones
                if (adminAccessAttempted) return;
                adminAccessAttempted = true;
                
                // ¬°ACCESO EXCLUSIVO PARA CARLA!
                console.log('üéØ Acceso exclusivo de CRISLA detectado - Sistema de Atenci√≥n al Cliente...');
                mostrarNotificacionSecreta('üëë Acceso exclusivo de CRISLA - Sistema de Atenci√≥n al Cliente', 'success');
                
                // Guardar estado del carrito antes de redirigir
                if (typeof carrito !== 'undefined' && carrito.length > 0) {
                    localStorage.setItem('carritoBackup', JSON.stringify(carrito));
                    console.log('üíæ Carrito guardado antes de redirecci√≥n');
                }
                
                // Acceso secreto deshabilitado por seguridad
                // Los paneles privados no deben ser accesibles p√∫blicamente
                mostrarNotificacionSecreta('‚ö†Ô∏è Acceso restringido. Este panel es privado.', 'error');
                
                // Resetear despu√©s de 3 segundos
                setTimeout(() => {
                    adminAccessAttempted = false;
                }, 3000);
            }
        });
        
        // ===== NOTIFICACI√ìN SECRETA =====
        function mostrarNotificacionSecreta(mensaje, tipo = 'info') {
            const notificacion = document.createElement('div');
            notificacion.className = `notificacion-secreta notificacion-${tipo}`;
            notificacion.innerHTML = `
                <div class="notificacion-contenido">
                    <span>${mensaje}</span>
                </div>
            `;
            
            // Estilos para notificaci√≥n secreta
            notificacion.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: ${tipo === 'success' ? '#10B981' : tipo === 'error' ? '#EF4444' : '#3B82F6'};
                color: white;
                padding: 1.5rem 2rem;
                border-radius: 15px;
                box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                z-index: 100000;
                animation: fadeInScale 0.3s ease-out;
                font-weight: 600;
                font-size: 1.1rem;
                text-align: center;
                min-width: 300px;
            `;
            
            // Agregar al DOM
            document.body.appendChild(notificacion);
            
            // Auto-remover despu√©s de 3 segundos
            setTimeout(() => {
                if (notificacion.parentElement) {
                    notificacion.remove();
                }
            }, 3000);
        }
        
        // ===== ESTILOS CSS DIN√ÅMICOS PARA NOTIFICACI√ìN =====
        const estilosSecretos = `
            @keyframes fadeInScale {
                from {
                    opacity: 0;
                    transform: translate(-50%, -50%) scale(0.8);
                }
                to {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1);
                }
            }
        `;
        
        // Agregar estilos al head
        const styleSheet = document.createElement('style');
        styleSheet.textContent = estilosSecretos;
        document.head.appendChild(styleSheet);
        
        // ===== LOG DE INICIALIZACI√ìN =====
        console.log('üîê Sistema de acceso secreto inicializado');
        console.log('üéØ Combinaci√≥n secreta: Ctrl + Alt + A');
        console.log('üí° Solo Cresalia conoce esta combinaci√≥n');
    </script>
    
    
    <style>
        @keyframes pulseChat {
            0%, 100% {
                box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
            }
            50% {
                box-shadow: 0 8px 35px rgba(239, 68, 68, 0.6);
            }
        }
        
        /* Estilos para la secci√≥n de servicios */
        .servicios-section {
            padding: 80px 0;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }
        
        .servicios-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .servicio-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .servicio-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            border-color: #667eea;
        }
        
        .servicio-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .servicio-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
                    display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 20px;
                        color: white;
        }
        
        .servicio-info h3 {
            margin: 0;
            color: #2d3748;
            font-size: 1.2rem;
        }
        
        .servicio-categoria {
            color: #667eea;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .servicio-descripcion {
            color: #4a5568;
            margin: 15px 0;
            line-height: 1.6;
        }
        
        .servicio-precio {
            font-size: 1.5rem;
            font-weight: 700;
            color: #10b981;
            margin: 15px 0;
        }
        
        .servicio-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }
        
        .servicio-feature {
            background: #f1f5f9;
            color: #475569;
            padding: 4px 12px;
                    border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .servicio-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-servicio {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-contactar {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-contactar:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-favorito {
            background: #f1f5f9;
            color: #64748b;
            border: 2px solid #e2e8f0;
        }
        
        .btn-favorito:hover {
            background: #fef2f2;
            color: #dc2626;
            border-color: #fecaca;
        }
        
        .filtros-especiales {
                    display: flex;
                    flex-direction: column;
            gap: 8px;
        }
        
        .filtros-especiales .form-check {
            margin: 0;
        }
        
        .filtros-especiales .form-check-label {
            font-size: 0.9rem;
            color: #4a5568;
        }
        
        /* Bot√≥n secundario para servicios */
        .btn-secondary-hero {
            background: linear-gradient(135deg, #10b981, #059669);
                        color: white;
                                border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }
        
        .btn-secondary-hero:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(16, 185, 129, 0.4);
                                color: white;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .servicios-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .servicio-card {
                        padding: 20px;
            }
            
            .servicio-actions {
                flex-direction: column;
            }
        }
    </style>
    
    <script>
        
        // Funciones del widget rojo eliminadas (redundante)
        
        // ===== SISTEMA DE ANIVERSARIOS =====
        
        // Cargar aniversarios al iniciar
        document.addEventListener('DOMContentLoaded', function() {
            cargarAniversarios();
        });
        
        // Cargar aniversarios de tiendas y servicios
        async function cargarAniversarios() {
            try {
                const mesActual = new Date().getMonth() + 1; // 1-12
                
                // Cargar aniversarios de tiendas
                await cargarAniversariosTiendas(mesActual);
                
                // Cargar aniversarios de servicios
                await cargarAniversariosServicios(mesActual);
            } catch (error) {
                console.error('‚ùå Error cargando aniversarios:', error);
            }
        }
        
        // Cargar aniversarios de tiendas
        async function cargarAniversariosTiendas(mesActual) {
            try {
                let tiendas = [];
                
                // Intentar cargar desde Supabase
                if (window.supabase || window.SUPABASE_CLIENT) {
                    const supabase = window.supabase || window.SUPABASE_CLIENT;
                    
                    try {
                        const { data, error } = await supabase
                            .from('tiendas')
                            .select('*')
                            .eq('activo', true);
                        
                        if (!error && data) {
                            tiendas = data;
                        }
                    } catch (supabaseError) {
                        console.log('‚ö†Ô∏è Error cargando tiendas desde Supabase:', supabaseError);
                    }
                }
                
                // Si no hay en Supabase, intentar desde localStorage
                if (tiendas.length === 0) {
                    const keys = Object.keys(localStorage);
                    const tiendasKeys = keys.filter(key => key.startsWith('tienda_') && key !== 'tienda_actual');
                    
                    tiendas = tiendasKeys.map(key => {
                        try {
                            const tienda = JSON.parse(localStorage.getItem(key));
                            return {
                                id: tienda.id || key.replace('tienda_', ''),
                                slug: tienda.slug || tienda.id || key.replace('tienda_', ''),
                                nombre: tienda.nombre || tienda.nombreTienda || 'Tienda sin nombre',
                                imagen: tienda.imagenesVideos?.logo || tienda.logo || './assets/logo/logo-cresalia.png',
                                fecha_creacion: tienda.fechaCreacion || tienda.fecha_creacion || new Date().toISOString(),
                                activo: true
                            };
                        } catch (e) {
                            return null;
                        }
                    }).filter(t => t !== null);
                }
                
                // Filtrar tiendas que cumplen aniversario este mes
                const aniversarios = tiendas.filter(tienda => {
                    if (!tienda.fecha_creacion) return false;
                    
                    const fechaCreacion = new Date(tienda.fecha_creacion);
                    const mesCreacion = fechaCreacion.getMonth() + 1;
                    
                    return mesCreacion === mesActual;
                }).map(tienda => {
                    const fechaCreacion = new Date(tienda.fecha_creacion);
                    const ahora = new Date();
                    const a√±os = ahora.getFullYear() - fechaCreacion.getFullYear();
                    const mesCreacion = fechaCreacion.getMonth();
                    const mesActual = ahora.getMonth();
                    
                    // Ajustar si a√∫n no lleg√≥ el mes este a√±o
                    const a√±osCompletos = (mesActual < mesCreacion) ? a√±os - 1 : a√±os;
                    
                    return {
                        ...tienda,
                        a√±os: a√±osCompletos,
                        fechaCreacion: fechaCreacion
                    };
                }).sort((a, b) => a.fechaCreacion - b.fechaCreacion); // Ordenar por fecha de creaci√≥n
                
                // Mostrar aniversarios
                mostrarAniversariosTiendas(aniversarios);
                
            } catch (error) {
                console.error('‚ùå Error cargando aniversarios de tiendas:', error);
            }
        }
        
        // Cargar aniversarios de servicios
        async function cargarAniversariosServicios(mesActual) {
            try {
                let servicios = [];
                
                // Intentar cargar desde Supabase
                if (window.supabase || window.SUPABASE_CLIENT) {
                    const supabase = window.supabase || window.SUPABASE_CLIENT;
                    
                    try {
                        const { data, error } = await supabase
                            .from('servicios')
                            .select('*, tiendas(nombre, slug, logo)')
                            .eq('estado', 'activo')
                            .eq('visible', true);
                        
                        if (!error && data) {
                            servicios = data;
                        }
                    } catch (supabaseError) {
                        console.log('‚ö†Ô∏è Error cargando servicios desde Supabase:', supabaseError);
                    }
                }
                
                // Si no hay en Supabase, intentar desde localStorage
                if (servicios.length === 0) {
                    const keys = Object.keys(localStorage);
                    const serviciosKeys = keys.filter(key => key.startsWith('servicios_'));
                    
                    servicios = serviciosKeys.flatMap(key => {
                        try {
                            const serviciosArray = JSON.parse(localStorage.getItem(key));
                            return serviciosArray.map(servicio => ({
                                ...servicio,
                                fecha_creacion: servicio.fechaCreacion || servicio.fecha_creacion || new Date().toISOString()
                            }));
                        } catch (e) {
                            return [];
                        }
                    });
                }
                
                // Filtrar servicios que cumplen aniversario este mes
                const aniversarios = servicios.filter(servicio => {
                    if (!servicio.fecha_creacion) return false;
                    
                    const fechaCreacion = new Date(servicio.fecha_creacion);
                    const mesCreacion = fechaCreacion.getMonth() + 1;
                    
                    return mesCreacion === mesActual;
                }).map(servicio => {
                    const fechaCreacion = new Date(servicio.fecha_creacion);
                    const ahora = new Date();
                    const a√±os = ahora.getFullYear() - fechaCreacion.getFullYear();
                    const mesCreacion = fechaCreacion.getMonth();
                    const mesActual = ahora.getMonth();
                    
                    // Ajustar si a√∫n no lleg√≥ el mes este a√±o
                    const a√±osCompletos = (mesActual < mesCreacion) ? a√±os - 1 : a√±os;
                    
                    return {
                        ...servicio,
                        a√±os: a√±osCompletos,
                        fechaCreacion: fechaCreacion
                    };
                }).sort((a, b) => a.fechaCreacion - b.fechaCreacion); // Ordenar por fecha de creaci√≥n
                
                // Mostrar aniversarios
                mostrarAniversariosServicios(aniversarios);
                
            } catch (error) {
                console.error('‚ùå Error cargando aniversarios de servicios:', error);
            }
        }
        
        // Mostrar aniversarios de tiendas
        function mostrarAniversariosTiendas(aniversarios) {
            const container = document.querySelector('[data-list-tiendas-aniversarios]');
            const empty = document.querySelector('[data-empty-tiendas-aniversarios]');
            
            if (!container) return;
            
            if (aniversarios.length === 0) {
                if (empty) empty.style.display = 'block';
                container.innerHTML = '';
                return;
            }
            
            if (empty) empty.style.display = 'none';
            
            container.innerHTML = aniversarios.map(tienda => {
                const dia = tienda.fechaCreacion.getDate();
                const mes = tienda.fechaCreacion.toLocaleDateString('es-AR', { month: 'long', day: 'numeric' });
                
                return `
                    <div class="aniversario-card">
                        <div class="aniversario-avatar">
                            <img src="${tienda.imagen || './assets/logo/logo-cresalia.png'}" alt="${tienda.nombre}" 
                                 onerror="this.src='./assets/logo/logo-cresalia.png'">
                        </div>
                        <div class="aniversario-info">
                            <h4>${tienda.nombre}</h4>
                            <span class="badge">
                                <i class="fas fa-calendar-check"></i> ${tienda.a√±os} ${tienda.a√±os === 1 ? 'a√±o' : 'a√±os'} con Cresalia
                            </span>
                            <div class="aniversario-meta">
                                <i class="fas fa-calendar-alt"></i> ${mes}
                            </div>
                        </div>
                        <div class="aniversario-anos">${dia}</div>
                    </div>
                `;
            }).join('');
        }
        
        // Mostrar aniversarios de servicios
        function mostrarAniversariosServicios(aniversarios) {
            const container = document.querySelector('[data-list-servicios-aniversarios]');
            const empty = document.querySelector('[data-empty-servicios-aniversarios]');
            
            if (!container) return;
            
            if (aniversarios.length === 0) {
                if (empty) empty.style.display = 'block';
                container.innerHTML = '';
                return;
            }
            
            if (empty) empty.style.display = 'none';
            
            container.innerHTML = aniversarios.map(servicio => {
                const nombreTienda = servicio.tiendas?.nombre || servicio.nombre_tienda || servicio.nombre || 'Servicio';
                const logoTienda = servicio.tiendas?.logo || './assets/logo/logo-cresalia.png';
                const dia = servicio.fechaCreacion.getDate();
                const mes = servicio.fechaCreacion.toLocaleDateString('es-AR', { month: 'long', day: 'numeric' });
                
                return `
                    <div class="aniversario-card">
                        <div class="aniversario-avatar">
                            <img src="${logoTienda}" alt="${nombreTienda}" 
                                 onerror="this.src='./assets/logo/logo-cresalia.png'">
                        </div>
                        <div class="aniversario-info">
                            <h4>${servicio.nombre || nombreTienda}</h4>
                            <span class="badge">
                                <i class="fas fa-calendar-check"></i> ${servicio.a√±os} ${servicio.a√±os === 1 ? 'a√±o' : 'a√±os'} con Cresalia
                            </span>
                            <div class="aniversario-meta">
                                <i class="fas fa-calendar-alt"></i> ${mes}
                            </div>
                        </div>
                        <div class="aniversario-anos">${dia}</div>
                    </div>
                `;
            }).join('');
        }
        
        // ===== SISTEMA DE SERVICIOS =====
        
        // Datos de servicios de ejemplo
        // Servicios - NO cargar datos de ejemplo en producci√≥n
        // Los servicios deben agregarse desde el panel de administraci√≥n
        let servicios = [];
        
        // Cargar servicios al iniciar
        document.addEventListener('DOMContentLoaded', function() {
            cargarServicios();
            configurarFiltrosServicios();
        });
        
        // Cargar servicios en el grid
        function cargarServicios() {
            const serviciosGrid = document.getElementById('serviciosGrid');
            if (!serviciosGrid) return;
            
            serviciosGrid.innerHTML = '';
            
            servicios.forEach(servicio => {
                const servicioCard = crearServicioCard(servicio);
                serviciosGrid.appendChild(servicioCard);
            });
        }
        
        // Crear tarjeta de servicio
        function crearServicioCard(servicio) {
            const card = document.createElement('div');
            card.className = 'servicio-card';
            card.innerHTML = `
                <div class="servicio-header">
                    <div class="servicio-icon" style="background: ${servicio.color}">
                        <i class="${servicio.icono}"></i>
                            </div>
                    <div class="servicio-info">
                        <h3>${servicio.nombre}</h3>
                        <div class="servicio-categoria">${obtenerNombreCategoria(servicio.categoria)}</div>
                        </div>
                    </div>
                    
                <div class="servicio-descripcion">
                    ${servicio.descripcion}
                        </div>
                
                <div class="servicio-precio">
                    $${servicio.precio.toLocaleString()}
                    </div>
                    
                <div class="servicio-features">
                    ${servicio.features.map(feature => `<span class="servicio-feature">${feature}</span>`).join('')}
                    ${servicio.envioDomicilio ? '<span class="servicio-feature" style="background: #dcfce7; color: #166534;"><i class="fas fa-truck"></i> A domicilio</span>' : ''}
                    <span class="servicio-feature" style="background: #dbeafe; color: #1e40af;"><i class="fas fa-map-marker-alt"></i> ${servicio.distancia}</span>
                </div>
                
                <div class="servicio-actions">
                    <button class="btn-servicio btn-contactar" onclick="contactarServicio(${servicio.id})">
                        <i class="fas fa-phone"></i> Contactar
                    </button>
                    <button class="btn-servicio btn-favorito" onclick="agregarFavorito(${servicio.id})">
                        <i class="fas fa-heart"></i> Favorito
                            </button>
                        </div>
            `;
            
            return card;
        }
        
        // Obtener nombre de categor√≠a
        function obtenerNombreCategoria(categoria) {
            const categorias = {
                'peluqueria': 'Peluquer√≠a',
                'estetica': 'Est√©tica y Belleza',
                'transporte': 'Transporte',
                'lubricentro': 'Lubricentro',
                'detail': 'Detail y Limpieza',
                'distribucion': 'Distribuci√≥n',
                'restaurante': 'Restaurante',
                'bar': 'Bar y Tragos',
                'cafe': 'Caf√© y T√©',
                'panaderia': 'Panader√≠a',
                'comida': 'Comida',
                'general': 'Negocio General'
            };
            return categorias[categoria] || categoria;
        }
        
        // Configurar filtros
        function configurarFiltrosServicios() {
            const busqueda = document.getElementById('busquedaServicios');
            if (busqueda) {
                busqueda.addEventListener('input', aplicarFiltrosServicios);
            }
        }
        
        // Aplicar filtros
        function aplicarFiltrosServicios() {
            const busqueda = document.getElementById('busquedaServicios')?.value.toLowerCase() || '';
            const categoria = document.getElementById('categoriaServicio')?.value || '';
            const precioMin = parseFloat(document.getElementById('precioMinServicio')?.value) || 0;
            const precioMax = parseFloat(document.getElementById('precioMaxServicio')?.value) || 100000;
            const envioDomicilio = document.getElementById('envioDomicilio')?.checked || false;
            const masBarato = document.getElementById('masBarato')?.checked || false;
            const masCercano = document.getElementById('masCercano')?.checked || false;
            
            let serviciosFiltrados = servicios.filter(servicio => {
                // Filtro de b√∫squeda
                if (busqueda && !servicio.nombre.toLowerCase().includes(busqueda) && 
                    !servicio.descripcion.toLowerCase().includes(busqueda)) {
                    return false;
                }
                
                // Filtro de categor√≠a
                if (categoria && servicio.categoria !== categoria) {
                    return false;
                }
                
                // Filtro de precio
                if (servicio.precio < precioMin || servicio.precio > precioMax) {
                    return false;
                }
                
                // Filtro de env√≠o a domicilio
                if (envioDomicilio && !servicio.envioDomicilio) {
                    return false;
                }
                
                return true;
            });
            
            // Ordenar por criterios especiales
            if (masBarato) {
                serviciosFiltrados.sort((a, b) => a.precio - b.precio);
            }
            
            if (masCercano) {
                serviciosFiltrados.sort((a, b) => parseFloat(a.distancia) - parseFloat(b.distancia));
            }
            
            // Mostrar servicios filtrados
            mostrarServiciosFiltrados(serviciosFiltrados);
        }
        
        // Mostrar servicios filtrados
        function mostrarServiciosFiltrados(serviciosFiltrados) {
            const serviciosGrid = document.getElementById('serviciosGrid');
            if (!serviciosGrid) return;
            
            serviciosGrid.innerHTML = '';
            
            if (serviciosFiltrados.length === 0) {
                serviciosGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #64748b;">
                        <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.5;"></i>
                        <h3>No se encontraron servicios</h3>
                        <p>Intenta ajustar los filtros de b√∫squeda</p>
                    </div>
                `;
                return;
            }
            
            serviciosFiltrados.forEach(servicio => {
                const servicioCard = crearServicioCard(servicio);
                serviciosGrid.appendChild(servicioCard);
            });
        }
        
        // Contactar servicio
        function contactarServicio(servicioId) {
            const servicio = servicios.find(s => s.id === servicioId);
            if (!servicio) return;
            
            // Simular contacto (aqu√≠ integrar√≠as con WhatsApp, tel√©fono, etc.)
            alert(`Contactando con ${servicio.nombre}\nTel√©fono: ${servicio.telefono}\n\n¬°Pronto te contactaremos!`);
        }
        
        // Agregar a favoritos
        function agregarFavorito(servicioId) {
            const servicio = servicios.find(s => s.id === servicioId);
            if (!servicio) return;
            
            // Simular agregar a favoritos
            alert(`¬°${servicio.nombre} agregado a favoritos! üíú`);
        }
        
        // ===== CRESALIA AI CHATBOT =====
        
        // Funci√≥n para enviar mensaje al AI
        function sendAIMessage(inputElement) {
            console.log('üì§ sendAIMessage llamada');
            
            // Si se pasa un input como par√°metro, usarlo; sino buscar
            let input = inputElement;
            if (!input) {
                // Buscar el input dentro del modal activo (puede estar en el body despu√©s de moverlo)
                input = document.getElementById('aiChatInput');
                if (!input) {
                    // Buscar dentro del modal si existe
                    const modal = document.getElementById('aiChatbotModal');
                    if (modal) {
                        input = modal.querySelector('#aiChatInput');
                    }
                }
            }
            
            if (!input) {
                console.error('‚ùå Input no encontrado');
                return;
            }
            
            // Obtener el valor del input directamente del elemento ANTES de cualquier otra operaci√≥n
            const inputValue = input.value || '';
            const message = inputValue.trim();
            
            console.log('üí¨ Mensaje a enviar:', message);
            console.log('üìù Valor del input antes de trim:', inputValue);
            console.log('üìù Input element:', input);
            console.log('üìù Input value length:', inputValue.length);
            
            if (!message || message.length === 0) {
                console.log('‚ö†Ô∏è Mensaje vac√≠o, no se env√≠a');
                console.log('üîç Revisando input... valor raw:', `"${input.value}"`, 'length:', input.value ? input.value.length : 0);
                return;
            }
            
            // Limpiar input ANTES de agregar el mensaje para evitar problemas
            input.value = '';
            
            // Mostrar mensaje del usuario
            addAIMessage(message, 'user');
            
            // Simular respuesta del AI
            setTimeout(() => {
                const response = generateAIResponse(message);
                addAIMessage(response, 'ai');
            }, 1000);
        }
        
        // Generar respuesta del AI
        function generateAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // Respuestas sobre servicios profesionales
            if (lowerMessage.includes('servicio') || lowerMessage.includes('profesional') || lowerMessage.includes('emprendimiento')) {
                return `¬°Excelente! Para servicios profesionales y emprendimientos, puedes:
                
üè™ **Crear tu tienda online** - Vender productos y servicios
üíº **Servicios profesionales** - Ofrecer servicios especializados
üõí **Comprar en Cresalia** - Descubrir tiendas y productos

¬øTe gustar√≠a que te ayude con alguna opci√≥n espec√≠fica?`;
            }
            
            // Respuestas sobre productos
            if (lowerMessage.includes('producto') || lowerMessage.includes('vender') || lowerMessage.includes('tienda')) {
                return `¬°Perfecto! Para vender productos puedes:
                
üè™ **Crear tu tienda online** - Configurar tu tienda completa
üì¶ **Agregar productos** - Subir tus productos con fotos
üí∞ **Gestionar ventas** - Controlar pedidos y pagos
üìä **Analizar ventas** - Ver estad√≠sticas de tu negocio

¬øNecesitas ayuda con alg√∫n paso espec√≠fico?`;
            }
            
            // Respuestas sobre compras
            if (lowerMessage.includes('comprar') || lowerMessage.includes('buscar') || lowerMessage.includes('encontrar')) {
                return `¬°Genial! Para comprar en Cresalia puedes:
                
üõí **Explorar productos** - Ver todas las tiendas disponibles
üîç **Buscar servicios** - Encontrar servicios profesionales
üè™ **Ver tiendas** - Descubrir nuevas tiendas
üíù **Favoritos** - Guardar tus productos favoritos

¬øQu√© tipo de producto o servicio buscas?`;
            }
            
            // Respuestas sobre ayuda
            if (lowerMessage.includes('ayuda') || lowerMessage.includes('problema') || lowerMessage.includes('soporte')) {
                return `¬°Estoy aqu√≠ para ayudarte! Puedo ayudarte con:
                
üè™ **Configurar tu tienda** - Pasos para crear tu tienda
üíº **Servicios profesionales** - C√≥mo ofrecer servicios
üõí **Comprar productos** - Encontrar lo que necesitas
üìû **Contacto directo** - Hablar con nuestro equipo

¬øEn qu√© espec√≠ficamente necesitas ayuda?`;
            }
            
            // Respuesta por defecto
            return `¬°Hola! Soy Cresalia AI, tu asistente virtual. Puedo ayudarte con:
            
üè™ **Crear tu tienda online** - Para vender productos
üíº **Servicios profesionales** - Para ofrecer servicios
üõí **Comprar productos** - Para encontrar lo que necesitas
üìû **Soporte t√©cnico** - Para resolver problemas

¬øEn qu√© puedo ayudarte hoy?`;
        }
        
        // Agregar mensaje al chat
        function addAIMessage(message, sender) {
            // Buscar en el modal que est√© activo
            let messagesContainer = document.getElementById('aiChatbotMessages');
            if (!messagesContainer) {
                // Buscar dentro del modal si existe
                const modal = document.getElementById('aiChatbotModal');
                if (modal) {
                    messagesContainer = modal.querySelector('#aiChatbotMessages');
                }
            }
            if (!messagesContainer) {
                // Fallback al otro ID por si acaso
                messagesContainer = document.getElementById('aiChatMessages');
            }
            if (!messagesContainer) {
                console.error('‚ùå Contenedor de mensajes del chatbot IA no encontrado');
                return;
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `ai-message ai-message-${sender}`;
            
            if (sender === 'user') {
                messageDiv.innerHTML = `
                    <div style="text-align: right; margin-bottom: 15px;">
                        <div style="display: inline-block; background: #667eea; color: white; padding: 10px 15px; border-radius: 15px 15px 0 15px; max-width: 70%;">
                            ${message}
                        </div>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <div style="display: inline-block; background: #f1f5f9; color: #374151; padding: 10px 15px; border-radius: 15px 15px 15px 0; max-width: 70%; white-space: pre-line;">
                            ${message}
                        </div>
                    </div>
                `;
            }
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            console.log('‚úÖ Mensaje agregado al contenedor:', messagesContainer.children.length, 'mensajes totales');
            console.log('üìù √öltimo mensaje:', messageDiv.textContent.substring(0, 50));
        }
        
        // Manejar tecla Enter en el input
        function handleAIChatKeyPress(event) {
            console.log('‚å®Ô∏è Tecla presionada:', event.key, 'keyCode:', event.keyCode);
            if (event.key === 'Enter' || event.keyCode === 13) {
                event.preventDefault();
                event.stopPropagation();
                console.log('‚úÖ Enter detectado, enviando mensaje...');
                // Pasar el input directamente desde el evento
                const input = event.target || event.srcElement;
                console.log('üìù Input del evento:', input, 'valor:', input.value);
                sendAIMessage(input);
                return false;
            }
        }
        
        // ===== SERVICIO DE AYUDA =====
        
        // Funci√≥n para enviar mensaje al servicio de ayuda
        function sendMessage(type = 'help') {
            let input, messagesContainer;
            
            if (type === 'help') {
                input = document.getElementById('chatHelpInput');
                messagesContainer = document.getElementById('chatbotMessages');
            } else if (type === 'ai') {
                input = document.getElementById('chatAIInput');
                messagesContainer = document.getElementById('chatbotMessages');
            }
            
            if (!input || !messagesContainer) return;
            
            const message = input.value.trim();
            if (!message) return;
            
            // Mostrar mensaje del usuario
            addHelpMessage(message, 'user', messagesContainer);
            
            // Limpiar input
            input.value = '';
            
            // Simular respuesta del servicio de ayuda
            setTimeout(() => {
                const response = generateHelpResponse(message, type);
                addHelpMessage(response, 'help', messagesContainer);
            }, 1000);
        }
        
        // Generar respuesta del servicio de ayuda
        function generateHelpResponse(message, type) {
            const lowerMessage = message.toLowerCase();
            
            // Respuestas sobre servicios profesionales
            if (lowerMessage.includes('servicio') || lowerMessage.includes('profesional') || lowerMessage.includes('emprendimiento')) {
                return `¬°Perfecto! Para servicios profesionales y emprendimientos:

üíº **Opciones disponibles:**
‚Ä¢ Crear tu tienda online para vender productos
‚Ä¢ Ofrecer servicios profesionales especializados
‚Ä¢ Gestionar emprendimientos y negocios

üè™ **Para empezar:**
1. Haz clic en "Servicios Profesionales" en el registro
2. Configura tu perfil profesional
3. Agrega tus servicios y precios
4. ¬°Comienza a recibir clientes!

¬øNecesitas ayuda con alg√∫n paso espec√≠fico?`;
            }
            
            // Respuestas sobre productos
            if (lowerMessage.includes('producto') || lowerMessage.includes('vender') || lowerMessage.includes('tienda')) {
                return `¬°Excelente! Para vender productos:

üè™ **Crear tu tienda:**
1. Registra tu tienda online
2. Configura tu perfil y descripci√≥n
3. Agrega productos con fotos y precios
4. Configura m√©todos de pago
5. ¬°Comienza a vender!

üì¶ **Gesti√≥n de productos:**
‚Ä¢ Subir fotos desde tu dispositivo
‚Ä¢ Descripciones detalladas
‚Ä¢ Categor√≠as organizadas
‚Ä¢ Precios competitivos

¬øTe ayudo con alg√∫n paso espec√≠fico?`;
            }
            
            // Respuestas sobre compras
            if (lowerMessage.includes('comprar') || lowerMessage.includes('buscar') || lowerMessage.includes('encontrar')) {
                return `¬°Genial! Para comprar en Cresalia:

üõí **Explorar productos:**
‚Ä¢ Navega por todas las tiendas
‚Ä¢ Usa filtros para encontrar lo que buscas
‚Ä¢ Compara precios y caracter√≠sticas
‚Ä¢ Lee rese√±as de otros compradores

üîç **Buscar servicios:**
‚Ä¢ Encuentra servicios profesionales
‚Ä¢ Filtra por categor√≠a y precio
‚Ä¢ Ve servicios con env√≠o a domicilio
‚Ä¢ Contacta directamente con el proveedor

¬øQu√© tipo de producto o servicio buscas?`;
            }
            
            // Respuestas sobre planes y pagos
            if (lowerMessage.includes('plan') || lowerMessage.includes('pago') || lowerMessage.includes('suscripcion')) {
                return `¬°Informaci√≥n sobre planes:

üí≥ **Planes disponibles:**
‚Ä¢ **Gratuito** - 1.8% de comisi√≥n por venta
‚Ä¢ **B√°sico** - 2.0% de comisi√≥n por venta  
‚Ä¢ **Premium** - 1.5% de comisi√≥n por venta

üí∞ **Ventajas de los planes pagos:**
‚Ä¢ Herramientas avanzadas para crecer
‚Ä¢ Soporte prioritario personalizado
‚Ä¢ IA para descripciones de productos
‚Ä¢ Recursos adicionales de bienestar

¬øTe interesa alg√∫n plan espec√≠fico?`;
            }
            
            // Respuesta por defecto
            return `¬°Hola! Soy el servicio de ayuda de Cresalia. Puedo ayudarte con:

üè™ **Crear tu tienda** - Para vender productos
üíº **Servicios profesionales** - Para ofrecer servicios
üõí **Comprar productos** - Para encontrar lo que necesitas
üí∞ **Planes y pagos** - Informaci√≥n sobre suscripciones
üìû **Soporte t√©cnico** - Para resolver problemas

¬øEn qu√© espec√≠ficamente necesitas ayuda?`;
        }
        
        // Agregar mensaje al chat de ayuda
        function addHelpMessage(message, sender, container) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `help-message help-message-${sender}`;
            
            if (sender === 'user') {
                messageDiv.innerHTML = `
                    <div style="text-align: right; margin-bottom: 15px;">
                        <div style="display: inline-block; background: #667eea; color: white; padding: 10px 15px; border-radius: 15px 15px 0 15px; max-width: 70%;">
                            ${message}
                        </div>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <div style="display: inline-block; background: #f1f5f9; color: #374151; padding: 10px 15px; border-radius: 15px 15px 15px 0; max-width: 70%; white-space: pre-line;">
                            ${message}
                        </div>
                    </div>
                `;
            }
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }
        
        // ===== FUNCIONES PARA ABRIR/CERRAR MODALES =====
        
        // Funci√≥n para abrir/cerrar el chatbot IA
        function toggleAIChatbot() {
            console.log('ü§ñ toggleAIChatbot llamada');
            try {
                const modal = document.getElementById('aiChatbotModal');
                if (!modal) {
                    console.error('‚ùå Modal de chatbot IA no encontrado');
                    return;
                }
                
                console.log('‚úÖ Modal encontrado:', modal);
                const isActive = modal.classList.contains('active') || modal.style.display === 'flex' || window.getComputedStyle(modal).display === 'flex';
                
                // Detectar si es m√≥vil/tablet
                const isMobile = window.innerWidth <= 768;
                
                if (isActive) {
                    console.log('üîÑ Cerrando modal IA');
                    // Cerrar modal
                    modal.classList.remove('active');
                    modal.style.display = 'none';
                    modal.style.opacity = '0';
                    modal.style.visibility = 'hidden';
                    
                    // Remover overlay si existe
                    const overlay = document.getElementById('chatbotOverlay');
                    if (overlay) {
                        overlay.style.display = 'none';
                    }
                    
                    // Restaurar scroll del body completamente
                    document.body.style.overflow = '';
                    document.body.style.position = '';
                    document.body.style.height = '';
                    document.body.classList.remove('modal-open');
                    // Asegurar que se restaure el scroll en m√≥vil
                    if (isMobile) {
                        document.documentElement.style.overflow = '';
                        document.documentElement.style.position = '';
                        document.documentElement.style.height = '';
                        document.documentElement.classList.remove('modal-open');
                        // Forzar rec√°lculo del layout
                        window.scrollTo(0, window.scrollY);
                    }
                } else {
                    console.log('üîÑ Abriendo modal IA');
                    // Cerrar el otro chatbot si est√° abierto
                    const helpModal = document.getElementById('chatbotModal');
                    if (helpModal) {
                        helpModal.classList.remove('active');
                        helpModal.style.display = 'none';
                        helpModal.style.opacity = '0';
                        helpModal.style.visibility = 'hidden';
                        // Restaurar scroll si se estaba bloqueado
                        document.body.style.overflow = '';
                        document.body.style.position = '';
                    }
                    
                    // Mover el modal fuera del contenedor si est√° dentro para evitar problemas de overflow
                    const container = modal.parentElement;
                    if (container && container.classList.contains('ai-chatbot-container')) {
                        document.body.appendChild(modal);
                        console.log('‚úÖ Modal movido fuera del contenedor al body');
                    }
                    
                    // Estilos responsivos seg√∫n el tama√±o de pantalla
                    let modalStyles;
                    if (isMobile) {
                        // En m√≥vil: mini ventana peque√±a centrada (similar a feedbacks) - TAMA√ëO FIJO IGUAL PARA AMBOS
                        modalStyles = 'display: flex !important; flex-direction: column !important; opacity: 1 !important; visibility: visible !important; z-index: 10001 !important; position: fixed !important; top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) !important; width: min(90vw, 400px) !important; max-width: 400px !important; height: min(70vh, 500px) !important; max-height: 500px !important; background: white !important; border-radius: 25px !important; box-shadow: 0 20px 60px rgba(0,0,0,0.3) !important; pointer-events: all !important; overflow: hidden !important;';
                        // En m√≥vil, NO bloquear el scroll del body para evitar problemas
                        // El modal tiene su propio scroll interno
                    } else {
                        // En desktop: tama√±o fijo
                        modalStyles = 'display: flex !important; flex-direction: column !important; opacity: 1 !important; visibility: visible !important; z-index: 10001 !important; position: fixed !important; bottom: 80px !important; right: 20px !important; width: 380px !important; height: 500px !important; max-width: 380px !important; max-height: 500px !important; background: white !important; border-radius: 20px !important; box-shadow: 0 20px 60px rgba(0,0,0,0.3) !important; transform: scale(1) translateY(0) !important; pointer-events: all !important; overflow: hidden !important;';
                        // En desktop s√≠ podemos bloquear el scroll
                        document.body.style.overflow = 'hidden';
                    }
                    
                    // Abrir modal
                    modal.classList.add('active');
                    modal.setAttribute('style', modalStyles);
                    
                    console.log('‚úÖ Estilos aplicados, display:', window.getComputedStyle(modal).display);
                    console.log('‚úÖ Posici√≥n:', window.getComputedStyle(modal).position, window.getComputedStyle(modal).bottom, window.getComputedStyle(modal).right);
                    console.log('‚úÖ Opacidad:', window.getComputedStyle(modal).opacity);
                    console.log('‚úÖ Visibility:', window.getComputedStyle(modal).visibility);
                    console.log('‚úÖ Z-index:', window.getComputedStyle(modal).zIndex);
                    console.log('‚úÖ Transform:', window.getComputedStyle(modal).transform);
                    
                    // Enfocar el input cuando se abre y agregar event listeners - buscar dentro del modal
                    setTimeout(() => {
                        // Remover listeners anteriores si existen para evitar duplicados
                        const input = modal.querySelector('#aiChatInput');
                        if (input) {
                            // Clonar el input para remover todos los listeners
                            const newInput = input.cloneNode(true);
                            input.parentNode.replaceChild(newInput, input);
                            
                            // Ahora trabajar con el nuevo input
                            const cleanInput = modal.querySelector('#aiChatInput');
                            cleanInput.focus();
                            
                            // Agregar UN SOLO event listener para Enter directamente al input
                            cleanInput.addEventListener('keydown', function(e) {
                                if (e.key === 'Enter' || e.keyCode === 13) {
                                    e.preventDefault();
                                    e.stopPropagation();
                                    console.log('‚å®Ô∏è Enter detectado en listener directo');
                                    console.log('üìù Input value en listener:', this.value);
                                    // Pasar el input directamente
                                    sendAIMessage(this);
                                    return false;
                                }
                            }, { once: false });
                            
                            // Agregar event listener al bot√≥n de enviar (remover duplicados primero)
                            const sendButton = modal.querySelector('.send-btn');
                            if (sendButton) {
                                // Remover listeners anteriores
                                const newButton = sendButton.cloneNode(true);
                                sendButton.parentNode.replaceChild(newButton, sendButton);
                                
                                const cleanButton = modal.querySelector('.send-btn');
                                cleanButton.addEventListener('click', function(e) {
                                    e.preventDefault();
                                    e.stopPropagation();
                                    console.log('üîò Bot√≥n de enviar clickeado');
                                    console.log('üìù Input value desde bot√≥n:', cleanInput.value);
                                    // Pasar el input directamente
                                    sendAIMessage(cleanInput);
                                    return false;
                                }, { once: false });
                            }
                        }
                    }, 300);
                    
                    // Agregar mensaje de bienvenida si est√° vac√≠o - buscar dentro del modal
                    setTimeout(() => {
                        const messagesContainer = modal.querySelector('#aiChatbotMessages');
                        console.log('üîç Buscando contenedor de mensajes:', messagesContainer);
                        if (messagesContainer) {
                            console.log('‚úÖ Contenedor encontrado, hijos actuales:', messagesContainer.children.length);
                            if (messagesContainer.children.length === 0) {
                                console.log('üìù Agregando mensaje de bienvenida...');
                                const welcomeMessage = generateAIResponse('hola');
                                addAIMessage(welcomeMessage, 'ai');
                                console.log('‚úÖ Mensaje de bienvenida agregado, hijos ahora:', messagesContainer.children.length);
                            } else {
                                console.log('‚ÑπÔ∏è Ya hay mensajes en el contenedor');
                            }
                        } else {
                            console.error('‚ùå No se encontr√≥ el contenedor de mensajes dentro del modal');
                        }
                    }, 100);
                }
            } catch (error) {
                console.error('‚ùå Error en toggleAIChatbot:', error);
            }
        }
        
        // Funci√≥n para abrir/cerrar el chatbot de ayuda/soporte
        function toggleChatbot() {
            console.log('üí¨ toggleChatbot llamada');
            try {
                const modal = document.getElementById('chatbotModal');
                if (!modal) {
                    console.error('‚ùå Modal de chatbot de ayuda no encontrado');
                    return;
                }
                
                console.log('‚úÖ Modal encontrado:', modal);
                const isActive = modal.classList.contains('active') || modal.style.display === 'flex' || window.getComputedStyle(modal).display === 'flex';
                
                // Detectar si es m√≥vil/tablet
                const isMobile = window.innerWidth <= 768;
                
                if (isActive) {
                    console.log('üîÑ Cerrando modal de ayuda');
                    // Cerrar modal
                    modal.classList.remove('active');
                    modal.style.display = 'none';
                    modal.style.opacity = '0';
                    modal.style.visibility = 'hidden';
                    
                    // Remover overlay si existe
                    const overlay = document.getElementById('chatbotHelpOverlay');
                    if (overlay) {
                        overlay.style.display = 'none';
                    }
                    
                    // Restaurar scroll del body completamente
                    document.body.style.overflow = '';
                    document.body.style.position = '';
                    document.body.style.height = '';
                    document.body.classList.remove('modal-open');
                    // Asegurar que se restaure el scroll en m√≥vil
                    if (isMobile) {
                        document.documentElement.style.overflow = '';
                        document.documentElement.style.position = '';
                        document.documentElement.style.height = '';
                        document.documentElement.classList.remove('modal-open');
                        // Forzar rec√°lculo del layout
                        window.scrollTo(0, window.scrollY);
                    }
                } else {
                    console.log('üîÑ Abriendo modal de ayuda');
                    // Cerrar el otro chatbot si est√° abierto
                    const aiModal = document.getElementById('aiChatbotModal');
                    if (aiModal) {
                        aiModal.classList.remove('active');
                        aiModal.style.display = 'none';
                        aiModal.style.opacity = '0';
                        aiModal.style.visibility = 'hidden';
                        // Restaurar scroll si se estaba bloqueado
                        document.body.style.overflow = '';
                        document.body.style.position = '';
                    }
                    
                    // Mover el modal fuera del contenedor si est√° dentro para evitar problemas de overflow
                    const container = modal.parentElement;
                    if (container && container.classList.contains('chatbot-container')) {
                        document.body.appendChild(modal);
                        console.log('‚úÖ Modal movido fuera del contenedor al body');
                    }
                    
                    // Estilos responsivos seg√∫n el tama√±o de pantalla
                    let modalStyles;
                    if (isMobile) {
                        // Crear overlay de fondo oscuro (similar a feedbacks)
                        let overlay = document.getElementById('chatbotHelpOverlay');
                        if (!overlay) {
                            overlay = document.createElement('div');
                            overlay.id = 'chatbotHelpOverlay';
                            overlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(8px); z-index: 10000; display: flex; justify-content: center; align-items: center;';
                            overlay.onclick = function() { toggleChatbot(); };
                            document.body.appendChild(overlay);
                        }
                        overlay.style.display = 'flex';
                        
                        // En m√≥vil: mini ventana peque√±a centrada (similar a feedbacks) - TAMA√ëO FIJO IGUAL PARA AMBOS
                        modalStyles = 'display: flex !important; flex-direction: column !important; opacity: 1 !important; visibility: visible !important; z-index: 10001 !important; position: fixed !important; top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) !important; width: min(90vw, 400px) !important; max-width: 400px !important; height: min(70vh, 500px) !important; max-height: 500px !important; background: white !important; border-radius: 25px !important; box-shadow: 0 20px 60px rgba(0,0,0,0.3) !important; pointer-events: all !important; overflow: hidden !important;';
                        // En m√≥vil, NO bloquear el scroll del body para evitar problemas
                        // El modal tiene su propio scroll interno
                    } else {
                        // En desktop: tama√±o fijo
                        modalStyles = 'display: flex !important; flex-direction: column !important; opacity: 1 !important; visibility: visible !important; z-index: 10001 !important; position: fixed !important; bottom: 80px !important; right: 20px !important; width: 380px !important; height: 500px !important; max-width: 380px !important; max-height: 500px !important; background: white !important; border-radius: 20px !important; box-shadow: 0 20px 60px rgba(0,0,0,0.3) !important; transform: scale(1) translateY(0) !important; pointer-events: all !important; overflow: hidden !important;';
                        // En desktop s√≠ podemos bloquear el scroll
                        document.body.style.overflow = 'hidden';
                    }
                    
                    // Abrir modal
                    modal.classList.add('active');
                    modal.setAttribute('style', modalStyles);
                    
                    console.log('‚úÖ Estilos aplicados, display:', window.getComputedStyle(modal).display);
                    console.log('‚úÖ Posici√≥n:', window.getComputedStyle(modal).position, window.getComputedStyle(modal).bottom, window.getComputedStyle(modal).right);
                    console.log('‚úÖ Opacidad:', window.getComputedStyle(modal).opacity);
                    console.log('‚úÖ Visibility:', window.getComputedStyle(modal).visibility);
                    console.log('‚úÖ Z-index:', window.getComputedStyle(modal).zIndex);
                    console.log('‚úÖ Transform:', window.getComputedStyle(modal).transform);
                    
                    // Enfocar el input cuando se abre - buscar dentro del modal
                    setTimeout(() => {
                        const input = modal.querySelector('#chatInput');
                        if (input) {
                            input.focus();
                        }
                    }, 300);
                    
                    // Agregar mensaje de bienvenida si est√° vac√≠o - buscar dentro del modal
                    const messagesContainer = modal.querySelector('#chatbotMessages');
                    if (messagesContainer && messagesContainer.children.length === 0) {
                        const welcomeMessage = generateHelpResponse('hola', 'help');
                        addHelpMessage(welcomeMessage, 'help', messagesContainer);
                    }
                }
            } catch (error) {
                console.error('‚ùå Error en toggleChatbot:', error);
            }
        }
        
        // Funci√≥n para manejar tecla Enter en el input del chatbot de ayuda
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatbotMessage();
            }
        }
        
        // Funci√≥n para enviar mensaje en el chatbot de ayuda (sin par√°metros)
        function sendChatbotMessage() {
            // Buscar el modal activo primero
            const modal = document.getElementById('chatbotModal');
            if (!modal) return;
            
            // Buscar elementos dentro del modal espec√≠fico
            const input = modal.querySelector('#chatInput');
            const messagesContainer = modal.querySelector('#chatbotMessages');
            
            if (!input || !messagesContainer) return;
            
            const message = input.value.trim();
            if (!message) return;
            
            // Mostrar mensaje del usuario
            addHelpMessage(message, 'user', messagesContainer);
            
            // Limpiar input
            input.value = '';
            
            // Simular respuesta del servicio de ayuda
            setTimeout(() => {
                const response = generateHelpResponse(message, 'help');
                addHelpMessage(response, 'help', messagesContainer);
            }, 1000);
        }
    </script>
    
    <!-- Asegurar que las funciones de chatbot est√©n disponibles globalmente -->
    <script>
        // Asegurar que las funciones est√©n disponibles cuando el DOM est√© listo
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DOM cargado, funciones de chatbot disponibles');
            
            // Verificar que los modales existan
            const aiModal = document.getElementById('aiChatbotModal');
            const helpModal = document.getElementById('chatbotModal');
            
            if (aiModal) {
                console.log('‚úÖ Modal de chatbot IA encontrado:', aiModal);
            } else {
                console.error('‚ùå Modal de chatbot IA NO encontrado');
            }
            
            if (helpModal) {
                console.log('‚úÖ Modal de chatbot de ayuda encontrado:', helpModal);
            } else {
                console.error('‚ùå Modal de chatbot de ayuda NO encontrado');
            }
            
            // Hacer las funciones disponibles globalmente
            window.toggleAIChatbot = toggleAIChatbot;
            window.toggleChatbot = toggleChatbot;
            window.handleChatKeyPress = handleChatKeyPress;
            window.sendChatbotMessage = sendChatbotMessage;
            // Funciones del chatbot IA
            window.sendAIMessage = sendAIMessage;
            window.handleAIChatKeyPress = handleAIChatKeyPress;
            window.addAIMessage = addAIMessage;
            
            console.log('‚úÖ Funciones de chatbot asignadas a window');
            
            // Ajustar modal al redimensionar ventana (especialmente √∫til en m√≥vil)
            let resizeTimeout;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(function() {
                    const aiModal = document.getElementById('aiChatbotModal');
                    const helpModal = document.getElementById('chatbotModal');
                    const isMobile = window.innerWidth <= 768;
                    
                    // Si un modal est√° abierto, ajustar sus estilos
                    if (aiModal && (aiModal.classList.contains('active') || window.getComputedStyle(aiModal).display === 'flex')) {
                        if (isMobile) {
                            aiModal.setAttribute('style', 'display: flex !important; flex-direction: column !important; opacity: 1 !important; visibility: visible !important; z-index: 10001 !important; position: fixed !important; top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) !important; width: min(90vw, 400px) !important; max-width: 400px !important; height: min(70vh, 500px) !important; max-height: 500px !important; background: white !important; border-radius: 25px !important; box-shadow: 0 20px 60px rgba(0,0,0,0.3) !important; pointer-events: all !important; overflow: hidden !important;');
                        } else {
                            aiModal.setAttribute('style', 'display: flex !important; flex-direction: column !important; opacity: 1 !important; visibility: visible !important; z-index: 10001 !important; position: fixed !important; bottom: 80px !important; right: 20px !important; width: 380px !important; height: 500px !important; max-width: 380px !important; max-height: 500px !important; background: white !important; border-radius: 20px !important; box-shadow: 0 20px 60px rgba(0,0,0,0.3) !important; transform: scale(1) translateY(0) !important; pointer-events: all !important; overflow: hidden !important;');
                        }
                    }
                    
                    if (helpModal && (helpModal.classList.contains('active') || window.getComputedStyle(helpModal).display === 'flex')) {
                        if (isMobile) {
                            helpModal.setAttribute('style', 'display: flex !important; flex-direction: column !important; opacity: 1 !important; visibility: visible !important; z-index: 10001 !important; position: fixed !important; top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) !important; width: min(90vw, 400px) !important; max-width: 400px !important; height: min(70vh, 500px) !important; max-height: 500px !important; background: white !important; border-radius: 25px !important; box-shadow: 0 20px 60px rgba(0,0,0,0.3) !important; pointer-events: all !important; overflow: hidden !important;');
                        } else {
                            helpModal.setAttribute('style', 'display: flex !important; flex-direction: column !important; opacity: 1 !important; visibility: visible !important; z-index: 10001 !important; position: fixed !important; bottom: 80px !important; right: 20px !important; width: 380px !important; height: 500px !important; max-width: 380px !important; max-height: 500px !important; background: white !important; border-radius: 20px !important; box-shadow: 0 20px 60px rgba(0,0,0,0.3) !important; transform: scale(1) translateY(0) !important; pointer-events: all !important; overflow: hidden !important;');
                        }
                    }
                }, 100);
            });
        });
    </script>
    
    <!-- Estilos CSS para chatbot en m√≥vil/tablet -->
    <style>
        /* Asegurar que el modal no se corte y el scroll funcione en m√≥vil */
        @media (max-width: 768px) {
            .ai-chatbot-modal,
            .chatbot-modal {
                /* Mini ventana peque√±a centrada (similar a feedbacks) - TAMA√ëO FIJO IGUAL PARA AMBOS */
                position: fixed !important;
                top: 50% !important;
                left: 50% !important;
                transform: translate(-50%, -50%) !important;
                width: min(90vw, 400px) !important;
                max-width: 400px !important;
                height: min(70vh, 500px) !important;
                max-height: 500px !important;
                bottom: auto !important;
                right: auto !important;
                border-radius: 25px !important;
                overflow: hidden !important;
                box-shadow: 0 20px 60px rgba(0,0,0,0.3) !important;
            }
            
            /* Asegurar que el contenedor de mensajes tenga scroll interno correcto */
            .ai-chatbot-messages,
            .chatbot-messages {
                flex: 1 !important;
                overflow-y: auto !important;
                overflow-x: hidden !important;
                min-height: 0 !important;
                max-height: none !important;
                height: auto !important;
                -webkit-overflow-scrolling: touch !important; /* Scroll suave en iOS */
            }
            
            /* Asegurar que el header y input no se corten */
            .ai-chatbot-header,
            .chatbot-header {
                flex-shrink: 0 !important;
            }
            
            .ai-chatbot-input,
            .chatbot-input {
                flex-shrink: 0 !important;
            }
            
            /* Prevenir que el body se bloquee en m√≥vil cuando el modal est√° abierto */
            body.modal-open {
                overflow: visible !important;
                position: relative !important;
            }
            
            html.modal-open {
                overflow: visible !important;
            }
        }
        
        /* Para tablets */
        @media (min-width: 769px) and (max-width: 1024px) {
            .ai-chatbot-modal,
            .chatbot-modal {
                max-width: 90vw !important;
                max-height: 80vh !important;
                width: 90vw !important;
                height: 80vh !important;
            }
            
            .ai-chatbot-messages,
            .chatbot-messages {
                max-height: none !important;
            }
        }
    </style>
    
    <!-- ===== SISTEMAS ADICIONALES ===== -->
    
    <!-- Sistema de Feedbacks de Tiendas - NO necesario en index (solo en p√°ginas de tiendas) -->
    <!-- <script src="js/sistema-feedbacks.js"></script> -->
    
    <!-- Sistema de Desaf√≠os Emocionales -->
    <script src="js/sistema-desafios-emocionales.js"></script>
    
    <!-- Sistema de Contacto Directo -->
    <script src="js/contacto-directo-crisla.js"></script>
    
    <!-- Sistema Anti-Fraudes -->
    <script src="js/sistema-anti-fraudes-cresalia.js"></script>
    
    <!-- Sistema Protecci√≥n Bidireccional -->
    <script src="js/sistema-proteccion-bidireccional.js"></script>
    
    <!-- Sistema Credenciales Seguras -->
    <script src="js/sistema-credenciales-seguras.js"></script>
    
    <!-- Categor√≠as y Servicios -->
    <script src="js/categorias-servicios-populares.js"></script>
    
    <!-- Filtros Avanzados -->
    <script src="js/filtros-avanzados.js"></script>

    <!-- Cumplea√±eros del Mes -->
    <script src="js/cumpleaneros-home.js"></script>
    
    <!-- Inicializaci√≥n de Sistemas -->
    <script>
        // Inicializar sistemas al cargar
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Inicializando sistemas adicionales...');
            
            // Sistema de Bienestar eliminado
            
            // Sistema de Feedbacks (ya se auto-inicializa)
            
            // Sistema de Desaf√≠os Emocionales
            if (typeof DesafiosEmocionales !== 'undefined') {
                // Se inicializa cuando hay un contenedor disponible
                console.log('‚úÖ Sistema de Desaf√≠os disponible');
            }
            
            // Sistema de Contacto
            if (typeof ContactoDirectoCRISLA !== 'undefined') {
                // Descomentar para activar bot√≥n flotante
                // ContactoDirectoCRISLA.crearBotonFlotante();
                console.log('‚úÖ Sistema de Contacto disponible');
            }
            
            // Categor√≠as y Servicios
            if (typeof CategoriasServiciosPopulares !== 'undefined') {
                console.log('‚úÖ Categor√≠as y Servicios cargados:', {
                    categorias: CategoriasServiciosPopulares.categorias.length,
                    servicios: CategoriasServiciosPopulares.servicios.length
                });
                window.categoriasDisponibles = CategoriasServiciosPopulares;
            }
            
            console.log('üéâ Todos los sistemas cargados correctamente');
        });
        
        // ========================================
        // FUNCIONES DE SISTEMA DE USUARIOS
        // ========================================
        
        function showLoginForm() {
            console.log('üë§ Mostrando formulario de login');
            document.getElementById('loginUserForm').style.display = 'block';
            document.getElementById('registerUserForm').style.display = 'none';
        }
        
        function showRegisterForm() {
            console.log('üë§ Mostrando formulario de registro');
            document.getElementById('loginUserForm').style.display = 'none';
            document.getElementById('registerUserForm').style.display = 'block';
        }
        
        function closeUserSystem() {
            console.log('üë§ Cerrando sistema de usuarios');
            document.getElementById('userSystem').style.display = 'none';
        }
        
        // Funciones mejoradas para redirigir a p√°ginas espec√≠ficas
        function openUserSystem() {
            console.log('üë§ Abriendo sistema de usuarios');
            document.getElementById('userSystem').style.display = 'flex';
            showLoginForm(); // Mostrar login por defecto
        }
        
        // Interceptar env√≠o de formularios para redirigir correctamente
        document.addEventListener('DOMContentLoaded', function() {
            // Interceptar formulario de login
            const loginForms = document.querySelectorAll('#loginUserForm, form[onsubmit*="loginUser"]');
            loginForms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Mostrar modal de selecci√≥n de tipo de login
                    mostrarSeleccionTipoLoginIndex();
                });
            });
            
            // Interceptar formulario de registro
            const registerForms = document.querySelectorAll('#registerUserForm, form[onsubmit*="registerUser"]');
            registerForms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Mostrar modal de selecci√≥n de tipo de cuenta
                    mostrarSeleccionTipoCuentaIndex();
                });
            });
        });
        
        // Funci√≥n para mostrar selecci√≥n de tipo de cuenta en index
        function mostrarSeleccionTipoCuentaIndex() {
            closeUserSystem();
            
            const modalHTML = `
                <div id="modalTipoCuentaIndex" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 99999;">
                    <div style="background: white; border-radius: 20px; padding: 40px; max-width: 500px; margin: 20px;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <h2 style="margin: 0; color: #374151;"><i class="fas fa-user-plus"></i> ¬øQu√© quieres hacer?</h2>
                            <p style="color: #6b7280; margin-top: 10px;">Selecciona el tipo de cuenta que necesitas</p>
                        </div>
                        
                        <div style="display: grid; gap: 20px;">
                            <button onclick="irARegistroTiendaIndex()" style="background: linear-gradient(135deg, #7C3AED, #EC4899); color: white; padding: 20px; border: none; border-radius: 15px; cursor: pointer; text-align: left; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 30px rgba(124, 58, 237, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 60px; height: 60px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                                        üè™
                                    </div>
                                    <div>
                                        <h3 style="margin: 0; font-size: 1.2rem;">Crear mi Tienda Online</h3>
                                        <p style="margin: 5px 0 0 0; opacity: 0.9; font-size: 0.9rem;">Vender productos y ofrecer servicios</p>
                                    </div>
                                </div>
                            </button>
                            
                            <button onclick="irARegistroServiciosProfesionales()" style="background: linear-gradient(135deg, #F59E0B, #EF4444); color: white; padding: 20px; border: none; border-radius: 15px; cursor: pointer; text-align: left; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 30px rgba(245, 158, 11, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 60px; height: 60px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                                        üíº
                                    </div>
                                    <div>
                                        <h3 style="margin: 0; font-size: 1.2rem;">Servicios Profesionales</h3>
                                        <p style="margin: 5px 0 0 0; opacity: 0.9; font-size: 0.9rem;">Ofrecer servicios profesionales y emprendimientos</p>
                                    </div>
                                </div>
                            </button>
                            
                            <button onclick="irARegistroCompradorIndex()" style="background: linear-gradient(135deg, #10B981, #059669); color: white; padding: 20px; border: none; border-radius: 15px; cursor: pointer; text-align: left; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 30px rgba(16, 185, 129, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 60px; height: 60px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                                        üõí
                                    </div>
                                    <div>
                                        <h3 style="margin: 0; font-size: 1.2rem;">Comprar en Cresalia</h3>
                                        <p style="margin: 5px 0 0 0; opacity: 0.9; font-size: 0.9rem;">Descubrir tiendas y productos</p>
                                    </div>
                                </div>
                            </button>
                        </div>
                        
                        <div style="text-align: center; margin-top: 30px;">
                            <button onclick="cerrarModalTipoCuentaIndex()" style="background: #6b7280; color: white; padding: 12px 30px; border: none; border-radius: 10px; cursor: pointer;">
                                <i class="fas fa-times"></i> Cerrar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        // Funci√≥n para mostrar selecci√≥n de tipo de login en index
        function mostrarSeleccionTipoLoginIndex() {
            closeUserSystem();
            
            const modalHTML = `
                <div id="modalTipoLoginIndex" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 99999;">
                    <div style="background: white; border-radius: 20px; padding: 40px; max-width: 500px; margin: 20px;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <h2 style="margin: 0; color: #374151;"><i class="fas fa-sign-in-alt"></i> ¬øC√≥mo quieres ingresar?</h2>
                            <p style="color: #6b7280; margin-top: 10px;">Selecciona tu tipo de cuenta</p>
                        </div>
                        
                        <div style="display: grid; gap: 20px;">
                            <button onclick="irALoginTiendaIndex()" style="background: linear-gradient(135deg, #7C3AED, #EC4899); color: white; padding: 20px; border: none; border-radius: 15px; cursor: pointer; text-align: left; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 30px rgba(124, 58, 237, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 60px; height: 60px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                                        üè™
                                    </div>
                                    <div>
                                        <h3 style="margin: 0; font-size: 1.2rem;">Soy Vendedor</h3>
                                        <p style="margin: 5px 0 0 0; opacity: 0.9; font-size: 0.9rem;">Acceder a mi tienda</p>
                                    </div>
                                </div>
                            </button>
                            
                            <button onclick="irALoginCompradorIndex()" style="background: linear-gradient(135deg, #10B981, #059669); color: white; padding: 20px; border: none; border-radius: 15px; cursor: pointer; text-align: left; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 30px rgba(16, 185, 129, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 60px; height: 60px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                                        üõí
                                    </div>
                                    <div>
                                        <h3 style="margin: 0; font-size: 1.2rem;">Soy Comprador</h3>
                                        <p style="margin: 5px 0 0 0; opacity: 0.9; font-size: 0.9rem;">Acceder a mi cuenta</p>
                                    </div>
                                </div>
                            </button>
                        </div>
                        
                        <div style="text-align: center; margin-top: 30px;">
                            <button onclick="cerrarModalTipoLoginIndex()" style="background: #6b7280; color: white; padding: 12px 30px; border: none; border-radius: 10px; cursor: pointer;">
                                <i class="fas fa-times"></i> Cerrar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        // Funciones de redirecci√≥n para index
        function irARegistroTiendaIndex() {
            window.location.href = 'registro-tienda.html';
        }
        
        function irARegistroServiciosProfesionales() {
            // Redirigir a la p√°gina de admin para servicios profesionales
            window.location.href = 'tiendas/ejemplo-tienda/admin.html';
        }
        
        function irARegistroCompradorIndex() {
            window.location.href = 'registro-comprador.html';
        }
        
        function irALoginTiendaIndex() {
            window.location.href = 'login-tienda.html';
        }
        
        function irALoginCompradorIndex() {
            window.location.href = 'login-comprador.html';
        }
        
        function cerrarModalTipoCuentaIndex() {
            const modal = document.getElementById('modalTipoCuentaIndex');
            if (modal) modal.remove();
        }
        
        function cerrarModalTipoLoginIndex() {
            const modal = document.getElementById('modalTipoLoginIndex');
            if (modal) modal.remove();
        }
    </script>
    
    <!-- üì± PWA INSTALLATION BUTTON -->
    <div id="pwa-install-container" style="display: none; position: fixed; top: 20px; right: 20px; z-index: 9999;">
        <button id="pwa-install-btn" style="
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)';">
            <i class="fas fa-download"></i>
            <span>Instalar App</span>
        </button>
    </div>

    <!-- üì± PWA SCRIPTS -->
    <script>
        // üîß PWA Configuration
        const PWA_CONFIG = {
            enabled: false, // ‚ö†Ô∏è CAMBIAR A true PARA ACTIVAR PWA
            showInstallPrompt: true,
            notificationsEnabled: false
        };

        // üì± PWA Install Prompt Management
        let deferredPrompt;
        const installButton = document.getElementById('pwa-install-btn');
        const installContainer = document.getElementById('pwa-install-container');

        // üîß Service Worker Registration
        async function registerServiceWorker() {
            if (!PWA_CONFIG.enabled) {
                console.log('üîÑ PWA desactivada - Service Worker no registrado');
                return;
            }

            if ('serviceWorker' in navigator) {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    
                    console.log('‚úÖ Service Worker registrado:', registration.scope);
                    
                    // Manejar actualizaciones
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                showUpdateNotification();
                            }
                        });
                    });
                    
                } catch (error) {
                    console.error('‚ùå Error registrando Service Worker:', error);
                }
            }
        }

        // üì± PWA Install Prompt
        window.addEventListener('beforeinstallprompt', (e) => {
            if (!PWA_CONFIG.enabled || !PWA_CONFIG.showInstallPrompt) {
                return;
            }

            e.preventDefault();
            deferredPrompt = e;
            
            // Mostrar bot√≥n de instalaci√≥n personalizado
            installContainer.style.display = 'block';
            
            // Animaci√≥n de entrada
            installContainer.style.opacity = '0';
            installContainer.style.transform = 'translateY(-20px)';
            setTimeout(() => {
                installContainer.style.transition = 'all 0.3s ease';
                installContainer.style.opacity = '1';
                installContainer.style.transform = 'translateY(0)';
            }, 100);
        });

        // üéØ Install Button Click Handler
        installButton.addEventListener('click', async () => {
            if (!deferredPrompt) return;

            try {
                // Mostrar prompt nativo
                deferredPrompt.prompt();
                
                // Esperar respuesta del usuario
                const { outcome } = await deferredPrompt.userChoice;
                
                if (outcome === 'accepted') {
                    console.log('‚úÖ PWA instalada por el usuario');
                    showNotification('¬°Cresalia instalada correctamente!', 'success');
                } else {
                    console.log('‚ùå Usuario cancel√≥ instalaci√≥n PWA');
                }
                
                // Limpiar prompt
                deferredPrompt = null;
                installContainer.style.display = 'none';
                
            } catch (error) {
                console.error('‚ùå Error instalando PWA:', error);
                showNotification('Error al instalar la aplicaci√≥n', 'error');
            }
        });

        // üì± PWA Installed Event
        window.addEventListener('appinstalled', () => {
            console.log('‚úÖ PWA instalada exitosamente');
            installContainer.style.display = 'none';
            showNotification('¬°Bienvenido a Cresalia App! üéâ', 'success');
            
            // Ocultar elementos web-only
            document.querySelectorAll('.web-only').forEach(el => {
                el.style.display = 'none';
            });
        });

        // üîÑ Update Notification
        function showUpdateNotification() {
            if (!PWA_CONFIG.enabled) return;

            const notification = document.createElement('div');
            notification.innerHTML = `
                <div style="
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 15px 25px;
                    border-radius: 15px;
                    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
                    z-index: 10000;
                    font-family: 'Poppins', sans-serif;
                    display: flex;
                    align-items: center;
                    gap: 15px;
                    animation: slideDown 0.3s ease;
                ">
                    <i class="fas fa-sync-alt"></i>
                    <span>Nueva versi√≥n disponible</span>
                    <button onclick="window.location.reload()" style="
                        background: rgba(255,255,255,0.2);
                        border: 1px solid rgba(255,255,255,0.3);
                        color: white;
                        padding: 5px 15px;
                        border-radius: 8px;
                        cursor: pointer;
                        font-size: 0.9rem;
                    ">Actualizar</button>
                    <button onclick="this.parentElement.parentElement.remove()" style="
                        background: none;
                        border: none;
                        color: white;
                        cursor: pointer;
                        font-size: 1.2rem;
                        opacity: 0.7;
                    ">&times;</button>
                </div>
            `;
            document.body.appendChild(notification);
            
            // Auto-remover despu√©s de 10 segundos
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 10000);
        }

        // üîî PWA Notifications Helper
        function showNotification(message, type = 'info') {
            // Usar el sistema de notificaciones existente de Cresalia
            if (typeof mostrarNotificacion === 'function') {
                mostrarNotificacion(message, type);
            } else {
                // Fallback simple
                console.log(`üì¢ ${type.toUpperCase()}: ${message}`);
            }
        }

        // üéØ Check PWA Display Mode
        function checkPWAMode() {
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const isInStandaloneMode = ('standalone' in window.navigator) && (window.navigator.standalone);
            
            if (isStandalone || (isIOS && isInStandaloneMode)) {
                document.body.classList.add('pwa-mode');
                console.log('üì± Ejecut√°ndose como PWA');
                // Mostrar bot√≥n flotante de perfil en modo PWA
                mostrarBotonPerfilPWA();
            }
        }

        // üë§ Bot√≥n flotante de perfil para PWA
        function mostrarBotonPerfilPWA() {
            // Verificar si ya existe el bot√≥n
            if (document.getElementById('pwa-profile-btn')) {
                return;
            }

            const profileButton = document.createElement('div');
            profileButton.id = 'pwa-profile-btn';
            profileButton.innerHTML = `
                <button onclick="toggleUserSystem()" style="
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    border: none;
                    width: 56px;
                    height: 56px;
                    border-radius: 50%;
                    cursor: pointer;
                    font-size: 24px;
                    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
                    transition: all 0.3s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    position: fixed;
                    bottom: 100px;
                    right: 20px;
                    z-index: 9998;
                " onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.5)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)';" title="Mi Cuenta - Crear cuenta o iniciar sesi√≥n">
                    <i class="fas fa-user-circle"></i>
                </button>
            `;
            document.body.appendChild(profileButton);
        }

        // üöÄ PWA Initialization
        document.addEventListener('DOMContentLoaded', () => {
            checkPWAMode();
            
            if (PWA_CONFIG.enabled) {
                registerServiceWorker();
                console.log('üöÄ PWA Cresalia inicializada');
            } else {
                console.log('‚è∏Ô∏è PWA Cresalia desactivada');
                console.log('üí° Para activar: cambiar PWA_CONFIG.enabled = true');
            }
        });

        // üì± PWA Share API
        async function shareContent(title, text, url) {
            if (!PWA_CONFIG.enabled) return false;

            if (navigator.share) {
                try {
                    await navigator.share({ title, text, url });
                    return true;
                } catch (error) {
                    console.log('‚ùå Error compartiendo:', error);
                }
            }
            return false;
        }

        // üîã PWA Battery API (opcional)
        async function checkBatteryStatus() {
            if (!PWA_CONFIG.enabled || !navigator.getBattery) return;

            try {
                const battery = await navigator.getBattery();
                if (battery.level < 0.2 && !battery.charging) {
                    showNotification('Bater√≠a baja. Considera activar modo ahorro.', 'warning');
                }
            } catch (error) {
                console.log('‚ùå Battery API no disponible');
            }
        }

        // üì± Add to Home Screen CSS for PWA mode
        const pwaStyles = `
            <style id="pwa-styles">
                .pwa-mode .web-only { display: none !important; }
                .pwa-mode body { padding-top: env(safe-area-inset-top); }
                .pwa-mode .navbar { padding-top: env(safe-area-inset-top); }
                
                /* Bot√≥n de perfil PWA - Responsive */
                #pwa-profile-btn {
                    position: fixed;
                    bottom: 100px;
                    right: 20px;
                    z-index: 9998;
                }
                
                @media (max-width: 768px) {
                    #pwa-profile-btn {
                        bottom: 80px;
                        right: 15px;
                    }
                    #pwa-profile-btn button {
                        width: 50px !important;
                        height: 50px !important;
                        font-size: 20px !important;
                    }
                }
                
                @keyframes slideDown {
                    from { transform: translateX(-50%) translateY(-50px); opacity: 0; }
                    to { transform: translateX(-50%) translateY(0); opacity: 1; }
                }
            </style>
        `;
        document.head.insertAdjacentHTML('beforeend', pwaStyles);

        // üåê PWA Analytics (opcional)
        function trackPWAUsage(event, data = {}) {
            if (!PWA_CONFIG.enabled) return;

            // Aqu√≠ puedes integrar con tu sistema de analytics
            console.log(`üìä PWA Event: ${event}`, data);
            
            // Ejemplo: Google Analytics
            if (typeof gtag === 'function') {
                gtag('event', event, {
                    event_category: 'PWA',
                    ...data
                });
            }
        }

        console.log('üì± Sistema PWA Cresalia cargado' + (PWA_CONFIG.enabled ? ' y activo' : ' (desactivado)'));
    </script>
    
    <!-- Mercado Pago SDK (solo para SaaS principal) -->
    <script src="https://sdk.mercadopago.com/js/v2"></script>
    
    <!-- Configuraci√≥n Mercado Pago -->
    <script src="config-mercado-pago.js"></script>
    
    <!-- Integraci√≥n Mercado Pago (CheckoutAPI) -->
    <script src="js/mercadopago-checkoutapi.js"></script>
    
    <!-- Integraci√≥n Mercado Pago (legacy, para compatibilidad) -->
    <script src="js/mercado-pago-integration.js"></script>
    
    <!-- Sistema de Alertas de Emergencia Global -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config-supabase-seguro.js"></script>
    <script src="js/sistema-alertas-comunidades.js"></script>
    <!-- Sistema de Alertas de Emergencia Global -->
    <script src="js/sistema-alertas-emergencia-global.js"></script>
    <!-- Sistema de Check-in Autom√°tico de Emergencias -->
    <script src="js/sistema-checkin-emergencias.js"></script>
    <script>
        // Inicializar sistema de alertas global (sin comunidad espec√≠fica)
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                if (typeof SistemaAlertasComunidades !== 'undefined') {
                    window.alertasGlobalCresalia = new SistemaAlertasComunidades('global');
                }
                // Inicializar sistema de alertas de emergencia global
                if (typeof SistemaAlertasEmergenciaGlobal !== 'undefined') {
                    window.sistemaAlertasEmergenciaGlobal = new SistemaAlertasEmergenciaGlobal();
                    window.sistemaAlertasEmergenciaGlobal.inicializar();
                }
                // Sistema de check-in se inicializa autom√°ticamente
            }, 500);
        });
    </script>
    <!-- Sistema de Feedbacks General -->
    <script src="js/sistema-feedbacks-general.js"></script>
    
    <!-- Sistema de Notificaciones Push -->
    <script src="js/sistema-notificaciones-push.js"></script>
    
    <!-- Widget de Chat de Email - Brevo -->
    <script src="js/widget-brevo-chat.js"></script>
    
    <!-- Sistema de Permisos (Notificaciones y Ubicaci√≥n) -->
    <script>
        // Solicitar permisos de notificaci√≥n y ubicaci√≥n despu√©s de cargar la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            // Esperar a que todos los scripts se carguen
            setTimeout(() => {
                // El sistema de notificaciones se inicializa autom√°ticamente en sistema-notificaciones-push.js
                // Solo verificar que est√© disponible
                if (window.sistemaNotificaciones) {
                    console.log('‚úÖ Sistema de notificaciones push disponible');
                    // El sistema ya solicita permisos autom√°ticamente en su inicializaci√≥n
                }
                
                // Solicitar permisos de ubicaci√≥n para alertas de emergencia
                if (typeof SistemaAlertasEmergenciaGlobal !== 'undefined' && window.sistemaAlertasEmergenciaGlobal) {
                    console.log('üìç Solicitando permisos de ubicaci√≥n para alertas de emergencia...');
                    // Esperar un poco m√°s para que el sistema se inicialice completamente
                    setTimeout(() => {
                        window.sistemaAlertasEmergenciaGlobal.solicitarUbicacionParaEmergencias();
                    }, 3000);
                } else if (typeof SistemaAlertasEmergenciaGlobal !== 'undefined') {
                    // Si el sistema existe pero no est√° en window, inicializarlo
                    window.sistemaAlertasEmergenciaGlobal = new SistemaAlertasEmergenciaGlobal();
                    window.sistemaAlertasEmergenciaGlobal.inicializar();
                    setTimeout(() => {
                        window.sistemaAlertasEmergenciaGlobal.solicitarUbicacionParaEmergencias();
                    }, 1000);
                }
            }, 4000); // Esperar 4 segundos despu√©s de cargar la p√°gina para mejor UX
        });
    </script>
    
    <style>
        .historias-corazon-section {
            padding: 80px 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(236, 72, 153, 0.05));
        }
        
        .historias-logo-container {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .historias-logo {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.2);
        }
        
        .historias-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .historia-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .historia-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #ec4899);
        }
        
        .historia-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.15);
        }
        
        .historia-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .historia-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #667eea;
        }
        
        .historia-info h4 {
            margin: 0;
            color: #1e293b;
            font-size: 1.2rem;
        }
        
        .historia-info p {
            margin: 5px 0 0 0;
            color: #64748b;
            font-size: 0.9rem;
        }
        
        .historia-contenido {
            color: #475569;
            line-height: 1.7;
            margin-bottom: 20px;
        }
        
        .historia-acciones {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn-historia {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .btn-editar-historia {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }
        
        .btn-editar-historia:hover {
            background: rgba(102, 126, 234, 0.2);
        }
        
        .btn-eliminar-historia {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }
        
        .btn-eliminar-historia:hover {
            background: rgba(239, 68, 68, 0.2);
        }
        
        @media (max-width: 768px) {
            .historias-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    
    <script src="js/historias-corazon-cresalia.js">    </script>
    
    <!-- Sistema de Monitoreo de Errores Propio (Fallback) -->
    <script src="js/error-reporter.js"></script>
    
    <!-- Sistema de Verificaci√≥n de Mantenimiento -->
    <script src="js/sistema-mantenimiento.js"></script>
</body>
</html>
